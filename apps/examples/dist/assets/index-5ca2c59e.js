var RA=Object.defineProperty;var LA=(t,e,n)=>e in t?RA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var y=(t,e,n)=>(LA(t,typeof e!="symbol"?e+"":e,n),n);function DA(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in t)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(t,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var PP={exports:{}},Sp={},_P={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ou=Symbol.for("react.element"),OA=Symbol.for("react.portal"),jA=Symbol.for("react.fragment"),NA=Symbol.for("react.strict_mode"),BA=Symbol.for("react.profiler"),zA=Symbol.for("react.provider"),UA=Symbol.for("react.context"),FA=Symbol.for("react.forward_ref"),KA=Symbol.for("react.suspense"),HA=Symbol.for("react.memo"),VA=Symbol.for("react.lazy"),Ux=Symbol.iterator;function WA(t){return t===null||typeof t!="object"?null:(t=Ux&&t[Ux]||t["@@iterator"],typeof t=="function"?t:null)}var IP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},CP=Object.assign,kP={};function nl(t,e,n){this.props=t,this.context=e,this.refs=kP,this.updater=n||IP}nl.prototype.isReactComponent={};nl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};nl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $P(){}$P.prototype=nl.prototype;function z0(t,e,n){this.props=t,this.context=e,this.refs=kP,this.updater=n||IP}var U0=z0.prototype=new $P;U0.constructor=z0;CP(U0,nl.prototype);U0.isPureReactComponent=!0;var Fx=Array.isArray,TP=Object.prototype.hasOwnProperty,F0={current:null},MP={key:!0,ref:!0,__self:!0,__source:!0};function AP(t,e,n){var r,o={},i=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(i=""+e.key),e)TP.call(e,r)&&!MP.hasOwnProperty(r)&&(o[r]=e[r]);var a=arguments.length-2;if(a===1)o.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];o.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)o[r]===void 0&&(o[r]=a[r]);return{$$typeof:ou,type:t,key:i,ref:s,props:o,_owner:F0.current}}function YA(t,e){return{$$typeof:ou,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function K0(t){return typeof t=="object"&&t!==null&&t.$$typeof===ou}function XA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Kx=/\/+/g;function Af(t,e){return typeof t=="object"&&t!==null&&t.key!=null?XA(""+t.key):e.toString(36)}function Ld(t,e,n,r,o){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case ou:case OA:s=!0}}if(s)return s=t,o=o(s),t=r===""?"."+Af(s,0):r,Fx(o)?(n="",t!=null&&(n=t.replace(Kx,"$&/")+"/"),Ld(o,e,n,"",function(c){return c})):o!=null&&(K0(o)&&(o=YA(o,n+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(Kx,"$&/")+"/")+t)),e.push(o)),1;if(s=0,r=r===""?".":r+":",Fx(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Af(i,a);s+=Ld(i,e,n,l,o)}else if(l=WA(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Af(i,a++),s+=Ld(i,e,n,l,o);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Nu(t,e,n){if(t==null)return t;var r=[],o=0;return Ld(t,r,"","",function(i){return e.call(n,i,o++)}),r}function GA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Cn={current:null},Dd={transition:null},qA={ReactCurrentDispatcher:Cn,ReactCurrentBatchConfig:Dd,ReactCurrentOwner:F0};Oe.Children={map:Nu,forEach:function(t,e,n){Nu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Nu(t,function(){e++}),e},toArray:function(t){return Nu(t,function(e){return e})||[]},only:function(t){if(!K0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Oe.Component=nl;Oe.Fragment=jA;Oe.Profiler=BA;Oe.PureComponent=z0;Oe.StrictMode=NA;Oe.Suspense=KA;Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qA;Oe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=CP({},t.props),o=t.key,i=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,s=F0.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)TP.call(e,l)&&!MP.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:ou,type:t.type,key:o,ref:i,props:r,_owner:s}};Oe.createContext=function(t){return t={$$typeof:UA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:zA,_context:t},t.Consumer=t};Oe.createElement=AP;Oe.createFactory=function(t){var e=AP.bind(null,t);return e.type=t,e};Oe.createRef=function(){return{current:null}};Oe.forwardRef=function(t){return{$$typeof:FA,render:t}};Oe.isValidElement=K0;Oe.lazy=function(t){return{$$typeof:VA,_payload:{_status:-1,_result:t},_init:GA}};Oe.memo=function(t,e){return{$$typeof:HA,type:t,compare:e===void 0?null:e}};Oe.startTransition=function(t){var e=Dd.transition;Dd.transition={};try{t()}finally{Dd.transition=e}};Oe.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Oe.useCallback=function(t,e){return Cn.current.useCallback(t,e)};Oe.useContext=function(t){return Cn.current.useContext(t)};Oe.useDebugValue=function(){};Oe.useDeferredValue=function(t){return Cn.current.useDeferredValue(t)};Oe.useEffect=function(t,e){return Cn.current.useEffect(t,e)};Oe.useId=function(){return Cn.current.useId()};Oe.useImperativeHandle=function(t,e,n){return Cn.current.useImperativeHandle(t,e,n)};Oe.useInsertionEffect=function(t,e){return Cn.current.useInsertionEffect(t,e)};Oe.useLayoutEffect=function(t,e){return Cn.current.useLayoutEffect(t,e)};Oe.useMemo=function(t,e){return Cn.current.useMemo(t,e)};Oe.useReducer=function(t,e,n){return Cn.current.useReducer(t,e,n)};Oe.useRef=function(t){return Cn.current.useRef(t)};Oe.useState=function(t){return Cn.current.useState(t)};Oe.useSyncExternalStore=function(t,e,n){return Cn.current.useSyncExternalStore(t,e,n)};Oe.useTransition=function(){return Cn.current.useTransition()};Oe.version="18.2.0";_P.exports=Oe;var w=_P.exports;const xe=tl(w),mh=DA({__proto__:null,default:xe},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QA=w,ZA=Symbol.for("react.element"),JA=Symbol.for("react.fragment"),eR=Object.prototype.hasOwnProperty,tR=QA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nR={key:!0,ref:!0,__self:!0,__source:!0};function RP(t,e,n){var r,o={},i=null,s=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)eR.call(e,r)&&!nR.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:ZA,type:t,key:i,ref:s,props:o,_owner:tR.current}}Sp.Fragment=JA;Sp.jsx=RP;Sp.jsxs=RP;PP.exports=Sp;var f=PP.exports;function O(t,e={}){const n=typeof t=="string"?t:t.src;if(typeof e=="function")return e(n);const{baseUrl:r=""}=e;return n.startsWith("data:")||n.match(/^https?:\/\//)?n:`${r.replace(/\/$/,"")}/${n.replace(/^\.?\//,"")}`}function rR(t){return{fonts:{monospace:O(new URL("/assets/IBMPlexMono-Medium-602b967b.woff2",self.location).href,t),sansSerif:O(new URL("/assets/IBMPlexSans-Medium-032f2da3.woff2",self.location).href,t),serif:O(new URL("/assets/IBMPlexSerif-Medium-8685eac3.woff2",self.location).href,t),draw:O(new URL("/assets/Shantell_Sans-Normal-SemiBold-1857bc6e.woff2",self.location).href,t)},icons:{"align-bottom-center":O(new URL("/assets/align-bottom-center-98ae03ef.svg",self.location).href,t),"align-bottom-left":O(new URL("/assets/align-bottom-left-07ae03a3.svg",self.location).href,t),"align-bottom-right":O(new URL("/assets/align-bottom-right-70299e1f.svg",self.location).href,t),"align-bottom":O(new URL("/assets/align-bottom-87873aaf.svg",self.location).href,t),"align-center-center":O(new URL("/assets/align-center-center-1e23bfe8.svg",self.location).href,t),"align-center-horizontal":O(new URL("/assets/align-center-horizontal-13d7b61c.svg",self.location).href,t),"align-center-left":O(new URL("/assets/align-center-left-61368b96.svg",self.location).href,t),"align-center-right":O(new URL("/assets/align-center-right-f5c1febe.svg",self.location).href,t),"align-center-vertical":O(new URL("/assets/align-center-vertical-dd2a323f.svg",self.location).href,t),"align-left":O(new URL("/assets/align-left-91be85c5.svg",self.location).href,t),"align-right":O(new URL("/assets/align-right-c34c732d.svg",self.location).href,t),"align-top-center":O(new URL("/assets/align-top-center-d00b6824.svg",self.location).href,t),"align-top-left":O(new URL("/assets/align-top-left-b36e1d34.svg",self.location).href,t),"align-top-right":O(new URL("/assets/align-top-right-a42d38c2.svg",self.location).href,t),"align-top":O(new URL("/assets/align-top-de8caa57.svg",self.location).href,t),"arrow-left":O(new URL("/assets/arrow-left-c1856d50.svg",self.location).href,t),"arrowhead-arrow":O(new URL("/assets/arrowhead-arrow-aa22be04.svg",self.location).href,t),"arrowhead-bar":O(new URL("/assets/arrowhead-bar-b46daeee.svg",self.location).href,t),"arrowhead-diamond":O(new URL("/assets/arrowhead-diamond-240be147.svg",self.location).href,t),"arrowhead-dot":O(new URL("/assets/arrowhead-dot-a3fe2c9e.svg",self.location).href,t),"arrowhead-none":O(new URL("/assets/arrowhead-none-584d3843.svg",self.location).href,t),"arrowhead-square":O(new URL("/assets/arrowhead-square-9fc2a59d.svg",self.location).href,t),"arrowhead-triangle-inverted":O(new URL("/assets/arrowhead-triangle-inverted-0bdbf3c9.svg",self.location).href,t),"arrowhead-triangle":O(new URL("/assets/arrowhead-triangle-2e2ce23f.svg",self.location).href,t),"aspect-ratio":O(new URL("/assets/aspect-ratio-9a6ba93d.svg",self.location).href,t),avatar:O(new URL("/assets/avatar-55a2882d.svg",self.location).href,t),blob:O(new URL("/assets/blob-d6ef2b5b.svg",self.location).href,t),"bring-forward":O(new URL("/assets/bring-forward-3e596147.svg",self.location).href,t),"bring-to-front":O(new URL("/assets/bring-to-front-878dcb2a.svg",self.location).href,t),check:O(new URL("/assets/check-5fb46552.svg",self.location).href,t),"checkbox-checked":O(new URL("/assets/checkbox-checked-63e568a8.svg",self.location).href,t),"checkbox-empty":O(new URL("/assets/checkbox-empty-b93e2d3d.svg",self.location).href,t),"chevron-down":O(new URL("/assets/chevron-down-e1e1407a.svg",self.location).href,t),"chevron-left":O(new URL("/assets/chevron-left-4f19e170.svg",self.location).href,t),"chevron-right":O(new URL("/assets/chevron-right-9cd9116e.svg",self.location).href,t),"chevron-up":O(new URL("/assets/chevron-up-cb281221.svg",self.location).href,t),"chevrons-ne":O(new URL("/assets/chevrons-ne-de971f54.svg",self.location).href,t),"chevrons-sw":O(new URL("/assets/chevrons-sw-a7ecb720.svg",self.location).href,t),"clipboard-copied":O(new URL("/assets/clipboard-copied-3bc0246f.svg",self.location).href,t),"clipboard-copy":O(new URL("/assets/clipboard-copy-1614d6e0.svg",self.location).href,t),code:O(new URL("/assets/code-c1e58d4e.svg",self.location).href,t),collab:O(new URL("/assets/collab-01718d96.svg",self.location).href,t),color:O(new URL("/assets/color-459651ac.svg",self.location).href,t),comment:O(new URL("/assets/comment-0ea468ab.svg",self.location).href,t),"cross-2":O(new URL("/assets/cross-2-0dcac7bb.svg",self.location).href,t),cross:O(new URL("/assets/cross-62050f30.svg",self.location).href,t),"dash-dashed":O(new URL("/assets/dash-dashed-d53c57fe.svg",self.location).href,t),"dash-dotted":O(new URL("/assets/dash-dotted-9382c43c.svg",self.location).href,t),"dash-draw":O(new URL("/assets/dash-draw-3cf15d23.svg",self.location).href,t),"dash-solid":O(new URL("/assets/dash-solid-dcb25706.svg",self.location).href,t),discord:O(new URL("/assets/discord-3a3c8bda.svg",self.location).href,t),"distribute-horizontal":O(new URL("/assets/distribute-horizontal-283a85a4.svg",self.location).href,t),"distribute-vertical":O(new URL("/assets/distribute-vertical-0f10b1f2.svg",self.location).href,t),dot:O(new URL("/assets/dot-46f927ef.svg",self.location).href,t),"dots-horizontal":O(new URL("/assets/dots-horizontal-e18e7e4c.svg",self.location).href,t),"dots-vertical":O(new URL("/assets/dots-vertical-81378fb4.svg",self.location).href,t),"drag-handle-dots":O(new URL("/assets/drag-handle-dots-e71f2e14.svg",self.location).href,t),duplicate:O(new URL("/assets/duplicate-1f9856d0.svg",self.location).href,t),edit:O(new URL("/assets/edit-d24e1453.svg",self.location).href,t),"external-link":O(new URL("/assets/external-link-5b6b5d54.svg",self.location).href,t),file:O(new URL("/assets/file-77c3854a.svg",self.location).href,t),"fill-none":O(new URL("/assets/fill-none-560d7a72.svg",self.location).href,t),"fill-pattern":O(new URL("/assets/fill-pattern-25adb9df.svg",self.location).href,t),"fill-semi":O(new URL("/assets/fill-semi-afaa2e39.svg",self.location).href,t),"fill-solid":O(new URL("/assets/fill-solid-af7483c3.svg",self.location).href,t),follow:O(new URL("/assets/follow-4170f476.svg",self.location).href,t),following:O(new URL("/assets/following-2ae1ad77.svg",self.location).href,t),"font-draw":O(new URL("/assets/font-draw-f16fdfad.svg",self.location).href,t),"font-mono":O(new URL("/assets/font-mono-b6125938.svg",self.location).href,t),"font-sans":O(new URL("/assets/font-sans-a5e3047d.svg",self.location).href,t),"font-serif":O(new URL("/assets/font-serif-430b8221.svg",self.location).href,t),"geo-arrow-down":O(new URL("/assets/geo-arrow-down-7e26af19.svg",self.location).href,t),"geo-arrow-left":O(new URL("/assets/geo-arrow-left-bb054881.svg",self.location).href,t),"geo-arrow-right":O(new URL("/assets/geo-arrow-right-0433630b.svg",self.location).href,t),"geo-arrow-up":O(new URL("/assets/geo-arrow-up-8afc16ce.svg",self.location).href,t),"geo-check-box":O(new URL("/assets/geo-check-box-fcbf4aef.svg",self.location).href,t),"geo-diamond":O(new URL("/assets/geo-diamond-b3d96dba.svg",self.location).href,t),"geo-ellipse":O(new URL("/assets/geo-ellipse-cbbb7937.svg",self.location).href,t),"geo-hexagon":O(new URL("/assets/geo-hexagon-5c21961c.svg",self.location).href,t),"geo-octagon":O(new URL("/assets/geo-octagon-30b98ec2.svg",self.location).href,t),"geo-oval":O(new URL("/assets/geo-oval-9347a6b4.svg",self.location).href,t),"geo-pentagon":O(new URL("/assets/geo-pentagon-4c1f4fb7.svg",self.location).href,t),"geo-rectangle":O(new URL("/assets/geo-rectangle-0108de6a.svg",self.location).href,t),"geo-rhombus-2":O(new URL("/assets/geo-rhombus-2-639b17dd.svg",self.location).href,t),"geo-rhombus":O(new URL("/assets/geo-rhombus-0b9d5d4b.svg",self.location).href,t),"geo-star":O(new URL("/assets/geo-star-4b3393e1.svg",self.location).href,t),"geo-trapezoid":O(new URL("/assets/geo-trapezoid-c9e72f50.svg",self.location).href,t),"geo-triangle":O(new URL("/assets/geo-triangle-e3082238.svg",self.location).href,t),"geo-x-box":O(new URL("/assets/geo-x-box-7ba0d440.svg",self.location).href,t),github:O(new URL("/assets/github-51a9de99.svg",self.location).href,t),group:O(new URL("/assets/group-6bbd1c74.svg",self.location).href,t),hidden:O(new URL("/assets/hidden-8594b1dc.svg",self.location).href,t),image:O(new URL("/assets/image-fd3e2fb7.svg",self.location).href,t),"info-circle":O(new URL("/assets/info-circle-5b33b2cd.svg",self.location).href,t),leading:O(new URL("/assets/leading-fb729b74.svg",self.location).href,t),link:O(new URL("/assets/link-4fff5649.svg",self.location).href,t),"lock-small":O(new URL("/assets/lock-small-ddf01959.svg",self.location).href,t),lock:O(new URL("/assets/lock-6cb37427.svg",self.location).href,t),menu:O(new URL("/assets/menu-b39d0e14.svg",self.location).href,t),minus:O(new URL("/assets/minus-b03a3113.svg",self.location).href,t),mixed:O(new URL("/assets/mixed-c62471e3.svg",self.location).href,t),pack:O(new URL("/assets/pack-50c3480c.svg",self.location).href,t),page:O(new URL("/assets/page-3d663197.svg",self.location).href,t),plus:O(new URL("/assets/plus-c90df3bb.svg",self.location).href,t),"question-mark-circle":O(new URL("/assets/question-mark-circle-91699c2e.svg",self.location).href,t),"question-mark":O(new URL("/assets/question-mark-ec2cf8df.svg",self.location).href,t),redo:O(new URL("/assets/redo-64589cc7.svg",self.location).href,t),"reset-zoom":O(new URL("/assets/reset-zoom-fe4ad9cf.svg",self.location).href,t),"rotate-ccw":O(new URL("/assets/rotate-ccw-863caef5.svg",self.location).href,t),"rotate-cw":O(new URL("/assets/rotate-cw-75df62f8.svg",self.location).href,t),ruler:O(new URL("/assets/ruler-e75cb085.svg",self.location).href,t),search:O(new URL("/assets/search-e94ed51b.svg",self.location).href,t),"send-backward":O(new URL("/assets/send-backward-e1e1506b.svg",self.location).href,t),"send-to-back":O(new URL("/assets/send-to-back-c6a8d6e0.svg",self.location).href,t),"settings-horizontal":O(new URL("/assets/settings-horizontal-5c4f3c76.svg",self.location).href,t),"settings-vertical-1":O(new URL("/assets/settings-vertical-1-b827ecb3.svg",self.location).href,t),"settings-vertical":O(new URL("/assets/settings-vertical-517f96c2.svg",self.location).href,t),"share-1":O(new URL("/assets/share-1-e9a58432.svg",self.location).href,t),"share-2":O(new URL("/assets/share-2-9abac035.svg",self.location).href,t),"size-extra-large":O(new URL("/assets/size-extra-large-9129b84b.svg",self.location).href,t),"size-large":O(new URL("/assets/size-large-aeb289df.svg",self.location).href,t),"size-medium":O(new URL("/assets/size-medium-1bd5d459.svg",self.location).href,t),"size-small":O(new URL("/assets/size-small-0456c8f3.svg",self.location).href,t),"spline-cubic":O(new URL("/assets/spline-cubic-0d08337b.svg",self.location).href,t),"spline-line":O(new URL("/assets/spline-line-e4b0c70d.svg",self.location).href,t),"stack-horizontal":O(new URL("/assets/stack-horizontal-203b751f.svg",self.location).href,t),"stack-vertical":O(new URL("/assets/stack-vertical-192610e7.svg",self.location).href,t),"stretch-horizontal":O(new URL("/assets/stretch-horizontal-0df1f9a5.svg",self.location).href,t),"stretch-vertical":O(new URL("/assets/stretch-vertical-c27affd7.svg",self.location).href,t),"text-align-center":O(new URL("/assets/text-align-center-d4e4b52e.svg",self.location).href,t),"text-align-justify":O(new URL("/assets/text-align-justify-81d84b0b.svg",self.location).href,t),"text-align-left":O(new URL("/assets/text-align-left-2a312c27.svg",self.location).href,t),"text-align-right":O(new URL("/assets/text-align-right-5a23e653.svg",self.location).href,t),"tool-arrow":O(new URL("/assets/tool-arrow-a35ddeaa.svg",self.location).href,t),"tool-embed":O(new URL("/assets/tool-embed-87f5f2ae.svg",self.location).href,t),"tool-eraser":O(new URL("/assets/tool-eraser-be2225bb.svg",self.location).href,t),"tool-frame":O(new URL("/assets/tool-frame-deced99e.svg",self.location).href,t),"tool-hand":O(new URL("/assets/tool-hand-51a87280.svg",self.location).href,t),"tool-highlighter":O(new URL("/assets/tool-highlighter-3fcba8b9.svg",self.location).href,t),"tool-line":O(new URL("/assets/tool-line-83d19546.svg",self.location).href,t),"tool-media":O(new URL("/assets/image-fd3e2fb7.svg",self.location).href,t),"tool-note":O(new URL("/assets/tool-note-70446f4a.svg",self.location).href,t),"tool-pencil":O(new URL("/assets/tool-pencil-83727f88.svg",self.location).href,t),"tool-pointer":O(new URL("/assets/tool-pointer-26df96e8.svg",self.location).href,t),"tool-text":O(new URL("/assets/tool-text-4cae6149.svg",self.location).href,t),trash:O(new URL("/assets/trash-5f706981.svg",self.location).href,t),"triangle-down":O(new URL("/assets/triangle-down-444a1cd5.svg",self.location).href,t),"triangle-up":O(new URL("/assets/triangle-up-c259a164.svg",self.location).href,t),twitter:O(new URL("/assets/twitter-7b613aa3.svg",self.location).href,t),undo:O(new URL("/assets/undo-af81f8f7.svg",self.location).href,t),ungroup:O(new URL("/assets/ungroup-5e8a5f84.svg",self.location).href,t),"unlock-small":O(new URL("/assets/unlock-small-aca7b191.svg",self.location).href,t),unlock:O(new URL("/assets/unlock-8500de28.svg",self.location).href,t),visible:O(new URL("/assets/visible-32067af2.svg",self.location).href,t),"warning-triangle":O(new URL("/assets/warning-triangle-eb9175ef.svg",self.location).href,t),"zoom-in":O(new URL("/assets/zoom-in-cbe77698.svg",self.location).href,t),"zoom-out":O(new URL("/assets/zoom-out-ef283578.svg",self.location).href,t)},translations:{ar:O(new URL("/assets/ar-c993abbf.json",self.location).href,t),ca:O(new URL("/assets/ca-3ca6c26c.json",self.location).href,t),da:O(new URL("/assets/da-8ee65d3a.json",self.location).href,t),de:O(new URL("/assets/de-728d531f.json",self.location).href,t),en:O(new URL("/assets/en-ca3d163b.json",self.location).href,t),es:O(new URL("/assets/es-f0ea8999.json",self.location).href,t),fa:O(new URL("/assets/fa-60525b5c.json",self.location).href,t),fi:O(new URL("/assets/fi-de0d242a.json",self.location).href,t),fr:O(new URL("/assets/fr-0d7ceb32.json",self.location).href,t),gl:O(new URL("/assets/gl-0a813168.json",self.location).href,t),he:O(new URL("/assets/he-f4ffa1b9.json",self.location).href,t),"hi-in":O(new URL("/assets/hi-in-2f5eb44e.json",self.location).href,t),hu:O(new URL("/assets/hu-57ab884f.json",self.location).href,t),it:O(new URL("/assets/it-875d6eff.json",self.location).href,t),ja:O(new URL("/assets/ja-8e7c7f00.json",self.location).href,t),"ko-kr":O(new URL("/assets/ko-kr-bb058459.json",self.location).href,t),ku:O(new URL("/assets/ku-35a7bf85.json",self.location).href,t),languages:O(new URL("/assets/languages-85fa6cb4.json",self.location).href,t),main:O(new URL("/assets/main-2134ce40.json",self.location).href,t),my:O(new URL("/assets/my-9e176f8b.json",self.location).href,t),ne:O(new URL("/assets/ne-2fcab306.json",self.location).href,t),no:O(new URL("/assets/no-081a09e1.json",self.location).href,t),pl:O(new URL("/assets/pl-90d9ac72.json",self.location).href,t),"pt-br":O(new URL("/assets/pt-br-4fde9e9e.json",self.location).href,t),"pt-pt":O(new URL("/assets/pt-pt-4159d215.json",self.location).href,t),ro:O(new URL("/assets/ro-a136c912.json",self.location).href,t),ru:O(new URL("/assets/ru-fcedf408.json",self.location).href,t),sv:O(new URL("/assets/sv-cffab93b.json",self.location).href,t),te:O(new URL("/assets/te-7484fdfa.json",self.location).href,t),th:O(new URL("/assets/th-914a50c3.json",self.location).href,t),tr:O(new URL("/assets/tr-e1e653c5.json",self.location).href,t),uk:O(new URL("/assets/uk-a331c938.json",self.location).href,t),vi:O(new URL("/assets/vi-d33925c8.json",self.location).href,t),"zh-cn":O(new URL("/assets/zh-cn-85afaef5.json",self.location).href,t),"zh-tw":O(new URL("/assets/zh-tw-fb075770.json",self.location).href,t)},embedIcons:{codepen:O(new URL("/assets/codepen-c5091340.png",self.location).href,t),codesandbox:O(new URL("/assets/codesandbox-0d91ed96.png",self.location).href,t),excalidraw:O(new URL("/assets/excalidraw-99a33a0f.png",self.location).href,t),felt:O(new URL("/assets/felt-ce0f1fb6.png",self.location).href,t),figma:O(new URL("/assets/figma-12bf0233.png",self.location).href,t),github_gist:O(new URL("/assets/github_gist-fe770981.png",self.location).href,t),google_calendar:O(new URL("/assets/google_calendar-372998bd.png",self.location).href,t),google_maps:O(new URL("/assets/google_maps-96179f24.png",self.location).href,t),google_slides:O(new URL("/assets/google_slides-3c807caf.png",self.location).href,t),observable:O(new URL("/assets/observable-eba6b075.png",self.location).href,t),replit:O(new URL("/assets/replit-bce8ed12.png",self.location).href,t),scratch:O(new URL("/assets/scratch-93375fd4.png",self.location).href,t),spotify:O(new URL("/assets/spotify-a30d4066.png",self.location).href,t),tldraw:O(new URL("/assets/tldraw-76b04190.png",self.location).href,t),vimeo:O(new URL("/assets/vimeo-f0a42f95.png",self.location).href,t),youtube:O(new URL("/assets/youtube-0f750243.png",self.location).href,t)}}}var Bu=function(t){return t&&t.Math==Math&&t},ar=Bu(typeof globalThis=="object"&&globalThis)||Bu(typeof window=="object"&&window)||Bu(typeof self=="object"&&self)||Bu(typeof zn=="object"&&zn)||function(){return this}()||Function("return this")(),H0={},kn=function(t){try{return!!t()}catch{return!0}},oR=kn,Fi=!oR(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),iR=kn,Ep=!iR(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),sR=Ep,zu=Function.prototype.call,Ki=sR?zu.bind(zu):function(){return zu.apply(zu,arguments)},LP={},DP={}.propertyIsEnumerable,OP=Object.getOwnPropertyDescriptor,aR=OP&&!DP.call({1:2},1);LP.f=aR?function(e){var n=OP(this,e);return!!n&&n.enumerable}:DP;var jP=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},NP=Ep,BP=Function.prototype,Vm=BP.call,lR=NP&&BP.bind.bind(Vm,Vm),Qt=NP?lR:function(t){return function(){return Vm.apply(t,arguments)}},zP=Qt,cR=zP({}.toString),uR=zP("".slice),rl=function(t){return uR(cR(t),8,-1)},dR=Qt,hR=kn,pR=rl,Rf=Object,fR=dR("".split),gR=hR(function(){return!Rf("z").propertyIsEnumerable(0)})?function(t){return pR(t)=="String"?fR(t,""):Rf(t)}:Rf,Pp=function(t){return t==null},mR=Pp,yR=TypeError,ol=function(t){if(mR(t))throw yR("Can't call method on "+t);return t},vR=gR,wR=ol,_p=function(t){return vR(wR(t))},Wm=typeof document=="object"&&document.all,xR=typeof Wm>"u"&&Wm!==void 0,UP={all:Wm,IS_HTMLDDA:xR},FP=UP,bR=FP.all,$n=FP.IS_HTMLDDA?function(t){return typeof t=="function"||t===bR}:function(t){return typeof t=="function"},Hx=$n,KP=UP,SR=KP.all,Bs=KP.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:Hx(t)||t===SR}:function(t){return typeof t=="object"?t!==null:Hx(t)},Lf=ar,ER=$n,PR=function(t){return ER(t)?t:void 0},Ip=function(t,e){return arguments.length<2?PR(Lf[t]):Lf[t]&&Lf[t][e]},_R=Qt,HP=_R({}.isPrototypeOf),IR=typeof navigator<"u"&&String(navigator.userAgent)||"",VP=ar,Df=IR,Vx=VP.process,Wx=VP.Deno,Yx=Vx&&Vx.versions||Wx&&Wx.version,Xx=Yx&&Yx.v8,Kr,yh;Xx&&(Kr=Xx.split("."),yh=Kr[0]>0&&Kr[0]<4?1:+(Kr[0]+Kr[1]));!yh&&Df&&(Kr=Df.match(/Edge\/(\d+)/),(!Kr||Kr[1]>=74)&&(Kr=Df.match(/Chrome\/(\d+)/),Kr&&(yh=+Kr[1])));var CR=yh,Gx=CR,kR=kn,WP=!!Object.getOwnPropertySymbols&&!kR(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Gx&&Gx<41}),$R=WP,YP=$R&&!Symbol.sham&&typeof Symbol.iterator=="symbol",TR=Ip,MR=$n,AR=HP,RR=YP,LR=Object,XP=RR?function(t){return typeof t=="symbol"}:function(t){var e=TR("Symbol");return MR(e)&&AR(e.prototype,LR(t))},DR=String,OR=function(t){try{return DR(t)}catch{return"Object"}},jR=$n,NR=OR,BR=TypeError,V0=function(t){if(jR(t))return t;throw BR(NR(t)+" is not a function")},zR=V0,UR=Pp,W0=function(t,e){var n=t[e];return UR(n)?void 0:zR(n)},Of=Ki,jf=$n,Nf=Bs,FR=TypeError,KR=function(t,e){var n,r;if(e==="string"&&jf(n=t.toString)&&!Nf(r=Of(n,t))||jf(n=t.valueOf)&&!Nf(r=Of(n,t))||e!=="string"&&jf(n=t.toString)&&!Nf(r=Of(n,t)))return r;throw FR("Can't convert object to primitive value")},GP={exports:{}},qx=ar,HR=Object.defineProperty,Y0=function(t,e){try{HR(qx,t,{value:e,configurable:!0,writable:!0})}catch{qx[t]=e}return e},VR=ar,WR=Y0,Qx="__core-js_shared__",YR=VR[Qx]||WR(Qx,{}),X0=YR,Zx=X0;(GP.exports=function(t,e){return Zx[t]||(Zx[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.30.1",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"});var G0=GP.exports,XR=ol,GR=Object,iu=function(t){return GR(XR(t))},qR=Qt,QR=iu,ZR=qR({}.hasOwnProperty),Hi=Object.hasOwn||function(e,n){return ZR(QR(e),n)},JR=Qt,eL=0,tL=Math.random(),nL=JR(1 .toString),qP=function(t){return"Symbol("+(t===void 0?"":t)+")_"+nL(++eL+tL,36)},rL=ar,oL=G0,Jx=Hi,iL=qP,sL=WP,aL=YP,pa=rL.Symbol,Bf=oL("wks"),lL=aL?pa.for||pa:pa&&pa.withoutSetter||iL,ti=function(t){return Jx(Bf,t)||(Bf[t]=sL&&Jx(pa,t)?pa[t]:lL("Symbol."+t)),Bf[t]},cL=Ki,eb=Bs,tb=XP,uL=W0,dL=KR,hL=ti,pL=TypeError,fL=hL("toPrimitive"),gL=function(t,e){if(!eb(t)||tb(t))return t;var n=uL(t,fL),r;if(n){if(e===void 0&&(e="default"),r=cL(n,t,e),!eb(r)||tb(r))return r;throw pL("Can't convert object to primitive value")}return e===void 0&&(e="number"),dL(t,e)},mL=gL,yL=XP,QP=function(t){var e=mL(t,"string");return yL(e)?e:e+""},vL=ar,nb=Bs,Ym=vL.document,wL=nb(Ym)&&nb(Ym.createElement),ZP=function(t){return wL?Ym.createElement(t):{}},xL=Fi,bL=kn,SL=ZP,JP=!xL&&!bL(function(){return Object.defineProperty(SL("div"),"a",{get:function(){return 7}}).a!=7}),EL=Fi,PL=Ki,_L=LP,IL=jP,CL=_p,kL=QP,$L=Hi,TL=JP,rb=Object.getOwnPropertyDescriptor;H0.f=EL?rb:function(e,n){if(e=CL(e),n=kL(n),TL)try{return rb(e,n)}catch{}if($L(e,n))return IL(!PL(_L.f,e,n),e[n])};var il={},ML=Fi,AL=kn,e_=ML&&AL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),RL=Bs,LL=String,DL=TypeError,zs=function(t){if(RL(t))return t;throw DL(LL(t)+" is not an object")},OL=Fi,jL=JP,NL=e_,Uu=zs,ob=QP,BL=TypeError,zf=Object.defineProperty,zL=Object.getOwnPropertyDescriptor,Uf="enumerable",Ff="configurable",Kf="writable";il.f=OL?NL?function(e,n,r){if(Uu(e),n=ob(n),Uu(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Kf in r&&!r[Kf]){var o=zL(e,n);o&&o[Kf]&&(e[n]=r.value,r={configurable:Ff in r?r[Ff]:o[Ff],enumerable:Uf in r?r[Uf]:o[Uf],writable:!1})}return zf(e,n,r)}:zf:function(e,n,r){if(Uu(e),n=ob(n),Uu(r),jL)try{return zf(e,n,r)}catch{}if("get"in r||"set"in r)throw BL("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var UL=Fi,FL=il,KL=jP,q0=UL?function(t,e,n){return FL.f(t,e,KL(1,n))}:function(t,e,n){return t[e]=n,t},t_={exports:{}},Xm=Fi,HL=Hi,n_=Function.prototype,VL=Xm&&Object.getOwnPropertyDescriptor,Q0=HL(n_,"name"),WL=Q0&&function(){}.name==="something",YL=Q0&&(!Xm||Xm&&VL(n_,"name").configurable),XL={EXISTS:Q0,PROPER:WL,CONFIGURABLE:YL},GL=Qt,qL=$n,Gm=X0,QL=GL(Function.toString);qL(Gm.inspectSource)||(Gm.inspectSource=function(t){return QL(t)});var r_=Gm.inspectSource,ZL=ar,JL=$n,ib=ZL.WeakMap,eD=JL(ib)&&/native code/.test(String(ib)),tD=G0,nD=qP,sb=tD("keys"),o_=function(t){return sb[t]||(sb[t]=nD(t))},Z0={},rD=eD,i_=ar,oD=Bs,iD=q0,Hf=Hi,Vf=X0,sD=o_,aD=Z0,ab="Object already initialized",qm=i_.TypeError,lD=i_.WeakMap,vh,wc,wh,cD=function(t){return wh(t)?wc(t):vh(t,{})},uD=function(t){return function(e){var n;if(!oD(e)||(n=wc(e)).type!==t)throw qm("Incompatible receiver, "+t+" required");return n}};if(rD||Vf.state){var io=Vf.state||(Vf.state=new lD);io.get=io.get,io.has=io.has,io.set=io.set,vh=function(t,e){if(io.has(t))throw qm(ab);return e.facade=t,io.set(t,e),e},wc=function(t){return io.get(t)||{}},wh=function(t){return io.has(t)}}else{var Xs=sD("state");aD[Xs]=!0,vh=function(t,e){if(Hf(t,Xs))throw qm(ab);return e.facade=t,iD(t,Xs,e),e},wc=function(t){return Hf(t,Xs)?t[Xs]:{}},wh=function(t){return Hf(t,Xs)}}var s_={set:vh,get:wc,has:wh,enforce:cD,getterFor:uD},J0=Qt,dD=kn,hD=$n,Fu=Hi,Qm=Fi,pD=XL.CONFIGURABLE,fD=r_,a_=s_,gD=a_.enforce,mD=a_.get,lb=String,Od=Object.defineProperty,yD=J0("".slice),vD=J0("".replace),wD=J0([].join),xD=Qm&&!dD(function(){return Od(function(){},"length",{value:8}).length!==8}),bD=String(String).split("String"),SD=t_.exports=function(t,e,n){yD(lb(e),0,7)==="Symbol("&&(e="["+vD(lb(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Fu(t,"name")||pD&&t.name!==e)&&(Qm?Od(t,"name",{value:e,configurable:!0}):t.name=e),xD&&n&&Fu(n,"arity")&&t.length!==n.arity&&Od(t,"length",{value:n.arity});try{n&&Fu(n,"constructor")&&n.constructor?Qm&&Od(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=gD(t);return Fu(r,"source")||(r.source=wD(bD,typeof e=="string"?e:"")),t};Function.prototype.toString=SD(function(){return hD(this)&&mD(this).source||fD(this)},"toString");var ED=t_.exports,PD=$n,_D=il,ID=ED,CD=Y0,l_=function(t,e,n,r){r||(r={});var o=r.enumerable,i=r.name!==void 0?r.name:e;if(PD(n)&&ID(n,i,r),r.global)o?t[e]=n:CD(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch{}o?t[e]=n:_D.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},c_={},kD=Math.ceil,$D=Math.floor,TD=Math.trunc||function(e){var n=+e;return(n>0?$D:kD)(n)},MD=TD,Us=function(t){var e=+t;return e!==e||e===0?0:MD(e)},AD=Us,RD=Math.max,LD=Math.min,DD=function(t,e){var n=AD(t);return n<0?RD(n+e,0):LD(n,e)},OD=Us,jD=Math.min,u_=function(t){return t>0?jD(OD(t),9007199254740991):0},ND=u_,su=function(t){return ND(t.length)},BD=_p,zD=DD,UD=su,cb=function(t){return function(e,n,r){var o=BD(e),i=UD(o),s=zD(r,i),a;if(t&&n!=n){for(;i>s;)if(a=o[s++],a!=a)return!0}else for(;i>s;s++)if((t||s in o)&&o[s]===n)return t||s||0;return!t&&-1}},FD={includes:cb(!0),indexOf:cb(!1)},KD=Qt,Wf=Hi,HD=_p,VD=FD.indexOf,WD=Z0,ub=KD([].push),d_=function(t,e){var n=HD(t),r=0,o=[],i;for(i in n)!Wf(WD,i)&&Wf(n,i)&&ub(o,i);for(;e.length>r;)Wf(n,i=e[r++])&&(~VD(o,i)||ub(o,i));return o},ev=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],YD=d_,XD=ev,GD=XD.concat("length","prototype");c_.f=Object.getOwnPropertyNames||function(e){return YD(e,GD)};var h_={};h_.f=Object.getOwnPropertySymbols;var qD=Ip,QD=Qt,ZD=c_,JD=h_,e6=zs,t6=QD([].concat),n6=qD("Reflect","ownKeys")||function(e){var n=ZD.f(e6(e)),r=JD.f;return r?t6(n,r(e)):n},db=Hi,r6=n6,o6=H0,i6=il,s6=function(t,e,n){for(var r=r6(e),o=i6.f,i=o6.f,s=0;s<r.length;s++){var a=r[s];!db(t,a)&&!(n&&db(n,a))&&o(t,a,i(e,a))}},a6=kn,l6=$n,c6=/#|\.prototype\./,au=function(t,e){var n=d6[u6(t)];return n==p6?!0:n==h6?!1:l6(e)?a6(e):!!e},u6=au.normalize=function(t){return String(t).replace(c6,".").toLowerCase()},d6=au.data={},h6=au.NATIVE="N",p6=au.POLYFILL="P",f6=au,Yf=ar,g6=H0.f,m6=q0,y6=l_,v6=Y0,w6=s6,x6=f6,sl=function(t,e){var n=t.target,r=t.global,o=t.stat,i,s,a,l,c,d;if(r?s=Yf:o?s=Yf[n]||v6(n,{}):s=(Yf[n]||{}).prototype,s)for(a in e){if(c=e[a],t.dontCallGetSet?(d=g6(s,a),l=d&&d.value):l=s[a],i=x6(r?a:n+(o?".":"#")+a,t.forced),!i&&l!==void 0){if(typeof c==typeof l)continue;w6(c,l)}(t.sham||l&&l.sham)&&m6(c,"sham",!0),y6(s,a,c,t)}},p_={},b6=d_,S6=ev,E6=Object.keys||function(e){return b6(e,S6)},P6=Fi,_6=e_,I6=il,C6=zs,k6=_p,$6=E6;p_.f=P6&&!_6?Object.defineProperties:function(e,n){C6(e);for(var r=k6(n),o=$6(n),i=o.length,s=0,a;i>s;)I6.f(e,a=o[s++],r[a]);return e};var T6=Ip,M6=T6("document","documentElement"),A6=zs,R6=p_,hb=ev,L6=Z0,D6=M6,O6=ZP,j6=o_,pb=">",fb="<",Zm="prototype",Jm="script",f_=j6("IE_PROTO"),Xf=function(){},g_=function(t){return fb+Jm+pb+t+fb+"/"+Jm+pb},gb=function(t){t.write(g_("")),t.close();var e=t.parentWindow.Object;return t=null,e},N6=function(){var t=O6("iframe"),e="java"+Jm+":",n;return t.style.display="none",D6.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(g_("document.F=Object")),n.close(),n.F},Ku,jd=function(){try{Ku=new ActiveXObject("htmlfile")}catch{}jd=typeof document<"u"?document.domain&&Ku?gb(Ku):N6():gb(Ku);for(var t=hb.length;t--;)delete jd[Zm][hb[t]];return jd()};L6[f_]=!0;var m_=Object.create||function(e,n){var r;return e!==null?(Xf[Zm]=A6(e),r=new Xf,Xf[Zm]=null,r[f_]=e):r=jd(),n===void 0?r:R6.f(r,n)},B6=ti,z6=m_,U6=il.f,ey=B6("unscopables"),ty=Array.prototype;ty[ey]==null&&U6(ty,ey,{configurable:!0,value:z6(null)});var tv=function(t){ty[ey][t]=!0},F6=sl,K6=iu,H6=su,V6=Us,W6=tv;F6({target:"Array",proto:!0},{at:function(e){var n=K6(this),r=H6(n),o=V6(e),i=o>=0?o:r+o;return i<0||i>=r?void 0:n[i]}});W6("at");var Y6=ar,X6=Qt,lu=function(t,e){return X6(Y6[t].prototype[e])},G6=lu;G6("Array","at");var q6=rl,y_=Array.isArray||function(e){return q6(e)=="Array"},Q6=TypeError,Z6=9007199254740991,J6=function(t){if(t>Z6)throw Q6("Maximum allowed index exceeded");return t},eO=rl,tO=Qt,v_=function(t){if(eO(t)==="Function")return tO(t)},mb=v_,nO=V0,rO=Ep,oO=mb(mb.bind),iO=function(t,e){return nO(t),e===void 0?t:rO?oO(t,e):function(){return t.apply(e,arguments)}},sO=y_,aO=su,lO=J6,cO=iO,w_=function(t,e,n,r,o,i,s,a){for(var l=o,c=0,d=s?cO(s,a):!1,u,h;c<r;)c in n&&(u=d?d(n[c],c,e):n[c],i>0&&sO(u)?(h=aO(u),l=w_(t,e,u,h,l,i-1)-1):(lO(l+1),t[l]=u),l++),c++;return l},x_=w_,uO=ti,dO=uO("toStringTag"),b_={};b_[dO]="z";var hO=String(b_)==="[object z]",pO=hO,fO=$n,Nd=rl,gO=ti,mO=gO("toStringTag"),yO=Object,vO=Nd(function(){return arguments}())=="Arguments",wO=function(t,e){try{return t[e]}catch{}},S_=pO?Nd:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=wO(e=yO(t),mO))=="string"?n:vO?Nd(e):(r=Nd(e))=="Object"&&fO(e.callee)?"Arguments":r},xO=Qt,bO=kn,E_=$n,SO=S_,EO=Ip,PO=r_,P_=function(){},_O=[],__=EO("Reflect","construct"),nv=/^\s*(?:class|function)\b/,IO=xO(nv.exec),CO=!nv.exec(P_),Pl=function(e){if(!E_(e))return!1;try{return __(P_,_O,e),!0}catch{return!1}},I_=function(e){if(!E_(e))return!1;switch(SO(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return CO||!!IO(nv,PO(e))}catch{return!0}};I_.sham=!0;var kO=!__||bO(function(){var t;return Pl(Pl.call)||!Pl(Object)||!Pl(function(){t=!0})||t})?I_:Pl,yb=y_,$O=kO,TO=Bs,MO=ti,AO=MO("species"),vb=Array,RO=function(t){var e;return yb(t)&&(e=t.constructor,$O(e)&&(e===vb||yb(e.prototype))?e=void 0:TO(e)&&(e=e[AO],e===null&&(e=void 0))),e===void 0?vb:e},LO=RO,C_=function(t,e){return new(LO(t))(e===0?0:e)},DO=sl,OO=x_,jO=iu,NO=su,BO=Us,zO=C_;DO({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,n=jO(this),r=NO(n),o=zO(n,0);return o.length=OO(o,n,n,r,0,e===void 0?1:BO(e)),o}});var UO=tv;UO("flat");var FO=lu;FO("Array","flat");var KO=sl,HO=x_,VO=V0,WO=iu,YO=su,XO=C_;KO({target:"Array",proto:!0},{flatMap:function(e){var n=WO(this),r=YO(n),o;return VO(e),o=XO(n,0),o.length=HO(o,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),o}});var GO=tv;GO("flatMap");var qO=lu;qO("Array","flatMap");var QO=S_,ZO=String,cu=function(t){if(QO(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return ZO(t)},JO=sl,e4=Qt,t4=ol,n4=Us,r4=cu,o4=kn,i4=e4("".charAt),s4=o4(function(){return"𠮷".at(-2)!=="\uD842"});JO({target:"String",proto:!0,forced:s4},{at:function(e){var n=r4(t4(this)),r=n.length,o=n4(e),i=o>=0?o:r+o;return i<0||i>=r?void 0:i4(n,i)}});var a4=lu;a4("String","at");var l4=zs,k_=function(){var t=l4(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},rv=kn,c4=ar,ov=c4.RegExp,iv=rv(function(){var t=ov("a","y");return t.lastIndex=2,t.exec("abcd")!=null}),u4=iv||rv(function(){return!ov("a","y").sticky}),d4=iv||rv(function(){var t=ov("^r","gy");return t.lastIndex=2,t.exec("str")!=null}),h4={BROKEN_CARET:d4,MISSED_STICKY:u4,UNSUPPORTED_Y:iv},p4=kn,f4=ar,g4=f4.RegExp,m4=p4(function(){var t=g4(".","s");return!(t.dotAll&&t.exec(`
`)&&t.flags==="s")}),y4=kn,v4=ar,w4=v4.RegExp,x4=y4(function(){var t=w4("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),fa=Ki,Cp=Qt,b4=cu,S4=k_,E4=h4,P4=G0,_4=m_,I4=s_.get,C4=m4,k4=x4,$4=P4("native-string-replace",String.prototype.replace),xh=RegExp.prototype.exec,ny=xh,T4=Cp("".charAt),M4=Cp("".indexOf),A4=Cp("".replace),Gf=Cp("".slice),ry=function(){var t=/a/,e=/b*/g;return fa(xh,t,"a"),fa(xh,e,"a"),t.lastIndex!==0||e.lastIndex!==0}(),$_=E4.BROKEN_CARET,oy=/()??/.exec("")[1]!==void 0,R4=ry||oy||$_||C4||k4;R4&&(ny=function(e){var n=this,r=I4(n),o=b4(e),i=r.raw,s,a,l,c,d,u,h;if(i)return i.lastIndex=n.lastIndex,s=fa(ny,i,o),n.lastIndex=i.lastIndex,s;var p=r.groups,g=$_&&n.sticky,m=fa(S4,n),v=n.source,x=0,b=o;if(g&&(m=A4(m,"y",""),M4(m,"g")===-1&&(m+="g"),b=Gf(o,n.lastIndex),n.lastIndex>0&&(!n.multiline||n.multiline&&T4(o,n.lastIndex-1)!==`
`)&&(v="(?: "+v+")",b=" "+b,x++),a=new RegExp("^(?:"+v+")",m)),oy&&(a=new RegExp("^"+v+"$(?!\\s)",m)),ry&&(l=n.lastIndex),c=fa(xh,g?a:n,b),g?c?(c.input=Gf(c.input,x),c[0]=Gf(c[0],x),c.index=n.lastIndex,n.lastIndex+=c[0].length):n.lastIndex=0:ry&&c&&(n.lastIndex=n.global?c.index+c[0].length:l),oy&&c&&c.length>1&&fa($4,c[0],a,function(){for(d=1;d<arguments.length-2;d++)arguments[d]===void 0&&(c[d]=void 0)}),c&&p)for(c.groups=u=_4(null),d=0;d<p.length;d++)h=p[d],u[h[0]]=c[h[1]];return c});var sv=ny,L4=sl,wb=sv;L4({target:"RegExp",proto:!0,forced:/./.exec!==wb},{exec:wb});var D4=Ep,T_=Function.prototype,xb=T_.apply,bb=T_.call,O4=typeof Reflect=="object"&&Reflect.apply||(D4?bb.bind(xb):function(){return bb.apply(xb,arguments)}),Sb=v_,Eb=l_,j4=sv,Pb=kn,M_=ti,N4=q0,B4=M_("species"),qf=RegExp.prototype,z4=function(t,e,n,r){var o=M_(t),i=!Pb(function(){var c={};return c[o]=function(){return 7},""[t](c)!=7}),s=i&&!Pb(function(){var c=!1,d=/a/;return t==="split"&&(d={},d.constructor={},d.constructor[B4]=function(){return d},d.flags="",d[o]=/./[o]),d.exec=function(){return c=!0,null},d[o](""),!c});if(!i||!s||n){var a=Sb(/./[o]),l=e(o,""[t],function(c,d,u,h,p){var g=Sb(c),m=d.exec;return m===j4||m===qf.exec?i&&!p?{done:!0,value:a(d,u,h)}:{done:!0,value:g(u,d,h)}:{done:!1}});Eb(String.prototype,t,l[0]),Eb(qf,o,l[1])}r&&N4(qf[o],"sham",!0)},av=Qt,U4=Us,F4=cu,K4=ol,H4=av("".charAt),_b=av("".charCodeAt),V4=av("".slice),Ib=function(t){return function(e,n){var r=F4(K4(e)),o=U4(n),i=r.length,s,a;return o<0||o>=i?t?"":void 0:(s=_b(r,o),s<55296||s>56319||o+1===i||(a=_b(r,o+1))<56320||a>57343?t?H4(r,o):s:t?V4(r,o,o+2):(s-55296<<10)+(a-56320)+65536)}},W4={codeAt:Ib(!1),charAt:Ib(!0)},Y4=W4.charAt,X4=function(t,e,n){return e+(n?Y4(t,e).length:1)},lv=Qt,G4=iu,q4=Math.floor,Qf=lv("".charAt),Q4=lv("".replace),Zf=lv("".slice),Z4=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,J4=/\$([$&'`]|\d{1,2})/g,A_=function(t,e,n,r,o,i){var s=n+t.length,a=r.length,l=J4;return o!==void 0&&(o=G4(o),l=Z4),Q4(i,l,function(c,d){var u;switch(Qf(d,0)){case"$":return"$";case"&":return t;case"`":return Zf(e,0,n);case"'":return Zf(e,s);case"<":u=o[Zf(d,1,-1)];break;default:var h=+d;if(h===0)return c;if(h>a){var p=q4(h/10);return p===0?c:p<=a?r[p-1]===void 0?Qf(d,1):r[p-1]+Qf(d,1):c}u=r[h-1]}return u===void 0?"":u})},Cb=Ki,ej=zs,tj=$n,nj=rl,rj=sv,oj=TypeError,ij=function(t,e){var n=t.exec;if(tj(n)){var r=Cb(n,t,e);return r!==null&&ej(r),r}if(nj(t)==="RegExp")return Cb(rj,t,e);throw oj("RegExp#exec called on incompatible receiver")},sj=O4,kb=Ki,kp=Qt,aj=z4,lj=kn,cj=zs,uj=$n,dj=Pp,hj=Us,pj=u_,Gs=cu,fj=ol,gj=X4,mj=W0,yj=A_,vj=ij,wj=ti,iy=wj("replace"),xj=Math.max,bj=Math.min,Sj=kp([].concat),Jf=kp([].push),$b=kp("".indexOf),Tb=kp("".slice),Ej=function(t){return t===void 0?t:String(t)},Pj=function(){return"a".replace(/./,"$0")==="$0"}(),Mb=function(){return/./[iy]?/./[iy]("a","$0")==="":!1}(),_j=!lj(function(){var t=/./;return t.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(t,"$<a>")!=="7"});aj("replace",function(t,e,n){var r=Mb?"$":"$0";return[function(i,s){var a=fj(this),l=dj(i)?void 0:mj(i,iy);return l?kb(l,i,a,s):kb(e,Gs(a),i,s)},function(o,i){var s=cj(this),a=Gs(o);if(typeof i=="string"&&$b(i,r)===-1&&$b(i,"$<")===-1){var l=n(e,s,a,i);if(l.done)return l.value}var c=uj(i);c||(i=Gs(i));var d=s.global;if(d){var u=s.unicode;s.lastIndex=0}for(var h=[];;){var p=vj(s,a);if(p===null||(Jf(h,p),!d))break;var g=Gs(p[0]);g===""&&(s.lastIndex=gj(a,pj(s.lastIndex),u))}for(var m="",v=0,x=0;x<h.length;x++){p=h[x];for(var b=Gs(p[0]),E=xj(bj(hj(p.index),a.length),0),P=[],C=1;C<p.length;C++)Jf(P,Ej(p[C]));var k=p.groups;if(c){var $=Sj([b],P,E,a);k!==void 0&&Jf($,k);var A=Gs(sj(i,void 0,$))}else A=yj(b,a,E,P,k,i);E>=v&&(m+=Tb(a,v,E)+A,v=E+b.length)}return m+Tb(a,v)}]},!_j||!Pj||Mb);var Ij=Bs,Cj=rl,kj=ti,$j=kj("match"),Tj=function(t){var e;return Ij(t)&&((e=t[$j])!==void 0?!!e:Cj(t)=="RegExp")},Mj=Ki,Aj=Hi,Rj=HP,Lj=k_,Ab=RegExp.prototype,Dj=function(t){var e=t.flags;return e===void 0&&!("flags"in Ab)&&!Aj(t,"flags")&&Rj(Ab,t)?Mj(Lj,t):e},Oj=sl,jj=Ki,cv=Qt,Rb=ol,Nj=$n,Bj=Pp,zj=Tj,_l=cu,Uj=W0,Fj=Dj,Kj=A_,Hj=ti,Vj=Hj("replace"),Wj=TypeError,R_=cv("".indexOf);cv("".replace);var Lb=cv("".slice),Yj=Math.max,Db=function(t,e,n){return n>t.length?-1:e===""?n:R_(t,e,n)};Oj({target:"String",proto:!0},{replaceAll:function(e,n){var r=Rb(this),o,i,s,a,l,c,d,u,h,p=0,g=0,m="";if(!Bj(e)){if(o=zj(e),o&&(i=_l(Rb(Fj(e))),!~R_(i,"g")))throw Wj("`.replaceAll` does not allow non-global regexes");if(s=Uj(e,Vj),s)return jj(s,e,r,n)}for(a=_l(r),l=_l(e),c=Nj(n),c||(n=_l(n)),d=l.length,u=Yj(1,d),p=Db(a,l,0);p!==-1;)h=c?_l(n(l,p,a)):Kj(l,a,p,[],void 0,n),m+=Lb(a,g,p)+h,g=p+d,p=Db(a,l,p+u);return g<a.length&&(m+=Lb(a,g)),m}});var Xj=lu;Xj("String","replaceAll");function bh(t,e){const n=[];e:for(const r of t){for(const o of n)if(e?e(r,o):r===o)continue e;n.push(r)}return n}function Ee(t){return t.filter(e=>e!=null)}function wr(t){return t[t.length-1]}function Gj(t,e){let n,r=1/0;for(const o of t){const i=e(o);i<r&&(n=o,r=i)}return n}function qj(t,e){const n=[],r=[];for(const o of t)e(o)?n.push(o):r.push(o);return[n,r]}function L_(t){const e=(...n)=>{try{return t(...n)}catch(r){throw r instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(r,e),r}};return e}function Qj(t,e){const n=e&&t&&typeof t=="object"&&e in t?t[e]:t;throw new Error(`Unknown switch case ${n}`)}const uv=L_((t,e)=>{if(!t)throw new Error(e||"Assertion Error")}),Zj=L_((t,e)=>{if(t==null)throw new Error(e??"value must be defined");return t});function D_(t,e){let n;const r=(...o)=>(n||(n={},n.promise=new Promise((i,s)=>{n.resolve=i,n.reject=s})),clearTimeout(n.timeout),n.latestArgs=o,n.timeout=setTimeout(()=>{const i=n;n=void 0;try{i.resolve(t(...i.latestArgs))}catch(s){i.reject(s)}},e),n.promise);return r.cancel=()=>{n&&clearTimeout(n.timeout)},r}const Ob=new WeakMap;function dv(t,e){if(typeof t!="object"||t===null)return;let n=Ob.get(t);n||(n={tags:{},extras:{}},Ob.set(t,n)),e.tags&&(n.tags={...n.tags,...e.tags}),e.extras&&(n.extras={...n.extras,...e.extras})}function hv(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e+""}function Bd(t=""){let e=0,n=0,r=0,o=0;function i(){const s=e^e<<11;return e=n,n=r,r=o,o^=(o>>>19^s^s>>>8)>>>0,o/4294967296*2}for(let s=0;s<t.length+64;s++)e^=t.charCodeAt(s)|0,i();return i}function sy(t,e,n,r=!1){const[o,i]=e,[s,a]=n,l=s+(t-o)/(i-o)*(a-s);return r?s<a?Math.max(Math.min(l,a),s):Math.max(Math.min(l,s),a):l}function $p(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Sh(t,e){if($p(t,e))return t[e]}function Fn(t){if(!t)return t;if(Array.isArray(t)){const e=[],n=t.length;for(let r=0;r<n;r++)e.push(Fn(t[r]));return e}else if(typeof t=="object"){const e=Object.keys(t),n=e.length,r={};for(let o=0;o<n;o++){const i=e[o];r[i]=Fn(t[i])}return r}return t}function jb(t){return Object.values(t)}function O_(t){return Object.entries(t)}const Jj=()=>typeof process<"u"&&!1,Eh=[],e5=()=>{const t=Eh.splice(0,Eh.length);for(const e of t)e()};let eg;function t5(){eg||(eg=requestAnimationFrame(()=>{eg=void 0,e5()}))}function n5(t){if(Jj())return t();Eh.includes(t)||(Eh.push(t),t5())}function r5(t){return t!==null}function o5(t){return t!=null}const Uo=typeof window<"u"&&window.structuredClone?window.structuredClone:t=>t&&JSON.parse(JSON.stringify(t));class zd{constructor(e){y(this,"nextValue");y(this,"diff");this.previousValue=e}get(){var r,o,i,s;const e=((o=(r=this.diff)==null?void 0:r.removed)==null?void 0:o.size)??0,n=((s=(i=this.diff)==null?void 0:i.added)==null?void 0:s.size)??0;if(!(e===0&&n===0))return{value:this.nextValue,diff:this.diff}}_add(e,n){var r,o;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.add(e),this.diff??(this.diff={}),n?(r=this.diff.removed)==null||r.delete(e):((o=this.diff).added??(o.added=new Set),this.diff.added.add(e))}add(e){var o,i,s;const n=this.previousValue.has(e);if(n)return((i=(o=this.diff)==null?void 0:o.removed)==null?void 0:i.has(e))?this._add(e,n):void 0;(s=this.nextValue)!=null&&s.has(e)||this._add(e,n)}_remove(e,n){var r,o;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(e),this.diff??(this.diff={}),n?((r=this.diff).removed??(r.removed=new Set),this.diff.removed.add(e)):(o=this.diff.added)==null||o.delete(e)}remove(e){var o,i,s,a;const n=this.previousValue.has(e);if(!n)return((i=(o=this.diff)==null?void 0:o.added)==null?void 0:i.has(e))?this._remove(e,n):void 0;(a=(s=this.diff)==null?void 0:s.removed)!=null&&a.has(e)||this._remove(e,n)}}let Tp=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");class pv{constructor(e,n){y(this,"createDefaultProperties");y(this,"migrations");y(this,"validator");y(this,"scope");y(this,"isInstance",e=>(e==null?void 0:e.typeName)===this.typeName);this.typeName=e,this.createDefaultProperties=n.createDefaultProperties,this.migrations=n.migrations,this.validator=n.validator??{validate:r=>r},this.scope=n.scope??"document"}create(e){const n={...this.createDefaultProperties(),id:this.createId()};for(const[r,o]of Object.entries(e))o!==void 0&&(n[r]=o);return n.typeName=this.typeName,n}clone(e){return{...Uo(e),id:this.createId()}}createId(){return this.typeName+":"+Tp()}createCustomId(e){return this.typeName+":"+e}parseId(e){if(!this.isId(e))throw new Error(`ID "${e}" is not a valid ID for type "${this.typeName}"`);return e.slice(this.typeName.length+1)}isId(e){if(!e)return!1;for(let n=0;n<this.typeName.length;n++)if(e[n]!==this.typeName[n])return!1;return e[this.typeName.length]===":"}withDefaultProperties(e){return new pv(this.typeName,{createDefaultProperties:e,migrations:this.migrations,validator:this.validator,scope:this.scope})}validate(e){return this.validator.validate(e)}}function Jr(t,e){return new pv(t,{createDefaultProperties:()=>({}),migrations:e.migrations??{currentVersion:0,firstVersion:0,migrators:{}},validator:e.validator,scope:e.scope})}var Nb=8,j_=class{constructor(){y(this,"arraySize",0);y(this,"array",Array(Nb));y(this,"set",null)}get isEmpty(){if(this.array)return this.arraySize===0;if(this.set)return this.set.size===0;throw new Error("no set or array")}add(t){if(this.array)return this.array.indexOf(t)!==-1?!1:this.arraySize<Nb?(this.array[this.arraySize]=t,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(t),!0);if(this.set)return this.set.has(t)?!1:(this.set.add(t),!0);throw new Error("no set or array")}remove(t){if(this.array){const e=this.array.indexOf(t);return e===-1?!1:(this.array[e]=void 0,this.arraySize--,e!==this.arraySize&&(this.array[e]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return this.set.has(t)?(this.set.delete(t),!0):!1;throw new Error("no set or array")}visit(t){if(this.array){for(let e=0;e<this.arraySize;e++){const n=this.array[e];typeof n<"u"&&t(n)}return}if(this.set){this.set.forEach(t);return}throw new Error("no set or array")}};function N_(t){return t&&typeof t=="object"&&"parents"in t}function B_(t){for(let e=0,n=t.parents.length;e<n;e++)if(t.parents[e].__unsafe__getWithoutCapture(),t.parents[e].lastChangedEpoch!==t.parentEpochs[e])return!0;return!1}var Ph=(t,e)=>{if(t.children.remove(e)&&t.children.isEmpty&&N_(t))for(let n=0,r=t.parents.length;n<r;n++)Ph(t.parents[n],t)},fv=(t,e)=>{if(t.children.add(e)&&N_(t))for(let n=0,r=t.parents.length;n<r;n++)fv(t.parents[n],t)};function z_(t,e){return t===e||Object.is(t,e)||!!(t&&e&&typeof t.equals=="function"&&t.equals(e))}var Cr=Object.freeze([]),Bb=Symbol.for("__signia__"),zb=globalThis;zb[Bb]?console.error('Multiple versions of signia detected. This will cause unexpected behavior. Please add "resolutions" (yarn/pnpm) or "overrides" (npm) in your package.json to ensure only one version of signia is loaded.'):zb[Bb]=!0;var i5=class{constructor(t,e){y(this,"offset",0);y(this,"numNewParents",0);y(this,"maybeRemoved");this.below=t,this.child=e}},Je=null;function U_(t){Je=new i5(Je,t)}function F_(){const t=Je;if(Je=t.below,t.numNewParents>0||t.offset!==t.child.parents.length){for(let n=t.offset;n<t.child.parents.length;n++){const r=t.child.parents[n];t.child.parents.indexOf(r)>=t.offset&&Ph(r,t.child)}if(t.child.parents.length=t.offset,t.child.parentEpochs.length=t.offset,Je!=null&&Je.maybeRemoved)for(let n=0;n<Je.maybeRemoved.length;n++){const r=Je.maybeRemoved[n];t.child.parents.indexOf(r)===-1&&Ph(r,t.child)}}}function ay(t){if(Je){const e=Je.child.parents.indexOf(t);if(e<0&&(Je.numNewParents++,Je.child.isActivelyListening&&fv(t,Je.child)),e<0||e>=Je.offset){if(e!==Je.offset&&e>0){const n=Je.child.parents[Je.offset];Je.maybeRemoved?Je.maybeRemoved.indexOf(n)===-1&&Je.maybeRemoved.push(n):Je.maybeRemoved=[n]}Je.child.parents[Je.offset]=t,Je.child.parentEpochs[Je.offset]=t.lastChangedEpoch,Je.offset++}}}var or=Symbol("RESET_VALUE"),K_=class{constructor(t){y(this,"index",0);y(this,"buffer");this.capacity=t,this.buffer=new Array(t)}pushEntry(t,e,n){if(n!==void 0){if(n===or){this.clear();return}this.buffer[this.index]=[t,e,n],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(t){const{index:e,capacity:n,buffer:r}=this;for(let o=0;o<n;o++){const i=(e-1+n-o)%n,s=r[i];if(!s)return or;const[a,l]=s;if(o===0&&t>=l)return[];if(a<=t&&t<l){const c=o+1,d=new Array(c);for(let u=0;u<c;u++)d[u]=r[(i+u)%n][2];return d}}return or}},fs=-1,on=fs+1,tg=!1;function s5(){on++}var a5=class{constructor(t){y(this,"initialAtomValues",new Map);this.parent=t}get isRoot(){return this.parent===null}commit(){if(this.isRoot){const t=this.initialAtomValues;this.initialAtomValues=new Map,H_(t.keys())}else this.initialAtomValues.forEach((t,e)=>{this.parent.initialAtomValues.has(e)||this.parent.initialAtomValues.set(e,t)})}abort(){on++,this.initialAtomValues.forEach((t,e)=>{var n;e.set(t),(n=e.historyBuffer)==null||n.clear()}),this.commit()}};function H_(t){if(tg)throw new Error("cannot change atoms during reaction cycle");try{tg=!0;const e=new Set,n=r=>{r.lastTraversedEpoch!==on&&(r.lastTraversedEpoch=on,"maybeScheduleEffect"in r?e.add(r):r.children.visit(n))};for(const r of t)r.children.visit(n);for(const r of e)r.maybeScheduleEffect()}finally{tg=!1}}function l5(t,e){vi?vi.initialAtomValues.has(t)||vi.initialAtomValues.set(t,e):H_([t])}var vi=null;function c5(t){const e=new a5(vi);vi=e;try{let n=!1;const r=t(()=>n=!0);return n?e.abort():e.commit(),r}catch(n){throw e.abort(),n}finally{vi=vi.parent}}function Hr(t){return vi?t():c5(t)}var u5=class{constructor(t,e,n){y(this,"isEqual");y(this,"computeDiff");y(this,"lastChangedEpoch",on);y(this,"children",new j_);y(this,"historyBuffer");this.name=t,this.current=e,this.isEqual=(n==null?void 0:n.isEqual)??null,n&&(n.historyLength&&(this.historyBuffer=new K_(n.historyLength)),this.computeDiff=n.computeDiff)}__unsafe__getWithoutCapture(){return this.current}get value(){return ay(this),this.current}set(t,e){var r,o;if(((r=this.isEqual)==null?void 0:r.call(this,this.current,t))??z_(this.current,t))return this.current;s5(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,on,e??((o=this.computeDiff)==null?void 0:o.call(this,this.current,t,this.lastChangedEpoch,on))??or),this.lastChangedEpoch=on;const n=this.current;return this.current=t,l5(this,n),t}update(t){return this.set(t(this.current))}getDiffSince(t){var e;return ay(this),t>=this.lastChangedEpoch?Cr:((e=this.historyBuffer)==null?void 0:e.getChangesSince(t))??or}};function lt(t,e,n){return new u5(t,e,n)}var ly=Symbol("UNINITIALIZED"),Ma=t=>t===ly,cy=class{constructor(t,e){this.value=t,this.diff=e}};function Yl(t,e){return new cy(t,e)}var V_=class{constructor(t,e,n){y(this,"lastChangedEpoch",fs);y(this,"lastTraversedEpoch",fs);y(this,"lastCheckedEpoch",fs);y(this,"parents",[]);y(this,"parentEpochs",[]);y(this,"children",new j_);y(this,"historyBuffer");y(this,"state",ly);y(this,"computeDiff");y(this,"isEqual");this.name=t,this.derive=e,n!=null&&n.historyLength&&(this.historyBuffer=new K_(n.historyLength)),this.computeDiff=n==null?void 0:n.computeDiff,this.isEqual=(n==null?void 0:n.isEqual)??z_}get isActivelyListening(){return!this.children.isEmpty}__unsafe__getWithoutCapture(){var e;const t=this.lastChangedEpoch===fs;if(!t&&(this.lastCheckedEpoch===on||!B_(this)))return this.lastCheckedEpoch=on,this.state;try{U_(this);const n=this.derive(this.state,this.lastCheckedEpoch),r=n instanceof cy?n.value:n;if(this.state===ly||!this.isEqual(r,this.state)){if(this.historyBuffer&&!t){const o=n instanceof cy?n.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,on,o??((e=this.computeDiff)==null?void 0:e.call(this,this.state,r,this.lastCheckedEpoch,on))??or)}this.lastChangedEpoch=on,this.state=r}return this.lastCheckedEpoch=on,this.state}finally{F_()}}get value(){const t=this.__unsafe__getWithoutCapture();return ay(this),t}getDiffSince(t){var e;return this.value,t>=this.lastChangedEpoch?Cr:((e=this.historyBuffer)==null?void 0:e.getChangesSince(t))??or}};function Ub(t={},e,n,r){const o=r.get,i=Symbol.for("__signia__computed__"+n);return r.get=function(){let s=this[i];return s||(s=new V_(n,o.bind(this),t),Object.defineProperty(this,i,{enumerable:!1,configurable:!1,writable:!1,value:s})),s.value},r}function ue(){if(arguments.length===1){const t=arguments[0];return(e,n,r)=>Ub(t,e,n,r)}else return typeof arguments[0]=="string"?new V_(arguments[0],arguments[1],arguments[2]):Ub(void 0,arguments[0],arguments[1],arguments[2])}var uu=class{constructor(t,e,n){y(this,"_isActivelyListening",!1);y(this,"lastTraversedEpoch",fs);y(this,"lastReactedEpoch",fs);y(this,"_scheduleCount",0);y(this,"parentEpochs",[]);y(this,"parents",[]);y(this,"_scheduleEffect");y(this,"maybeExecute",()=>{this._isActivelyListening&&this.execute()});this.name=t,this.runEffect=e,this._scheduleEffect=n==null?void 0:n.scheduleEffect}get isActivelyListening(){return this._isActivelyListening}get scheduleCount(){return this._scheduleCount}maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==on){if(this.parents.length&&!B_(this)){this.lastReactedEpoch=on;return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}attach(){this._isActivelyListening=!0;for(let t=0,e=this.parents.length;t<e;t++)fv(this.parents[t],this)}detach(){this._isActivelyListening=!1;for(let t=0,e=this.parents.length;t<e;t++)Ph(this.parents[t],this)}execute(){try{U_(this);const t=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=on,t}finally{F_()}}};function du(t,e,n){const r=new uu(t,e,n);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function d5(t,e,n){const r=new uu(t,e,n);return{scheduler:r,start:o=>{const i=(o==null?void 0:o.force)??!1;r.attach(),i?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}class Fb{constructor(){y(this,"items",new WeakMap)}get(e,n){return this.items.has(e)||this.items.set(e,n(e)),this.items.get(e)}}var _h={exports:{}};_h.exports;(function(t,e){var n=200,r="__lodash_hash_undefined__",o=1,i=2,s=9007199254740991,a="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",d="[object Boolean]",u="[object Date]",h="[object Error]",p="[object Function]",g="[object GeneratorFunction]",m="[object Map]",v="[object Number]",x="[object Null]",b="[object Object]",E="[object Promise]",P="[object Proxy]",C="[object RegExp]",k="[object Set]",$="[object String]",A="[object Symbol]",D="[object Undefined]",j="[object WeakMap]",Y="[object ArrayBuffer]",V="[object DataView]",q="[object Float32Array]",F="[object Float64Array]",X="[object Int8Array]",ne="[object Int16Array]",ie="[object Int32Array]",W="[object Uint8Array]",H="[object Uint8ClampedArray]",G="[object Uint16Array]",Q="[object Uint32Array]",le=/[\\^$.*+?()[\]{}|]/g,De=/^\[object .+?Constructor\]$/,Ie=/^(?:0|[1-9]\d*)$/,we={};we[q]=we[F]=we[X]=we[ne]=we[ie]=we[W]=we[H]=we[G]=we[Q]=!0,we[a]=we[l]=we[Y]=we[d]=we[V]=we[u]=we[h]=we[p]=we[m]=we[v]=we[b]=we[C]=we[k]=we[$]=we[j]=!1;var Ze=typeof zn=="object"&&zn&&zn.Object===Object&&zn,je=typeof self=="object"&&self&&self.Object===Object&&self,ze=Ze||je||Function("return this")(),Re=e&&!e.nodeType&&e,Ft=Re&&!0&&t&&!t.nodeType&&t,Zt=Ft&&Ft.exports===Re,vt=Zt&&Ze.process,kt=function(){try{return vt&&vt.binding&&vt.binding("util")}catch{}}(),Lt=kt&&kt.isTypedArray;function xn(L,B){for(var J=-1,he=L==null?0:L.length,nt=0,Ce=[];++J<he;){var wt=L[J];B(wt,J,L)&&(Ce[nt++]=wt)}return Ce}function Dt(L,B){for(var J=-1,he=B.length,nt=L.length;++J<he;)L[nt+J]=B[J];return L}function Kt(L,B){for(var J=-1,he=L==null?0:L.length;++J<he;)if(B(L[J],J,L))return!0;return!1}function Lr(L,B){for(var J=-1,he=Array(L);++J<L;)he[J]=B(J);return he}function ht(L){return function(B){return L(B)}}function Pt(L,B){return L.has(B)}function Ht(L,B){return L==null?void 0:L[B]}function We(L){var B=-1,J=Array(L.size);return L.forEach(function(he,nt){J[++B]=[nt,he]}),J}function dr(L,B){return function(J){return L(B(J))}}function Dr(L){var B=-1,J=Array(L.size);return L.forEach(function(he){J[++B]=he}),J}var Rn=Array.prototype,Ji=Function.prototype,M=Object.prototype,_=ze["__core-js_shared__"],S=Ji.toString,T=M.hasOwnProperty,R=function(){var L=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||"");return L?"Symbol(src)_1."+L:""}(),N=M.toString,z=RegExp("^"+S.call(T).replace(le,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),re=Zt?ze.Buffer:void 0,ae=ze.Symbol,ce=ze.Uint8Array,se=M.propertyIsEnumerable,ve=Rn.splice,ke=ae?ae.toStringTag:void 0,Ln=Object.getOwnPropertySymbols,$t=re?re.isBuffer:void 0,Ot=dr(Object.keys,Object),bn=Ys(ze,"DataView"),Or=Ys(ze,"Map"),es=Ys(ze,"Promise"),Co=Ys(ze,"Set"),oo=Ys(ze,"WeakMap"),ko=Ys(Object,"create"),wl=rs(bn),Vt=rs(Or),Qn=rs(es),$o=rs(Co),ts=rs(oo),Tu=ae?ae.prototype:void 0,xl=Tu?Tu.valueOf:void 0;function Jt(L){var B=-1,J=L==null?0:L.length;for(this.clear();++B<J;){var he=L[B];this.set(he[0],he[1])}}function bl(){this.__data__=ko?ko(null):{},this.size=0}function Mu(L){var B=this.has(L)&&delete this.__data__[L];return this.size-=B?1:0,B}function Tf(L){var B=this.__data__;if(ko){var J=B[L];return J===r?void 0:J}return T.call(B,L)?B[L]:void 0}function Y3(L){var B=this.__data__;return ko?B[L]!==void 0:T.call(B,L)}function X3(L,B){var J=this.__data__;return this.size+=this.has(L)?0:1,J[L]=ko&&B===void 0?r:B,this}Jt.prototype.clear=bl,Jt.prototype.delete=Mu,Jt.prototype.get=Tf,Jt.prototype.has=Y3,Jt.prototype.set=X3;function To(L){var B=-1,J=L==null?0:L.length;for(this.clear();++B<J;){var he=L[B];this.set(he[0],he[1])}}function G3(){this.__data__=[],this.size=0}function q3(L){var B=this.__data__,J=Ru(B,L);if(J<0)return!1;var he=B.length-1;return J==he?B.pop():ve.call(B,J,1),--this.size,!0}function Q3(L){var B=this.__data__,J=Ru(B,L);return J<0?void 0:B[J][1]}function Z3(L){return Ru(this.__data__,L)>-1}function J3(L,B){var J=this.__data__,he=Ru(J,L);return he<0?(++this.size,J.push([L,B])):J[he][1]=B,this}To.prototype.clear=G3,To.prototype.delete=q3,To.prototype.get=Q3,To.prototype.has=Z3,To.prototype.set=J3;function ns(L){var B=-1,J=L==null?0:L.length;for(this.clear();++B<J;){var he=L[B];this.set(he[0],he[1])}}function eA(){this.size=0,this.__data__={hash:new Jt,map:new(Or||To),string:new Jt}}function tA(L){var B=Lu(this,L).delete(L);return this.size-=B?1:0,B}function nA(L){return Lu(this,L).get(L)}function rA(L){return Lu(this,L).has(L)}function oA(L,B){var J=Lu(this,L),he=J.size;return J.set(L,B),this.size+=J.size==he?0:1,this}ns.prototype.clear=eA,ns.prototype.delete=tA,ns.prototype.get=nA,ns.prototype.has=rA,ns.prototype.set=oA;function Au(L){var B=-1,J=L==null?0:L.length;for(this.__data__=new ns;++B<J;)this.add(L[B])}function iA(L){return this.__data__.set(L,r),this}function sA(L){return this.__data__.has(L)}Au.prototype.add=Au.prototype.push=iA,Au.prototype.has=sA;function ai(L){var B=this.__data__=new To(L);this.size=B.size}function aA(){this.__data__=new To,this.size=0}function lA(L){var B=this.__data__,J=B.delete(L);return this.size=B.size,J}function cA(L){return this.__data__.get(L)}function uA(L){return this.__data__.has(L)}function dA(L,B){var J=this.__data__;if(J instanceof To){var he=J.__data__;if(!Or||he.length<n-1)return he.push([L,B]),this.size=++J.size,this;J=this.__data__=new ns(he)}return J.set(L,B),this.size=J.size,this}ai.prototype.clear=aA,ai.prototype.delete=lA,ai.prototype.get=cA,ai.prototype.has=uA,ai.prototype.set=dA;function hA(L,B){var J=Du(L),he=!J&&CA(L),nt=!J&&!he&&Mf(L),Ce=!J&&!he&&!nt&&Bx(L),wt=J||he||nt||Ce,Wt=wt?Lr(L.length,String):[],en=Wt.length;for(var pt in L)(B||T.call(L,pt))&&!(wt&&(pt=="length"||nt&&(pt=="offset"||pt=="parent")||Ce&&(pt=="buffer"||pt=="byteLength"||pt=="byteOffset")||SA(pt,en)))&&Wt.push(pt);return Wt}function Ru(L,B){for(var J=L.length;J--;)if(Dx(L[J][0],B))return J;return-1}function pA(L,B,J){var he=B(L);return Du(L)?he:Dt(he,J(L))}function Sl(L){return L==null?L===void 0?D:x:ke&&ke in Object(L)?xA(L):IA(L)}function Mx(L){return El(L)&&Sl(L)==a}function Ax(L,B,J,he,nt){return L===B?!0:L==null||B==null||!El(L)&&!El(B)?L!==L&&B!==B:fA(L,B,J,he,Ax,nt)}function fA(L,B,J,he,nt,Ce){var wt=Du(L),Wt=Du(B),en=wt?l:li(L),pt=Wt?l:li(B);en=en==a?b:en,pt=pt==a?b:pt;var Zn=en==b,jr=pt==b,dn=en==pt;if(dn&&Mf(L)){if(!Mf(B))return!1;wt=!0,Zn=!1}if(dn&&!Zn)return Ce||(Ce=new ai),wt||Bx(L)?Rx(L,B,J,he,nt,Ce):vA(L,B,en,J,he,nt,Ce);if(!(J&o)){var hr=Zn&&T.call(L,"__wrapped__"),pr=jr&&T.call(B,"__wrapped__");if(hr||pr){var ci=hr?L.value():L,Mo=pr?B.value():B;return Ce||(Ce=new ai),nt(ci,Mo,J,he,Ce)}}return dn?(Ce||(Ce=new ai),wA(L,B,J,he,nt,Ce)):!1}function gA(L){if(!Nx(L)||PA(L))return!1;var B=Ox(L)?z:De;return B.test(rs(L))}function mA(L){return El(L)&&jx(L.length)&&!!we[Sl(L)]}function yA(L){if(!_A(L))return Ot(L);var B=[];for(var J in Object(L))T.call(L,J)&&J!="constructor"&&B.push(J);return B}function Rx(L,B,J,he,nt,Ce){var wt=J&o,Wt=L.length,en=B.length;if(Wt!=en&&!(wt&&en>Wt))return!1;var pt=Ce.get(L);if(pt&&Ce.get(B))return pt==B;var Zn=-1,jr=!0,dn=J&i?new Au:void 0;for(Ce.set(L,B),Ce.set(B,L);++Zn<Wt;){var hr=L[Zn],pr=B[Zn];if(he)var ci=wt?he(pr,hr,Zn,B,L,Ce):he(hr,pr,Zn,L,B,Ce);if(ci!==void 0){if(ci)continue;jr=!1;break}if(dn){if(!Kt(B,function(Mo,os){if(!Pt(dn,os)&&(hr===Mo||nt(hr,Mo,J,he,Ce)))return dn.push(os)})){jr=!1;break}}else if(!(hr===pr||nt(hr,pr,J,he,Ce))){jr=!1;break}}return Ce.delete(L),Ce.delete(B),jr}function vA(L,B,J,he,nt,Ce,wt){switch(J){case V:if(L.byteLength!=B.byteLength||L.byteOffset!=B.byteOffset)return!1;L=L.buffer,B=B.buffer;case Y:return!(L.byteLength!=B.byteLength||!Ce(new ce(L),new ce(B)));case d:case u:case v:return Dx(+L,+B);case h:return L.name==B.name&&L.message==B.message;case C:case $:return L==B+"";case m:var Wt=We;case k:var en=he&o;if(Wt||(Wt=Dr),L.size!=B.size&&!en)return!1;var pt=wt.get(L);if(pt)return pt==B;he|=i,wt.set(L,B);var Zn=Rx(Wt(L),Wt(B),he,nt,Ce,wt);return wt.delete(L),Zn;case A:if(xl)return xl.call(L)==xl.call(B)}return!1}function wA(L,B,J,he,nt,Ce){var wt=J&o,Wt=Lx(L),en=Wt.length,pt=Lx(B),Zn=pt.length;if(en!=Zn&&!wt)return!1;for(var jr=en;jr--;){var dn=Wt[jr];if(!(wt?dn in B:T.call(B,dn)))return!1}var hr=Ce.get(L);if(hr&&Ce.get(B))return hr==B;var pr=!0;Ce.set(L,B),Ce.set(B,L);for(var ci=wt;++jr<en;){dn=Wt[jr];var Mo=L[dn],os=B[dn];if(he)var zx=wt?he(os,Mo,dn,B,L,Ce):he(Mo,os,dn,L,B,Ce);if(!(zx===void 0?Mo===os||nt(Mo,os,J,he,Ce):zx)){pr=!1;break}ci||(ci=dn=="constructor")}if(pr&&!ci){var Ou=L.constructor,ju=B.constructor;Ou!=ju&&"constructor"in L&&"constructor"in B&&!(typeof Ou=="function"&&Ou instanceof Ou&&typeof ju=="function"&&ju instanceof ju)&&(pr=!1)}return Ce.delete(L),Ce.delete(B),pr}function Lx(L){return pA(L,TA,bA)}function Lu(L,B){var J=L.__data__;return EA(B)?J[typeof B=="string"?"string":"hash"]:J.map}function Ys(L,B){var J=Ht(L,B);return gA(J)?J:void 0}function xA(L){var B=T.call(L,ke),J=L[ke];try{L[ke]=void 0;var he=!0}catch{}var nt=N.call(L);return he&&(B?L[ke]=J:delete L[ke]),nt}var bA=Ln?function(L){return L==null?[]:(L=Object(L),xn(Ln(L),function(B){return se.call(L,B)}))}:MA,li=Sl;(bn&&li(new bn(new ArrayBuffer(1)))!=V||Or&&li(new Or)!=m||es&&li(es.resolve())!=E||Co&&li(new Co)!=k||oo&&li(new oo)!=j)&&(li=function(L){var B=Sl(L),J=B==b?L.constructor:void 0,he=J?rs(J):"";if(he)switch(he){case wl:return V;case Vt:return m;case Qn:return E;case $o:return k;case ts:return j}return B});function SA(L,B){return B=B??s,!!B&&(typeof L=="number"||Ie.test(L))&&L>-1&&L%1==0&&L<B}function EA(L){var B=typeof L;return B=="string"||B=="number"||B=="symbol"||B=="boolean"?L!=="__proto__":L===null}function PA(L){return!!R&&R in L}function _A(L){var B=L&&L.constructor,J=typeof B=="function"&&B.prototype||M;return L===J}function IA(L){return N.call(L)}function rs(L){if(L!=null){try{return S.call(L)}catch{}try{return L+""}catch{}}return""}function Dx(L,B){return L===B||L!==L&&B!==B}var CA=Mx(function(){return arguments}())?Mx:function(L){return El(L)&&T.call(L,"callee")&&!se.call(L,"callee")},Du=Array.isArray;function kA(L){return L!=null&&jx(L.length)&&!Ox(L)}var Mf=$t||AA;function $A(L,B){return Ax(L,B)}function Ox(L){if(!Nx(L))return!1;var B=Sl(L);return B==p||B==g||B==c||B==P}function jx(L){return typeof L=="number"&&L>-1&&L%1==0&&L<=s}function Nx(L){var B=typeof L;return L!=null&&(B=="object"||B=="function")}function El(L){return L!=null&&typeof L=="object"}var Bx=Lt?ht(Lt):mA;function TA(L){return kA(L)?hA(L):yA(L)}function MA(){return[]}function AA(){return!1}t.exports=$A})(_h,_h.exports);var h5=_h.exports;const p5=tl(h5);function f5(t){if(t.length===0)return new Set;const e=t[0],n=t.slice(1),r=new Set;for(const o of e)n.every(i=>i.has(o))&&r.add(o);return r}function g5(t,e){const n={};for(const r of e)t.has(r)||(n.added??(n.added=new Set),n.added.add(r));for(const r of t)e.has(r)||(n.removed??(n.removed=new Set),n.removed.add(r));return n.added||n.removed?n:void 0}function Kb(t,e){for(const[n,r]of Object.entries(t)){const o=r,i=e[n];if("eq"in o&&i!==o.eq||"neq"in o&&i===o.neq||"gt"in o&&(typeof i!="number"||i<=o.gt))return!1}return!0}function Hb(t,e,n){const r=Object.fromEntries(Object.keys(n).map(o=>[o,new Set]));for(const[o,i]of Object.entries(n))if("eq"in i){const a=t.index(e,o).value.get(i.eq);if(a)for(const l of a)r[o].add(l)}else if("neq"in i){const s=t.index(e,o);for(const[a,l]of s.value)if(a!==i.neq)for(const c of l)r[o].add(c)}else if("gt"in i){const s=t.index(e,o);for(const[a,l]of s.value)if(a>i.gt)for(const c of l)r[o].add(c)}return f5(Object.values(r))}class m5{constructor(e,n){y(this,"indexCache",new Map);y(this,"historyCache",new Map);this.atoms=e,this.history=n}filterHistory(e){if(this.historyCache.has(e))return this.historyCache.get(e);const n=ue("filterHistory:"+e,(r,o)=>{if(Ma(r))return this.history.value;const i=this.history.getDiffSince(o);if(i===or)return this.history.value;const s={added:{},removed:{},updated:{}};let a=0,l=0,c=0;for(const d of i){for(const u of Object.values(d.added))if(u.typeName===e)if(s.removed[u.id]){const h=s.removed[u.id];delete s.removed[u.id],l--,h!==u&&(s.updated[u.id]=[h,u],c++)}else s.added[u.id]=u,a++;for(const[u,h]of Object.values(d.updated))h.typeName===e&&(s.added[h.id]?s.added[h.id]=h:s.updated[h.id]?s.updated[h.id]=[s.updated[h.id][0],h]:(s.updated[h.id]=[u,h],c++));for(const u of Object.values(d.removed))u.typeName===e&&(s.added[u.id]?(delete s.added[u.id],a--):s.updated[u.id]?(s.removed[u.id]=s.updated[u.id][0],delete s.updated[u.id],c--,l++):(s.removed[u.id]=u,l++))}return a||l||c?Yl(this.history.value,s):r},{historyLength:100});return this.historyCache.set(e,n),n}index(e,n){const r=e+":"+n;if(this.indexCache.has(r))return this.indexCache.get(r);const o=this.__uncached_createIndex(e,n);return this.indexCache.set(r,o),o}__uncached_createIndex(e,n){const r=this.filterHistory(e),o=()=>{r.value;const i=new Map;for(const s of Object.values(this.atoms.value)){const a=s.value;if(a.typeName===e){const l=a[n];i.has(l)||i.set(l,new Set),i.get(l).add(a.id)}}return i};return ue("index:"+e+":"+n,(i,s)=>{if(Ma(i))return o();const a=r.getDiffSince(s);if(a===or)return o();const l=new Map,c=(p,g)=>{let m=l.get(p);m||(m=new zd(i.get(p)??new Set)),m.add(g),l.set(p,m)},d=(p,g)=>{let m=l.get(p);m||(m=new zd(i.get(p)??new Set)),m.remove(g),l.set(p,m)};for(const p of a){for(const g of Object.values(p.added))if(g.typeName===e){const m=g[n];c(m,g.id)}for(const[g,m]of Object.values(p.updated))if(m.typeName===e){const v=g[n],x=m[n];v!==x&&(d(v,m.id),c(x,m.id))}for(const g of Object.values(p.removed))if(g.typeName===e){const m=g[n];d(m,g.id)}}let u,h;for(const[p,g]of l){const m=g.get();m&&(u||(u=new Map(i)),h||(h=new Map),m.value.size===0?u.delete(p):u.set(p,m.value),h.set(p,m.diff))}return u&&h?Yl(u,h):i},{historyLength:100})}record(e,n=()=>({}),r="record:"+e+(n?":"+n.toString():"")){const o=this.ids(e,n,r);return ue(r,()=>{var i;for(const s of o.value)return(i=this.atoms.value[s])==null?void 0:i.value})}records(e,n=()=>({}),r="records:"+e+(n?":"+n.toString():"")){const o=this.ids(e,n,"ids:"+r);return ue(r,()=>[...o.value].map(i=>{const s=this.atoms.value[i];if(!s)throw new Error("no atom found for record id: "+i);return s.value}))}ids(e,n=()=>({}),r="ids:"+e+(n?":"+n.toString():"")){const o=this.filterHistory(e),i=()=>{o.value;const l=n();return Object.keys(l).length===0?new Set(Object.values(this.atoms.value).flatMap(c=>{const d=c.value;return d.typeName===e?d.id:[]})):Hb(this,e,l)},s=l=>{const c=i(),d=g5(l,c);return d?Yl(c,d):l},a=ue("ids_query:"+r,n,{isEqual:p5});return ue("query:"+r,(l,c)=>{const d=a.value;if(Ma(l))return i();if(c<a.lastChangedEpoch)return s(l);const u=o.getDiffSince(c);if(u===or)return s(l);const h=new zd(l);for(const g of u){for(const m of Object.values(g.added))m.typeName===e&&Kb(d,m)&&h.add(m.id);for(const[m,v]of Object.values(g.updated))v.typeName===e&&(Kb(d,v)?h.add(v.id):h.remove(v.id));for(const m of Object.values(g.removed))m.typeName===e&&h.remove(m.id)}const p=h.get();return p?Yl(p.value,p.diff):l},{historyLength:50})}exec(e,n){const r=Hb(this,e,n);if(r.size===0)return Cr;const o=this.atoms.value;return[...r].map(i=>o[i].value)}}class W_{constructor(e){y(this,"atoms",lt("store_atoms",{}));y(this,"history",lt("history",0,{historyLength:1e3}));y(this,"query",new m5(this.atoms,this.history));y(this,"listeners",new Set);y(this,"historyAccumulator",new v5);y(this,"historyReactor");y(this,"schema");y(this,"props");y(this,"onAfterCreate");y(this,"onAfterChange");y(this,"onBeforeDelete");y(this,"onAfterDelete");y(this,"_runCallbacks",!0);y(this,"put",(e,n)=>{Hr(()=>{const r={},o={},i=this.atoms.__unsafe__getWithoutCapture();let s=null,a,l=!1;for(let u=0,h=e.length;u<h;u++){a=e[u];const p=(s??i)[a.id];if(p){const g=p.__unsafe__getWithoutCapture();a=this.schema.validateRecord(this,a,n??"updateRecord",g),p.set(a);const m=p.__unsafe__getWithoutCapture();g!==m&&(l=!0,r[a.id]=[g,m])}else l=!0,a=this.schema.validateRecord(this,a,n??"createRecord",null),o[a.id]=a,s||(s={...i}),s[a.id]=lt("atom:"+a.id,a)}if(s&&this.atoms.set(s),!l)return;this.updateHistory({added:o,updated:r,removed:{}});const{onAfterCreate:c,onAfterChange:d}=this;c&&this._runCallbacks&&Object.values(o).forEach(u=>{c(u)}),d&&this._runCallbacks&&Object.values(r).forEach(([u,h])=>{d(u,h)})})});y(this,"remove",e=>{Hr(()=>{if(this.onBeforeDelete&&this._runCallbacks)for(const r of e){const o=this.atoms.__unsafe__getWithoutCapture()[r];o&&this.onBeforeDelete(o.value)}let n;if(this.atoms.update(r=>{let o;for(const i of e)i in r&&(o||(o={...r}),n||(n={}),delete o[i],n[i]=r[i].value);return o??r}),!!n&&(this.updateHistory({added:{},updated:{},removed:n}),this.onAfterDelete&&this._runCallbacks))for(let r=0,o=e.length;r<o;r++)this.onAfterDelete(n[e[r]])})});y(this,"get",e=>{var n;return(n=this.atoms.value[e])==null?void 0:n.value});y(this,"unsafeGetWithoutCapture",e=>{var n;return(n=this.atoms.value[e])==null?void 0:n.__unsafe__getWithoutCapture()});y(this,"serialize",e=>{const n={};for(const[r,o]of Object.entries(this.atoms.value)){const i=o.value;typeof e=="function"&&!e(i)||(n[r]=i)}return n});y(this,"serializeDocumentState",()=>this.serialize(e=>this.schema.types[e.typeName].scope==="document"));y(this,"deserialize",e=>{Hr(()=>{this.clear(),this.put(Object.values(e))})});y(this,"allRecords",()=>Object.values(this.atoms.value).map(e=>e.value));y(this,"clear",()=>{this.remove(Object.keys(this.atoms.value))});y(this,"update",(e,n)=>{const r=this.atoms.value[e];if(!r){console.error(`Record ${e} not found. This is probably an error`);return}this.put([n(r.__unsafe__getWithoutCapture())])});y(this,"has",e=>!!this.atoms.value[e]);y(this,"listen",e=>(this._flushHistory(),this.listeners.add(e),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(e),this.listeners.size===0&&this.historyReactor.stop()}));y(this,"isMergingRemoteChanges",!1);y(this,"mergeRemoteChanges",e=>{if(this.isMergingRemoteChanges)return e();try{this.isMergingRemoteChanges=!0,Hr(e)}finally{this.isMergingRemoteChanges=!1}});y(this,"createComputedCache",(e,n)=>{const r=new Fb;return{get:o=>{const i=this.atoms.value[o];if(i)return r.get(i,()=>ue(e+":"+o,()=>n(i.value))).value}}});y(this,"createSelectedComputedCache",(e,n,r)=>{const o=new Fb;return{get:i=>{const s=this.atoms.value[i];if(!s)return;const a=ue(e+":"+i+":selector",()=>n(s.value));return o.get(s,()=>ue(e+":"+i,()=>r(a.value))).value}}});y(this,"_integrityChecker");y(this,"_isPossiblyCorrupted",!1);const{initialData:n,schema:r}=e;this.schema=r,this.props=e.props,n&&this.atoms.set(Object.fromEntries(Object.entries(n).map(([o,i])=>[o,lt("atom:"+o,this.schema.validateRecord(this,i,"initialize",null))]))),this.historyReactor=d5("Store.historyReactor",()=>{this.history.value,this._flushHistory()},{scheduleEffect:o=>n5(o)})}_flushHistory(){if(this.historyAccumulator.hasChanges()){const e=this.historyAccumulator.flush();for(const{changes:n,source:r}of e)this.listeners.forEach(o=>o({changes:n,source:r}))}}updateHistory(e){this.historyAccumulator.add({changes:e,source:this.isMergingRemoteChanges?"remote":"user"}),this.listeners.size===0&&this.historyAccumulator.clear(),this.history.set(this.history.value+1,e)}validate(e){this.allRecords().forEach(n=>this.schema.validateRecord(this,n,e,null))}extractingChanges(e){const n=[],r=this.historyAccumulator.intercepting(o=>n.push(o.changes));try{return Hr(e),gv(n)}finally{r()}}applyDiff(e,n=!0){const r=this._runCallbacks;try{this._runCallbacks=n,Hr(()=>{const o=Object.values(e.added).concat(Object.values(e.updated).map(([s,a])=>a)),i=Object.keys(e.removed);o.length&&this.put(o),i.length&&this.remove(i)})}finally{this._runCallbacks=r}}ensureStoreIsUsable(){var e;this._integrityChecker??(this._integrityChecker=this.schema.createIntegrityChecker(this)),(e=this._integrityChecker)==null||e.call(this)}markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}}function gv(t){const e={added:{},removed:{},updated:{}};for(const n of t){for(const[r,o]of Object.entries(n.added))if(e.removed[r]){const i=e.removed[r];delete e.removed[r],i!==o&&(e.updated[r]=[i,o])}else e.added[r]=o;for(const[r,[o,i]]of Object.entries(n.updated)){if(e.added[r]){e.added[r]=i,delete e.updated[r],delete e.removed[r];continue}if(e.updated[r]){e.updated[r][1]=i,delete e.removed[r];continue}e.updated[r]=n.updated[r],delete e.removed[r]}for(const[r,o]of Object.entries(n.removed))e.added[r]?delete e.added[r]:e.updated[r]?(e.removed[r]=e.updated[r][0],delete e.updated[r]):e.removed[r]=o}return e}function y5(t){const e=[];let n=t[0],r;for(let o=1,i=t.length;o<i;o++)r=t[o],n.source!==r.source?(e.push(n),n=r):n={source:n.source,changes:gv([n.changes,r.changes])};return e.push(n),e}class v5{constructor(){y(this,"_history",[]);y(this,"_inteceptors",new Set)}intercepting(e){return this._inteceptors.add(e),()=>{this._inteceptors.delete(e)}}add(e){this._history.push(e);for(const n of this._inteceptors)n(e)}flush(){const e=y5(this._history);return this._history=[],e}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function w5(t){return typeof t=="object"&&t!==null&&"id"in t&&"typeName"in t}function Qe({firstVersion:t,currentVersion:e,migrators:n,subTypeKey:r,subTypeMigrations:o}){return{currentVersion:e,firstVersion:t,migrators:n,subTypeKey:r,subTypeMigrations:o}}var Xl=(t=>(t.IncompatibleSubtype="incompatible-subtype",t.UnknownType="unknown-type",t.TargetVersionTooNew="target-version-too-new",t.TargetVersionTooOld="target-version-too-old",t.MigrationError="migration-error",t.UnrecognizedSubtype="unrecognized-subtype",t))(Xl||{});function Hu({record:t,migrations:e,fromVersion:n,toVersion:r}){let o=n;if(!w5(t))throw new Error("[migrateRecord] object is not a record");const{typeName:i,id:s,...a}=t;let l=a;for(;o<r;){const c=o+1,d=e.migrators[c];if(!d)return{type:"error",reason:"target-version-too-new"};l=d.up(l),o=c}for(;o>r;){const c=o-1,d=e.migrators[o];if(!d)return{type:"error",reason:"target-version-too-old"};l=d.down(l),o=c}return{type:"success",value:{...l,id:s,typeName:i}}}function x5({value:t,migrations:e,fromVersion:n,toVersion:r}){let o=n;for(;o<r;){const i=o+1,s=e.migrators[i];if(!s)return{type:"error",reason:"target-version-too-new"};t=s.up(t),o=i}for(;o>r;){const i=o-1,s=e.migrators[o];if(!s)return{type:"error",reason:"target-version-too-old"};t=s.down(t),o=i}return{type:"success",value:t}}class mv{constructor(e,n){this.types=e,this.options=n}static create(e,n){return new mv(e,n??{})}get currentStoreVersion(){var e;return((e=this.options.snapshotMigrations)==null?void 0:e.currentVersion)??0}validateRecord(e,n,r,o){try{const i=Sh(this.types,n.typeName);if(!i)throw new Error(`Missing definition for record type ${n.typeName}`);return i.validate(n)}catch(i){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:e,record:n,phase:r,recordBefore:o,error:i});throw i}}migratePersistedRecord(e,n,r="up"){var u;const o=Sh(this.types,e.typeName),i=n.recordVersions[e.typeName];if(!i||!o)return{type:"error",reason:Xl.UnknownType};const s=o.migrations.currentVersion,a=i.version;if(s!==a){const h=Hu(r==="up"?{record:e,migrations:o.migrations,fromVersion:a,toVersion:s}:{record:e,migrations:o.migrations,fromVersion:s,toVersion:a});if(h.type==="error")return h;e=h.value}if(!o.migrations.subTypeKey)return{type:"success",value:e};const l=(u=o.migrations.subTypeMigrations)==null?void 0:u[e[o.migrations.subTypeKey]],c="subTypeVersions"in i?i.subTypeVersions[e[o.migrations.subTypeKey]]:null;if(l===void 0)return{type:"error",reason:Xl.UnrecognizedSubtype};if(c==null)return{type:"error",reason:Xl.IncompatibleSubtype};const d=Hu(r==="up"?{record:e,migrations:l,fromVersion:c,toVersion:l.currentVersion}:{record:e,migrations:l,fromVersion:l.currentVersion,toVersion:c});return d.type==="error"?d:{type:"success",value:d.value}}migrateStoreSnapshot(e,n){const r=this.options.snapshotMigrations;if(!r)return{type:"success",value:e};const o=r.currentVersion,i=n.storeVersion??0;if(o<i)return{type:"error",reason:Xl.TargetVersionTooOld};if(o>i){const a=x5({value:e,migrations:r,fromVersion:i,toVersion:o});if(a.type==="error")return a;e=a.value}const s=[];for(const a of Object.values(e)){const l=this.migratePersistedRecord(a,n);if(l.type==="error")return l;l.value&&l.value!==a&&s.push(l.value)}if(s.length){e={...e};for(const a of s)e[a.id]=a}return{type:"success",value:e}}createIntegrityChecker(e){var n,r;return((r=(n=this.options).createIntegrityChecker)==null?void 0:r.call(n,e))??void 0}derivePresenceState(e){var n,r;return(r=(n=this.options).derivePresenceState)==null?void 0:r.call(n,e)}serialize(){var e;return{schemaVersion:1,storeVersion:((e=this.options.snapshotMigrations)==null?void 0:e.currentVersion)??0,recordVersions:Object.fromEntries(jb(this.types).map(n=>[n.typeName,n.migrations.subTypeKey&&n.migrations.subTypeMigrations?{version:n.migrations.currentVersion,subTypeKey:n.migrations.subTypeKey,subTypeVersions:n.migrations.subTypeMigrations?Object.fromEntries(Object.entries(n.migrations.subTypeMigrations).map(([r,o])=>[r,o.currentVersion])):void 0}:{version:n.migrations.currentVersion}]))}}serializeEarliestVersion(){var e;return{schemaVersion:1,storeVersion:((e=this.options.snapshotMigrations)==null?void 0:e.firstVersion)??0,recordVersions:Object.fromEntries(jb(this.types).map(n=>[n.typeName,n.migrations.subTypeKey&&n.migrations.subTypeMigrations?{version:n.migrations.firstVersion,subTypeKey:n.migrations.subTypeKey,subTypeVersions:n.migrations.subTypeMigrations?Object.fromEntries(Object.entries(n.migrations.subTypeMigrations).map(([r,o])=>[r,o.firstVersion])):void 0}:{version:n.migrations.firstVersion}]))}}}const b5=(t,e)=>{if(t.schemaVersion>e.schemaVersion)return 1;if(t.schemaVersion<e.schemaVersion)return-1;if(t.storeVersion>e.storeVersion)return 1;if(t.storeVersion<e.storeVersion)return-1;for(const n of Object.keys(t.recordVersions)){const r=t.recordVersions[n],o=e.recordVersions[n];if(r.version>o.version)return 1;if(r.version<o.version)return-1;if("subTypeVersions"in r&&!("subTypeVersions"in o))return 1;if(!("subTypeVersions"in r)&&"subTypeVersions"in o)return-1;if(!(!("subTypeVersions"in r)||!("subTypeVersions"in o)))for(const i of Object.keys(r.subTypeVersions)){const s=r.subTypeVersions[i],a=o.subTypeVersions[i];if(s>a)return 1;if(s<a)return-1}}return 0};function S5(t){if(!t.length)return null;let e="";for(const n of t)typeof n=="number"?e+=`.${n}`:n.startsWith("(")?e.endsWith(")")?e=`${e.slice(0,-1)}, ${n.slice(1)}`:e+=n:e+=`.${n}`;return e.startsWith(".")?e.slice(1):e}class Et extends Error{constructor(n,r=[]){const o=S5(r),i=n.split(`
`).map((s,a)=>a===0?s:`  ${s}`).join(`
`);super(r?`At ${o}: ${i}`:i);y(this,"name","ValidationError");this.rawMessage=n,this.path=r}}function al(t,e){try{return e()}catch(n){throw n instanceof Et?new Et(n.rawMessage,[t,...n.path]):new Et(n.toString(),[t])}}function Fa(t){if(t===null)return"null";if(Array.isArray(t))return"an array";const e=typeof t;switch(e){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${e}`;case"object":return`an ${e}`;case"undefined":return"undefined";default:Qj(e)}}class Kn{constructor(e){this.validationFn=e}validate(e){return this.validationFn(e)}nullable(){return new Kn(e=>e===null?null:this.validate(e))}optional(){return new Kn(e=>{if(e!==void 0)return this.validate(e)})}refine(e){return new Kn(n=>e(this.validate(n)))}check(e,n){return typeof e=="string"?this.refine(r=>(al(`(check ${e})`,()=>n(r)),r)):this.refine(r=>(e(r),r))}}class E5 extends Kn{constructor(e){super(n=>{const r=I5.validate(n);for(let o=0;o<r.length;o++)al(o,()=>e.validate(r[o]));return r}),this.itemValidator=e}nonEmpty(){return this.check(e=>{if(e.length===0)throw new Et("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(e=>{if(e.length<=1)throw new Et("Expected an array with length greater than 1")})}}class Ih extends Kn{constructor(e,n=!1){super(r=>{if(typeof r!="object"||r===null)throw new Et(`Expected object, got ${Fa(r)}`);for(const[o,i]of Object.entries(e))al(o,()=>{i.validate(Sh(r,o))});if(!n){for(const o of Object.keys(r))if(!$p(e,o))throw new Et("Unexpected property",[o])}return r}),this.config=e,this.shouldAllowUnknownProperties=n}allowUnknownProperties(){return new Ih(this.config,!0)}extend(e){return new Ih({...this.config,...e})}}class yv extends Kn{constructor(e,n,r){super(o=>{if(typeof o!="object"||o===null)throw new Et(`Expected an object, got ${Fa(o)}`,[]);const i=Sh(o,e);if(typeof i!="string")throw new Et(`Expected a string for key "${e}", got ${Fa(i)}`);const s=$p(n,i)?n[i]:void 0;return s===void 0?this.unknownValueValidation(o,i):al(`(${e} = ${i})`,()=>s.validate(o))}),this.key=e,this.config=n,this.unknownValueValidation=r}validateUnknownVariants(e){return new yv(this.key,this.config,e)}}class P5 extends Kn{constructor(e,n){super(r=>{if(typeof r!="object"||r===null)throw new Et(`Expected object, got ${Fa(r)}`);for(const[o,i]of Object.entries(r))al(o,()=>{e.validate(o),n.validate(i)});return r}),this.keyValidator=e,this.valueValidator=n}}function vv(t){return new Kn(e=>{if(typeof e!==t)throw new Et(`Expected ${t}, got ${Fa(e)}`);return e})}const _5=new Kn(t=>t),Ne=vv("string"),Ae=vv("number").check(t=>{if(Number.isNaN(t))throw new Et("Expected a number, got NaN");if(!Number.isFinite(t))throw new Et(`Expected a finite number, got ${t}`)}),wv=Ae.check(t=>{if(t<0)throw new Et(`Expected a positive number, got ${t}`)}),Xn=Ae.check(t=>{if(t<=0)throw new Et(`Expected a non-zero positive number, got ${t}`)}),Y_=Ae.check(t=>{if(!Number.isInteger(t))throw new Et(`Expected an integer, got ${t}`)});Y_.check(t=>{if(t<0)throw new Et(`Expected a positive integer, got ${t}`)});Y_.check(t=>{if(t<=0)throw new Et(`Expected a non-zero positive integer, got ${t}`)});const St=vv("boolean");function yn(t){return new Kn(e=>{if(e!==t)throw new Et(`Expected ${t}, got ${JSON.stringify(e)}`);return t})}const I5=new Kn(t=>{if(!Array.isArray(t))throw new Et(`Expected an array, got ${Fa(t)}`);return t});function Es(t){return new E5(t)}function Te(t){return new Ih(t)}function X_(t,e){return new P5(t,e)}function xv(t,e){return new yv(t,e,(n,r)=>{throw new Et(`Expected one of ${Object.keys(e).map(o=>JSON.stringify(o)).join(" or ")}, got ${JSON.stringify(r)}`,[t])})}function eo(t,e){return new Kn(n=>{const r=n&&typeof n=="object"&&"id"in n&&typeof n.id=="string"?`${t}(id = ${n.id})`:t;return al(r,()=>e.validate(n))})}function un(t){return new Kn(e=>{if(!t.has(e)){const n=Array.from(t,r=>JSON.stringify(r)).join(" or ");throw new Et(`Expected ${n}, got ${e}`)}return e})}const Ka=Te({x:Ae,y:Ae,z:Ae.optional()}),Aa=Te({x:Ae,y:Ae,w:Ae,h:Ae}),G_=new Set(["color","labelColor","dash","fill","size","opacity","font","align","icon","geo","arrowheadStart","arrowheadEnd","spline"]),C5=new Set(["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"]),k5=new Set(["draw","solid","dashed","dotted"]),$5=new Set(["none","semi","solid","pattern"]),T5=new Set(["s","m","l","xl"]),M5=new Set(["0.1","0.25","0.5","0.75","1"]),A5=new Set(["draw","sans","serif","mono"]),R5=new Set(["start","middle","end"]),q_=new Set(["rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]),L5=new Set(["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"]),D5=new Set(["cubic","line"]),O5=new Set(["activity","airplay","alert-circle","alert-octagon","alert-triangle","align-center","align-justify","align-left","align-right","anchor","aperture","archive","arrow-down-circle","arrow-down-left","arrow-down-right","arrow-down","arrow-left-circle","arrow-left","arrow-right-circle","arrow-right","arrow-up-circle","arrow-up-left","arrow-up-right","arrow-up","at-sign","award","bar-chart-2","bar-chart","battery-charging","battery","bell-off","bell","bluetooth","bold","book-open","book","bookmark","geo","briefcase","calendar","camera-off","camera","cast","check-circle","check-square","check","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-down","chevrons-left","chevrons-right","chevrons-up","chrome","circle","clipboard","clock","cloud-drizzle","cloud-lightning","cloud-off","cloud-rain","cloud-snow","cloud","codepen","codesandbox","coffee","columns","command","compass","copy","corner-down-left","corner-down-right","corner-left-down","corner-left-up","corner-right-down","corner-right-up","corner-up-left","corner-up-right","cpu","credit-card","crop","crosshair","database","delete","disc","divide-circle","divide-square","divide","dollar-sign","download-cloud","download","dribbble","droplet","edit-2","edit-3","edit","external-link","eye-off","eye","facebook","fast-forward","feather","figma","file-minus","file-plus","file-text","file","film","filter","flag","folder-minus","folder-plus","folder","framer","frown","gift","git-branch","git-commit","git-merge","git-pull-request","github","gitlab","globe","grid","hard-drive","hash","headphones","heart","help-circle","hexagon","home","image","inbox","info","instagram","italic","key","layers","layout","life-buoy","link-2","link","linkedin","list","loader","lock","log-in","log-out","mail","map-pin","map","maximize-2","maximize","meh","menu","message-circle","message-square","mic-off","mic","minimize-2","minimize","minus-circle","minus-square","minus","monitor","moon","more-horizontal","more-vertical","mouse-pointer","move","music","navigation-2","navigation","octagon","package","paperclip","pause-circle","pause","pen-tool","percent","phone-call","phone-forwarded","phone-incoming","phone-missed","phone-off","phone-outgoing","phone","pie-chart","play-circle","play","plus-circle","plus-square","plus","pocket","power","printer","radio","refresh-ccw","refresh-cw","repeat","rewind","rotate-ccw","rotate-cw","rss","save","scissors","search","send","server","settings","share-2","share","shield-off","shield","shopping-bag","shopping-cart","shuffle","sidebar","skip-back","skip-forward","slack","slash","sliders","smartphone","smile","speaker","square","star","stop-circle","sun","sunrise","sunset","table","tablet","tag","target","terminal","thermometer","thumbs-down","thumbs-up","toggle-left","toggle-right","tool","trash-2","trash","trello","trending-down","trending-up","triangle","truck","tv","twitch","twitter","type","umbrella","underline","unlock","upload-cloud","upload","user-check","user-minus","user-plus","user-x","user","users","video-off","video","voicemail","volume-1","volume-2","volume-x","volume","watch","wifi-off","wifi","wind","x-circle","x-octagon","x-square","x","youtube","zap-off","zap","zoom-in","zoom-out"]);function En(t){return Ne.refine(e=>{if(!e.startsWith(`${t}:`))throw new Error(`${t} ID must start with "${t}:"`);return e})}const ks=En("user"),Mp=En("asset"),Ap=En("page"),Ro=En("shape"),bv=En("instance"),j5=Ne.refine(t=>{if(!t.startsWith("page:")&&!t.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return t}),Qr=un(C5),ll=un(k5),Rp=un($5),Q_=un(q_),Vi=un(T5),hu=un(A5),Lp=un(R5),Ch=un(L5),Gn=un(M5),Z_=un(O5),J_=un(D5),N5=eo("camera",Te({typeName:yn("camera"),id:En("camera"),x:Ae,y:Ae,z:Ae})),Vb={Initial:0},B5=Qe({firstVersion:Vb.Initial,currentVersion:Vb.Initial,migrators:{}}),xc=Jr("camera",{migrations:B5,validator:N5,scope:"instance"}).withDefaultProperties(()=>({x:0,y:0,z:1})),z5=eo("document",Te({typeName:yn("document"),id:yn("document:document"),gridSize:Ae})),Wb={Initial:0},U5=Qe({firstVersion:Wb.Initial,currentVersion:Wb.Initial,migrators:{}}),Sv=Jr("document",{migrations:U5,validator:z5,scope:"document"}).withDefaultProperties(()=>({gridSize:10})),kh=Sv.createCustomId("document"),F5=new Set(["accent","white","black","selection-stroke","selection-fill","muted-1"]),eI=un(F5),K5=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),tI=un(K5),H5=Te({color:eI,type:tI,rotation:Ae}),V5=new Set(["starting","paused","active","stopping"]),nI=Te({points:Es(Ka),size:wv,color:eI,opacity:Ae,state:un(V5)}),W5=new Set(["vertex","virtual","create"]),Y5=Te({id:Ne,type:un(W5),canBind:St.optional(),index:Ne,x:Ae,y:Ae}),X5=eo("instance",Te({typeName:yn("instance"),id:En("instance"),userId:ks,currentPageId:Ap,followingUserId:ks.nullable(),brush:Aa.nullable(),propsForNextShape:Te({color:Qr,labelColor:Qr,dash:ll,fill:Rp,size:Vi,opacity:Gn,font:hu,align:Lp,icon:Z_,geo:Q_,arrowheadStart:Ch,arrowheadEnd:Ch,spline:J_}),cursor:H5,scribble:nI.nullable(),isFocusMode:St,isDebugMode:St,isToolLocked:St,exportBackground:St,screenBounds:Aa,zoomBrush:Aa.nullable()})),so={Initial:0,AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8},G5=Qe({firstVersion:so.Initial,currentVersion:so.AddZoom,migrators:{[so.AddTransparentExportBgs]:{up:t=>({...t,exportBackground:!0}),down:({exportBackground:t,...e})=>e},[so.RemoveDialog]:{up:({dialog:t,...e})=>e,down:t=>({...t,dialog:null})},[so.AddToolLockMode]:{up:t=>({...t,isToolLocked:!1}),down:({isToolLocked:t,...e})=>e},[so.RemoveExtraPropsForNextShape]:{up:({propsForNextShape:t,...e})=>({...e,propsForNextShape:Object.fromEntries(Object.entries(t).filter(([n])=>G_.has(n)))}),down:t=>t},[so.AddLabelColor]:{up:({propsForNextShape:t,...e})=>({...e,propsForNextShape:{...t,labelColor:"black"}}),down:t=>{const{labelColor:e,...n}=t.propsForNextShape;return{...t,propsForNextShape:{...n}}}},[so.AddFollowingUserId]:{up:t=>({...t,followingUserId:null}),down:({followingUserId:t,...e})=>e},[so.RemoveAlignJustify]:{up:t=>{let e=t.propsForNextShape.align;return e==="justify"&&(e="start"),{...t,propsForNextShape:{...t.propsForNextShape,align:e}}},down:t=>({...t})},[so.AddZoom]:{up:t=>({...t,zoomBrush:null}),down:({zoomBrush:t,...e})=>e}}}),Fo=Jr("instance",{migrations:G5,validator:X5,scope:"instance"}).withDefaultProperties(()=>({followingUserId:null,propsForNextShape:{opacity:"1",color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"},brush:null,scribble:null,cursor:{type:"default",color:"black",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null})),q5=eo("instance_page_state",Te({typeName:yn("instance_page_state"),id:En("instance_page_state"),instanceId:bv,pageId:Ap,cameraId:En("camera"),selectedIds:Es(Ro),hintingIds:Es(Ro),erasingIds:Es(Ro),hoveredId:Ro.nullable(),editingId:Ro.nullable(),croppingId:Ro.nullable(),focusLayerId:Ro.nullable()})),ng={Initial:0,AddCroppingId:1},Q5=Qe({firstVersion:ng.Initial,currentVersion:ng.AddCroppingId,migrators:{[ng.AddCroppingId]:{up(t){return{...t,croppingId:null}},down({croppingId:t,...e}){return e}}}}),Ha=Jr("instance_page_state",{migrations:Q5,validator:q5,scope:"instance"}).withDefaultProperties(()=>({editingId:null,croppingId:null,selectedIds:[],hoveredId:null,erasingIds:[],hintingIds:[],focusLayerId:null})),Z5=eo("page",Te({typeName:yn("page"),id:Ap,name:Ne,index:Ne})),Yb={Initial:0},J5=Qe({firstVersion:Yb.Initial,currentVersion:Yb.Initial,migrators:{}}),it=Jr("page",{migrations:J5,validator:Z5,scope:"document"}),Xb=[{locale:"ar",label:"عربي"},{locale:"ca",label:"Català"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Español"},{locale:"fa",label:"فارسی"},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Français"},{locale:"gl",label:"Galego"},{locale:"he",label:"עברית"},{locale:"it",label:"Italiano"},{locale:"ja",label:"日本語"},{locale:"ko-kr",label:"한국어"},{locale:"ku",label:"کوردی"},{locale:"hi-in",label:"हिन्दी"},{locale:"hu",label:"Magyar"},{locale:"my",label:"မြန်မာစာ"},{locale:"ne",label:"नेपाली"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Português - Brasil"},{locale:"pt-pt",label:"Português - Europeu"},{locale:"ro",label:"Română"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:"తెలుగు"},{locale:"th",label:"ภาษาไทย"},{locale:"tr",label:"Türkçe"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Tiếng Việt"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:"繁體中文 (台灣)"}];function e8(t){for(const e of t){const n=t8(e);if(n)return n}return"en"}const Gb={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function t8(t){const e=Xb.find(o=>o.locale===t.toLowerCase());if(e)return e.locale;const[n,r]=t.split(/[-_]/).map(o=>o.toLowerCase());if(r){const o=Xb.find(i=>i.locale===n);if(o)return o.locale}return n in Gb?Gb[n]:null}const n8=eo("user",Te({typeName:yn("user"),id:ks,name:Ne,locale:Ne})),qb={Initial:0},r8=Qe({currentVersion:qb.Initial,firstVersion:qb.Initial,migrators:{}}),$s=Jr("user",{migrations:r8,validator:n8,scope:"instance"}).withDefaultProperties(()=>{let t="en";return typeof window<"u"&&window.navigator&&(t=e8(window.navigator.languages)),{name:"New User",locale:t}}),o8=eo("user_document",Te({typeName:yn("user_document"),id:En("user_document"),userId:ks,isPenMode:St,isGridMode:St,isDarkMode:St,isMobileMode:St,isSnapMode:St,lastUpdatedPageId:Ap.nullable(),lastUsedTabId:bv.nullable()})),Il={Initial:0,AddSnapMode:1,AddMissingIsMobileMode:2,RemoveIsReadOnly:3},i8=Qe({firstVersion:Il.Initial,currentVersion:Il.RemoveIsReadOnly,migrators:{[Il.AddSnapMode]:{up:t=>({...t,isSnapMode:!1}),down:({isSnapMode:t,...e})=>e},[Il.AddMissingIsMobileMode]:{up:t=>({...t,isMobileMode:t.isMobileMode??!1}),down:({isMobileMode:t,...e})=>e},[Il.RemoveIsReadOnly]:{up:({isReadOnly:t,...e})=>e,down:t=>({...t,isReadOnly:!1})}}}),rI=Jr("user_document",{migrations:i8,validator:o8,scope:"instance"}).withDefaultProperties(()=>({isPenMode:!1,isGridMode:!1,isDarkMode:!1,isMobileMode:!1,isSnapMode:!1,lastUpdatedPageId:null,lastUsedTabId:null})),s8=eo("user_presence",Te({typeName:yn("user_presence"),id:En("user_presence"),userId:ks,lastUsedInstanceId:bv.nullable(),lastActivityTimestamp:Ae,cursor:Ka,viewportPageBounds:Aa,color:Ne})),rg={Initial:0,AddViewportPageBounds:1},a8=Qe({currentVersion:rg.AddViewportPageBounds,firstVersion:rg.Initial,migrators:{[rg.AddViewportPageBounds]:{up:t=>({...t,viewportPageBounds:{x:0,y:0,w:1,h:1}}),down:({viewportPageBounds:t,...e})=>e}}}),$h=Jr("user_presence",{migrations:a8,validator:s8,scope:"instance"}).withDefaultProperties(()=>({lastUsedInstanceId:null,lastActivityTimestamp:0,cursor:{x:0,y:0},viewportPageBounds:{x:0,y:0,w:1,h:1},color:"#000000"}));function l8(t,e){return t.index<e.index?-1:t.index>e.index?1:0}const Qb=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function Zb(t){t.typeName==="asset"&&("src"in t&&(t.src="<redacted>"),"src"in t.props&&(t.props.src="<redacted>"))}const c8=({error:t,phase:e,record:n,recordBefore:r})=>{throw dv(t,{tags:{origin:"store.validateRecord",storePhase:e,isExistingValidationIssue:e==="initialize"},extras:{recordBefore:r?Zb(Uo(r)):void 0,recordAfter:Zb(Uo(n))}}),t};function u8(){return Qb[Math.floor(Math.random()*Qb.length)]}function d8(){return[it.create({name:"Page 1",index:"a1"})]}function h8(t){const e=t.query.records("page"),n=t.query.record("user_document",()=>({userId:{eq:t.props.userId}})),r=t.query.record("instance",()=>({id:{eq:t.props.instanceId}})),o=t.query.record("user",()=>({id:{eq:t.props.userId}})),i=t.query.records("user_presence"),s=t.query.records("instance_page_state"),a=()=>{var m;const{userId:l,instanceId:c}=t.props;if(!t.has(kh))return t.put([Sv.create({id:kh})]),a();const d=n.value;if(!d)return t.put([rI.create({userId:l})]),a();const u=e.value.sort(l8);if(u.length===0)return t.put(d8()),a();const h=r.value;if(!h){const v=d.lastUsedTabId?(m=t.get(d.lastUsedTabId))==null?void 0:m.propsForNextShape:void 0,x=(d==null?void 0:d.lastUpdatedPageId)??u[0].id;return t.put([Fo.create({id:c,userId:l,currentPageId:x,propsForNextShape:v,exportBackground:!0})]),a()}let p=h.currentPageId;if(!u.find(v=>v.id===p))return p=u[0].id,t.put([{...h,currentPageId:p}]),a();if(!o.value)return t.put([$s.create({id:l})]),a();const g=i.value.filter(v=>v.userId===l);if(g.length===0)return t.put([$h.create({userId:l,color:u8()})]),a();g.length>1&&t.remove(g.slice(1).map(v=>v.id));for(const v of u){const x=s.value.filter(E=>E.pageId===v.id&&E.instanceId===c);if(x.length>1)t.remove(x.slice(1).map(E=>E.id));else if(x.length===0){const E=xc.create({});return t.put([E,Ha.create({pageId:v.id,instanceId:c,cameraId:E.id})]),a()}if(!t.get(x[0].cameraId))return t.put([xc.create({id:x[0].cameraId})]),a()}};return a}function Ev(t,e){return Te({id:Mp,typeName:yn("asset"),type:yn(t),props:e})}const p8=Ev("bookmark",Te({title:Ne,description:Ne,image:Ne,src:Ne.nullable()})),Jb={Initial:0},f8=Qe({firstVersion:Jb.Initial,currentVersion:Jb.Initial,migrators:{}}),g8=Ev("image",Te({w:Ae,h:Ae,name:Ne,isAnimated:St,mimeType:Ne.nullable(),src:Ne.nullable()})),Vu={Initial:0,AddIsAnimated:1,RenameWidthHeight:2},m8=Qe({firstVersion:Vu.Initial,currentVersion:Vu.RenameWidthHeight,migrators:{[Vu.AddIsAnimated]:{up:t=>({...t,props:{...t.props,isAnimated:!1}}),down:t=>{const{isAnimated:e,...n}=t.props;return{...t,props:n}}},[Vu.RenameWidthHeight]:{up:t=>{const{width:e,height:n,...r}=t.props;return{...t,props:{w:e,h:n,...r}}},down:t=>{const{w:e,h:n,...r}=t.props;return{...t,props:{width:e,height:n,...r}}}}}}),y8=Ev("video",Te({w:Ae,h:Ae,name:Ne,isAnimated:St,mimeType:Ne.nullable(),src:Ne.nullable()})),Wu={Initial:0,AddIsAnimated:1,RenameWidthHeight:2},v8=Qe({firstVersion:Wu.Initial,currentVersion:Wu.RenameWidthHeight,migrators:{[Wu.AddIsAnimated]:{up:t=>({...t,props:{...t.props,isAnimated:!1}}),down:t=>{const{isAnimated:e,...n}=t.props;return{...t,props:n}}},[Wu.RenameWidthHeight]:{up:t=>{const{width:e,height:n,...r}=t.props;return{...t,props:{w:e,h:n,...r}}},down:t=>{const{w:e,h:n,...r}=t.props;return{...t,props:{width:e,height:n,...r}}}}}}),w8=eo("instance_presence",Te({instanceId:En("instance"),typeName:yn("instance_presence"),id:En("instance_presence"),userId:ks,userName:Ne,lastActivityTimestamp:Ae,followingUserId:ks.nullable(),cursor:Te({x:Ae,y:Ae,type:tI,rotation:Ae}),color:Ne,camera:Te({x:Ae,y:Ae,z:Ae}),screenBounds:Aa,selectedIds:Es(En("shape")),currentPageId:En("page"),brush:Aa.nullable(),scribble:nI.nullable()})),e1={Initial:0},x8=Qe({currentVersion:e1.Initial,firstVersion:e1.Initial,migrators:{}}),uy=Jr("instance_presence",{migrations:x8,validator:w8,scope:"presence"}),b8=t=>{const e=t.query.record("instance",()=>({id:{eq:t.props.instanceId}})),n=t.query.record("user",()=>({id:{eq:t.props.userId}})),r=t.query.record("user_presence",()=>({userId:{eq:t.props.userId}})),o=t.query.record("instance_page_state",()=>{var s;return{instanceId:{eq:t.props.instanceId},pageId:{eq:((s=e.value)==null?void 0:s.currentPageId)??""}}}),i=t.query.record("camera",()=>{var s;return{id:{eq:((s=o.value)==null?void 0:s.cameraId)??""}}});return ue("instancePresence",()=>{const s=o.value,a=e.value,l=n.value,c=r.value,d=i.value;return!s||!a||!l||!c||!d?null:uy.create({id:uy.createCustomId(t.props.instanceId),instanceId:t.props.instanceId,selectedIds:s.selectedIds,brush:a.brush,scribble:a.scribble,userId:t.props.userId,userName:l.name,followingUserId:a.followingUserId,camera:{x:d.x,y:d.y,z:d.z},color:c.color,currentPageId:a.currentPageId,cursor:{x:c.cursor.x,y:c.cursor.y,rotation:a.cursor.rotation,type:a.cursor.type},lastActivityTimestamp:c.lastActivityTimestamp,screenBounds:a.screenBounds})})},S8=eo("asset",xv("type",{image:g8,video:y8,bookmark:p8})),t1={Initial:0},E8=Qe({firstVersion:t1.Initial,currentVersion:t1.Initial,migrators:{},subTypeKey:"type",subTypeMigrations:{image:m8,video:v8,bookmark:f8}}),pu=Jr("asset",{migrations:E8,validator:S8,scope:"document"}),og={Initial:0,AddIsLocked:1},ig=Qe({currentVersion:og.AddIsLocked,firstVersion:og.Initial,migrators:{[og.AddIsLocked]:{up:t=>({...t,isLocked:!1}),down:t=>{const{isLocked:e,...n}=t;return{...n}}}}});function gs(t){return t?t.typeName==="shape":!1}function vr(t){return t?t.startsWith("shape:"):!1}function Ut(){return`shape:${Tp()}`}function P8(t){return`shape:${t}`}const Yu={Initial:0,RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2},_8=Qe({firstVersion:Yu.Initial,currentVersion:Yu.AddInstancePresenceType,migrators:{[Yu.RemoveCodeAndIconShapeTypes]:{up:t=>Object.fromEntries(Object.entries(t).filter(([e,n])=>n.typeName!=="shape"||n.type!=="icon"&&n.type!=="code")),down:t=>t},[Yu.AddInstancePresenceType]:{up:t=>t,down:t=>Object.fromEntries(Object.entries(t).filter(([e,n])=>n.typeName!=="instance_presence"))}}});function lr(t,e){return Te({id:Ro,typeName:yn("shape"),x:Ae,y:Ae,rotation:Ae,index:Ne,parentId:j5,type:yn(t),isLocked:St,props:e})}const n1=xv("type",{binding:Te({type:yn("binding"),boundShapeId:Ro,normalizedAnchor:Ka,isExact:St}),point:Te({type:yn("point"),x:Ae,y:Ae})}),oI=lr("arrow",Te({labelColor:Qr,color:Qr,fill:Rp,dash:ll,size:Vi,opacity:Gn,arrowheadStart:Ch,arrowheadEnd:Ch,font:hu,start:n1,end:n1,bend:Ae,text:Ne})),sg={Initial:0,AddLabelColor:1},iI=Qe({currentVersion:sg.AddLabelColor,firstVersion:sg.Initial,migrators:{[sg.AddLabelColor]:{up:t=>({...t,props:{...t.props,labelColor:"black"}}),down:t=>{const{labelColor:e,...n}=t.props;return{...t,props:n}}}}}),sI=lr("bookmark",Te({opacity:Gn,w:Xn,h:Xn,assetId:Mp.nullable(),url:Ne})),ag={Initial:0,NullAssetId:1},aI=Qe({firstVersion:ag.Initial,currentVersion:ag.NullAssetId,migrators:{[ag.NullAssetId]:{up:t=>t.props.assetId===void 0?{...t,props:{...t.props,assetId:null}}:t,down:t=>{if(t.props.assetId===null){const{assetId:e,...n}=t.props;return{...t,props:n}}return t}}}}),I8=new Set(["free","straight"]),lI=lr("draw",Te({color:Qr,fill:Rp,dash:ll,size:Vi,opacity:Gn,segments:Es(Te({type:un(I8),points:Es(Ka)})),isComplete:St,isClosed:St,isPen:St})),lg={Initial:0,AddInPen:1},cI=Qe({firstVersion:lg.Initial,currentVersion:lg.AddInPen,migrators:{[lg.AddInPen]:{up:t=>{const{points:e}=t.props.segments[0];if(e.length===0)return{...t,props:{...t.props,isPen:!1}};let n=!(e[0].z===0||e[0].z===.5);return e[1]&&(n=n&&!(e[1].z===0||e[1].z===.5)),{...t,props:{...t.props,isPen:n}}},down:t=>{const{isPen:e,...n}=t.props;return{...t,props:{...n}}}}}}),uI={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},dI=lr("embed",Te({opacity:Gn,w:Xn,h:Xn,url:Ne,tmpOldUrl:Ne.optional(),doesResize:St,overridePermissions:X_(un(new Set(Object.keys(uI))),St.optional()).optional()})),r1=/(^\/r\/[^/]+\/?$)/,et=t=>{try{return new URL(t)}catch{return}},Va=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","lite.tldraw.com","www.tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(r1))return t},fromEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(r1))return t}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=et(t),n=e&&e.pathname.match(/\/s\/([^/]+)\/?/);if(n)return`https://codesandbox.io/embed/${n[1]}`},fromEmbedUrl:t=>{const e=et(t),n=e&&e.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://codesandbox.io/s/${n[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,toEmbedUrl:t=>{const e=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,n=t.match(e);if(n){const[r,o,i]=n;return`https://codepen.io/${o}/embed/${i}`}},fromEmbedUrl:t=>{const e=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,n=t.match(e);if(n){const[r,o,i]=n;return`https://codepen.io/${o}/pen/${i}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,toEmbedUrl:t=>{const e=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,n=t.match(e);if(n){const[r,o]=n;return`https://scratch.mit.edu/projects/embed/${o}`}},fromEmbedUrl:t=>{const e=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,n=t.match(e);if(n){const[r,o]=n;return`https://scratch.mit.edu/projects/${o}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:t=>{const e=et(t);if(!e)return;const n=e.hostname.replace(/^www./,"");if(n==="youtu.be")return`https://www.youtube.com/embed/${e.pathname.split("/").filter(Boolean)[0]}`;if((n==="youtube.com"||n==="m.youtube.com")&&e.pathname.match(/^\/watch/))return`https://www.youtube.com/embed/${e.searchParams.get("v")}`},fromEmbedUrl:t=>{const e=et(t);if(!e)return;if(e.hostname.replace(/^www./,"")==="youtube.com"){const r=e.pathname.match(/^\/embed\/([^/]+)\/?/);if(r)return`https://www.youtube.com/watch?v=${r[1]}`}}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{if(t.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!t.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${t}`},fromEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/^\/embed\/?$/)){const n=e.searchParams.get("url");if(n)return n}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{if(t.includes("/maps/")){const e=t.match(/@(.*),(.*),(.*)z/);let n;if(e){const[,r,o,i]=e;n=`https://${new URL(t).host.replace("www.","")}/maps/embed/v1/view?key=${{}.NEXT_PUBLIC_GC_API_KEY}&center=${r},${o}&zoom=${i}`}else n="";return n}},fromEmbedUrl:t=>{const e=et(t);if(!e)return;if(e.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&e.searchParams.has("center")&&e.searchParams.get("zoom")){const r=e.searchParams.get("zoom"),[o,i]=e.searchParams.get("center").split(",");return`https://www.google.com/maps/@${o},${i},${r}z`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:t=>{const e=et(t),n=e==null?void 0:e.searchParams.get("cid");if(e!=null&&e.pathname.match(/\/calendar\/u\/0/)&&n){e.pathname="/calendar/embed";const r=Array.from(e.searchParams.keys());for(const o of r)e.searchParams.delete(o);return e.searchParams.set("src",n),e.href}},fromEmbedUrl:t=>{const e=et(t),n=e==null?void 0:e.searchParams.get("src");if(e!=null&&e.pathname.match(/\/calendar\/embed/)&&n){e.pathname="/calendar/u/0";const r=Array.from(e.searchParams.keys());for(const o of r)e.searchParams.delete(o);return e.searchParams.set("cid",n),e.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,toEmbedUrl:t=>{const e=et(t);if(e!=null&&e.pathname.match(/^\/presentation/)&&(e!=null&&e.pathname.match(/\/pub\/?$/))){e.pathname=e.pathname.replace(/\/pub$/,"/embed");const n=Array.from(e.searchParams.keys());for(const r of n)e.searchParams.delete(r);return e.href}},fromEmbedUrl:t=>{const e=et(t);if(e!=null&&e.pathname.match(/^\/presentation/)&&(e!=null&&e.pathname.match(/\/embed\/?$/))){e.pathname=e.pathname.replace(/\/embed$/,"/pub");const n=Array.from(e.searchParams.keys());for(const r of n)e.searchParams.delete(r);return e.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/\/([^/]+)\/([^/]+)/))return t},fromEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/\/([^/]+)\/([^/]+)/))return t}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${t}?embed=true`},fromEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/\/@([^/]+)\/([^/]+)/)&&e.searchParams.has("embed"))return e.searchParams.delete("embed"),e.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/^\/map\//))return e.origin+"/embed"+e.pathname},fromEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/^\/embed\/map\//))return e.pathname=e.pathname.replace(/^\/embed/,""),e.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,toEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/^\/(artist|album)\//))return e.origin+"/embed"+e.pathname},fromEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/^\/embed\/(artist|album)\//))return e.origin+e.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const e=et(t);if(e&&e.hostname==="vimeo.com"&&e.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+e.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:t=>{const e=et(t);if(e&&e.hostname==="player.vimeo.com"){const n=e.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/"+n[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const e=et(t);if(e&&e.hash.match(/#room=/))return t},fromEmbedUrl:t=>{const e=et(t);if(e&&e.hash.match(/#room=/))return t}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${e.origin}/embed${e.pathname}?cell=*`;if(e&&e.pathname.match(/^\/d\/([^/]+)\/?$/)){const n=e.pathname.replace(/^\/d/,"");return`${e.origin}/embed${n}?cell=*`}},fromEmbedUrl:t=>{const e=et(t);if(e&&e.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","")}#cell-*`;if(e&&e.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","/d")}#cell-*`}}],cg={Initial:0,GenOriginalUrlInEmbed:1},hI=Qe({currentVersion:cg.GenOriginalUrlInEmbed,firstVersion:cg.Initial,migrators:{[cg.GenOriginalUrlInEmbed]:{up:t=>{const e=t.props.url,n=new URL(e).host.replace("www.","");let r;for(const o of Va)if(o.hostnames.includes(n))try{r=o.fromEmbedUrl(e)}catch(i){console.warn(i)}return{...t,props:{...t.props,tmpOldUrl:t.props.url,url:r??""}}},down:t=>{let e=t.props.tmpOldUrl;if(!e||e===""){const o=t.props.url,i=new URL(o).host.replace("www.","");for(const s of Va)if(s.hostnames.includes(i))try{e=s.toEmbedUrl(o)}catch(a){console.warn(a)}}const{tmpOldUrl:n,...r}=t.props;return{...t,props:{...r,url:e??""}}}}}}),pI=lr("frame",Te({opacity:Gn,w:Xn,h:Xn,name:Ne})),o1={Initial:0},fI=Qe({currentVersion:o1.Initial,firstVersion:o1.Initial,migrators:{}}),gI=lr("geo",Te({geo:Q_,labelColor:Qr,color:Qr,fill:Rp,dash:ll,size:Vi,opacity:Gn,font:hu,align:Lp,url:Ne,w:Xn,h:Xn,growY:wv,text:Ne})),qs={Initial:0,AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4},mI=Qe({firstVersion:qs.Initial,currentVersion:qs.AddCheckBox,migrators:{[qs.AddUrlProp]:{up:t=>({...t,props:{...t.props,url:""}}),down:t=>{const{url:e,...n}=t.props;return{...t,props:n}}},[qs.AddLabelColor]:{up:t=>({...t,props:{...t.props,labelColor:"black"}}),down:t=>{const{labelColor:e,...n}=t.props;return{...t,props:n}}},[qs.RemoveJustify]:{up:t=>{let e=t.props.align;return e==="justify"&&(e="start"),{...t,props:{...t.props,align:e}}},down:t=>({...t})},[qs.AddCheckBox]:{up:t=>({...t}),down:t=>({...t,props:{...t.props,geo:t.props.geo==="check-box"?"rectangle":t.props.geo}})}}}),yI=lr("group",Te({opacity:Gn})),i1={Initial:0},vI=Qe({currentVersion:i1.Initial,firstVersion:i1.Initial,migrators:{}}),C8=Te({topLeft:Ka,bottomRight:Ka}),wI=lr("image",Te({opacity:Gn,w:Xn,h:Xn,playing:St,url:Ne,assetId:Mp.nullable(),crop:C8.nullable()})),Xu={Initial:0,AddUrlProp:1,AddCropProp:2},xI=Qe({firstVersion:Xu.Initial,currentVersion:Xu.AddCropProp,migrators:{[Xu.AddUrlProp]:{up:t=>({...t,props:{...t.props,url:""}}),down:t=>{const{url:e,...n}=t.props;return{...t,props:n}}},[Xu.AddCropProp]:{up:t=>({...t,props:{...t.props,crop:null}}),down:t=>{const{crop:e,...n}=t.props;return{...t,props:n}}}}}),bI=lr("line",Te({color:Qr,dash:ll,size:Vi,opacity:Gn,spline:J_,handles:X_(Ne,Y5)})),s1={Initial:0},SI=Qe({currentVersion:s1.Initial,firstVersion:s1.Initial,migrators:{}}),EI=lr("note",Te({color:Qr,size:Vi,font:hu,align:Lp,opacity:Gn,growY:wv,url:Ne,text:Ne})),Gu={Initial:0,AddUrlProp:1,RemoveJustify:2},PI=Qe({firstVersion:Gu.Initial,currentVersion:Gu.RemoveJustify,migrators:{[Gu.AddUrlProp]:{up:t=>({...t,props:{...t.props,url:""}}),down:t=>{const{url:e,...n}=t.props;return{...t,props:n}}},[Gu.RemoveJustify]:{up:t=>{let e=t.props.align;return e==="justify"&&(e="start"),{...t,props:{...t.props,align:e}}},down:t=>({...t})}}}),_I=lr("text",Te({color:Qr,size:Vi,font:hu,align:Lp,opacity:Gn,w:Xn,text:Ne,scale:Xn,autoSize:St})),ug={Initial:0,RemoveJustify:1},II=Qe({firstVersion:ug.Initial,currentVersion:ug.RemoveJustify,migrators:{[ug.RemoveJustify]:{up:t=>{let e=t.props.align;return e==="justify"&&(e="start"),{...t,props:{...t.props,align:e}}},down:t=>({...t})}}}),CI=lr("video",Te({opacity:Gn,w:Xn,h:Xn,time:Ae,playing:St,url:Ne,assetId:Mp.nullable()})),dg={Initial:0,AddUrlProp:1},kI=Qe({firstVersion:dg.Initial,currentVersion:dg.AddUrlProp,migrators:{[dg.AddUrlProp]:{up:t=>({...t,props:{...t.props,url:""}}),down:t=>{const{url:e,...n}=t.props;return{...t,props:n}}}}}),k8=[{type:"draw",migrations:cI,validator:lI},{type:"text",migrations:II,validator:_I},{type:"line",migrations:SI,validator:bI},{type:"arrow",migrations:iI,validator:oI},{type:"image",migrations:xI,validator:wI},{type:"video",migrations:kI,validator:CI},{type:"geo",migrations:mI,validator:gI},{type:"note",migrations:PI,validator:EI},{type:"group",migrations:vI,validator:yI},{type:"bookmark",migrations:aI,validator:sI},{type:"frame",migrations:fI,validator:pI},{type:"embed",migrations:hI,validator:dI}];function $8({customShapeDefs:t,allowUnknownShapes:e,derivePresenceState:n}){const r=[...k8,...t??[]],o=new Set;for(const l of r){if(o.has(l.type))throw new Error(`Shape type ${l.type} is already defined`);o.add(l.type)}const i=Qe({currentVersion:ig.currentVersion,firstVersion:ig.firstVersion,migrators:ig.migrators,subTypeKey:"type",subTypeMigrations:Object.fromEntries(r.map(l=>[l.type,l.migrations]))});let s=xv("type",{...Object.fromEntries(r.map(l=>[l.type,l.validator??_5]))});e&&(s=s.validateUnknownVariants(l=>l));const a=Jr("shape",{migrations:i,validator:eo("shape",s),scope:"document"}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1}));return mv.create({asset:pu,camera:xc,document:Sv,instance:Fo,instance_page_state:Ha,page:it,shape:a,user:$s,user_document:rI,user_presence:$h,instance_presence:uy},{snapshotMigrations:_8,onValidationFailure:c8,createIntegrityChecker:h8,derivePresenceState:n??b8})}function T8(t){const e=Object.values(t);for(let n=0;n<e.length;n++){if(!e[n])continue;const{record:r}=M8(e[n]);r?t[e[n].id]=r:delete t[e[n].id]}return t}function M8(t){const e=[];let n=JSON.parse(JSON.stringify(t));switch(n.typeName){case"user_presence":{n.cursor||(e.push("no cursor"),n.cursor={x:0,y:0}),(n.cursor.x===void 0||n.cursor.x===null)&&(e.push("no cursor x"),n.cursor.x=0),(n.cursor.y===void 0||n.cursor.y===null)&&(e.push("no cursor y"),n.cursor.y=0);break}case"asset":{switch(n.type){case"image":case"video":{n.props||(e.push("no props in asset"),n.props={w:100,h:100,name:"old_asset",isAnimated:!1,mimeType:null,src:null}),n.props.mimeType||(e.push("no mimeType in asset props"),n.props.mimeType="image/png"),n.props.src||(e.push("no src in asset props"),n.props.src=""),n.props.isAnimated==null&&(e.push("no isAnimated in asset props"),n.props.isAnimated=!1),n.props.name===void 0&&(n.props.name="asset"),"width"in n&&(e.push("width in asset"),n.props.w=n.width,delete n.width),"width"in n.props&&typeof n.props.width=="number"&&n.props.width&&(e.push("no w in asset props"),n.props.w=n.props.width,delete n.props.width),"height"in n&&(e.push("height in asset"),n.props.h=n.height,delete n.height),"height"in n.props&&typeof n.props.height=="number"&&n.props.height&&(e.push("no h in asset props"),n.props.h=n.props.height,delete n.props.height),n.props.w||(e.push("no w in asset props"),n.props.w=100),n.props.h||(e.push("no h in asset props"),n.props.h=100),"src"in n&&(e.push("src in asset"),n.props.src=n.src,delete n.src),"name"in n&&(e.push("name in asset"),delete n.name);break}case"bookmark":n.props||(e.push("no asset props"),n.props={title:"",description:"",image:"",src:"url"in n&&typeof n.url=="string"?n.url:""}),n.props.title||(e.push("no title in bookmark asset props"),n.props.title=""),n.props.description||(e.push("no description in bookmark asset props"),n.props.description=""),n.props.image||(e.push("no image in bookmark asset props"),n.props.image=""),"src"in n&&(e.push("leftover src in bookmark asset"),delete n.src),"width"in n&&(e.push("leftover width in bookmark asset"),delete n.width),"height"in n&&(e.push("leftover height in bookmark asset"),delete n.height),"name"in n&&(e.push("leftover name in bookmark asset"),delete n.name),"meta"in n&&delete n.meta;break}break}case"camera":{(n.x===void 0||n.x===null)&&(e.push("no x in camera"),n.x=0),(n.y===void 0||n.y===null)&&(e.push("no y in camera"),n.y=0);break}case"instance":{"props"in n&&(e.push("leftover props in instance"),delete n.props),n.isToolLocked===void 0&&(e.push("no isToolLocked in instance"),n.isToolLocked=!1),n.propsForNextShape===void 0&&(e.push("no props in instance"),n.propsForNextShape={opacity:"1",color:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"}),"url"in n.propsForNextShape&&(e.push("leftover url in instance.propsForNextShape"),delete n.propsForNextShape.url),"lang"in n.propsForNextShape&&(e.push("leftover lang in instance.propsForNextShape"),delete n.propsForNextShape.lang),n.exportBackground===void 0&&(e.push(`no export background in ${n.typeName}`),n.exportBackground=!1),n.brush===void 0&&(e.push(`no brush in ${n.typeName}`),n.brush=null),n.scribble===void 0&&(e.push(`no scribble in ${n.typeName}`),n.scribble=null),n.dialog!==void 0&&(e.push(`no dialog in ${n.typeName}`),delete n.dialog),n.screenBounds===void 0&&(e.push(`no screen bounds in ${n.typeName}`),n.screenBounds={x:0,y:0,w:1080,h:720});break}case"user":{n.name||(e.push("no name in user"),n.name="User"),n.locale||(e.push("no locale in user"),n.locale="en"),"cursor"in n&&(e.push("leftover cursor in user"),delete n.cursor),"color"in n&&(e.push("leftover color in user"),delete n.color),"brush"in n&&(e.push("leftover brush in user"),delete n.brush),"selectedIds"in n&&(e.push("leftover selectedIds in user"),delete n.selectedIds),"scribble"in n&&(e.push("leftover scribble in user"),delete n.scribble),"currentPageId"in n&&(e.push("leftover currentPageId in user"),delete n.currentPageId);break}case"user_document":{n.isMobileMode===void 0&&(e.push("no ismobilemode in user document"),n.isMobileMode=!1),n.isSnapMode===void 0&&(e.push("no issnapmode in user document"),n.isSnapMode=!1);break}case"shape":{if("url"in n&&delete n.url,(n.x===void 0||n.x===null)&&(e.push(`some bug in ${n.typeName} ${n.type}`),n.x=0),(n.y===void 0||n.y===null)&&(e.push(`some bug in ${n.typeName} ${n.type}`),n.y=0),n.type==="image"&&(n.props.playing===void 0&&(e.push(`some bug in ${n.typeName} ${n.type}`),n.props.playing=!1),"loaded"in n.props&&delete n.props.loaded),n.type==="arrow"&&(n.props.start.type==="binding"?((n.props.start.normalizedAnchor.x===void 0||n.props.start.normalizedAnchor.x===null)&&(e.push(`some bug in ${n.typeName} ${n.type}`),n.props.start.normalizedAnchor.x=0),(n.props.start.normalizedAnchor.y===void 0||n.props.start.normalizedAnchor.y===null)&&(e.push(`some bug in ${n.typeName} ${n.type}`),n.props.start.normalizedAnchor.y=0)):((n.props.start.x===void 0||n.props.start.x===null)&&(e.push(`some bug in ${n.typeName} ${n.type}`),n.props.start.x=0),(n.props.start.y===void 0||n.props.start.y===null)&&(e.push(`some bug in ${n.typeName} ${n.type}`),n.props.start.y=0),"boundShapeId"in n.props.start&&(e.push("leftover bound shape id in arrow"),delete n.props.start.boundShapeId),"normalizedAnchor"in n.props.start&&(e.push("leftover normalize anchor in arrow"),delete n.props.start.normalizedAnchor),"isExact"in n.props.start&&(e.push("leftover isExact in arrow"),delete n.props.start.isExact)),n.props.end.type==="binding"?((n.props.end.normalizedAnchor.x===void 0||n.props.end.normalizedAnchor.x===null)&&(e.push(`some bug in ${n.typeName}  ${n.type}`),n.props.end.normalizedAnchor.x=0),(n.props.end.normalizedAnchor.y===void 0||n.props.end.normalizedAnchor.y===null)&&(e.push(`some bug in ${n.typeName} ${n.type}`),n.props.end.normalizedAnchor.y=0)):((n.props.end.x===void 0||n.props.end.x===null)&&(e.push("no x in arrow end"),n.props.end.x=0),(n.props.end.y===void 0||n.props.end.y===null)&&(e.push("no y in arrow end"),n.props.end.y=0),"boundShapeId"in n.props.end&&(e.push("leftover bound shape id in arrow"),delete n.props.end.boundShapeId),"normalizedAnchor"in n.props.end&&(e.push("leftover normalize anchor in arrow"),delete n.props.end.normalizedAnchor),"isExact"in n.props.end&&(e.push("leftover isExact in arrow"),delete n.props.end.isExact))),(n.type==="note"||n.type==="video"||n.type==="image"||n.type==="geo"||n.type==="bookmark")&&n.props.url===void 0&&(e.push(`missing url prop in ${n.type} shape`),n.props.url=""),n.type==="bookmark"&&(n.props.assetId===void 0&&(e.push(`some bug in ${n.typeName}  ${n.type}`),n.props.assetId=null),"src"in n&&(e.push("leftover src in bookmark"),delete n.src)),n.type==="geo"&&("width"in n.props&&(e.push("leftover width in geo"),delete n.props.width),"height"in n.props&&(e.push("leftover height in geo"),delete n.props.height)),n.type==="draw"){n.props.segments===void 0&&(e.push(`some bug in ${n.typeName}  ${n.type}`),n.props.segments=[{points:[{x:0,y:0,z:.5},{x:1,y:1,z:.5}],type:"free"}]);for(const r of n.props.segments)for(const o of r.points)(o.x===void 0||o.y===null)&&(e.push(`some bug in ${n.typeName}`),o.x=0),(o.y===void 0||o.y===null)&&(e.push(`some bug in ${n.typeName}`),o.y=0);"points"in n.props&&delete n.props.points}n.type==="bookmark"&&"loaded"in n.props&&(e.push("leftover loaded in bookmark"),delete n.props.loaded),n.type==="draw"&&"points"in n.props&&n.props.segments===void 0&&(n.props.segments=[{type:"free",points:n.props.points}]),n.type==="image"&&(n.props.w<1&&(n.props.w=1,e.push(`zero w image in ${n.typeName}`)),n.props.h<1&&(n.props.h=1,e.push(`zero h image in ${n.typeName}`))),n.type==="embed"&&"loaded"in n.props&&(e.push("leftover loaded in embed"),delete n.props.loaded);break}case void 0:n=null}return{record:n,issues:e}}lr("icon",Te({size:Vi,icon:Z_,dash:ll,color:Qr,opacity:Gn,scale:Ae}));const Pn={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,easeInCubic:t=>t*t*t,easeOutCubic:t=>--t*t*t+1,easeInOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1- --t*t*t*t,easeInOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1+--t*t*t*t*t,easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t<=0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t>=1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t<=0?0:t>=1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2};class I{constructor(e=0,n=0,r=1){this.x=e,this.y=n,this.z=r}get pressure(){return this.z}set(e=this.x,n=this.y,r=this.z){return this.x=e,this.y=n,this.z=r,this}setTo({x:e=0,y:n=0,z:r=1}){return this.x=e,this.y=n,this.z=r,this}rot(e){if(e===0)return this;const{x:n,y:r}=this,o=Math.sin(e),i=Math.cos(e);return this.x=n*i-r*o,this.y=n*o+r*i,this}rotWith(e,n){if(n===0)return this;const r=this.x-e.x,o=this.y-e.y,i=Math.sin(n),s=Math.cos(n);return this.x=e.x+(r*s-o*i),this.y=e.y+(r*i+o*s),this}clone(){const{x:e,y:n,z:r}=this;return new I(e,n,r)}sub(e){return this.x-=e.x,this.y-=e.y,this}subXY(e,n){return this.x-=e,this.y-=n,this}subScalar(e){return this.x-=e,this.y-=e,this}add(e){return this.x+=e.x,this.y+=e.y,this}addXY(e,n){return this.x+=e,this.y+=n,this}addScalar(e){return this.x+=e,this.y+=e,this}clamp(e,n){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),n!==void 0&&(this.x=Math.min(this.x,n),this.y=Math.min(this.y,n)),this}div(e){return this.x/=e,this.y/=e,this}divV(e){return this.x/=e.x,this.y/=e.y,this}mul(e){return this.x*=e,this.y*=e,this}mulV(e){return this.x*=e.x,this.y*=e.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(e,n){const r=I.Tan(e,this);return this.add(r.mul(n))}neg(){return this.x*=-1,this.y*=-1,this}cross(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}dpr(e){return I.Dpr(this,e)}cpr(e){return I.Cpr(this,e)}len2(){return I.Len2(this)}len(){return I.Len(this)}pry(e){return I.Pry(this,e)}per(){const{x:e,y:n}=this;return this.x=n,this.y=-e,this}uni(){return I.Uni(this)}tan(e){return I.Tan(this,e)}dist(e){return I.Dist(this,e)}distanceToLineSegment(e,n){return I.DistanceToLineSegment(e,n,this)}slope(e){return I.Slope(this,e)}snapToGrid(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}angle(e){return I.Angle(this,e)}toAngle(){return I.ToAngle(this)}lrp(e,n){return this.x=this.x+(e.x-this.x)*n,this.y=this.y+(e.y-this.y)*n,this}equals(e){return I.Equals(this,e)}equalsXY(e,n){return I.EqualsXY(this,e,n)}norm(){const e=this.len();return this.x=e===0?0:this.x/e,this.y=e===0?0:this.y/e,this}toFixed(){return I.ToFixed(this)}toString(){return I.ToString(I.ToFixed(this))}toJson(){return I.ToJson(this)}toArray(){return I.ToArray(this)}static Add(e,n){return new I(e.x+n.x,e.y+n.y)}static AddXY(e,n,r){return new I(e.x+n,e.y+r)}static Sub(e,n){return new I(e.x-n.x,e.y-n.y)}static SubXY(e,n,r){return new I(e.x-n,e.y-r)}static AddScalar(e,n){return new I(e.x+n,e.y+n)}static SubScalar(e,n){return new I(e.x-n,e.y-n)}static Div(e,n){return new I(e.x/n,e.y/n)}static Mul(e,n){return new I(e.x*n,e.y*n)}static DivV(e,n){return new I(e.x/n.x,e.y/n.y)}static MulV(e,n){return new I(e.x*n.x,e.y*n.y)}static Neg(e){return new I(-e.x,-e.y)}static Per(e){return new I(e.y,-e.x)}static Dist2(e,n){return I.Sub(e,n).len2()}static Abs(e){return new I(Math.abs(e.x),Math.abs(e.y))}static Dist(e,n){return Math.hypot(e.y-n.y,e.x-n.x)}static Dpr(e,n){return e.x*n.x+e.y*n.y}static Cross(e,n){return new I(e.y*n.z-e.z*n.y,e.z*n.x-e.x*n.z)}static Cpr(e,n){return e.x*n.y-n.x*e.y}static Len2(e){return e.x*e.x+e.y*e.y}static Len(e){return Math.sqrt(I.Len2(e))}static Pry(e,n){return I.Dpr(e,n)/I.Len(n)}static Uni(e){return I.Div(e,I.Len(e))}static Tan(e,n){return I.Uni(I.Sub(e,n))}static Min(e,n){return new I(Math.min(e.x,n.x),Math.min(e.y,n.y))}static Max(e,n){return new I(Math.max(e.x,n.x),Math.max(e.y,n.y))}static From({x:e,y:n,z:r=1}){return new I(e,n,r)}static FromArray(e){return new I(e[0],e[1])}static Rot(e,n=0){const r=Math.sin(n),o=Math.cos(n);return new I(e.x*o-e.y*r,e.x*r+e.y*o)}static RotWith(e,n,r){const o=e.x-n.x,i=e.y-n.y,s=Math.sin(r),a=Math.cos(r);return new I(n.x+(o*a-i*s),n.y+(o*s+i*a))}static NearestPointOnLineThroughPoint(e,n,r){return I.Mul(n,I.Sub(r,e).pry(n)).add(e)}static NearestPointOnLineSegment(e,n,r,o=!0){const i=I.Tan(n,e),s=I.Add(e,I.Mul(i,I.Sub(r,e).pry(i)));if(o){if(s.x<Math.min(e.x,n.x))return I.Cast(e.x<n.x?e:n);if(s.x>Math.max(e.x,n.x))return I.Cast(e.x>n.x?e:n);if(s.y<Math.min(e.y,n.y))return I.Cast(e.y<n.y?e:n);if(s.y>Math.max(e.y,n.y))return I.Cast(e.y>n.y?e:n)}return s}static DistanceToLineThroughPoint(e,n,r){return I.Dist(r,I.NearestPointOnLineThroughPoint(e,n,r))}static DistanceToLineSegment(e,n,r,o=!0){return I.Dist(r,I.NearestPointOnLineSegment(e,n,r,o))}static Snap(e,n=1){return new I(Math.round(e.x/n)*n,Math.round(e.y/n)*n)}static Cast(e){return e instanceof I?e:I.From(e)}static Slope(e,n){return e.x===n.y?NaN:(e.y-n.y)/(e.x-n.x)}static Angle(e,n){return Math.atan2(n.y-e.y,n.x-e.x)}static Lrp(e,n,r){return I.Sub(n,e).mul(r).add(e)}static Med(e,n){return new I((e.x+n.x)/2,(e.y+n.y)/2)}static Equals(e,n){return Math.abs(e.x-n.x)<1e-4&&Math.abs(e.y-n.y)<1e-4}static EqualsXY(e,n,r){return e.x===n&&e.y===r}static Clockwise(e,n,r){return(r.x-e.x)*(n.y-e.y)-(n.x-e.x)*(r.y-e.y)<0}static Rescale(e,n){const r=I.Len(e);return new I(n*e.x/r,n*e.y/r)}static ScaleWithOrigin(e,n,r){return I.Sub(e,r).mul(n).add(r)}static ToFixed(e,n=2){return new I(+e.x.toFixed(n),+e.y.toFixed(n),+e.z.toFixed(n))}static Nudge(e,n,r){return I.Add(e,I.Tan(n,e).mul(r))}static ToString(e){return`${e.x}, ${e.y}`}static ToAngle(e){let n=Math.atan2(e.y,e.x);return n<0&&(n+=Math.PI*2),n}static ToArray(e){return[e.x,e.y,e.z]}static ToJson(e){const{x:n,y:r,z:o}=e;return{x:n,y:r,z:o}}static Average(e){const n=e.length,r=new I(0,0);for(let o=0;o<n;o++)r.add(e[o]);return r.div(n)}static Clamp(e,n,r){return r===void 0?new I(Math.min(Math.max(e.x,n)),Math.min(Math.max(e.y,n))):new I(Math.min(Math.max(e.x,n),r),Math.min(Math.max(e.y,n),r))}static PointsBetween(e,n,r=6){const o=[];for(let i=0;i<r;i++){const s=Pn.easeInQuad(i/(r-1)),a=I.Lrp(e,n,s);a.z=Math.min(1,.5+Math.abs(.5-A8(s))*.65),o.push(a)}return o}static SnapToGrid(e,n=8){return new I(Math.round(e.x/n)*n,Math.round(e.y/n)*n)}}const A8=t=>t<.5?2*t*t:-1+(4-2*t)*t,ct=Math.PI,Ye=ct/2,dt=ct*2,a1=Math.PI/180,R8=Math.sin;function Vr(t,e,n){return Math.max(e,typeof n<"u"?Math.min(t,n):t)}function qu(t,e=1e10){return t?Math.round(t*e)/e:0}function nc(t,e,n=1e-6){return Math.abs(t-e)<=n}function bc(t,e){const n=Math.pow(t-e,2)/Math.pow(t+e,2);return ct*(t+e)*(1+3*n/(10+Math.sqrt(4-3*n)))}function Pv(t){return t=t%dt,t<0?t=t+dt:t===0&&(t=0),t}function wi(t,e){const n=(e-t)%dt;return 2*n%dt-n}function L8(t,e){return dt-wi(t,e)}function is(t,e,n){return t+wi(t,e)*n}function $I(t,e){return wi(t,e)}function D8(t,e,n){return $I(I.Angle(t,e),I.Angle(t,n))}function TI(t){return(dt+t)%dt}function Th(t,e){const n=dt/e;let r=Math.floor((TI(t)+n/2)/n)*n%dt;return r<ct&&(r+=dt),r>ct&&(r-=dt),r}function MI(t,e){return t===e||nc(t%(Math.PI/2)-e%(Math.PI/2),0)}function O8(t){return t*ct/180}function j8(t){return t*180/ct}function Qu(t,e,n,r){const o=D8(t,n,r);return e*dt*(o/dt)}function as(t,e,n,r){return new I(t+n*Math.cos(r),e+n*Math.sin(r))}function hg(t,e,n){const r=t/2,o=e/2,i=[];for(let s=0;s<n;s++){const a=dt/n,l=-Ye+s*a;i.push(new I(r+r*Math.cos(l),o+o*Math.sin(l)))}return i}function Cl(t,e,n,r){return t<r&&n<e}function Ur(t,e,n,r){const o=Math.max(t,n),i=Math.min(e,r);return o<=i?[o,i]:null}const N8=(t,e,n)=>{const r=dt/t/2,o=Math.floor(t/4)*2,i=t*2-o,s=0,a=Math.floor(t/2)*2,l=Math.cos(-Ye+o*r)*e/2,c=Math.cos(-Ye+i*r)*e/2,d=Math.sin(-Ye+s*r)*n/2,u=Math.sin(-Ye+a*r)*n/2;return new de(0,0,l-c,u-d)};function l1(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)}function $r(t,e){let n=0,r,o;for(let i=0;i<e.length;i++)r=e[i],o=e[(i+1)%e.length],r.y<=t.y?o.y>t.y&&l1(r,o,t)>0&&(n+=1):o.y<=t.y&&l1(r,o,t)<0&&(n-=1);return n!==0}function B8(t,e,n=8){const r=e.length;for(let o=1;o<r;o++){const i=e[o-1],s=e[o];if(I.DistanceToLineSegment(i,s,t)<n)return!0}return!1}function U(t){return+t.toFixed(4)}const tn=class{constructor(e=0,n=0,r=0,o=0){y(this,"x",0);y(this,"y",0);y(this,"w",0);y(this,"h",0);this.x=e,this.y=n,this.w=r,this.h=o}get point(){return new I(this.x,this.y)}set point(e){this.x=e.x,this.y=e.y}get minX(){return this.x}set minX(e){this.x=e}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(e){this.y=e}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(e){this.w=e}get height(){return this.h}set height(e){this.h=e}get aspectRatio(){return this.width/this.height}get center(){return new I(this.midX,this.midY)}set center(e){this.minX=e.x-this.width/2,this.minY=e.y-this.height/2}get corners(){return[new I(this.minX,this.minY),new I(this.maxX,this.minY),new I(this.maxX,this.maxY),new I(this.minX,this.maxY)]}get snapPoints(){return[new I(this.minX,this.minY),new I(this.maxX,this.minY),new I(this.maxX,this.maxY),new I(this.minX,this.maxY),this.center]}get sides(){const{corners:e}=this;return[[e[0],e[1]],[e[1],e[2]],[e[2],e[3]],[e[3],e[0]]]}get size(){return new I(this.w,this.h)}toFixed(){return this.x=qu(this.x),this.y=qu(this.y),this.w=qu(this.w),this.h=qu(this.h),this}setTo(e){return this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h,this}set(e=0,n=0,r=0,o=0){return this.x=e,this.y=n,this.w=r,this.h=o,this}expand(e){const n=Math.min(this.minX,e.minX),r=Math.min(this.minY,e.minY),o=Math.max(this.maxX,e.maxX),i=Math.max(this.maxY,e.maxY);return this.x=n,this.y=r,this.w=o-n,this.h=i-r,this}expandBy(e){return this.x-=e,this.y-=e,this.w+=e*2,this.h+=e*2,this}scale(e){return this.x/=e,this.y/=e,this.w/=e,this.h/=e,this}clone(){const{x:e,y:n,w:r,h:o}=this;return new tn(e,n,r,o)}translate(e){return this.x+=e.x,this.y+=e.y,this}snapToGrid(e){const n=Math.round(this.minX/e)*e,r=Math.round(this.minY/e)*e,o=Math.round(this.maxX/e)*e,i=Math.round(this.maxY/e)*e;this.minX=n,this.minY=r,this.width=Math.max(1,o-n),this.height=Math.max(1,i-r)}collides(e){return tn.Collides(this,e)}contains(e){return tn.Contains(this,e)}includes(e){return tn.Includes(this,e)}containsPoint(e,n){return tn.ContainsPoint(this,e,n)}getHandlePoint(e){switch(e){case"top_left":return new I(this.minX,this.minY);case"top_right":return new I(this.maxX,this.minY);case"bottom_left":return new I(this.minX,this.maxY);case"bottom_right":return new I(this.maxX,this.maxY);case"top":return new I(this.midX,this.minY);case"right":return new I(this.maxX,this.midY);case"bottom":return new I(this.midX,this.maxY);case"left":return new I(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(e,n,r){const{minX:o,minY:i,maxX:s,maxY:a}=this;let{minX:l,minY:c,maxX:d,maxY:u}=this;switch(e){case"left":case"top_left":case"bottom_left":{l+=n;break}case"right":case"top_right":case"bottom_right":{d+=n;break}}switch(e){case"top":case"top_left":case"top_right":{c+=r;break}case"bottom":case"bottom_left":case"bottom_right":{u+=r;break}}const h=(d-l)/(s-o),p=(u-c)/(a-i),g=h<0,m=p<0;if(g){const v=d;d=l,l=v}if(m){const v=u;u=c,c=v}this.minX=l,this.minY=c,this.width=Math.abs(d-l),this.height=Math.abs(u-c)}static From(e){return new tn(e.x,e.y,e.w,e.h)}static FromPoints(e){if(e.length===0)return new tn;let n=1/0,r=1/0,o=-1/0,i=-1/0,s;for(let a=0,l=e.length;a<l;a++)s=e[a],n=Math.min(s.x,n),r=Math.min(s.y,r),o=Math.max(s.x,o),i=Math.max(s.y,i);return new tn(n,r,o-n,i-r)}static Expand(e,n){const r=Math.min(n.minX,e.minX),o=Math.min(n.minY,e.minY),i=Math.max(n.maxX,e.maxX),s=Math.max(n.maxY,e.maxY);return new tn(r,o,i-r,s-o)}static ExpandBy(e,n){return new tn(e.minX-n,e.minY-n,e.width+n*2,e.height+n*2)}static Resize(e,n,r,o,i=!1){const{minX:s,minY:a,maxX:l,maxY:c}=e;let{minX:d,minY:u,maxX:h,maxY:p}=e;switch(n){case"left":case"top_left":case"bottom_left":{d+=r;break}case"right":case"top_right":case"bottom_right":{h+=r;break}}switch(n){case"top":case"top_left":case"top_right":{u+=o;break}case"bottom":case"bottom_left":case"bottom_right":{p+=o;break}}const g=(h-d)/(l-s),m=(p-u)/(c-a),v=g<0,x=m<0;if(i){const E=(l-s)/(c-a),P=Math.abs(h-d),C=Math.abs(p-u),k=P*(m<0?1:-1)*(1/E),$=C*(g<0?1:-1)*E,A=E<P/C;switch(n){case"top_left":{A?u=p+k:d=h+$;break}case"top_right":{A?u=p+k:h=d-$;break}case"bottom_right":{A?p=u-k:h=d-$;break}case"bottom_left":{A?p=u-k:d=h+$;break}case"bottom":case"top":{const D=(d+h)/2,j=C*E;d=D-j/2,h=D+j/2;break}case"left":case"right":{const D=(u+p)/2,j=P/E;u=D-j/2,p=D+j/2;break}}}if(v){const E=h;h=d,d=E}if(x){const E=p;p=u,u=E}const b=new tn(d,u,Math.abs(h-d),Math.abs(p-u));return{box:b,scaleX:+(b.width/e.width*(g>0?1:-1)).toFixed(5),scaleY:+(b.height/e.height*(m>0?1:-1)).toFixed(5)}}equals(e){return tn.Equals(this,e)}static Equals(e,n){return n.x===e.x&&n.y===e.y&&n.w===e.w&&n.h===e.h}};let de=tn;y(de,"Collides",(e,n)=>!(e.maxX<n.minX||e.minX>n.maxX||e.maxY<n.minY||e.minY>n.maxY)),y(de,"Contains",(e,n)=>e.minX<n.minX&&e.minY<n.minY&&e.maxY>n.maxY&&e.maxX>n.maxX),y(de,"Includes",(e,n)=>tn.Collides(e,n)||tn.Contains(e,n)),y(de,"ContainsPoint",(e,n,r)=>typeof n=="number"?!(n<e.minX||r<e.minY||n>e.maxX||r>e.maxY):!(n.x<e.minX||n.y<e.minY||n.x>e.maxX||n.y>e.maxY)),y(de,"Common",e=>{let n=1/0,r=1/0,o=-1/0,i=-1/0;for(let s=0;s<e.length;s++){const a=e[s];n=Math.min(n,a.minX),r=Math.min(r,a.minY),o=Math.max(o,a.maxX),i=Math.max(i,a.maxY)}return new tn(n,r,o-n,i-r)}),y(de,"Sides",(e,n=0)=>{const{corners:r}=e;return[[r[0],r[1]],[r[1],r[2]],[r[2],r[3]],[r[3],r[0]]]});function z8(t){switch(t){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return t}}function U8(t){switch(t){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return t}}function F8(t){return t==="top_left"||t==="top_right"||t==="bottom_right"||t==="bottom_left"}class AI{constructor(e){y(this,"_values");y(this,"_computed",{});this._values=e}get values(){return this._values}set values(e){this._values=e,this._computed={}}get length(){if(this._computed.length!==void 0)return this._computed.length;const{lut:e}=this;let n=e[0],r=0;for(let o=1;o<e.length;o++){const i=e[o];r+=n.dist(i),n=i}return this._computed.length=r,r}get bounds(){if(this._computed.bounds!==void 0)return this._computed.bounds;let e=1/0,n=1/0,r=-1/0,o=-1/0;const{lut:i}=this;for(const a of i)e=Math.min(a.x,e),n=Math.min(a.y,n),r=Math.max(a.x,r),o=Math.max(a.y,o);const s=new de(e,n,r-e,o-n);return this._computed.bounds=s,s}get lut(){if(this._computed.lut)return this._computed.lut;const{p:e}=this.values,n=[];for(let r=0;r<e+1;r++)n.push(this.getPoint(r/e));return this._computed.lut=n,n}get midPoint(){if(this._computed.midPoint)return this._computed.midPoint;const e=this.getPoint(.5);return this._computed.midPoint=e,e}get path(){if(this._computed.path)return this._computed.path;const e=this.getPath();return this._computed.path=e,e}getPointAtLength(e){const n=Math.max(0,Math.min(1,e/this.length));return this.getPoint(n)}getNormal(e){return this.getPoint(e-.0025).tan(this.getPoint(e+.0025)).per().uni().toFixed()}getNormalAtLength(e){return this.getNormal(e/this.length)}getClosestPointTo(e){const{lut:n}=this;let r=0,o=n[0],i=n[0].dist(e);for(let a=1;a<n.length;a++){const l=I.Dist(n[a],e);l<i&&(i=l,o=n[a],r=a/n.length)}const s=1/this.values.p;for(let a=Math.max(0,r-s/2);a<Math.min(1,r+s/2);a+=s/10){const l=this.getPoint(a),c=I.Dist(l,e);c<i&&(i=c,o=l)}return{point:o,distance:i}}update(e){this._computed={},this.values={...this.values,...e}}}var Aee;class K8 extends AI{constructor(n,r,o,i,s=25){super({a:n,b:r,c:o,d:i,p:s});y(this,Aee,function*(){const{a:n,b:r,c:o,d:i}=this.values;yield*[n,r,o,i]})}getPath(n=!0){const{a:r,b:o,c:i,d:s}=this.values;return I.Equals(r,s)?"":`${n?`M${r.x.toFixed(2)},${r.y.toFixed(2)}C`:""}${o.x.toFixed(2)},${o.y.toFixed(2)} ${i.x.toFixed(2)},${i.y.toFixed(2)} ${s.x.toFixed(2)},${s.y.toFixed(2)}`}getPoint(n){const{a:r,b:o,c:i,d:s}=this.values;return new I((1-n)*(1-n)*(1-n)*r.x+3*((1-n)*(1-n))*n*o.x+3*(1-n)*(n*n)*i.x+n*n*n*s.x,(1-n)*(1-n)*(1-n)*r.y+3*((1-n)*(1-n))*n*o.y+3*(1-n)*(n*n)*i.y+n*n*n*s.y)}getX(n){const{a:r,b:o,c:i,d:s}=this.values;return(1-n)*(1-n)*(1-n)*r.x+3*((1-n)*(1-n))*n*o.x+3*(1-n)*(n*n)*i.x+n*n*n*s.x}getY(n){const{a:r,b:o,c:i,d:s}=this.values;return(1-n)*(1-n)*(1-n)*r.y+3*((1-n)*(1-n))*n*o.y+3*(1-n)*(n*n)*i.y+n*n*n*s.y}}Aee=Symbol.iterator;class RI{constructor(e,n=50,r=1){y(this,"computed",{});this.points=e,this.p=n,this.k=r}get length(){if(this.computed.length!==void 0)return this.computed.length;const{segments:e}=this,n=e.reduce((r,o)=>r+o.length,0);return this.computed.length=n,n}get bounds(){if(this.computed.bounds!==void 0)return this.computed.bounds;const{segments:e}=this,n=de.Common(e.map(r=>r.bounds));return this.computed.bounds=n,n}get head(){const{points:e}=this;return e[0]}get tail(){const{points:e}=this;return e[e.length-1]}get path(){if(this.computed.path!==void 0)return this.computed.path;const e=this.segments.map(n=>n.path).filter(n=>n!=null&&n!=="").join(" ");return this.computed.path=e,e}addPoint(e){const{points:n,k:r,p:o}=this;return n.push(e),this.computed={},this.getSegmentsFromPoints(this.points,o,r),this}removePoint(e){const{points:n,k:r,p:o}=this,i=typeof e=="number"?Math.floor(e):n.indexOf(e);return i===-1?this:(n.splice(i,1),this.computed={},this.getSegmentsFromPoints(this.points,o,r),this)}getPointAtLength(e){const{segments:n}=this;let r=e;if(e<=0)return n[0].getPoint(0);if(e>=this.length)return n[n.length-1].getPoint(1);for(let o=0;o<n.length;o++){const i=n[o],{length:s}=i;if(r<s)return i.getPoint(r/s);r-=i.length}return n[n.length-1].getPoint(1)}getPoint(e){return e<=0?this.segments[0].getPoint(0):e>=1?this.segments[this.segments.length-1].getPoint(1):this.getPointAtLength(e*this.length)}getNormal(e){const{length:n}=this;return this.getNormalAtLength(e*n)}getNormalAtLength(e){const{segments:n}=this;if(e<0)return new I(0,0);let r=e;for(const o of n){const i=o.length;if(r<=i)return o.getNormal(r/i);r-=i}return new I(0,0)}getClosestPointTo(e){const{head:n,segments:r}=this;let o=n,i=I.Dist(e,n);for(const s of r){const a=s.getClosestPointTo(e);a.distance<i&&(i=a.distance,o=a.point)}return{point:o,distance:i}}}class _v extends RI{constructor(n,r=1.2,o=20){super(n,r,o);y(this,"segments");this.segments=this.getSegmentsFromPoints(n,r,o)}getSegmentsFromPoints(n,r=1.25,o=20){const i=n.length,s=i-2,a=[];for(let l=0;l<i-1;l++){const c=l===0?n[0]:n[l-1],d=n[l],u=n[l+1],h=l===s?u:n[l+2];a.push(new K8(d,l===0?c:new I(d.x+(u.x-c.x)/6*r,d.y+(u.y-c.y)/6*r),l===s?u:new I(u.x-(h.x-d.x)/6*r,u.y-(h.y-d.y)/6*r),u,o))}return a}static FromPoints(n){return new _v(n)}}class H8 extends AI{constructor(e,n,r=2){super({a:e,b:n,p:r}),this.a=e,this.b=n,this.values.p=Math.max(10,Math.ceil(this.length/20))}get length(){return I.Dist(this.a,this.b)}get tangent(){return I.Tan(this.a,this.b)}get angle(){return I.Angle(this.a,this.b)}get bounds(){return de.FromPoints([this.a,this.b])}getX(e){const{a:n,b:r}=this.values;return n.x+(r.x-n.x)*e}getY(e){const{a:n,b:r}=this.values;return n.y+(r.y-n.y)*e}getPoint(e){const{a:n,b:r}=this.values;return I.Lrp(n,r,e)}getPath(e=!0){const{a:n,b:r}=this.values;return I.Equals(n,r)?"":e?`M${n.x},${n.y}L${r.x},${r.y}`:`${r.x},${r.y}`}getNormal(){const{a:e,b:n}=this.values;return I.Sub(e,n).per().uni().toFixed()}getClosestPointTo(e){const{a:n,b:r}=this.values,o=I.NearestPointOnLineSegment(n,r,e),i=o.dist(e);return{point:o,distance:i}}static Length(e){return I.Dist(e.a,e.b)}static Tangent(e){return I.Tan(e.a,e.b)}static Angle(e){return I.Angle(e.a,e.b)}}const ot=class{constructor(e,n,r,o,i,s){y(this,"a",1);y(this,"b",0);y(this,"c",0);y(this,"d",1);y(this,"e",0);y(this,"f",0);this.a=e,this.b=n,this.c=r,this.d=o,this.e=i,this.f=s}equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(e){const n=e,{a:r,b:o,c:i,d:s,e:a,f:l}=this;return this.a=r*n.a+i*n.b,this.c=r*n.c+i*n.d,this.e=r*n.e+i*n.f+a,this.b=o*n.a+s*n.b,this.d=o*n.c+s*n.d,this.f=o*n.e+s*n.f+l,this}rotate(e,n,r){return e===0?this:n===void 0?this.multiply(ot.Rotate(e)):this.translate(n,r).multiply(ot.Rotate(e)).translate(-n,-r)}translate(e,n){return this.multiply(ot.Translate(e,n))}scale(e,n){return this.multiply(ot.Scale(e,n))}invert(){const{a:e,b:n,c:r,d:o,e:i,f:s}=this,a=e*o-n*r;return this.a=o/a,this.b=n/-a,this.c=r/-a,this.d=e/a,this.e=(o*i-r*s)/-a,this.f=(n*i-e*s)/a,this}applyToPoint(e){return ot.applyToPoint(this,e)}applyToPoints(e){return ot.applyToPoints(this,e)}decomposed(){return ot.Decompose(this)}toCssString(){return ot.toCssString(this)}setTo(e){return Object.assign(this,e),this}decompose(){return ot.Decompose(this)}clone(){return new ot(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new ot(1,0,0,1,0,0)}static Translate(e,n){return new ot(1,0,0,1,e,n)}static Rotate(e,n,r){if(e===0)return ot.Identity();const o=Math.cos(e),i=Math.sin(e),s=new ot(o,i,-i,o,0,0);return n===void 0?s:ot.Compose(ot.Translate(n,r),s,ot.Translate(-n,-r))}static Multiply(e,n){return{a:e.a*n.a+e.c*n.b,c:e.a*n.c+e.c*n.d,e:e.a*n.e+e.c*n.f+e.e,b:e.b*n.a+e.d*n.b,d:e.b*n.c+e.d*n.d,f:e.b*n.e+e.d*n.f+e.f}}static Inverse(e){const n=e.a*e.d-e.b*e.c;return{a:e.d/n,b:e.b/-n,c:e.c/-n,d:e.a/n,e:(e.d*e.e-e.c*e.f)/-n,f:(e.b*e.e-e.a*e.f)/n}}static Absolute(e){const n=e.a*e.d-e.b*e.c;return{a:e.d/n,b:e.b/-n,c:e.c/-n,d:e.a/n,e:(e.d*e.e-e.c*e.f)/n,f:(e.b*e.e-e.a*e.f)/-n}}static Compose(...e){const n=ot.Identity();for(let r=0,o=e.length;r<o;r++)n.multiply(e[r]);return n}static Decompose(e){let n,r,o;if(e.a!==0||e.c!==0){const i=Math.hypot(e.a,e.c);n=i,r=(e.a*e.d-e.b*e.c)/i,o=Math.acos(e.a/i)*(e.c>0?-1:1)}else if(e.b!==0||e.d!==0){const i=Math.hypot(e.b,e.d);n=(e.a*e.d-e.b*e.c)/i,r=i,o=Ye+Math.acos(e.b/i)*(e.d>0?-1:1)}else n=0,r=0,o=0;return{x:e.e,y:e.f,scaleX:n,scaleY:r,rotation:TI(o)}}static Smooth(e,n=1e10){return e.a=Math.round(e.a*n)/n,e.b=Math.round(e.b*n)/n,e.c=Math.round(e.c*n)/n,e.d=Math.round(e.d*n)/n,e.e=Math.round(e.e*n)/n,e.f=Math.round(e.f*n)/n,e}static toCssString(e){return`matrix(${U(e.a)}, ${U(e.b)}, ${U(e.c)}, ${U(e.d)}, ${U(e.e)}, ${U(e.f)})`}static applyToPoint(e,n){return new I(e.a*n.x+e.c*n.y+e.e,e.b*n.x+e.d*n.y+e.f,n.z)}static applyToXY(e,n,r){return[e.a*n+e.c*r+e.e,e.b*n+e.d*r+e.f]}static applyToPoints(e,n){return n.map(r=>new I(e.a*r.x+e.c*r.y+e.e,e.b*r.x+e.d*r.y+e.f,r.z))}static applyToBounds(e,n){return new de(e.e+n.minX,e.f+n.minY,n.width,n.height)}static From(e){return new ot(e.a,e.b,e.c,e.d,e.e,e.f)}};let ee=ot;y(ee,"Scale",(e,n,r,o)=>{const i=new ot(e,0,0,0,n,0);return r===void 0?i:ot.Compose(ot.Translate(r,o),i,ot.Translate(-r,-o))});class Iv extends RI{constructor(n,r=1.2,o=20){super(n,r,o);y(this,"segments");this.segments=this.getSegmentsFromPoints(n,o)}getSegmentsFromPoints(n,r=50){const o=[];for(let i=0;i<n.length-1;i++)o.push(new H8(n[i],n[i+1],r));return o}static FromPoints(n){return new Iv(n)}}const{PI:V8}=Math,Qs=V8+1e-4;function Sc(t,e={}){const{size:n=16,smoothing:r=.5,start:o={},end:i={},last:s=!1}=e,{cap:a=!0}=o,{cap:l=!0}=i;if(t.length===0||n<=0)return[];const c=t[0],d=t[t.length-1],u=d.runningLength,h=o.taper===!1?0:o.taper===!0?Math.max(n,u):o.taper,p=i.taper===!1?0:i.taper===!0?Math.max(n,u):i.taper,g=Math.pow(n*r,2),m=[],v=[];let x=t[0].vector,b=t[0].point,E=b,P=b,C=E,k=!1,$;for(let q=0;q<t.length;q++){$=t[q];const{point:F,vector:X}=t[q],ne=$.vector.dpr(x),ie=(q<t.length-1?t[q+1]:t[q]).vector,W=q<t.length-1?ie.dpr($.vector):1,H=ne<0&&!k,G=W!==null&&W<.2;if(H||G){if(W>-.62&&u-$.runningLength>$.radius){const le=x.clone().mul($.radius);x.clone().cpr(ie)<0?(P=I.Add(F,le),C=I.Sub(F,le)):(P=I.Sub(F,le),C=I.Add(F,le)),m.push(P),v.push(C)}else{const le=x.clone().mul($.radius).per(),De=I.Sub($.input,le);for(let Ie=1/13,we=0;we<1;we+=Ie)P=I.RotWith(De,$.input,Qs*we),m.push(P),C=I.RotWith(De,$.input,Qs+Qs*-we),v.push(C)}b=P,E=C,G&&(k=!0);continue}if(k=!1,$===c||$===d){const le=I.Per(X).mul($.radius);m.push(I.Sub(F,le)),v.push(I.Add(F,le));continue}const Q=I.Lrp(ie,X,W).per().mul($.radius);P=I.Sub(F,Q),(q<=1||I.Dist2(b,P)>g)&&(m.push(P),b=P),C=I.Add(F,Q),(q<=1||I.Dist2(E,C)>g)&&(v.push(C),E=C),x=X}const A=c.point,D=t.length>1?t[t.length-1].point:I.AddXY(c.point,1,1);if(t.length===1&&(!(h||p)||s)){const q=I.Add(A,I.Sub(A,D).uni().per().mul(-c.radius)),F=[];for(let X=1/13,ne=X;ne<=1;ne+=X)F.push(I.RotWith(q,A,Qs*2*ne));return F}const j=[];if(!(h||p&&t.length===1))if(a)for(let q=1/8,F=q;F<=1;F+=q){const X=I.RotWith(v[0],A,Qs*F);j.push(X)}else{const q=I.Sub(m[0],v[0]),F=I.Mul(q,.5),X=I.Mul(q,.51);j.push(I.Sub(A,F),I.Sub(A,X),I.Add(A,X),I.Add(A,F))}const Y=[],V=d.vector.clone().per().neg();if(p||h&&t.length===1)Y.push(D);else if(l){const q=I.Add(D,I.Mul(V,d.radius));for(let F=1/29,X=F;X<1;X+=F)Y.push(I.RotWith(q,D,Qs*3*X))}else Y.push(I.Add(D,I.Mul(V,d.radius)),I.Add(D,I.Mul(V,d.radius*.99)),I.Sub(D,I.Mul(V,d.radius*.99)),I.Sub(D,I.Mul(V,d.radius)));return m.concat(Y,v.reverse(),j)}const W8=.025,Y8=.01;function Ra(t,e={}){var v;const{streamline:n=.5,size:r=16,simulatePressure:o=!1}=e;if(t.length===0)return[];const i=.15+(1-n)*.85;let s=t.map(I.From),a=0;if(!o){let x=s[0];for(;x&&!(x.z>=W8);)s.shift(),x=s[0]}if(!o){let x=s[s.length-1];for(;x&&!(x.z>=Y8);)s.pop(),x=s[s.length-1]}if(s.length===0)return[{point:I.From(t[0]),input:I.From(t[0]),pressure:o?.5:.15,vector:new I(1,1),distance:0,runningLength:0,radius:1}];let l=s[1];for(;l&&!(I.Dist(l,s[0])>r/3);)s[0].z=Math.max(s[0].z,l.z),s.splice(1,1),l=s[1];const c=s.pop();for(l=s[s.length-1];l&&!(I.Dist(l,c)>r/3);)s.pop(),l=s[s.length-1],a++;s.push(c);const d=e.last||!e.simulatePressure||s.length>1&&I.Dist(s[s.length-1],s[s.length-2])<r||a>0;if(s.length===2&&e.simulatePressure){const x=s[1];s=s.slice(0,-1);for(let b=1;b<5;b++){const E=I.Lrp(s[0],x,b/4);E.z=(s[0].z+(x.z-s[0].z))*b/4,s.push(E)}}const u=[{point:s[0],input:s[0],pressure:o?.5:s[0].z,vector:new I(1,1),distance:0,runningLength:0,radius:1}];let h=0,p=u[0],g,m;d&&n>0&&s.push(s[s.length-1].clone());for(let x=1,b=s.length;x<b;x++)g=!i||e.last&&x===b-1?s[x].clone():s[x].clone().lrp(p.point,1-i),!p.point.equals(g)&&(m=I.Dist(g,p.point),h+=m,!(x<4&&h<r)&&(p={input:s[x],point:g,pressure:o?.5:s[x].z,vector:I.Sub(p.point,g).uni(),distance:m,runningLength:h,radius:1},u.push(p)));if((v=u[1])!=null&&v.vector&&(u[0].vector=u[1].vector.clone()),h<1){const x=Math.max(.5,...u.map(b=>b.pressure));u.forEach(b=>b.pressure=x)}return u}const{min:ui}=Math,pg=.275;function Ec(t,e){const{size:n=16,thinning:r=.5,simulatePressure:o=!0,easing:i=v=>v,start:s={},end:a={}}=e,{easing:l=Pn.easeOutQuad}=s,{easing:c=Pn.easeOutCubic}=a,d=t[t.length-1].runningLength;let u,h=t[0].pressure,p;if(!o&&d<n){const v=t.reduce((x,b)=>Math.max(x,b.pressure),.5);return t.forEach(x=>{x.pressure=v,x.radius=n*i(.5-r*(.5-x.pressure))}),t}else{let v;for(let x=0,b=t.length;x<b&&(p=t[x],!(p.runningLength>n*5));x++){const E=ui(1,p.distance/n);if(o){const P=ui(1,1-E);v=ui(1,h+(P-h)*(E*pg))}else v=ui(1,h+(p.pressure-h)*.5);h=h+(v-h)*.5}for(let x=0;x<t.length;x++){if(p=t[x],r){let{pressure:b}=p;const E=ui(1,p.distance/n);if(o){const P=ui(1,1-E);b=ui(1,h+(P-h)*(E*pg))}else b=ui(1,h+(b-h)*(E*pg));p.radius=n*i(.5-r*(.5-b)),h=b}else p.radius=n/2;u===void 0&&(u=p.radius)}}const g=s.taper===!1?0:s.taper===!0?Math.max(n,d):s.taper,m=a.taper===!1?0:a.taper===!0?Math.max(n,d):a.taper;if(g||m)for(let v=0;v<t.length;v++){p=t[v];const{runningLength:x}=p,b=x<g?l(x/g):1,E=d-x<m?c((d-x)/m):1;p.radius=Math.max(.01,p.radius*Math.min(b,E))}return t}function X8(t,e={}){return Sc(Ec(Ra(t,e),e),e)}function Cv(t,e,n,r){const o=t.x-n.x,i=t.y-n.y,s=r.x-n.x,a=r.y-n.y,l=e.x-t.x,c=e.y-t.y,d=s*i-a*o,u=l*i-c*o,h=a*l-s*c;if(d===0||u===0||h===0)return null;if(h!==0){const p=d/h,g=u/h;if(0<=p&&p<=1&&0<=g&&g<=1)return I.AddXY(t,p*l,p*c)}return null}function LI(t,e,n,r){const o=(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y),i=2*((e.x-t.x)*(t.x-n.x)+(e.y-t.y)*(t.y-n.y)),s=n.x*n.x+n.y*n.y+t.x*t.x+t.y*t.y-2*(n.x*t.x+n.y*t.y)-r*r,a=i*i-4*o*s;if(a<0||a===0)return null;const l=Math.sqrt(a),c=(-i+l)/(2*o),d=(-i-l)/(2*o);if((c<0||c>1)&&(d<0||d>1))return null;const u=[];return 0<=c&&c<=1&&u.push(I.Lrp(t,e,c)),0<=d&&d<=1&&u.push(I.Lrp(t,e,d)),u.length===0?null:u}function kv(t,e,n){const r=[];let o;for(let i=0,s=n.length-1;i<s;i++)o=Cv(t,e,n[i],n[i+1]),o&&r.push(o);return r.length===0?null:r}function G8(t,e,n){const r=[];let o;for(let i=1,s=n.length;i<s+1;i++)o=Cv(t,e,n[i-1],n[i%n.length]),o&&r.push(o);return r.length===0?null:r}function q8(t,e,n,r){let o=n.x-t.x,i=n.y-t.y;const s=Math.sqrt(o*o+i*i),a=(s*s-r*r+e*e)/(2*s),l=Math.sqrt(e*e-a*a);return o/=s,i/=s,[new I(t.x+o*a-i*l,t.y+i*a+o*l),new I(t.x+o*a+i*l,t.y+i*a-o*l)]}function c1(t,e,n){const r=[];let o,i,s;for(let a=0,l=n.length;a<l;a++)o=n[a],i=n[(a+1)%n.length],s=LI(o,i,t,e),s&&r.push(...s);return r.length===0?null:r}function u1(t,e,n){const r=[];let o,i,s;for(let a=1,l=n.length;a<l;a++)o=n[a-1],i=n[a],s=LI(o,i,t,e),s&&r.push(...s);return r.length===0?null:r}function Zu(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function qo(t,e,n,r){return Zu(t,n,r)!==Zu(e,n,r)&&Zu(t,e,n)!==Zu(t,e,r)}function dy(t,e){const n=[];let r,o,i,s;for(let a=0,l=t.length;a<l;a++)r=t[a],$r(r,e)&&n.push(r);for(let a=0,l=e.length;a<l;a++)r=e[a],$r(r,t)&&n.push(r);for(let a=0,l=t.length;a<l;a++){r=t[a],o=t[(a+1)%t.length];for(let c=0,d=e.length;c<d;c++){i=e[c],s=e[(c+1)%e.length];const u=Cv(r,o,i,s);u!==null&&n.push(u)}}return n.length===0?null:Q8(n)}function Q8(t){const e=I.Average(t);return t.sort((n,r)=>I.Angle(e,n)-I.Angle(e,r))}function Z8(t,e){let n,r,o,i;for(let s=0,a=t.length;s<a;s++){n=t[s],r=t[(s+1)%a];for(let l=0,c=e.length;l<c;l++)if(o=e[l],i=e[(l+1)%c],qo(n,r,o,i))return!0}return!1}function xt(t){return`${U(t.x)},${U(t.y)} `}function DI(t=""){let e=0,n=0,r=0,o=0;function i(){const s=e^e<<11;return e=n,n=r,r=o,o^=(o>>>19^s^s>>>8)>>>0,o/4294967296*2}for(let s=0;s<t.length+64;s++)e^=t.charCodeAt(s)|0,i();return i}function Pc(t){let e="M";const n=t.length;let r,o,i;for(let s=0,a=n;s<a;s+=3)r=t[s],o=t[s+1],i=t[s+2],e+=`${xt(r)}L${xt(o)}Q${xt(i)}`;return e+=`${xt(t[0])}`,e}function _c(t,e,n,r,o){const i=[],s=DI(t);let a=e[0],l;const c=e.length;for(let d=0,u=c*o;d<u;d++){l=I.AddXY(e[(d+1)%c],s()*n,s()*n);const h=I.Sub(l,a),p=I.Len(h),g=I.Div(h,p).mul(Math.min(p/4,r));i.push(I.Add(a,g),I.Add(l,g.neg()),l),a=l}return i}function d1(t,e,n){let r=`M${xt(e[0])}L`,o=`M${xt(e[0])}L`,i=`M${xt(e[0])}L`;const s=n/3,a=n*2,l=DI(t);let c=e[0],d,u=e[0],h;const p=e.length;for(let g=0,m=p-1;g<m;g++){d=I.AddXY(e[g+1],l()*s,l()*s),h=I.AddXY(e[g+1],l(),l()*s);const v=I.Sub(d,c),x=I.Len(v),b=I.Div(v,x).mul(Math.min(x/4,a)),E=I.Add(c,b),P=I.Add(d,b.neg()),C=I.Sub(h,u),k=I.Len(C),$=I.Div(C,k).mul(Math.min(k/4,a)),A=I.Add(u,$),D=I.Add(h,$.neg());g===m-1?(r+=`${xt(E)} L ${xt(d)}`,o+=`${xt(E)} L ${xt(d)}`,i+=`${xt(A)} L ${xt(h)}`):(r+=`${xt(E)}L ${xt(P)}Q ${xt(d)}`,o+=`${xt(E)}L ${xt(P)}Q ${xt(d)}`,i+=`${xt(A)}L ${xt(D)}Q ${xt(h)}`,c=d,u=h)}return[r,o+i]}var OI={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function o(l,c,d){this.fn=l,this.context=c,this.once=d||!1}function i(l,c,d,u,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new o(d,u||l,h),g=n?n+c:c;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],p]:l._events[g].push(p):(l._events[g]=p,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],d,u;if(this._eventsCount===0)return c;for(u in d=this._events)e.call(d,u)&&c.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(d)):c},a.prototype.listeners=function(c){var d=n?n+c:c,u=this._events[d];if(!u)return[];if(u.fn)return[u.fn];for(var h=0,p=u.length,g=new Array(p);h<p;h++)g[h]=u[h].fn;return g},a.prototype.listenerCount=function(c){var d=n?n+c:c,u=this._events[d];return u?u.fn?1:u.length:0},a.prototype.emit=function(c,d,u,h,p,g){var m=n?n+c:c;if(!this._events[m])return!1;var v=this._events[m],x=arguments.length,b,E;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,u),!0;case 4:return v.fn.call(v.context,d,u,h),!0;case 5:return v.fn.call(v.context,d,u,h,p),!0;case 6:return v.fn.call(v.context,d,u,h,p,g),!0}for(E=1,b=new Array(x-1);E<x;E++)b[E-1]=arguments[E];v.fn.apply(v.context,b)}else{var P=v.length,C;for(E=0;E<P;E++)switch(v[E].once&&this.removeListener(c,v[E].fn,void 0,!0),x){case 1:v[E].fn.call(v[E].context);break;case 2:v[E].fn.call(v[E].context,d);break;case 3:v[E].fn.call(v[E].context,d,u);break;case 4:v[E].fn.call(v[E].context,d,u,h);break;default:if(!b)for(C=1,b=new Array(x-1);C<x;C++)b[C-1]=arguments[C];v[E].fn.apply(v[E].context,b)}}return!0},a.prototype.on=function(c,d,u){return i(this,c,d,u,!1)},a.prototype.once=function(c,d,u){return i(this,c,d,u,!0)},a.prototype.removeListener=function(c,d,u,h){var p=n?n+c:c;if(!this._events[p])return this;if(!d)return s(this,p),this;var g=this._events[p];if(g.fn)g.fn===d&&(!h||g.once)&&(!u||g.context===u)&&s(this,p);else{for(var m=0,v=[],x=g.length;m<x;m++)(g[m].fn!==d||h&&!g[m].once||u&&g[m].context!==u)&&v.push(g[m]);v.length?this._events[p]=v.length===1?v[0]:v:s(this,p)}return this},a.prototype.removeAllListeners=function(c){var d;return c?(d=n?n+c:c,this._events[d]&&s(this,d)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(OI);var J8=OI.exports;function xr({children:t,className:e="",...n}){return f.jsx("svg",{...n,className:`tl-svg-container ${e}`,children:t})}function qn({type:t,getShapeUtil:e,validator:n,migrations:r={currentVersion:0,firstVersion:0,migrators:{}}}){return{type:t,createShapeUtils:o=>{const i=e();return new i(o,t)},is:o=>o.type===t,validator:n,migrations:r}}const ls=2e3,Mh=40,No=320,Zs=[.1,.25,.5,1,2,4,8],kl=.1,gi=8,eN=.5,tN=.1,nN=.2,rN=.005,oN=.05,iN=10,sN=1,aN=1e3,lN=1e3,cN=5,fr=8,uN=450,dN=200,hy=6,Ic=4,hN=32,Ah={};for(let t=1;t<=Math.ceil(gi);t++)Ah[t+"_dark"]=`hash_pattern_zoom_${t}_dark`,Ah[t+"_light"]=`hash_pattern_zoom_${t}_light`;const h1={duration:0,easing:Pn.easeInOutCubic},Ud=.09,ms=48,Rh=10,pN=10,jI=300,NI=320,$v=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}],p1=[{min:-1,mid:.15,step:100},{min:.05,mid:.375,step:25},{min:.15,mid:1,step:5},{min:.7,mid:2.5,step:1}],Ct={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px",maxWidth:"auto"},ys={s:18,m:24,l:36,xl:44},Pi={s:18,m:22,l:26,xl:32},hi={s:18,m:20,l:24,xl:28},Ko={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"},Ju={color:[{id:"black",type:"color",icon:"color"},{id:"grey",type:"color",icon:"color"},{id:"light-violet",type:"color",icon:"color"},{id:"violet",type:"color",icon:"color"},{id:"blue",type:"color",icon:"color"},{id:"light-blue",type:"color",icon:"color"},{id:"yellow",type:"color",icon:"color"},{id:"orange",type:"color",icon:"color"},{id:"green",type:"color",icon:"color"},{id:"light-green",type:"color",icon:"color"},{id:"light-red",type:"color",icon:"color"},{id:"red",type:"color",icon:"color"}],fill:[{id:"none",type:"fill",icon:"fill-none"},{id:"semi",type:"fill",icon:"fill-semi"},{id:"solid",type:"fill",icon:"fill-solid"},{id:"pattern",type:"fill",icon:"fill-pattern"}],dash:[{id:"draw",type:"dash",icon:"dash-draw"},{id:"dashed",type:"dash",icon:"dash-dashed"},{id:"dotted",type:"dash",icon:"dash-dotted"},{id:"solid",type:"dash",icon:"dash-solid"}],size:[{id:"s",type:"size",icon:"size-small"},{id:"m",type:"size",icon:"size-medium"},{id:"l",type:"size",icon:"size-large"},{id:"xl",type:"size",icon:"size-extra-large"}],opacity:[{id:"0.1",type:"opacity",icon:"color"},{id:"0.25",type:"opacity",icon:"color"},{id:"0.5",type:"opacity",icon:"color"},{id:"0.75",type:"opacity",icon:"color"},{id:"1",type:"opacity",icon:"color"}],font:[{id:"draw",type:"font",icon:"font-draw"},{id:"sans",type:"font",icon:"font-sans"},{id:"serif",type:"font",icon:"font-serif"},{id:"mono",type:"font",icon:"font-mono"}],align:[{id:"start",type:"align",icon:"text-align-left"},{id:"middle",type:"align",icon:"text-align-center"},{id:"end",type:"align",icon:"text-align-right"}],geo:[{id:"rectangle",type:"geo",icon:"geo-rectangle"},{id:"ellipse",type:"geo",icon:"geo-ellipse"},{id:"triangle",type:"geo",icon:"geo-triangle"},{id:"diamond",type:"geo",icon:"geo-diamond"},{id:"pentagon",type:"geo",icon:"geo-pentagon"},{id:"hexagon",type:"geo",icon:"geo-hexagon"},{id:"octagon",type:"geo",icon:"geo-octagon"},{id:"star",type:"geo",icon:"geo-star"},{id:"rhombus",type:"geo",icon:"geo-rhombus"},{id:"rhombus-2",type:"geo",icon:"geo-rhombus-2"},{id:"oval",type:"geo",icon:"geo-oval"},{id:"trapezoid",type:"geo",icon:"geo-trapezoid"},{id:"arrow-right",type:"geo",icon:"geo-arrow-right"},{id:"arrow-left",type:"geo",icon:"geo-arrow-left"},{id:"arrow-up",type:"geo",icon:"geo-arrow-up"},{id:"arrow-down",type:"geo",icon:"geo-arrow-down"},{id:"x-box",type:"geo",icon:"geo-x-box"},{id:"check-box",type:"geo",icon:"geo-check-box"}],arrowheadStart:[{id:"none",type:"arrowheadStart",icon:"arrowhead-none"},{id:"arrow",type:"arrowheadStart",icon:"arrowhead-arrow"},{id:"triangle",type:"arrowheadStart",icon:"arrowhead-triangle"},{id:"square",type:"arrowheadStart",icon:"arrowhead-square"},{id:"dot",type:"arrowheadStart",icon:"arrowhead-dot"},{id:"diamond",type:"arrowheadStart",icon:"arrowhead-diamond"},{id:"inverted",type:"arrowheadStart",icon:"arrowhead-triangle-inverted"},{id:"bar",type:"arrowheadStart",icon:"arrowhead-bar"}],arrowheadEnd:[{id:"none",type:"arrowheadEnd",icon:"arrowhead-none"},{id:"arrow",type:"arrowheadEnd",icon:"arrowhead-arrow"},{id:"triangle",type:"arrowheadEnd",icon:"arrowhead-triangle"},{id:"square",type:"arrowheadEnd",icon:"arrowhead-square"},{id:"dot",type:"arrowheadEnd",icon:"arrowhead-dot"},{id:"diamond",type:"arrowheadEnd",icon:"arrowhead-diamond"},{id:"inverted",type:"arrowheadEnd",icon:"arrowhead-triangle-inverted"},{id:"bar",type:"arrowheadEnd",icon:"arrowhead-bar"}],spline:[{id:"line",type:"spline",icon:"spline-line"},{id:"cubic",type:"spline",icon:"spline-cubic"}]},fN=new Set(["bend","w","h","start","end","text","name","url","growY"]);function _n(t,e,n={}){const{closed:r=!1,snap:o=1,start:i="outset",end:s="outset",lengthRatio:a=2,style:l="dashed"}=n;let c=0,d=0,u=1,h=0,p=0;switch(l){case"dashed":{u=1,c=Math.min(e*a,t/4);break}case"dotted":{u=100,c=e/u;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(i==="outset"?(t+=c/2,p+=c/2):i==="skip"&&(t-=c,p-=c),s==="outset"?t+=c/2:s==="skip"&&(t-=c)),d=Math.floor(t/c/(2*u)),d-=d%o,d<3&&l==="dashed"?t/e<5?(c=t,d=1,h=0):(c=t*.333,h=t*.333):(d=Math.max(d,3),c=t/d/(2*u),r?(p=c/2,h=(t-d*c)/d):h=(t-d*c)/Math.max(1,d-1)),{strokeDasharray:[c,h].join(" "),strokeDashoffset:p.toString()}}function BI(t,e){return t.match(/^\s*$/)?e:t}function gN(t){return t.replace(/\s/g," ")}function Dp(t,e){const{padding:n=0}=e,r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("font-size",e.fontSize+"px"),r.setAttribute("font-family",e.fontFamily),r.setAttribute("font-style",e.fontStyle),r.setAttribute("font-weight",e.fontWeight),r.setAttribute("line-height",e.lineHeight*e.fontSize+"px"),r.setAttribute("dominant-baseline","mathematical"),r.setAttribute("alignment-baseline","mathematical");const o=e.lines.map(c=>c),i=[],s=o.length*(e.lineHeight*e.fontSize),a=(Math.ceil(e.height)-s)/2,l=n;for(let c=0;c<o.length;c++){const d=document.createElementNS("http://www.w3.org/2000/svg","tspan");d.setAttribute("alignment-baseline","mathematical");const u=gN(o[c]);d.textContent=u,o.length>1&&c<o.length-1&&(d.textContent+=`
`),d.setAttribute("y",a+e.fontSize/2+e.lineHeight*e.fontSize*c+"px"),r.appendChild(d),i.push(d)}switch(e.stroke&&e.strokeWidth&&(r.setAttribute("stroke",e.stroke),r.setAttribute("stroke-width",e.strokeWidth+"px")),e.fill&&r.setAttribute("fill",e.fill),e.textAlign){case"middle":{r.setAttribute("text-align","center"),r.setAttribute("text-anchor","start"),i.forEach((c,d)=>{const u=t.textMeasure.measureText({...Ct,text:o[d],fontFamily:e.fontFamily,fontSize:e.fontSize,width:"fit-content",padding:`${n}px`}).w;c.setAttribute("x",l+(e.width-u)/2+"")});break}case"end":{r.setAttribute("text-align","right"),r.setAttribute("text-anchor","start"),i.forEach((c,d)=>{const u=t.textMeasure.measureText({...Ct,text:o[d],fontFamily:e.fontFamily,fontSize:e.fontSize,width:"fit-content",padding:`${n}px`}).w;c.setAttribute("x",l+e.width-u+"")});break}default:r.setAttribute("text-align","left"),r.setAttribute("text-anchor","start"),i.forEach(c=>c.setAttribute("x",l+""))}return r}function Tv(t,e){const n=xe.useRef(e);n.current=e;const[r,o,i]=xe.useMemo(()=>{let s=null;const a=d=>(s=d,()=>{s=null}),l=new uu(`useStateTracking(${t})`,()=>{var d;return(d=n.current)==null?void 0:d.call(n)},{scheduleEffect(){s==null||s()}});return[l,a,()=>l.scheduleCount]},[t]);return xe.useSyncExternalStore(o,i,i),xe.useEffect(()=>(r.attach(),r.maybeScheduleEffect(),()=>{r.detach()}),[r]),r.execute()}var f1={apply(t,e,n){return Tv(t.displayName??t.name??"tracked(???)",()=>t.apply(e,n))}},mN=Symbol.for("react.memo"),yN=Symbol.for("react.forward_ref");function Me(t){let e=null;const n=t.$$typeof;return n===mN&&(t=t.type,e=t.compare),n===yN?w.memo(w.forwardRef(new Proxy(t.render,f1))):w.memo(new Proxy(t,f1),e)}function zI(t,e,n){return w.useMemo(()=>{const r=typeof e=="function"?e():e;return lt(`useAtom(${t})`,r,n)},[])}function vN(){const t=arguments[0],e=arguments[1],n=arguments.length===3?void 0:arguments[2],r=arguments.length===3?arguments[2]:arguments[3];return w.useMemo(()=>ue(`useComputed(${t})`,e,n),r)}function ge(){const t=arguments,e=t.length===3?t[2]:[t[0]],n=t.length===3?t[0]:`useValue(${t[0].name})`,r=w.useRef(!0);r.current=!0;const o=w.useMemo(()=>t.length===1?t[0]:ue(n,()=>{if(r.current)return t[1]();try{return t[1]()}catch{return{}}}),e);try{const{subscribe:i,getSnapshot:s}=w.useMemo(()=>({subscribe:a=>du(`useValue(${n})`,()=>{o.value,a()}),getSnapshot:()=>o.value}),[o]);return w.useSyncExternalStore(i,s,s)}finally{r.current=!1}}const Mv=xe.createContext({}),Z=()=>xe.useContext(Mv),Xt=w.memo(function({d:e,color:n,fill:r}){switch(r){case"none":return f.jsx("path",{className:"tl-hitarea-stroke",fill:"none",d:e});case"solid":return f.jsx("path",{className:"tl-hitarea-fill-solid",fill:`var(--palette-${n}-semi)`,d:e});case"semi":return f.jsx("path",{className:"tl-hitarea-fill-solid",fill:"var(--palette-solid)",d:e});case"pattern":return f.jsx(wN,{color:n,fill:r,d:e})}}),wN=function({d:e,color:n}){const r=Z(),o=ge("zoomLevel",()=>r.zoomLevel,[r]),i=ge("isDarkMode",()=>r.userDocumentSettings.isDarkMode,[r]),s=Math.ceil(o),a=r.zoomLevel<=.18;return f.jsxs(f.Fragment,{children:[f.jsx("path",{className:"tl-hitarea-fill-solid",fill:`var(--palette-${n}-pattern)`,d:e}),f.jsx("path",{fill:a?`var(--palette-${n}-semi)`:`url(#${Ah[s+(i?"_dark":"_light")]})`,d:e})]})};function Eo({d:t,color:e,fill:n,colors:r}){if(n==="none")return;if(n==="pattern"){const i=document.createElementNS("http://www.w3.org/2000/svg","g"),s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",t),s.setAttribute("fill",r.pattern[e]);const a=document.createElementNS("http://www.w3.org/2000/svg","path");return a.setAttribute("d",t),a.setAttribute("fill","url(#hash_pattern)"),i.appendChild(s),i.appendChild(a),i}const o=document.createElementNS("http://www.w3.org/2000/svg","path");switch(o.setAttribute("d",t),n){case"semi":{o.setAttribute("fill",r.solid);break}case"solid":{o.setAttribute("fill",r.semi[e]);break}}return o}function Wi(t,e){if(e){const n=document.createElementNS("http://www.w3.org/2000/svg","g");return n.appendChild(e),n.appendChild(t),n}else return t}class cl{constructor(){y(this,"items",new WeakMap)}get(e,n){return this.items.has(e)||this.items.set(e,n(e)),this.items.get(e)}access(e){return this.items.get(e)}set(e,n){this.items.set(e,n)}has(e){return this.items.has(e)}invalidate(e){this.items.delete(e)}bust(){this.items=new WeakMap}}var xN=Object.defineProperty,bN=Object.getOwnPropertyDescriptor,Av=(t,e,n,r)=>{for(var o=r>1?void 0:r?bN(e,n):e,i=t.length-1,s;i>=0;i--)(s=t[i])&&(o=(r?s(e,n,o):s(o))||o);return r&&o&&xN(e,n,o),o};const SN=new cl,EN=new cl;class Po{constructor(e,n){y(this,"canScroll",()=>!1);y(this,"canUnmount",()=>!0);y(this,"canBind",(e,n)=>!0);y(this,"canEdit",()=>!1);y(this,"canResize",()=>!0);y(this,"canCrop",()=>!1);y(this,"getEditingBounds",e=>this.bounds(e));y(this,"isClosed",()=>!0);y(this,"hideResizeHandles",()=>!1);y(this,"hideRotateHandle",()=>!1);y(this,"hideSelectionBoundsBg",()=>!1);y(this,"hideSelectionBoundsFg",()=>!1);y(this,"isAspectRatioLocked",()=>!1);y(this,"onBeforeCreate");y(this,"onBeforeUpdate");y(this,"onDragShapesOver");y(this,"onDragShapesOut");y(this,"onDropShapesOver");y(this,"onResizeStart");y(this,"onResize");y(this,"onResizeEnd");y(this,"onTranslateStart");y(this,"onTranslate");y(this,"onTranslateEnd");y(this,"onRotateStart");y(this,"onRotate");y(this,"onRotateEnd");y(this,"onHandleChange");y(this,"onBindingChange");y(this,"onChildrenChange");y(this,"onDoubleClickHandle");y(this,"onDoubleClickEdge");y(this,"onDoubleClick");y(this,"onClick");y(this,"onEditEnd");this.app=e,this.type=n}is(e){return e.type===this.type}get handlesCache(){return this.app.store.createComputedCache("handles:"+this.type,e=>this.getHandles(e))}handles(e){return this.getHandles?this.handlesCache.get(e.id)??Cr:Cr}get boundsCache(){return this.app.store.createComputedCache("bounds:"+this.type,e=>this.getBounds(e))}bounds(e){const n=this.boundsCache.get(e.id)??new de;return n.width===0||n.height===0?new de(n.x,n.y,Math.max(n.width,1),Math.max(n.height,1)):n}transform(e){return EN.get(e,n=>ee.Compose(ee.Translate(n.x,n.y),ee.Rotate(n.rotation)))}point(e){return SN.get(e,n=>({x:n.x,y:n.y}))}get outlineCache(){return this.app.store.createComputedCache("outline:"+this.type,e=>this.getOutline(e))}outline(e){return this.outlineCache.get(e.id)??Cr}snapPoints(e){return this.bounds(e).snapPoints}center(e){return this.getCenter(e)}canReceiveNewChildrenOfType(e){return!1}canDropShapes(e,n){return!1}hitTestPoint(e,n){return this.bounds(e).containsPoint(n)}hitTestLineSegment(e,n,r){const o=this.outline(e);for(let i=0;i<o.length;i++){const s=o[i],a=o[(i+1)%o.length];if(qo(n,r,s,a))return!0}return!1}expandSelectionOutlinePx(e){return 0}}Av([ue],Po.prototype,"handlesCache",1);Av([ue],Po.prototype,"boundsCache",1);Av([ue],Po.prototype,"outlineCache",1);function PN(t,e,n){const r=e==="end"?t.end.point:t.start.point,o=e==="end"?t.start.point:t.end.point,i=t.isStraight?I.Dist(o,r):Math.abs(t.bodyArc.length),s=Math.max(Math.min(i/5,n*3),n);let a;if(t.isStraight)a=I.Nudge(r,o,s);else{const l=q8(r,s,t.handleArc.center,t.handleArc.radius);a=e==="end"?t.handleArc.sweepFlag?l[0]:l[1]:t.handleArc.sweepFlag?l[1]:l[0]}return{point:r,int:a}}function _N({point:t,int:e}){const n=I.RotWith(e,t,ct/6),r=I.RotWith(e,t,-ct/6);return`M ${n.x} ${n.y} L ${t.x} ${t.y} L ${r.x} ${r.y}`}function IN({point:t,int:e}){const n=I.RotWith(e,t,ct/6),r=I.RotWith(e,t,-ct/6);return`M ${n.x} ${n.y} L ${t.x} ${t.y} L ${r.x} ${r.y} Z`}function CN({point:t,int:e}){const n=I.Sub(e,t).div(2),r=I.Add(t,I.Rot(n,Ye)),o=I.Sub(t,I.Rot(n,Ye));return`M ${r.x} ${r.y} L ${e.x} ${e.y} L ${o.x} ${o.y} Z`}function kN({point:t,int:e}){const n=I.Lrp(t,e,.45),r=I.Dist(n,t);return`M ${n.x-r},${n.y}
  a ${r},${r} 0 1,0 ${r*2},0
  a ${r},${r} 0 1,0 -${r*2},0 `}function $N({point:t,int:e}){const n=I.Lrp(t,e,.75),r=I.RotWith(n,t,ct/4),o=I.RotWith(n,t,-ct/4),i=I.Lrp(r,o,.5);return i.add(I.Sub(i,t)),`M ${i.x} ${i.y} L ${r.x} ${r.y} ${t.x} ${t.y} L ${o.x} ${o.y} Z`}function TN({int:t,point:e}){const n=I.Lrp(e,t,.85),r=I.Sub(n,e).div(2),o=I.Add(e,I.Rot(r,Ye)),i=I.Sub(e,I.Rot(r,Ye)),s=I.Add(n,I.Rot(r,Ye)),a=I.Sub(n,I.Rot(r,Ye));return`M ${o.x} ${o.y} L ${s.x} ${s.y} L ${a.x} ${a.y} L ${i.x} ${i.y} Z`}function MN({int:t,point:e}){const n=I.Sub(t,e).div(2),r=I.Add(e,I.Rot(n,Ye)),o=I.Sub(e,I.Rot(n,Ye));return`M ${r.x} ${r.y} L ${o.x} ${o.y}`}function Js(t,e,n){const r=e==="end"?t.end.arrowhead:t.start.arrowhead;if(r==="none")return;const o=PN(t,e,n);if(o){switch(r){case"bar":return MN(o);case"square":return TN(o);case"diamond":return $N(o);case"dot":return kN(o);case"inverted":return CN(o);case"arrow":return _N(o);case"triangle":return IN(o)}return""}}function Gl(t){return Math.abs(t.props.bend)<8}function Lh(t,e){if(e.type==="point")return;const n=t.getShapeById(e.boundShapeId),r=t.getShapeUtil(n),o=t.getPageTransform(n);return{shape:n,util:r,transform:o,isExact:e.isExact,didIntersect:!1}}function g1(t,e,n){if(n.type==="point")return I.From(n);const r=t.getShapeById(n.boundShapeId);if(r){const{point:o,size:i}=t.getBounds(r),s=I.Add(o,I.MulV(n.normalizedAnchor,i)),a=ee.applyToPoint(t.getPageTransform(r),s);return ee.applyToPoint(ee.Inverse(e),a)}else return console.error("Expected a bound shape!"),new I(0,0)}function Yr(t,e){const n=t.getPageTransform(e),r=g1(t,n,e.props.start),o=g1(t,n,e.props.end);return{start:r,end:o}}function Dh(t,e){const{start:n,end:r,arrowheadStart:o,arrowheadEnd:i}=e.props,s=Yr(t,e),a=s.start.clone(),l=s.end.clone(),c=I.Med(a,l),d=I.Sub(l,a).uni(),u=Lh(t,n),h=Lh(t,r),p=t.getPageTransform(e);m1(l,s.start,p,h),m1(a,s.end,p,u);let g=ms;const m=u&&h&&u.shape===h.shape;u&&h&&!m&&!u.isExact&&!h.isExact&&(h.didIntersect&&!u.didIntersect?u.util.isClosed(u.shape)&&a.setTo(I.Nudge(l,a,g)):h.didIntersect||h.util.isClosed(h.shape)&&l.setTo(I.Nudge(a,l,g)));const v=I.Sub(l,a).uni(),x=!I.Equals(v,d);if(!m){if(u&&o!=="none"&&!u.isExact){const E=Rh+t.getStrokeWidth(e.props.size)/2+("size"in u.shape.props?t.getStrokeWidth(u.shape.props.size)/2:0);g-=E,a.nudge(l,E*(x?-1:1))}if(h&&i!=="none"&&!h.isExact){const E=Rh+t.getStrokeWidth(e.props.size)/2+("size"in h.shape.props?t.getStrokeWidth(h.shape.props.size)/2:0);g-=E,l.nudge(a,E*(x?-1:1))}}u&&h&&(x?l.setTo(I.Add(a,v.mul(-g))):I.Dist(a,l)<ms/2&&l.setTo(I.Add(a,v.mul(ms/2)))),x?c.setTo(I.Med(s.start,s.end)):c.setTo(I.Med(a,l));const b=I.Dist(a,l);return{isStraight:!0,start:{handle:s.start,point:a,arrowhead:e.props.arrowheadStart},end:{handle:s.end,point:l,arrowhead:e.props.arrowheadEnd},middle:c,isValid:b>0,length:b}}function m1(t,e,n,r){if(r===void 0||r.isExact)return;const o=ee.applyToPoint(n,e),i=ee.applyToPoint(n,t),s=ee.applyToPoint(ee.Inverse(r.transform),o),a=ee.applyToPoint(ee.Inverse(r.transform),i),l=r.util.isClosed(r.shape),d=(l?G8:kv)(s,a,r.util.outline(r.shape));let u;if(d!==null&&(u=d.sort((g,m)=>I.Dist(g,s)-I.Dist(m,s))[0]??(l?void 0:a)),u===void 0)return;const h=ee.applyToPoint(r.transform,u),p=ee.applyToPoint(ee.Inverse(n),h);t.setTo(p),r.didIntersect=!0}function AN(t){return UI(t.start.handle,t.end.handle)}function fg(t){return UI(t.start.point,t.end.point)}function UI(t,e){return`M${t.x},${t.y}L${e.x},${e.y}`}function py(t,e,n=0){const{arrowheadEnd:r,arrowheadStart:o}=e.props,i=e.props.bend+n;if(Math.abs(i)>Math.abs(e.props.bend*pN))return Dh(t,e);const s=Yr(t,e),a=I.Med(s.start,s.end),l=I.Sub(s.end,s.start).uni(),c=I.Add(a,l.per().mul(-i)),d=Lh(t,e.props.start),u=Lh(t,e.props.end),h=s.start.clone(),p=s.end.clone(),g=c.clone(),m=y1(h,p,g),v=t.getPageTransform(e);if(d&&!d.isExact){const C=ee.applyToPoint(v,h),k=ee.applyToPoint(v,p),$=ee.applyToPoint(v,m.center),A=ee.Inverse(d.transform),D=ee.applyToPoint(A,C),j=ee.applyToPoint(A,k),Y=ee.applyToPoint(A,$),V=d.util.isClosed(d.shape),q=V?c1:u1;let F,X=q(Y,m.radius,d.util.outline(d.shape));if(X){X=X.filter(H=>+I.Clockwise(D,H,j)===m.sweepFlag);const ne=I.Angle(m.center,c),ie=I.Angle(m.center,s.start),W=is(ne,ie,.5);X.sort((H,G)=>Math.abs(wi(W,Y.angle(H)))-Math.abs(wi(W,Y.angle(G)))),F=X[0]??(V?void 0:D)}else F=V?void 0:D;if(F&&(h.setTo(t.getPointInShapeSpace(e,ee.applyToPoint(d.transform,F))),d.didIntersect=!0,o!=="none")){const ne=Rh+t.getStrokeWidth(e.props.size)/2+("size"in d.shape.props?t.getStrokeWidth(d.shape.props.size)/2:0);h.setTo(as(m.center.x,m.center.y,m.radius,is(I.Angle(m.center,h),I.Angle(m.center,c),ne/Math.abs(Qu(m.center,m.radius,h,c)))))}}if(u&&!u.isExact){const C=ee.applyToPoint(v,h),k=ee.applyToPoint(v,p),$=ee.applyToPoint(v,m.center),A=ee.Inverse(u.transform),D=ee.applyToPoint(A,C),j=ee.applyToPoint(A,k),Y=ee.applyToPoint(A,$),V=u.util.isClosed(u.shape),q=V?c1:u1,F=I.Angle(m.center,c),X=I.Angle(m.center,s.end),ne=is(F,X,.5);let ie,W=q(Y,m.radius,u.util.outline(u.shape));if(W?(W=W.filter(H=>+I.Clockwise(D,H,j)===m.sweepFlag),W.sort((H,G)=>Math.abs(wi(ne,Y.angle(H)))-Math.abs(wi(ne,Y.angle(G)))),ie=W[0]??(V?void 0:j)):ie=V?void 0:j,ie&&(p.setTo(t.getPointInShapeSpace(e,ee.applyToPoint(u.transform,ie))),u.didIntersect=!0,r!=="none")){let H=Rh+t.getStrokeWidth(e.props.size)/2+("size"in u.shape.props?t.getStrokeWidth(u.shape.props.size)/2:0);I.Dist(h,p)<ms&&(H*=-2),p.setTo(as(m.center.x,m.center.y,m.radius,is(I.Angle(m.center,p),I.Angle(m.center,c),H/Math.abs(Qu(m.center,m.radius,p,c)))))}}if(Math.abs(Qu(m.center,m.radius,h,p))<ms/2&&(h.setTo(s.start),p.setTo(s.end)),d&&u&&d.shape!==u.shape&&!d.isExact&&!u.isExact){const C=I.Angle(m.center,h),k=I.Angle(m.center,p),$=m.sweepFlag?ms:-ms,A=Qu(m.center,m.radius,p,h),{center:{x:D,y:j},radius:Y}=m;d&&!d.didIntersect&&h.setTo(as(D,j,Y,is(C,k,$/A))),u&&!u.didIntersect&&p.setTo(as(D,j,Y,is(C,k,-$/A)))}let b=is(I.Angle(m.center,h),I.Angle(m.center,p),.5),E=as(m.center.x,m.center.y,m.radius,b);+I.Clockwise(h,E,p)!==m.sweepFlag&&(b+=ct,E=as(m.center.x,m.center.y,m.radius,b)),g.setTo(E);const P=y1(h,p,g);return{isStraight:!1,start:{point:h,handle:s.start,arrowhead:e.props.arrowheadStart},end:{point:p,handle:s.end,arrowhead:e.props.arrowheadEnd},middle:g,handleArc:m,bodyArc:P,isValid:P.length!==0&&isFinite(P.center.x)&&isFinite(P.center.y)}}function RN(t){const{start:e,end:n,handleArc:{radius:r,largeArcFlag:o,sweepFlag:i}}=t;return`M${e.handle.x},${e.handle.y} A${r} ${r} 0 ${o} ${i} ${n.handle.x},${n.handle.y}`}function gg(t){const{start:e,end:n,bodyArc:{radius:r,largeArcFlag:o,sweepFlag:i}}=t;return`M${e.point.x},${e.point.y} A${r} ${r} 0 ${o} ${i} ${n.point.x},${n.point.y}`}function y1(t,e,n){const r=-2*(t.x*(e.y-n.y)-t.y*(e.x-n.x)+e.x*n.y-n.x*e.y),o={x:((t.x*t.x+t.y*t.y)*(n.y-e.y)+(e.x*e.x+e.y*e.y)*(t.y-n.y)+(n.x*n.x+n.y*n.y)*(e.y-t.y))/r,y:((t.x*t.x+t.y*t.y)*(e.x-n.x)+(e.x*e.x+e.y*e.y)*(n.x-t.x)+(n.x*n.x+n.y*n.y)*(t.x-e.x))/r},i=I.Dist(o,t),s=+I.Clockwise(t,n,e),a=Math.hypot(t.y-e.y,t.x-e.x),l=Math.hypot(e.y-n.y,e.x-n.x),c=Math.hypot(n.y-t.y,n.x-t.x),d=Math.acos((l*l+c*c-a*a)/(2*l*c))*2,u=+(ct>d),h=(dt-d)*(s?1:-1),p=h*i;return{center:o,radius:i,size:h,length:p,largeArcFlag:u,sweepFlag:s}}const Gt={preventDefaultLogging:Nr("tldrawPreventDefaultLogging",!1),pointerCaptureLogging:Nr("tldrawPointerCaptureLogging",!1),pointerCaptureTracking:Nr("tldrawPointerCaptureTracking",!1),pointerCaptureTrackingObject:Nr("tldrawPointerCaptureTrackingObject",new Map,!1),elementRemovalLogging:Nr("tldrawElementRemovalLogging",!1),debugSvg:Nr("tldrawDebugSvg",!1),throwToBlob:Nr("tldrawThrowToBlob",!1),peopleMenu:Nr("tldrawPeopleMenu",!1),logMessages:Nr("tldrawUiLog",[]),resetConnectionEveryPing:Nr("tldrawResetConnectionEveryPing",!1),newLiveCollaborators:Nr("tldrawNewLiveCollaborators",!1)};Gt.logMessages.set([]);typeof window<"u"&&(window.tldrawLog=t=>{Gt.logMessages.set(Gt.logMessages.value.concat(t))});if(typeof Element<"u"){const t=Element.prototype.removeChild;du("element removal logging",()=>{Gt.elementRemovalLogging.value?Element.prototype.removeChild=function(e){return console.warn("[tldraw] removing child:",e),t.call(this,e)}:Element.prototype.removeChild=t})}function Nr(t,e,n=!0){if(typeof window>"u")return lt(`debug:${t}`,e);const r=n?LN(t):null,o=lt(`debug:${t}`,r??e);return n&&du(`debug:${t}`,()=>{const i=o.value;try{i===e?window.sessionStorage.removeItem(`debug:${t}`):window.sessionStorage.setItem(`debug:${t}`,JSON.stringify(i))}catch{}}),Object.defineProperty(window,t,{get(){return o.value},set(i){o.set(i)},configurable:!0}),o}function LN(t){try{return JSON.parse(window.sessionStorage.getItem(`debug:${t}`)??"null")}catch{return null}}function Oh(t){if(t instanceof HTMLElement)return t;if(t.parentElement)return Oh(t.parentElement);throw Error("Could not find a parent element of an HTML type!")}function Ve(t){t.preventDefault(),Gt.preventDefaultLogging.value&&console.warn("preventDefault called on event:",t)}function fu(t,e){if(t.setPointerCapture(e.pointerId),Gt.pointerCaptureTracking.value){const n=Gt.pointerCaptureTrackingObject.value;n.set(t,(n.get(t)??0)+1)}Gt.pointerCaptureLogging.value&&console.warn("setPointerCapture called on element:",t,e)}function gu(t,e){if(t.hasPointerCapture(e.pointerId)){if(t.releasePointerCapture(e.pointerId),Gt.pointerCaptureTracking.value){const n=Gt.pointerCaptureTrackingObject.value;n.get(t)===1?n.delete(t):n.has(t)?n.set(t,n.get(t)-1):console.warn("Release without capture")}Gt.pointerCaptureLogging.value&&console.warn("releasePointerCapture called on element:",t,e)}}function Rv(t,e){return e.map(r=>{const{offsetX:o,offsetY:i,blur:s,spread:a,color:l}=r,c=new I(o,i),{x:d,y:u}=c.rot(-t);return`${d}px ${u}px ${s}px ${a}px ${l}`}).join(", ")}function FI(){const[t,e]=w.useState(!1);return w.useEffect(()=>{const n=window.matchMedia("(prefers-reduced-motion: reduce)"),r=()=>{e(n.matches)};return r(),n.addEventListener("change",r),()=>n.removeEventListener("change",r)},[]),t}const mg=(t,e)=>t.length<=e?t:t.substring(0,e-3)+"...",yo=t=>t.stopPropagation(),vs="  ",On=class{static insertTextFirefox(e,n){e.setRangeText(n,e.selectionStart||0,e.selectionEnd||0,"end"),e.dispatchEvent(new InputEvent("input",{data:n,inputType:"insertText",isComposing:!1}))}static insert(e,n){const r=e.ownerDocument,o=r.activeElement;o!==e&&e.focus(),r.execCommand("insertText",!1,n)||On.insertTextFirefox(e,n),o===r.body?e.blur():o instanceof HTMLElement&&o!==e&&o.focus()}static set(e,n){e.select(),On.insert(e,n)}static getSelection(e){const{selectionStart:n,selectionEnd:r}=e;return e.value.slice(n||void 0,r||void 0)}static wrapSelection(e,n,r){const{selectionStart:o,selectionEnd:i}=e,s=On.getSelection(e);On.insert(e,n+s+(r??n)),e.selectionStart=(o||0)+n.length,e.selectionEnd=(i||0)+n.length}static replace(e,n,r){let o=0;e.value.replace(n,(...i)=>{const s=o+i[i.length-2],a=i[0].length;e.selectionStart=s,e.selectionEnd=s+a;const l=typeof r=="string"?r:r(...i);return On.insert(e,l),e.selectionStart=s,o+=l.length-a,l})}static findLineEnd(e,n){const r=e.lastIndexOf(`
`,n-1)+1;return e.charAt(r)!=="	"?n:r+1}static indent(e){var a;const{selectionStart:n,selectionEnd:r,value:o}=e,i=o.slice(n,r),s=(a=/\n/g.exec(i))==null?void 0:a.length;if(s&&s>0){const l=o.lastIndexOf(`
`,n-1)+1,c=e.value.slice(l,r-1),d=c.replace(/^|\n/g,`$&${vs}`),u=d.length-c.length;e.setSelectionRange(l,r-1),On.insert(e,d),e.setSelectionRange(n+1,r+u)}else On.insert(e,vs)}static unindent(e){const{selectionStart:n,selectionEnd:r,value:o}=e,i=o.lastIndexOf(`
`,n-1)+1,s=On.findLineEnd(o,r),a=e.value.slice(i,s),l=a.replace(/(^|\n)(\t| {1,2})/g,"$1"),c=a.length-l.length;e.setSelectionRange(i,s),On.insert(e,l);const d=/\t| {1,2}/.exec(o.slice(i,n)),u=d?d[0].length:0,h=n-u;e.setSelectionRange(n-u,Math.max(h,r-c))}static indentCE(e){var l;const n=window.getSelection(),r=e.innerText,o=ed(e)??0,i=ed(e)??0,s=r.slice(o,i),a=(l=/\n/g.exec(s))==null?void 0:l.length;if(a&&a>0){const c=r.lastIndexOf(`
`,o-1)+1,d=r.slice(c,i-1),h=d.replace(/^|\n/g,`$&${vs}`).length-d.length;n&&n.setBaseAndExtent(e,o+1,e,i+h)}else{const c=window.getSelection();e.innerText=r.slice(0,o)+vs+r.slice(o),c==null||c.setBaseAndExtent(e,o+1,e,o+2)}}static unindentCE(e){const n=window.getSelection(),r=e.innerText,o=ed(e)??0,i=ed(e)??0,s=r.lastIndexOf(`
`,o-1)+1,a=On.findLineEnd(r,i),l=r.slice(s,a),c=l.replace(/(^|\n)(\t| {1,2})/g,"$1"),d=l.length-c.length;if(n){n.setBaseAndExtent(e,s,e,a);const u=/\t| {1,2}/.exec(r.slice(s,o)),h=u?u[0].length:0,p=o-h;n.setBaseAndExtent(e,o-h,e,Math.max(p,i-d))}}static normalizeText(e){return e.replace(On.fixNewLines,`
`)}static normalizeTextForDom(e){return e.replace(On.fixNewLines,`
`).split(`
`).map(n=>n||" ").join(`
`)}};let Ho=On;y(Ho,"fixNewLines",/\r?\n|\r/g);function ed(t){if(typeof window.getSelection>"u")return;const e=window.getSelection();if(!e)return;let n=0;if(e.rangeCount!==0){const r=e.getRangeAt(0),o=r.cloneRange();o.selectNodeContents(t),o.setEnd(r.endContainer,r.endOffset),n=o.toString().length}return n}function Lv(t,e,n){const r=Z(),o=w.useRef(null),i=ge("isEditing",()=>r.pageState.editingId===t,[r,t]),s=w.useRef(!1),a=w.useRef(),l=ge("is editable hovering",()=>{if(e==="text"&&r.isIn("text")&&r.hoveredId===t)return!0;if(r.isIn("select.editing_shape")){const{editingShape:g}=r;return g?r.hoveredId===t&&g.type===e&&r.getShapeUtil(g).canEdit(g):!1}return!1},[e,t]),c=w.useCallback(()=>{l||requestAnimationFrame(()=>{const g=o.current;if(!g)return;const m=r.getShapeById(t);m&&(g.value=m.props.text,g.value.length&&!s.current&&g.select(),s.current=!1)})},[r,t,l]),d=w.useCallback(()=>{const g=a.current;requestAnimationFrame(()=>{var v;const m=o.current;if(r.isIn("select.editing_shape")&&m)if(g)if(!g.length)m.focus();else{s.current=!0,m.focus();const x=window.getSelection();x&&g.forEach(b=>x.addRange(b))}else m.focus();else(v=window.getSelection())==null||v.removeAllRanges(),r.complete()})},[r]),u=w.useCallback(g=>{switch((g.ctrlKey||g.metaKey)&&yo(g),g.key){case"Enter":{(g.ctrlKey||g.metaKey)&&r.complete();break}case"Tab":{Ve(g),g.shiftKey?Ho.unindent(g.currentTarget):Ho.indent(g.currentTarget);break}}},[r]),h=w.useCallback(g=>{let m=Ho.normalizeText(g.currentTarget.value);const v=m.replace(/\t/g,vs);if(v!==m){const x=g.currentTarget.selectionStart;g.currentTarget.value=v,g.currentTarget.selectionStart=x+(v.length-m.length),g.currentTarget.selectionEnd=x+(v.length-m.length),m=v}r.updateShapes([{id:t,type:e,props:{text:m}}])},[r,t,e]),p=n.trim().length===0;return w.useEffect(()=>{if(o.current){let m=function(){var x,b;const v=(x=window.getSelection)==null?void 0:x.call(window);if(v&&v.type!=="None"){const E=[];if(v)for(let P=0;P<v.rangeCount;P++)E.push((b=v.getRangeAt)==null?void 0:b.call(v,P));a.current=E}};return document.addEventListener("selectionchange",m),()=>{document.removeEventListener("selectionchange",m)}}}),{rInput:o,isEditing:i,isEditableFromHover:l,handleFocus:c,handleBlur:d,handleKeyDown:u,handleChange:h,isEmpty:p}}const DN=w.memo(function({id:e,text:n,size:r,font:o,position:i,width:s,labelColor:a}){const{rInput:l,isEditing:c,handleFocus:d,handleBlur:u,handleKeyDown:h,handleChange:p,isEmpty:g}=Lv(e,"arrow",n);return!c&&g?null:f.jsx("div",{className:"tl-arrow-label","data-font":o,"data-align":"center","data-hastext":!g,"data-isediting":c,style:{textAlign:"center",fontSize:hi[r],lineHeight:hi[r]*Ct.lineHeight+"px",transform:`translate(${i.x}px, ${i.y}px)`,color:a},children:f.jsxs("div",{className:"tl-arrow-label__inner",children:[f.jsx("p",{style:{width:s||"9px"},children:n?Ho.normalizeTextForDom(n):" "}),c&&f.jsx("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,onFocus:d,onChange:p,onKeyDown:h,onBlur:u,onContextMenu:yo})]})})});var ON=Object.defineProperty,jN=Object.getOwnPropertyDescriptor,KI=(t,e,n,r)=>{for(var o=r>1?void 0:r?jN(e,n):e,i=t.length-1,s;i>=0;i--)(s=t[i])&&(o=(r?s(e,n,o):s(o))||o);return r&&o&&ON(e,n,o),o};let NN=0;class Op extends Po{constructor(){super(...arguments);y(this,"canEdit",()=>!0);y(this,"canBind",()=>!1);y(this,"isClosed",()=>!1);y(this,"hideResizeHandles",()=>!0);y(this,"hideRotateHandle",()=>!0);y(this,"hideSelectionBoundsFg",()=>!0);y(this,"hideSelectionBoundsBg",()=>!0);y(this,"onHandleChange",(n,{handle:r,isPrecise:o})=>{const i=Fn(n);switch(r.id){case"start":case"end":{const s=this.app.getPageTransformById(i.id),a=ee.applyToPoint(s,r);if(this.app.inputs.ctrlKey)i.props[r.id]={type:"point",x:r.x,y:r.y};else{const l=wr(this.app.sortedShapesArray.filter(c=>{if(c.id===n.id)return;const d=this.app.getShapeUtil(c);if(!d.canBind(c))return;const u=this.app.getPageMaskById(c.id);if(u&&!$r(a,u))return;const h=this.app.getPointInShapeSpace(c,a);return d.isClosed(c)?$r(h,d.outline(c)):d.hitTestPoint(c,h)}));if(l){const c=this.app.getBounds(l),d=this.app.getPointInShapeSpace(l,a),u=i.props[r.id],h=n.props.start.type==="binding"&&n.props.start.boundShapeId,p=n.props.end.type==="binding"&&n.props.end.boundShapeId;let g=o||(h||p)&&h===p||!this.app.getShapeUtil(l).isClosed(i);(u.type==="point"||u.type==="binding"&&l.id!==u.boundShapeId)&&(g=this.app.inputs.pointerVelocity.len()<.5),g&&(g=I.Dist(d,c.center)>Math.max(4,Math.min(Math.min(c.width,c.height)*.15,16))/this.app.zoomLevel),i.props[r.id]={type:"binding",boundShapeId:l.id,normalizedAnchor:g?{x:(d.x-c.minX)/c.width,y:(d.y-c.minY)/c.height}:{x:.5,y:.5},isExact:this.app.inputs.altKey}}else i.props[r.id]={type:"point",x:r.x,y:r.y}}break}case"middle":{const{start:s,end:a}=Yr(this.app,i),l=I.Sub(a,s),c=I.Per(l),d=I.Med(a,s),u=I.Sub(d,c),h=I.Add(d,c),p=I.NearestPointOnLineSegment(u,h,r,!1);let g=I.Dist(p,d);I.Clockwise(p,a,d)&&(g*=-1),i.props.bend=g;break}}return i});y(this,"onTranslateStart",n=>{let r=n.props.start.type==="binding"?n.props.start.boundShapeId:null,o=n.props.end.type==="binding"?n.props.end.boundShapeId:null;if(r&&this.app.isWithinSelection(r)||o&&this.app.isWithinSelection(o))return;r=null,o=null;const{start:i,end:s}=Yr(this.app,n);return{id:n.id,type:n.type,props:{...n.props,start:{type:"point",x:i.x,y:i.y},end:{type:"point",x:s.x,y:s.y}}}});y(this,"onResize",(n,r)=>{const{scaleX:o,scaleY:i}=r,s=Yr(this.app,n),{start:a,end:l}=Fn(n.props);let{bend:c}=n.props;a.type==="point"&&(a.x=s.start.x*o,a.y=s.start.y*i),l.type==="point"&&(l.x=s.end.x*o,l.y=s.end.y*i);const d=Math.abs(o),u=Math.abs(i);return o<0&&i>=0?(c!==0&&(c*=-1,c*=Math.max(d,u)),a.type==="binding"&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x)):o>=0&&i<0?(c!==0&&(c*=-1,c*=Math.max(d,u)),a.type==="binding"&&(a.normalizedAnchor.y=1-a.normalizedAnchor.y),l.type==="binding"&&(l.normalizedAnchor.y=1-l.normalizedAnchor.y)):o>=0&&i>=0?c!==0&&(c*=Math.max(d,u)):o<0&&i<0&&(c!==0&&(c*=Math.max(d,u)),a.type==="binding"&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x,a.normalizedAnchor.y=1-a.normalizedAnchor.y),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x,l.normalizedAnchor.y=1-l.normalizedAnchor.y)),{props:{start:a,end:l,bend:c}}});y(this,"onDoubleClickHandle",(n,r)=>{switch(r.id){case"start":return{id:n.id,type:n.type,props:{...n.props,arrowheadStart:n.props.arrowheadStart==="none"?"arrow":"none"}};case"end":return{id:n.id,type:n.type,props:{...n.props,arrowheadEnd:n.props.arrowheadEnd==="none"?"arrow":"none"}}}});y(this,"getEditingBounds",n=>this.getLabelBounds(n)??new de);y(this,"onEditEnd",n=>{const{id:r,type:o,props:{text:i}}=n;i.trimEnd()!==n.props.text&&this.app.updateShapes([{id:r,type:o,props:{text:i.trimEnd()}}])})}defaultProps(){return{opacity:"1",dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:0,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}getCenter(n){return this.bounds(n).center}getBounds(n){return de.FromPoints(this.getOutlineWithoutLabel(n))}getOutlineWithoutLabel(n){const r=this.getArrowInfo(n);if(!r)return[];if(r.isStraight)return r.isValid?[r.start.point,r.end.point]:[new I(0,0),new I(1,1)];if(!r.isValid)return[new I(0,0),new I(1,1)];const o=Math.max(5,Math.ceil(Math.abs(r.bodyArc.length)/16));if(o<=0&&!isFinite(o))return[new I(0,0),new I(1,1)];const i=Array(o),s=I.Angle(r.bodyArc.center,r.start.point),a=I.Angle(r.bodyArc.center,r.end.point),l=r.bodyArc.sweepFlag?a:s,c=r.bodyArc.sweepFlag?s:a,d=r.bodyArc.largeArcFlag?-L8(l,c):wi(l,c),u=Math.max(1,r.bodyArc.radius);for(let h=0;h<o;h++){const p=h/(o-1),g=l+d*p,m=as(r.bodyArc.center.x,r.bodyArc.center.y,u,g);i[h]=m}return i}getOutline(n){const r=this.getOutlineWithoutLabel(n),o=this.getLabelBounds(n);if(!o)return r;const i=o.sides,s=[0,1,2,3];let a=r[0],l=!1;const c=[a];for(let d=1;d<r.length;d++){const u=r[d];if(!l){const h=Gj(s.filter(p=>qo(i[p][0],i[p][1],a,u)),p=>I.DistanceToLineSegment(i[p][0],i[p][1],a));if(h!==void 0){const p=I.NearestPointOnLineSegment(i[h][0],i[h][1],a);c.push(p);for(let g=0;g<4;g++){const m=(h+g)%4;c.push(i[m][1])}c.push(p),l=!0}}c.push(u),a=u}return c}snapPoints(n){return Cr}get infoCache(){return this.app.store.createComputedCache("arrow infoCache",n=>Gl(n)?Dh(this.app,n):py(this.app,n))}getArrowInfo(n){return this.infoCache.get(n.id)}getHandles(n){const r=this.infoCache.get(n.id);return[{id:"start",type:"vertex",index:"a0",x:r.start.handle.x,y:r.start.handle.y,canBind:!0},{id:"middle",type:"vertex",index:"a2",x:r.middle.x,y:r.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:r.end.handle.x,y:r.end.handle.y,canBind:!0}]}hitTestPoint(n,r){const o=this.outline(n),i=this.app.zoomLevel,s=this.app.getStrokeWidth(n.props.size)/i;for(let a=0;a<o.length-1;a++){const l=o[a],c=o[a+1];if(I.DistanceToLineSegment(l,c,r)<s)return!0}return!1}hitTestLineSegment(n,r,o){const i=this.outline(n);for(let s=0;s<i.length-1;s++){const a=i[s],l=i[s+1];if(qo(r,o,a,l))return!0}return!1}render(n){const r=this.app.onlySelectedShape,o=this.app.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.app.isReadOnly,i=this.getArrowInfo(n),s=this.bounds(n),a=this.getLabelBounds(n),l=w.useMemo(()=>this.app.isSafari?NN+=1:0,[n]);if(!(i!=null&&i.isValid))return null;const c=this.app.getStrokeWidth(n.props.size),d=i.start.arrowhead&&Js(i,"start",c),u=i.end.arrowhead&&Js(i,"end",c),h=i.isStraight?fg(i):gg(i);let p=null;if(r===n&&o){const{strokeDasharray:C,strokeDashoffset:k}=_n(i.isStraight?I.Dist(i.start.handle,i.end.handle):Math.abs(i.handleArc.length),2,{end:"skip",start:"skip",lengthRatio:2.5});p=n.props.start.type==="binding"||n.props.end.type==="binding"?f.jsx("path",{className:"tl-arrow-hint",d:i.isStraight?AN(i):RN(i),strokeDasharray:C,strokeDashoffset:k,strokeWidth:2,markerStart:n.props.start.type==="binding"?n.props.start.isExact?"":x1(n.props.start.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:n.props.end.type==="binding"?n.props.end.isExact?"":x1(n.props.end.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}const{strokeDasharray:g,strokeDashoffset:m}=_n(i.isStraight?i.length:Math.abs(i.bodyArc.length),c,{style:n.props.dash}),v=!(i.start.arrowhead==="none"||i.start.arrowhead==="arrow"),x=!(i.end.arrowhead==="none"||i.end.arrowhead==="arrow"),b=v||x||a,E=(n.id+"_clip_"+l).replace(":","_");return f.jsxs(f.Fragment,{children:[f.jsxs(xr,{id:n.id,style:{minWidth:50,minHeight:50},children:[b&&f.jsx("defs",{children:f.jsxs("mask",{id:E,children:[f.jsx("rect",{x:U(-100+s.minX),y:U(-100+s.minY),width:U(s.width+200),height:U(s.height+200),fill:"white"}),a&&f.jsx("rect",{x:U(a.x),y:U(a.y),width:U(a.w),height:U(a.h),fill:"black",rx:4,ry:4}),d&&v&&f.jsx("path",{d,fill:i.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),u&&x&&f.jsx("path",{d:u,fill:i.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),f.jsxs("g",{fill:"none",stroke:"currentColor",strokeWidth:c,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[p,f.jsxs("g",{...b?{mask:`url(#${E})`}:void 0,children:[b&&f.jsx("rect",{x:U(s.minX-100),y:U(s.minY-100),width:U(s.width+200),height:U(s.height+200),opacity:0}),f.jsx("path",{d:h,strokeDasharray:g,strokeDashoffset:m})]}),d&&v&&n.props.fill!=="none"&&f.jsx(Xt,{d,color:n.props.color,fill:n.props.fill}),u&&x&&n.props.fill!=="none"&&f.jsx(Xt,{d:u,color:n.props.color,fill:n.props.fill}),d&&f.jsx("path",{d}),u&&f.jsx("path",{d:u})]}),f.jsx("path",{d:h,className:"tl-hitarea-stroke"})]}),f.jsx(DN,{id:n.id,text:n.props.text,font:n.props.font,size:n.props.size,position:i.middle,width:(a==null?void 0:a.w)??0,labelColor:this.app.getCssColor(n.props.labelColor)})]})}indicator(n){const{start:r,end:o}=Yr(this.app,n),i=this.getArrowInfo(n),s=this.bounds(n),a=this.getLabelBounds(n);if(!i||I.Equals(r,o))return null;const l=this.app.getStrokeWidth(n.props.size),c=i.start.arrowhead&&Js(i,"start",l),d=i.end.arrowhead&&Js(i,"end",l),u=i.isStraight?fg(i):gg(i),h=c&&i.start.arrowhead!=="arrow"||d&&i.end.arrowhead!=="arrow"||a!==null,p=(n.id+"_clip").replace(":","_");return f.jsxs("g",{children:[h&&f.jsx("defs",{children:f.jsxs("mask",{id:p,children:[f.jsx("rect",{x:s.minX-100,y:s.minY-100,width:s.w+200,height:s.h+200,fill:"white"}),a&&f.jsx("rect",{x:a.x,y:a.y,width:a.w,height:a.h,fill:"black",rx:4,ry:4}),c&&f.jsx("path",{d:c,fill:i.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),d&&f.jsx("path",{d,fill:i.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),f.jsxs("g",{...h?{mask:`url(#${p})`}:void 0,children:[h&&f.jsx("rect",{x:s.minX-100,y:s.minY-100,width:s.width+200,height:s.height+200,opacity:0}),f.jsx("path",{d:u})]}),c&&f.jsx("path",{d:c}),d&&f.jsx("path",{d}),a&&f.jsx("rect",{x:a.x,y:a.y,width:a.w,height:a.h,rx:4,ry:4})]})}get labelBoundsCache(){return this.app.store.createComputedCache("labelBoundsCache",n=>{const r=this.getArrowInfo(n),o=this.bounds(n),{text:i,font:s,size:a}=n.props;if(!r||!i.trim())return null;const{w:l,h:c}=this.app.textMeasure.measureText({...Ct,text:i,fontFamily:Ko[s],fontSize:hi[a],width:"fit-content"});let d=l,u=c;if(o.width>o.height){d=Math.max(Math.min(l,64),Math.min(o.width-64,l));const{w:h,h:p}=this.app.textMeasure.measureText({...Ct,text:i,fontFamily:Ko[s],fontSize:hi[a],width:d+"px"});d=h,u=p}if(d>16*hi[a]){d=16*hi[a];const{w:h,h:p}=this.app.textMeasure.measureText({...Ct,text:i,fontFamily:Ko[s],fontSize:hi[a],width:d+"px"});d=h,u=p}return new de(r.middle.x-(d+8)/2,r.middle.y-(u+8)/2,d+8,u+8)})}getLabelBounds(n){return this.labelBoundsCache.get(n.id)||null}toSvg(n,r,o){const i=o.fill[n.props.color],s=this.getArrowInfo(n),a=this.app.getStrokeWidth(n.props.size),l=document.createElementNS("http://www.w3.org/2000/svg","g");if(!s)return l;const c=s.start.arrowhead&&Js(s,"start",a),d=s.end.arrowhead&&Js(s,"end",a),u=this.bounds(n),h=this.getLabelBounds(n),p=(n.id+"_clip").replace(":","_");if(c||d||h){const E=document.createElementNS("http://www.w3.org/2000/svg","defs"),P=document.createElementNS("http://www.w3.org/2000/svg","mask");P.id=p;const C=document.createElementNS("http://www.w3.org/2000/svg","rect");if(C.setAttribute("x",u.minX-100+""),C.setAttribute("y",u.minY-100+""),C.setAttribute("width",u.width+200+""),C.setAttribute("height",u.height+200+""),C.setAttribute("fill","white"),P.appendChild(C),c&&P.appendChild(v1(c,s.start.arrowhead)),d&&P.appendChild(v1(d,s.end.arrowhead)),h){const k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.setAttribute("x",h.x+""),k.setAttribute("y",h.y+""),k.setAttribute("width",h.w+""),k.setAttribute("height",h.h+""),k.setAttribute("fill","black"),P.appendChild(k)}E.appendChild(P),l.appendChild(E)}const g=document.createElementNS("http://www.w3.org/2000/svg","g");g.setAttribute("mask",`url(#${p})`),l.appendChild(g);const m=document.createElementNS("http://www.w3.org/2000/svg","rect");m.setAttribute("x","-100"),m.setAttribute("y","-100"),m.setAttribute("width",u.width+200+""),m.setAttribute("height",u.height+200+""),m.setAttribute("fill","transparent"),m.setAttribute("stroke","none"),g.appendChild(m);const v=BN(s.isStraight?fg(s):gg(s),i,a),{strokeDasharray:x,strokeDashoffset:b}=_n(s.isStraight?s.length:Math.abs(s.bodyArc.length),a,{style:n.props.dash});if(v.setAttribute("stroke-dasharray",x),v.setAttribute("stroke-dashoffset",b),g.appendChild(v),c&&l.appendChild(w1(c,n.props.color,a,n.props.arrowheadStart==="arrow"?"none":n.props.fill,o)),d&&l.appendChild(w1(d,n.props.color,a,n.props.arrowheadEnd==="arrow"?"none":n.props.fill,o)),h){const E={fontSize:hi[n.props.size],lineHeight:Ct.lineHeight,fontFamily:r,padding:0,textAlign:"middle",width:h.w,height:h.h,fontStyle:"normal",fontWeight:"normal"},P=this.app.textMeasure.getTextLines({text:n.props.text,wrap:!0,...E,width:h.w-8}),C=Dp(this.app,{lines:P,...E,width:h.w-8});C.setAttribute("fill",o.fill[n.props.labelColor]),Array.from(C.children).forEach($=>{const A=parseFloat($.getAttribute("x")||"0"),D=parseFloat($.getAttribute("y")||"0");$.setAttribute("x",A+4+h.x+"px"),$.setAttribute("y",D+h.y+"px")}),l.appendChild(C)}return l}}y(Op,"type","arrow");KI([ue],Op.prototype,"infoCache",1);KI([ue],Op.prototype,"labelBoundsCache",1);function v1(t,e){const n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",t),n.setAttribute("fill",e==="arrow"?"none":"black"),n.setAttribute("stroke","none"),n}function BN(t,e,n){const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",t),r.setAttribute("fill","none"),r.setAttribute("stroke",e),r.setAttribute("stroke-width",n+""),r}function w1(t,e,n,r,o){const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",t),i.setAttribute("fill","none"),i.setAttribute("stroke",o.fill[e]),i.setAttribute("stroke-width",n+"");const s=Eo({d:t,fill:r,color:e,colors:o});if(s){const a=document.createElementNS("http://www.w3.org/2000/svg","g");return a.appendChild(s),a.appendChild(i),a}else return i}function x1(t){return t.x!==.5||t.y!==.5}const Mt=qn({type:"arrow",getShapeUtil:()=>Op,validator:oI,migrations:iI});function Ts({children:t,className:e="",...n}){return f.jsx("div",{...n,className:`tl-html-container ${e}`,children:t})}var HI={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var r=[],o=0;o<arguments.length;o++){var i=arguments[o];if(i){var s=typeof i;if(s==="string"||s==="number")r.push(i);else if(Array.isArray(i)){if(i.length){var a=n.apply(null,i);a&&r.push(a)}}else if(s==="object"){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){r.push(i.toString());continue}for(var l in i)e.call(i,l)&&i[l]&&r.push(l)}}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(HI);var zN=HI.exports;const Se=tl(zN),b1="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function mu({url:t,zoomLevel:e}){return f.jsx("a",{className:Se("tl-hyperlink-button",{"tl-hyperlink-button__hidden":e<.5}),href:t,target:"_blank",rel:"noopener noreferrer",onPointerDown:yo,onPointerUp:yo,title:t,draggable:!1,children:f.jsx("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${b1}") center 100% / 100% no-repeat`,WebkitMask:`url("${b1}") center 100% / 100% no-repeat`}})})}const VI=(t,e,n={})=>{const{newPoint:r,handle:o,scaleX:i,scaleY:s}=e,{minWidth:a=1,maxWidth:l=1/0,minHeight:c=1,maxHeight:d=1/0}=n;let u=t.props.w*i,h=t.props.h*s;const p=new I(0,0);if(u>0){if(u<a){switch(o){case"top_left":case"left":case"bottom_left":{p.x=u-a;break}case"top":case"bottom":{p.x=(u-a)/2;break}default:p.x=0}u=a}}else if(p.x=u,u=-u,u<a){switch(o){case"top_left":case"left":case"bottom_left":{p.x=-u;break}default:p.x=-a}u=a}if(h>0){if(h<c){switch(o){case"top_left":case"top":case"top_right":{p.y=h-c;break}case"right":case"left":{p.y=(h-c)/2;break}default:p.y=0}h=c}}else if(p.y=h,h=-h,h<c){switch(o){case"top_left":case"top":case"top_right":{p.y=-h;break}default:p.y=-c}h=c}const{x:g,y:m}=p.rot(t.rotation).add(r);return{x:g,y:m,props:{w:Math.min(l,u),h:Math.min(d,h)}}};class Yi extends Po{constructor(){super(...arguments);y(this,"onResize",(n,r)=>VI(n,r))}getBounds(n){return new de(0,0,n.props.w,n.props.h)}getCenter(n){return new I(n.props.w/2,n.props.h/2)}getOutline(n){return this.bounds(n).corners}hitTestPoint(n,r){return $r(r,this.outline(n))}hitTestLineSegment(n,r,o){const i=this.outline(n);for(let s=0;s<i.length;s++){const a=i[s],l=i[(s+1)%i.length];if(qo(r,o,a,l))return!0}return!1}}class WI extends Yi{constructor(){super(...arguments);y(this,"canResize",()=>!1);y(this,"hideSelectionBoundsBg",()=>!0);y(this,"hideSelectionBoundsFg",()=>!0);y(this,"onBeforeCreate",n=>{this.updateBookmarkAsset(n)});y(this,"onBeforeUpdate",(n,r)=>{n.props.url!==r.props.url&&this.updateBookmarkAsset(r)});y(this,"updateBookmarkAsset",D_(n=>{const{url:r}=n.props,o=pu.createCustomId(hv(r)),i=this.app.getAssetById(o);i?n.props.assetId!==i.id&&this.app.updateShapes([{id:n.id,type:n.type,props:{assetId:o}}]):this.app.onCreateBookmarkFromUrl&&this.app.onCreateBookmarkFromUrl(r).then(s=>{if(!s){this.app.updateShapes([{id:n.id,type:n.type,props:{assetId:void 0}}]);return}this.app.batch(()=>{this.app.createAssets([{id:o,typeName:"asset",type:"bookmark",props:{src:r,description:s.description,image:s.image,title:s.title}}]).updateShapes([{id:n.id,type:n.type,props:{assetId:o}}])})})},500))}defaultProps(){return{opacity:"1",url:"",w:jI,h:NI,assetId:null}}render(n){const r=n.props.assetId?this.app.getAssetById(n.props.assetId):null,o=this.app.getPageRotation(n),i=this.getHumanReadableAddress(n);return f.jsx(Ts,{children:f.jsxs("div",{className:"tl-bookmark__container tl-hitarea-stroke",style:{boxShadow:Rv(o,$v)},children:[f.jsxs("div",{className:"tl-bookmark__image_container",children:[r!=null&&r.props.image?f.jsx("img",{className:"tl-bookmark__image",draggable:!1,src:r==null?void 0:r.props.image,alt:(r==null?void 0:r.props.title)||""}):f.jsx("div",{className:"tl-bookmark__placeholder"}),f.jsx(mu,{url:n.props.url,zoomLevel:this.app.zoomLevel})]}),f.jsxs("div",{className:"tl-bookmark__copy_container",children:[(r==null?void 0:r.props.title)&&f.jsx("h2",{className:"tl-bookmark__heading",children:mg((r==null?void 0:r.props.title)||"",54)}),(r==null?void 0:r.props.description)&&f.jsx("p",{className:"tl-bookmark__description",children:mg((r==null?void 0:r.props.description)||"",128)}),f.jsx("a",{className:"tl-bookmark__link",href:n.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:yo,onPointerUp:yo,onClick:yo,children:mg(i,45)})]})]})})}indicator(n){return f.jsx("rect",{width:U(n.props.w),height:U(n.props.h),rx:"8",ry:"8"})}getHumanReadableAddress(n){try{const r=new URL(n.props.url),o=r.pathname.replace(/\/*$/,"");return`${r.hostname}${o}`}catch{return n.props.url}}}y(WI,"type","bookmark");const jp=qn({type:"bookmark",getShapeUtil:()=>WI,validator:sI,migrations:aI});function Bt(t,e){t.isKilled=!0;const{top:n,left:r}=e.getBoundingClientRect();return{point:{x:t.clientX-r,y:t.clientY-n,z:t.pressure},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:t.pointerId,button:t.button,isPen:t.pointerType==="pen"}}function br(t){return`${U(t.x)},${U(t.y)} `}function Sr(t,e){return`${U((t.x+e.x)/2)},${U((t.y+e.y)/2)} `}function Cc(t,e=!0){const n=t.length;if(n<2)return"";let r=t[0],o=t[1];if(n===2)return`M${br(r)}L${br(o)}`;let i="";for(let s=2,a=n-1;s<a;s++)r=t[s],o=t[s+1],i+=Sr(r,o);return e?`M${Sr(t[0],t[1])}Q${br(t[1])}${Sr(t[1],t[2])}T${i}${Sr(t[n-1],t[0])}${Sr(t[0],t[1])}Z`:`M${br(t[0])}Q${br(t[1])}${Sr(t[1],t[2])}${t.length>3?"T":""}${i}L${br(t[n-1])}`}function rc(t,e=!1){const n=t.length;if(n<2)return"";let r=t[0].point,o=t[1].point;if(n===2)return`M${br(r)}L${br(o)}`;let i="";for(let s=2,a=n-1;s<a;s++)r=t[s].point,o=t[s+1].point,i+=Sr(r,o);return e?`M${Sr(t[0].point,t[1].point)}Q${br(t[1].point)}${Sr(t[1].point,t[2].point)}T${i}${Sr(t[n-1].point,t[0].point)}${Sr(t[0].point,t[1].point)}Z`:`M${br(t[0].point)}Q${br(t[1].point)}${Sr(t[1].point,t[2].point)}${t.length>3?"T":""}${i}L${br(t[n-1].point)}`}function kc(){const t=Z();return ge("zoom",()=>t.zoomLevel<.35,[t])}const UN=t=>t*.65+R8(t*ct/2)*.35,FN=t=>({size:1+t,thinning:.5,streamline:.62+(1+t)/8*.06,smoothing:.62,easing:Pn.easeOutSine,simulatePressure:!0}),KN=t=>({size:1+t*1.2,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:UN}),S1=t=>({size:1+t,thinning:0,streamline:.62+(1+t)/8*.06,smoothing:.62,simulatePressure:!1,easing:Pn.linear});function yg(t,e,n,r){return{...r?S1(e):t.props.dash==="draw"?t.props.isPen?KN(e):FN(e):S1(e),last:t.props.isComplete||n}}function td(t){const e=[];for(const n of t)if(n.type==="free"||n.points.length<2)e.push(...n.points.map(I.Cast));else{const r=Math.max(4,Math.floor(I.Dist(n.points[0],n.points[1])/16));e.push(...I.PointsBetween(n.points[0],n.points[1],r))}return e}function E1(t,e){return{draw:"none",solid:"none",dotted:`0.1 ${e*2}`,dashed:`${e*2} ${e*2}`}[t.props.dash]}class YI extends Po{constructor(){super(...arguments);y(this,"hideResizeHandles",n=>this.getIsDot(n));y(this,"hideRotateHandle",n=>this.getIsDot(n));y(this,"hideSelectionBoundsBg",n=>this.getIsDot(n));y(this,"hideSelectionBoundsFg",n=>this.getIsDot(n));y(this,"isClosed",n=>n.props.isClosed);y(this,"onResize",(n,r)=>{const{scaleX:o,scaleY:i}=r,s=[];for(const a of n.props.segments)s.push({...a,points:a.points.map(({x:l,y:c,z:d})=>({x:o*l,y:i*c,z:d}))});return{props:{segments:s}}})}defaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",opacity:"1",isComplete:!1,isClosed:!1,isPen:!1}}getIsDot(n){return n.props.segments.length===1&&n.props.segments[0].points.length<2}getBounds(n){return de.FromPoints(this.outline(n))}getOutline(n){return td(n.props.segments)}getCenter(n){return this.bounds(n).center}hitTestPoint(n,r){const o=this.outline(n),i=this.app.zoomLevel,s=this.app.getStrokeWidth(n.props.size)/i;if(n.props.segments.length===1&&n.props.segments[0].points.length<4&&n.props.segments[0].points.some(a=>I.Dist(r,a)<s*1.5))return!0;if(this.isClosed(n))return $r(r,o);if(this.bounds(n).containsPoint(r))for(let a=0;a<o.length;a++){const l=o[a],c=o[(a+1)%o.length];if(I.DistanceToLineSegment(l,c,r)<s)return!0}return!1}hitTestLineSegment(n,r,o){const i=this.outline(n);if(n.props.segments.length===1&&n.props.segments[0].points.length<4){const s=this.app.zoomLevel,a=this.app.getStrokeWidth(n.props.size)/s;if(n.props.segments[0].points.some(l=>I.DistanceToLineSegment(r,o,l)<a*1.5))return!0}if(this.isClosed(n))for(let s=0;s<i.length;s++){const a=i[s],l=i[(s+1)%i.length];if(qo(r,o,a,l))return!0}else for(let s=0;s<i.length-1;s++){const a=i[s],l=i[s+1];if(qo(r,o,a,l))return!0}return!1}render(n){var u;const r=kc(),o=this.app.getStrokeWidth(n.props.size),i=td(n.props.segments),s=n.props.isComplete||((u=wr(n.props.segments))==null?void 0:u.type)==="straight";let a=o;!r&&!n.props.isPen&&n.props.dash==="draw"&&i.length===1&&(a+=Bd(n.id)()*(o/6));const l=yg(n,a,s,r),c=Ra(i,l),d=c.length>1?rc(c,n.props.isClosed):vg(i[0],a);if(!r&&n.props.dash==="draw"||c.length<2){Ec(c,l);const h=Sc(c,l);return f.jsxs(xr,{id:n.id,children:[f.jsx(Xt,{fill:n.props.isClosed?n.props.fill:"none",color:n.props.color,d}),f.jsx("path",{d:Cc(h,!0),strokeLinecap:"round",fill:"currentColor"})]})}return f.jsxs(xr,{id:n.id,children:[f.jsx(Xt,{color:n.props.color,fill:n.props.isClosed?n.props.fill:"none",d}),f.jsx("path",{d,strokeLinecap:"round",fill:"none",stroke:"currentColor",strokeWidth:o,strokeDasharray:E1(n,o),strokeDashoffset:"0"})]})}indicator(n){var u;const r=kc(),o=this.app.getStrokeWidth(n.props.size),i=td(n.props.segments);let s=o;!r&&!n.props.isPen&&n.props.dash==="draw"&&i.length===1&&(s+=Bd(n.id)()*(o/6));const a=n.props.isComplete||((u=wr(n.props.segments))==null?void 0:u.type)==="straight",l=yg(n,s,a,!0),c=Ra(i,l),d=c.length>1?rc(c,n.props.isClosed):vg(i[0],s);return f.jsx("path",{d})}toSvg(n,r,o){var m;const{color:i}=n.props,s=this.app.getStrokeWidth(n.props.size),a=td(n.props.segments),l=n.props.isComplete||((m=wr(n.props.segments))==null?void 0:m.type)==="straight";let c=s;!n.props.isPen&&n.props.dash==="draw"&&a.length===1&&(c+=Bd(n.id)()*(s/6));const d=yg(n,c,l,!1),u=Ra(a,d),h=u.length>1?rc(u,n.props.isClosed):vg(a[0],c);let p;if(n.props.dash==="draw"||u.length<2){Ec(u,d);const v=Sc(u,d),x=document.createElementNS("http://www.w3.org/2000/svg","path");x.setAttribute("d",Cc(v,!0)),x.setAttribute("fill",o.fill[i]),x.setAttribute("stroke-linecap","round"),p=x}else{const v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d",h),v.setAttribute("stroke",o.fill[i]),v.setAttribute("fill","none"),v.setAttribute("stroke-linecap","round"),v.setAttribute("stroke-width",s.toString()),v.setAttribute("stroke-dasharray",E1(n,s)),v.setAttribute("stroke-dashoffset","0"),p=v}const g=Eo({fill:n.props.isClosed?n.props.fill:"none",d:h,color:n.props.color,colors:o});if(g){const v=document.createElementNS("http://www.w3.org/2000/svg","g");return v.appendChild(g),v.appendChild(p),v}return p}expandSelectionOutlinePx(n){const r=n.props.dash==="draw"?1.6:1;return this.app.getStrokeWidth(n.props.size)*r/2}}y(YI,"type","draw");const XI=qn({type:"draw",getShapeUtil:()=>YI,migrations:cI,validator:lI});function vg(t,e){const n=(e+1)*.5;return`M ${t.x} ${t.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function HN(){return f.jsx("div",{className:"tl-background"})}function Np(t,e,n,r,o,i){w.useLayoutEffect(()=>{const s=t.current;if(!s||e===void 0)return;let a=`translate(${e}px, ${n}px)`;r!==void 0&&(a+=` scale(${r})`),o!==void 0&&(a+=` rotate(${o}rad)`),i&&(a+=` translate(${i.x}px, ${i.y}px)`),s.style.transform=a})}const wg=({brush:t,color:e,opacity:n})=>{const r=w.useRef(null);return Np(r,t.x,t.y),f.jsx("svg",{className:"tl-overlays__item",ref:r,children:e?f.jsxs("g",{className:"tl-brush",opacity:n,children:[f.jsx("rect",{width:U(Math.max(1,t.w)),height:U(Math.max(1,t.h)),fill:e,opacity:.75}),f.jsx("rect",{width:U(Math.max(1,t.w)),height:U(Math.max(1,t.h)),fill:"none",stroke:e,opacity:.1})]}):f.jsx("rect",{className:"tl-brush tl-brush__default",width:U(Math.max(1,t.w)),height:U(Math.max(1,t.h))})})},VN=({className:t,zoom:e,point:n,color:r,viewport:o,opacity:i=1})=>{const s=w.useRef(null);return Np(s,Vr(n.x,o.minX+5/e,o.maxX-5/e),Vr(n.y,o.minY+5/e,o.maxY-5/e),1/e,I.Angle(o.center,n)),f.jsxs("svg",{ref:s,className:Se("tl-overlays__item",t),children:[f.jsx("use",{href:"#cursor_hint",color:r,strokeWidth:3,stroke:"var(--color-background)"}),f.jsx("use",{href:"#cursor_hint",color:r,opacity:i})]})},WN=({className:t,zoom:e,point:n,color:r,name:o})=>{const i=w.useRef(null);return Np(i,n==null?void 0:n.x,n==null?void 0:n.y,1/e),n?f.jsxs("div",{ref:i,className:Se("tl-overlays__item",t),children:[f.jsx("svg",{className:"tl-cursor",children:f.jsx("use",{href:"#cursor",color:r})}),o!==null&&o!==""&&f.jsx("div",{className:"tl-nametag",style:{backgroundColor:r},children:o})]}):null},P1=w.memo(WN),Dv={openWindow:(t,e)=>window.open(t,e,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>{var t;return await((t=window.__tldraw__hardReset)==null?void 0:t.call(window))}};function GI(){Dv.hardReset()}function YN(){Dv.refreshPage()}var XN=200,Ov="__lodash_hash_undefined__",GN=1/0,qN="[object Function]",QN="[object GeneratorFunction]",ZN=/[\\^$.*+?()[\]{}|]/g,JN=/^\[object .+?Constructor\]$/,eB=typeof zn=="object"&&zn&&zn.Object===Object&&zn,tB=typeof self=="object"&&self&&self.Object===Object&&self,jv=eB||tB||Function("return this")();function nB(t,e){var n=t?t.length:0;return!!n&&iB(t,e,0)>-1}function rB(t,e,n){for(var r=-1,o=t?t.length:0;++r<o;)if(n(e,t[r]))return!0;return!1}function oB(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}function iB(t,e,n){if(e!==e)return oB(t,sB,n);for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}function sB(t){return t!==t}function aB(t,e){return t.has(e)}function lB(t,e){return t==null?void 0:t[e]}function cB(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function qI(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var uB=Array.prototype,dB=Function.prototype,QI=Object.prototype,xg=jv["__core-js_shared__"],_1=function(){var t=/[^.]+$/.exec(xg&&xg.keys&&xg.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),ZI=dB.toString,Nv=QI.hasOwnProperty,hB=QI.toString,pB=RegExp("^"+ZI.call(Nv).replace(ZN,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fB=uB.splice,gB=Bv(jv,"Map"),bg=Bv(jv,"Set"),$c=Bv(Object,"create");function Ms(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function mB(){this.__data__=$c?$c(null):{}}function yB(t){return this.has(t)&&delete this.__data__[t]}function vB(t){var e=this.__data__;if($c){var n=e[t];return n===Ov?void 0:n}return Nv.call(e,t)?e[t]:void 0}function wB(t){var e=this.__data__;return $c?e[t]!==void 0:Nv.call(e,t)}function xB(t,e){var n=this.__data__;return n[t]=$c&&e===void 0?Ov:e,this}Ms.prototype.clear=mB;Ms.prototype.delete=yB;Ms.prototype.get=vB;Ms.prototype.has=wB;Ms.prototype.set=xB;function ul(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function bB(){this.__data__=[]}function SB(t){var e=this.__data__,n=Bp(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():fB.call(e,n,1),!0}function EB(t){var e=this.__data__,n=Bp(e,t);return n<0?void 0:e[n][1]}function PB(t){return Bp(this.__data__,t)>-1}function _B(t,e){var n=this.__data__,r=Bp(n,t);return r<0?n.push([t,e]):n[r][1]=e,this}ul.prototype.clear=bB;ul.prototype.delete=SB;ul.prototype.get=EB;ul.prototype.has=PB;ul.prototype.set=_B;function dl(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function IB(){this.__data__={hash:new Ms,map:new(gB||ul),string:new Ms}}function CB(t){return zp(this,t).delete(t)}function kB(t){return zp(this,t).get(t)}function $B(t){return zp(this,t).has(t)}function TB(t,e){return zp(this,t).set(t,e),this}dl.prototype.clear=IB;dl.prototype.delete=CB;dl.prototype.get=kB;dl.prototype.has=$B;dl.prototype.set=TB;function jh(t){var e=-1,n=t?t.length:0;for(this.__data__=new dl;++e<n;)this.add(t[e])}function MB(t){return this.__data__.set(t,Ov),this}function AB(t){return this.__data__.has(t)}jh.prototype.add=jh.prototype.push=MB;jh.prototype.has=AB;function Bp(t,e){for(var n=t.length;n--;)if(zB(t[n][0],e))return n;return-1}function RB(t){if(!JI(t)||jB(t))return!1;var e=UB(t)||cB(t)?pB:JN;return e.test(NB(t))}function LB(t,e,n){var r=-1,o=nB,i=t.length,s=!0,a=[],l=a;if(n)s=!1,o=rB;else if(i>=XN){var c=e?null:DB(t);if(c)return qI(c);s=!1,o=aB,l=new jh}else l=e?[]:a;e:for(;++r<i;){var d=t[r],u=e?e(d):d;if(d=n||d!==0?d:0,s&&u===u){for(var h=l.length;h--;)if(l[h]===u)continue e;e&&l.push(u),a.push(d)}else o(l,u,n)||(l!==a&&l.push(u),a.push(d))}return a}var DB=bg&&1/qI(new bg([,-0]))[1]==GN?function(t){return new bg(t)}:FB;function zp(t,e){var n=t.__data__;return OB(e)?n[typeof e=="string"?"string":"hash"]:n.map}function Bv(t,e){var n=lB(t,e);return RB(n)?n:void 0}function OB(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function jB(t){return!!_1&&_1 in t}function NB(t){if(t!=null){try{return ZI.call(t)}catch{}try{return t+""}catch{}}return""}function BB(t){return t&&t.length?LB(t):[]}function zB(t,e){return t===e||t!==t&&e!==e}function UB(t){var e=JI(t)?hB.call(t):"";return e==qN||e==QN}function JI(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function FB(){}var KB=BB;const e2=tl(KB);function I1(t,e){let n=0;for(;t[e+n];)n+=t[e+n]+1;return n+1}function HB(t){return new TextDecoder("ascii").decode(t.slice(0,3))==="GIF"}function VB(t){const e=new Uint8Array(t);let n,r,o=0,i=0;if(!HB(t))return!1;for(n=e[10]&128,r=e[10]&7,o+=6,o+=7,o+=n?3*Math.pow(2,r+1):0;i<2&&o<e.length;)switch(e[o]){case 44:i+=1,n=e[o+9]&128,r=e[o+9]&7,o+=10,o+=n?3*Math.pow(2,r+1):0,o+=I1(e,o+1)+1;break;case 33:o+=2,o+=I1(e,o);break;case 59:o=e.length;break;default:o=e.length;break}return i>1}let fy=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(fy=new Int32Array(fy));const WB=(t,e)=>{let n=e===0?0:~~e^-1;for(let r=0;r<t.length;r++)n=fy[(n^t[r])&255]^n>>>8;return n^-1};var t2={},Up={};Up.byteLength=GB;Up.toByteArray=QB;Up.fromByteArray=e7;var fo=[],yr=[],YB=typeof Uint8Array<"u"?Uint8Array:Array,Sg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ea=0,XB=Sg.length;ea<XB;++ea)fo[ea]=Sg[ea],yr[Sg.charCodeAt(ea)]=ea;yr["-".charCodeAt(0)]=62;yr["_".charCodeAt(0)]=63;function n2(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function GB(t){var e=n2(t),n=e[0],r=e[1];return(n+r)*3/4-r}function qB(t,e,n){return(e+n)*3/4-n}function QB(t){var e,n=n2(t),r=n[0],o=n[1],i=new YB(qB(t,r,o)),s=0,a=o>0?r-4:r,l;for(l=0;l<a;l+=4)e=yr[t.charCodeAt(l)]<<18|yr[t.charCodeAt(l+1)]<<12|yr[t.charCodeAt(l+2)]<<6|yr[t.charCodeAt(l+3)],i[s++]=e>>16&255,i[s++]=e>>8&255,i[s++]=e&255;return o===2&&(e=yr[t.charCodeAt(l)]<<2|yr[t.charCodeAt(l+1)]>>4,i[s++]=e&255),o===1&&(e=yr[t.charCodeAt(l)]<<10|yr[t.charCodeAt(l+1)]<<4|yr[t.charCodeAt(l+2)]>>2,i[s++]=e>>8&255,i[s++]=e&255),i}function ZB(t){return fo[t>>18&63]+fo[t>>12&63]+fo[t>>6&63]+fo[t&63]}function JB(t,e,n){for(var r,o=[],i=e;i<n;i+=3)r=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),o.push(ZB(r));return o.join("")}function e7(t){for(var e,n=t.length,r=n%3,o=[],i=16383,s=0,a=n-r;s<a;s+=i)o.push(JB(t,s,s+i>a?a:s+i));return r===1?(e=t[n-1],o.push(fo[e>>2]+fo[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],o.push(fo[e>>10]+fo[e>>4&63]+fo[e<<2&63]+"=")),o.join("")}var zv={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */zv.read=function(t,e,n,r,o){var i,s,a=o*8-r-1,l=(1<<a)-1,c=l>>1,d=-7,u=n?o-1:0,h=n?-1:1,p=t[e+u];for(u+=h,i=p&(1<<-d)-1,p>>=-d,d+=a;d>0;i=i*256+t[e+u],u+=h,d-=8);for(s=i&(1<<-d)-1,i>>=-d,d+=r;d>0;s=s*256+t[e+u],u+=h,d-=8);if(i===0)i=1-c;else{if(i===l)return s?NaN:(p?-1:1)*(1/0);s=s+Math.pow(2,r),i=i-c}return(p?-1:1)*s*Math.pow(2,i-r)};zv.write=function(t,e,n,r,o,i){var s,a,l,c=i*8-o-1,d=(1<<c)-1,u=d>>1,h=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,g=r?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=d):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+u>=1?e+=h/l:e+=h*Math.pow(2,1-u),e*l>=2&&(s++,l/=2),s+u>=d?(a=0,s=d):s+u>=1?(a=(e*l-1)*Math.pow(2,o),s=s+u):(a=e*Math.pow(2,u-1)*Math.pow(2,o),s=0));o>=8;t[n+p]=a&255,p+=g,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[n+p]=s&255,p+=g,s/=256,c-=8);t[n+p-g]|=m*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=Up,n=zv,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=b,t.INSPECT_MAX_BYTES=50;const o=2147483647;t.kMaxLength=o,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const M=new Uint8Array(1),_={foo:function(){return 42}};return Object.setPrototypeOf(_,Uint8Array.prototype),Object.setPrototypeOf(M,_),M.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(M){if(M>o)throw new RangeError('The value "'+M+'" is invalid for option "size"');const _=new Uint8Array(M);return Object.setPrototypeOf(_,a.prototype),_}function a(M,_,S){if(typeof M=="number"){if(typeof _=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return u(M)}return l(M,_,S)}a.poolSize=8192;function l(M,_,S){if(typeof M=="string")return h(M,_);if(ArrayBuffer.isView(M))return g(M);if(M==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M);if(We(M,ArrayBuffer)||M&&We(M.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(We(M,SharedArrayBuffer)||M&&We(M.buffer,SharedArrayBuffer)))return m(M,_,S);if(typeof M=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const T=M.valueOf&&M.valueOf();if(T!=null&&T!==M)return a.from(T,_,S);const R=v(M);if(R)return R;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof M[Symbol.toPrimitive]=="function")return a.from(M[Symbol.toPrimitive]("string"),_,S);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M)}a.from=function(M,_,S){return l(M,_,S)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(M){if(typeof M!="number")throw new TypeError('"size" argument must be of type number');if(M<0)throw new RangeError('The value "'+M+'" is invalid for option "size"')}function d(M,_,S){return c(M),M<=0?s(M):_!==void 0?typeof S=="string"?s(M).fill(_,S):s(M).fill(_):s(M)}a.alloc=function(M,_,S){return d(M,_,S)};function u(M){return c(M),s(M<0?0:x(M)|0)}a.allocUnsafe=function(M){return u(M)},a.allocUnsafeSlow=function(M){return u(M)};function h(M,_){if((typeof _!="string"||_==="")&&(_="utf8"),!a.isEncoding(_))throw new TypeError("Unknown encoding: "+_);const S=E(M,_)|0;let T=s(S);const R=T.write(M,_);return R!==S&&(T=T.slice(0,R)),T}function p(M){const _=M.length<0?0:x(M.length)|0,S=s(_);for(let T=0;T<_;T+=1)S[T]=M[T]&255;return S}function g(M){if(We(M,Uint8Array)){const _=new Uint8Array(M);return m(_.buffer,_.byteOffset,_.byteLength)}return p(M)}function m(M,_,S){if(_<0||M.byteLength<_)throw new RangeError('"offset" is outside of buffer bounds');if(M.byteLength<_+(S||0))throw new RangeError('"length" is outside of buffer bounds');let T;return _===void 0&&S===void 0?T=new Uint8Array(M):S===void 0?T=new Uint8Array(M,_):T=new Uint8Array(M,_,S),Object.setPrototypeOf(T,a.prototype),T}function v(M){if(a.isBuffer(M)){const _=x(M.length)|0,S=s(_);return S.length===0||M.copy(S,0,0,_),S}if(M.length!==void 0)return typeof M.length!="number"||dr(M.length)?s(0):p(M);if(M.type==="Buffer"&&Array.isArray(M.data))return p(M.data)}function x(M){if(M>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return M|0}function b(M){return+M!=M&&(M=0),a.alloc(+M)}a.isBuffer=function(_){return _!=null&&_._isBuffer===!0&&_!==a.prototype},a.compare=function(_,S){if(We(_,Uint8Array)&&(_=a.from(_,_.offset,_.byteLength)),We(S,Uint8Array)&&(S=a.from(S,S.offset,S.byteLength)),!a.isBuffer(_)||!a.isBuffer(S))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(_===S)return 0;let T=_.length,R=S.length;for(let N=0,z=Math.min(T,R);N<z;++N)if(_[N]!==S[N]){T=_[N],R=S[N];break}return T<R?-1:R<T?1:0},a.isEncoding=function(_){switch(String(_).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(_,S){if(!Array.isArray(_))throw new TypeError('"list" argument must be an Array of Buffers');if(_.length===0)return a.alloc(0);let T;if(S===void 0)for(S=0,T=0;T<_.length;++T)S+=_[T].length;const R=a.allocUnsafe(S);let N=0;for(T=0;T<_.length;++T){let z=_[T];if(We(z,Uint8Array))N+z.length>R.length?(a.isBuffer(z)||(z=a.from(z)),z.copy(R,N)):Uint8Array.prototype.set.call(R,z,N);else if(a.isBuffer(z))z.copy(R,N);else throw new TypeError('"list" argument must be an Array of Buffers');N+=z.length}return R};function E(M,_){if(a.isBuffer(M))return M.length;if(ArrayBuffer.isView(M)||We(M,ArrayBuffer))return M.byteLength;if(typeof M!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof M);const S=M.length,T=arguments.length>2&&arguments[2]===!0;if(!T&&S===0)return 0;let R=!1;for(;;)switch(_){case"ascii":case"latin1":case"binary":return S;case"utf8":case"utf-8":return Kt(M).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S*2;case"hex":return S>>>1;case"base64":return Pt(M).length;default:if(R)return T?-1:Kt(M).length;_=(""+_).toLowerCase(),R=!0}}a.byteLength=E;function P(M,_,S){let T=!1;if((_===void 0||_<0)&&(_=0),_>this.length||((S===void 0||S>this.length)&&(S=this.length),S<=0)||(S>>>=0,_>>>=0,S<=_))return"";for(M||(M="utf8");;)switch(M){case"hex":return H(this,_,S);case"utf8":case"utf-8":return F(this,_,S);case"ascii":return ie(this,_,S);case"latin1":case"binary":return W(this,_,S);case"base64":return q(this,_,S);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,_,S);default:if(T)throw new TypeError("Unknown encoding: "+M);M=(M+"").toLowerCase(),T=!0}}a.prototype._isBuffer=!0;function C(M,_,S){const T=M[_];M[_]=M[S],M[S]=T}a.prototype.swap16=function(){const _=this.length;if(_%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let S=0;S<_;S+=2)C(this,S,S+1);return this},a.prototype.swap32=function(){const _=this.length;if(_%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let S=0;S<_;S+=4)C(this,S,S+3),C(this,S+1,S+2);return this},a.prototype.swap64=function(){const _=this.length;if(_%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let S=0;S<_;S+=8)C(this,S,S+7),C(this,S+1,S+6),C(this,S+2,S+5),C(this,S+3,S+4);return this},a.prototype.toString=function(){const _=this.length;return _===0?"":arguments.length===0?F(this,0,_):P.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(_){if(!a.isBuffer(_))throw new TypeError("Argument must be a Buffer");return this===_?!0:a.compare(this,_)===0},a.prototype.inspect=function(){let _="";const S=t.INSPECT_MAX_BYTES;return _=this.toString("hex",0,S).replace(/(.{2})/g,"$1 ").trim(),this.length>S&&(_+=" ... "),"<Buffer "+_+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(_,S,T,R,N){if(We(_,Uint8Array)&&(_=a.from(_,_.offset,_.byteLength)),!a.isBuffer(_))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof _);if(S===void 0&&(S=0),T===void 0&&(T=_?_.length:0),R===void 0&&(R=0),N===void 0&&(N=this.length),S<0||T>_.length||R<0||N>this.length)throw new RangeError("out of range index");if(R>=N&&S>=T)return 0;if(R>=N)return-1;if(S>=T)return 1;if(S>>>=0,T>>>=0,R>>>=0,N>>>=0,this===_)return 0;let z=N-R,re=T-S;const ae=Math.min(z,re),ce=this.slice(R,N),se=_.slice(S,T);for(let ve=0;ve<ae;++ve)if(ce[ve]!==se[ve]){z=ce[ve],re=se[ve];break}return z<re?-1:re<z?1:0};function k(M,_,S,T,R){if(M.length===0)return-1;if(typeof S=="string"?(T=S,S=0):S>2147483647?S=2147483647:S<-2147483648&&(S=-2147483648),S=+S,dr(S)&&(S=R?0:M.length-1),S<0&&(S=M.length+S),S>=M.length){if(R)return-1;S=M.length-1}else if(S<0)if(R)S=0;else return-1;if(typeof _=="string"&&(_=a.from(_,T)),a.isBuffer(_))return _.length===0?-1:$(M,_,S,T,R);if(typeof _=="number")return _=_&255,typeof Uint8Array.prototype.indexOf=="function"?R?Uint8Array.prototype.indexOf.call(M,_,S):Uint8Array.prototype.lastIndexOf.call(M,_,S):$(M,[_],S,T,R);throw new TypeError("val must be string, number or Buffer")}function $(M,_,S,T,R){let N=1,z=M.length,re=_.length;if(T!==void 0&&(T=String(T).toLowerCase(),T==="ucs2"||T==="ucs-2"||T==="utf16le"||T==="utf-16le")){if(M.length<2||_.length<2)return-1;N=2,z/=2,re/=2,S/=2}function ae(se,ve){return N===1?se[ve]:se.readUInt16BE(ve*N)}let ce;if(R){let se=-1;for(ce=S;ce<z;ce++)if(ae(M,ce)===ae(_,se===-1?0:ce-se)){if(se===-1&&(se=ce),ce-se+1===re)return se*N}else se!==-1&&(ce-=ce-se),se=-1}else for(S+re>z&&(S=z-re),ce=S;ce>=0;ce--){let se=!0;for(let ve=0;ve<re;ve++)if(ae(M,ce+ve)!==ae(_,ve)){se=!1;break}if(se)return ce}return-1}a.prototype.includes=function(_,S,T){return this.indexOf(_,S,T)!==-1},a.prototype.indexOf=function(_,S,T){return k(this,_,S,T,!0)},a.prototype.lastIndexOf=function(_,S,T){return k(this,_,S,T,!1)};function A(M,_,S,T){S=Number(S)||0;const R=M.length-S;T?(T=Number(T),T>R&&(T=R)):T=R;const N=_.length;T>N/2&&(T=N/2);let z;for(z=0;z<T;++z){const re=parseInt(_.substr(z*2,2),16);if(dr(re))return z;M[S+z]=re}return z}function D(M,_,S,T){return Ht(Kt(_,M.length-S),M,S,T)}function j(M,_,S,T){return Ht(Lr(_),M,S,T)}function Y(M,_,S,T){return Ht(Pt(_),M,S,T)}function V(M,_,S,T){return Ht(ht(_,M.length-S),M,S,T)}a.prototype.write=function(_,S,T,R){if(S===void 0)R="utf8",T=this.length,S=0;else if(T===void 0&&typeof S=="string")R=S,T=this.length,S=0;else if(isFinite(S))S=S>>>0,isFinite(T)?(T=T>>>0,R===void 0&&(R="utf8")):(R=T,T=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const N=this.length-S;if((T===void 0||T>N)&&(T=N),_.length>0&&(T<0||S<0)||S>this.length)throw new RangeError("Attempt to write outside buffer bounds");R||(R="utf8");let z=!1;for(;;)switch(R){case"hex":return A(this,_,S,T);case"utf8":case"utf-8":return D(this,_,S,T);case"ascii":case"latin1":case"binary":return j(this,_,S,T);case"base64":return Y(this,_,S,T);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,_,S,T);default:if(z)throw new TypeError("Unknown encoding: "+R);R=(""+R).toLowerCase(),z=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(M,_,S){return _===0&&S===M.length?e.fromByteArray(M):e.fromByteArray(M.slice(_,S))}function F(M,_,S){S=Math.min(M.length,S);const T=[];let R=_;for(;R<S;){const N=M[R];let z=null,re=N>239?4:N>223?3:N>191?2:1;if(R+re<=S){let ae,ce,se,ve;switch(re){case 1:N<128&&(z=N);break;case 2:ae=M[R+1],(ae&192)===128&&(ve=(N&31)<<6|ae&63,ve>127&&(z=ve));break;case 3:ae=M[R+1],ce=M[R+2],(ae&192)===128&&(ce&192)===128&&(ve=(N&15)<<12|(ae&63)<<6|ce&63,ve>2047&&(ve<55296||ve>57343)&&(z=ve));break;case 4:ae=M[R+1],ce=M[R+2],se=M[R+3],(ae&192)===128&&(ce&192)===128&&(se&192)===128&&(ve=(N&15)<<18|(ae&63)<<12|(ce&63)<<6|se&63,ve>65535&&ve<1114112&&(z=ve))}}z===null?(z=65533,re=1):z>65535&&(z-=65536,T.push(z>>>10&1023|55296),z=56320|z&1023),T.push(z),R+=re}return ne(T)}const X=4096;function ne(M){const _=M.length;if(_<=X)return String.fromCharCode.apply(String,M);let S="",T=0;for(;T<_;)S+=String.fromCharCode.apply(String,M.slice(T,T+=X));return S}function ie(M,_,S){let T="";S=Math.min(M.length,S);for(let R=_;R<S;++R)T+=String.fromCharCode(M[R]&127);return T}function W(M,_,S){let T="";S=Math.min(M.length,S);for(let R=_;R<S;++R)T+=String.fromCharCode(M[R]);return T}function H(M,_,S){const T=M.length;(!_||_<0)&&(_=0),(!S||S<0||S>T)&&(S=T);let R="";for(let N=_;N<S;++N)R+=Dr[M[N]];return R}function G(M,_,S){const T=M.slice(_,S);let R="";for(let N=0;N<T.length-1;N+=2)R+=String.fromCharCode(T[N]+T[N+1]*256);return R}a.prototype.slice=function(_,S){const T=this.length;_=~~_,S=S===void 0?T:~~S,_<0?(_+=T,_<0&&(_=0)):_>T&&(_=T),S<0?(S+=T,S<0&&(S=0)):S>T&&(S=T),S<_&&(S=_);const R=this.subarray(_,S);return Object.setPrototypeOf(R,a.prototype),R};function Q(M,_,S){if(M%1!==0||M<0)throw new RangeError("offset is not uint");if(M+_>S)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(_,S,T){_=_>>>0,S=S>>>0,T||Q(_,S,this.length);let R=this[_],N=1,z=0;for(;++z<S&&(N*=256);)R+=this[_+z]*N;return R},a.prototype.readUintBE=a.prototype.readUIntBE=function(_,S,T){_=_>>>0,S=S>>>0,T||Q(_,S,this.length);let R=this[_+--S],N=1;for(;S>0&&(N*=256);)R+=this[_+--S]*N;return R},a.prototype.readUint8=a.prototype.readUInt8=function(_,S){return _=_>>>0,S||Q(_,1,this.length),this[_]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(_,S){return _=_>>>0,S||Q(_,2,this.length),this[_]|this[_+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(_,S){return _=_>>>0,S||Q(_,2,this.length),this[_]<<8|this[_+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(_,S){return _=_>>>0,S||Q(_,4,this.length),(this[_]|this[_+1]<<8|this[_+2]<<16)+this[_+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(_,S){return _=_>>>0,S||Q(_,4,this.length),this[_]*16777216+(this[_+1]<<16|this[_+2]<<8|this[_+3])},a.prototype.readBigUInt64LE=Rn(function(_){_=_>>>0,kt(_,"offset");const S=this[_],T=this[_+7];(S===void 0||T===void 0)&&Lt(_,this.length-8);const R=S+this[++_]*2**8+this[++_]*2**16+this[++_]*2**24,N=this[++_]+this[++_]*2**8+this[++_]*2**16+T*2**24;return BigInt(R)+(BigInt(N)<<BigInt(32))}),a.prototype.readBigUInt64BE=Rn(function(_){_=_>>>0,kt(_,"offset");const S=this[_],T=this[_+7];(S===void 0||T===void 0)&&Lt(_,this.length-8);const R=S*2**24+this[++_]*2**16+this[++_]*2**8+this[++_],N=this[++_]*2**24+this[++_]*2**16+this[++_]*2**8+T;return(BigInt(R)<<BigInt(32))+BigInt(N)}),a.prototype.readIntLE=function(_,S,T){_=_>>>0,S=S>>>0,T||Q(_,S,this.length);let R=this[_],N=1,z=0;for(;++z<S&&(N*=256);)R+=this[_+z]*N;return N*=128,R>=N&&(R-=Math.pow(2,8*S)),R},a.prototype.readIntBE=function(_,S,T){_=_>>>0,S=S>>>0,T||Q(_,S,this.length);let R=S,N=1,z=this[_+--R];for(;R>0&&(N*=256);)z+=this[_+--R]*N;return N*=128,z>=N&&(z-=Math.pow(2,8*S)),z},a.prototype.readInt8=function(_,S){return _=_>>>0,S||Q(_,1,this.length),this[_]&128?(255-this[_]+1)*-1:this[_]},a.prototype.readInt16LE=function(_,S){_=_>>>0,S||Q(_,2,this.length);const T=this[_]|this[_+1]<<8;return T&32768?T|4294901760:T},a.prototype.readInt16BE=function(_,S){_=_>>>0,S||Q(_,2,this.length);const T=this[_+1]|this[_]<<8;return T&32768?T|4294901760:T},a.prototype.readInt32LE=function(_,S){return _=_>>>0,S||Q(_,4,this.length),this[_]|this[_+1]<<8|this[_+2]<<16|this[_+3]<<24},a.prototype.readInt32BE=function(_,S){return _=_>>>0,S||Q(_,4,this.length),this[_]<<24|this[_+1]<<16|this[_+2]<<8|this[_+3]},a.prototype.readBigInt64LE=Rn(function(_){_=_>>>0,kt(_,"offset");const S=this[_],T=this[_+7];(S===void 0||T===void 0)&&Lt(_,this.length-8);const R=this[_+4]+this[_+5]*2**8+this[_+6]*2**16+(T<<24);return(BigInt(R)<<BigInt(32))+BigInt(S+this[++_]*2**8+this[++_]*2**16+this[++_]*2**24)}),a.prototype.readBigInt64BE=Rn(function(_){_=_>>>0,kt(_,"offset");const S=this[_],T=this[_+7];(S===void 0||T===void 0)&&Lt(_,this.length-8);const R=(S<<24)+this[++_]*2**16+this[++_]*2**8+this[++_];return(BigInt(R)<<BigInt(32))+BigInt(this[++_]*2**24+this[++_]*2**16+this[++_]*2**8+T)}),a.prototype.readFloatLE=function(_,S){return _=_>>>0,S||Q(_,4,this.length),n.read(this,_,!0,23,4)},a.prototype.readFloatBE=function(_,S){return _=_>>>0,S||Q(_,4,this.length),n.read(this,_,!1,23,4)},a.prototype.readDoubleLE=function(_,S){return _=_>>>0,S||Q(_,8,this.length),n.read(this,_,!0,52,8)},a.prototype.readDoubleBE=function(_,S){return _=_>>>0,S||Q(_,8,this.length),n.read(this,_,!1,52,8)};function le(M,_,S,T,R,N){if(!a.isBuffer(M))throw new TypeError('"buffer" argument must be a Buffer instance');if(_>R||_<N)throw new RangeError('"value" argument is out of bounds');if(S+T>M.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(_,S,T,R){if(_=+_,S=S>>>0,T=T>>>0,!R){const re=Math.pow(2,8*T)-1;le(this,_,S,T,re,0)}let N=1,z=0;for(this[S]=_&255;++z<T&&(N*=256);)this[S+z]=_/N&255;return S+T},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(_,S,T,R){if(_=+_,S=S>>>0,T=T>>>0,!R){const re=Math.pow(2,8*T)-1;le(this,_,S,T,re,0)}let N=T-1,z=1;for(this[S+N]=_&255;--N>=0&&(z*=256);)this[S+N]=_/z&255;return S+T},a.prototype.writeUint8=a.prototype.writeUInt8=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,1,255,0),this[S]=_&255,S+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,2,65535,0),this[S]=_&255,this[S+1]=_>>>8,S+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,2,65535,0),this[S]=_>>>8,this[S+1]=_&255,S+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,4,4294967295,0),this[S+3]=_>>>24,this[S+2]=_>>>16,this[S+1]=_>>>8,this[S]=_&255,S+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,4,4294967295,0),this[S]=_>>>24,this[S+1]=_>>>16,this[S+2]=_>>>8,this[S+3]=_&255,S+4};function De(M,_,S,T,R){vt(_,T,R,M,S,7);let N=Number(_&BigInt(4294967295));M[S++]=N,N=N>>8,M[S++]=N,N=N>>8,M[S++]=N,N=N>>8,M[S++]=N;let z=Number(_>>BigInt(32)&BigInt(4294967295));return M[S++]=z,z=z>>8,M[S++]=z,z=z>>8,M[S++]=z,z=z>>8,M[S++]=z,S}function Ie(M,_,S,T,R){vt(_,T,R,M,S,7);let N=Number(_&BigInt(4294967295));M[S+7]=N,N=N>>8,M[S+6]=N,N=N>>8,M[S+5]=N,N=N>>8,M[S+4]=N;let z=Number(_>>BigInt(32)&BigInt(4294967295));return M[S+3]=z,z=z>>8,M[S+2]=z,z=z>>8,M[S+1]=z,z=z>>8,M[S]=z,S+8}a.prototype.writeBigUInt64LE=Rn(function(_,S=0){return De(this,_,S,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Rn(function(_,S=0){return Ie(this,_,S,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(_,S,T,R){if(_=+_,S=S>>>0,!R){const ae=Math.pow(2,8*T-1);le(this,_,S,T,ae-1,-ae)}let N=0,z=1,re=0;for(this[S]=_&255;++N<T&&(z*=256);)_<0&&re===0&&this[S+N-1]!==0&&(re=1),this[S+N]=(_/z>>0)-re&255;return S+T},a.prototype.writeIntBE=function(_,S,T,R){if(_=+_,S=S>>>0,!R){const ae=Math.pow(2,8*T-1);le(this,_,S,T,ae-1,-ae)}let N=T-1,z=1,re=0;for(this[S+N]=_&255;--N>=0&&(z*=256);)_<0&&re===0&&this[S+N+1]!==0&&(re=1),this[S+N]=(_/z>>0)-re&255;return S+T},a.prototype.writeInt8=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,1,127,-128),_<0&&(_=255+_+1),this[S]=_&255,S+1},a.prototype.writeInt16LE=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,2,32767,-32768),this[S]=_&255,this[S+1]=_>>>8,S+2},a.prototype.writeInt16BE=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,2,32767,-32768),this[S]=_>>>8,this[S+1]=_&255,S+2},a.prototype.writeInt32LE=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,4,2147483647,-2147483648),this[S]=_&255,this[S+1]=_>>>8,this[S+2]=_>>>16,this[S+3]=_>>>24,S+4},a.prototype.writeInt32BE=function(_,S,T){return _=+_,S=S>>>0,T||le(this,_,S,4,2147483647,-2147483648),_<0&&(_=4294967295+_+1),this[S]=_>>>24,this[S+1]=_>>>16,this[S+2]=_>>>8,this[S+3]=_&255,S+4},a.prototype.writeBigInt64LE=Rn(function(_,S=0){return De(this,_,S,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Rn(function(_,S=0){return Ie(this,_,S,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function we(M,_,S,T,R,N){if(S+T>M.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("Index out of range")}function Ze(M,_,S,T,R){return _=+_,S=S>>>0,R||we(M,_,S,4),n.write(M,_,S,T,23,4),S+4}a.prototype.writeFloatLE=function(_,S,T){return Ze(this,_,S,!0,T)},a.prototype.writeFloatBE=function(_,S,T){return Ze(this,_,S,!1,T)};function je(M,_,S,T,R){return _=+_,S=S>>>0,R||we(M,_,S,8),n.write(M,_,S,T,52,8),S+8}a.prototype.writeDoubleLE=function(_,S,T){return je(this,_,S,!0,T)},a.prototype.writeDoubleBE=function(_,S,T){return je(this,_,S,!1,T)},a.prototype.copy=function(_,S,T,R){if(!a.isBuffer(_))throw new TypeError("argument should be a Buffer");if(T||(T=0),!R&&R!==0&&(R=this.length),S>=_.length&&(S=_.length),S||(S=0),R>0&&R<T&&(R=T),R===T||_.length===0||this.length===0)return 0;if(S<0)throw new RangeError("targetStart out of bounds");if(T<0||T>=this.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("sourceEnd out of bounds");R>this.length&&(R=this.length),_.length-S<R-T&&(R=_.length-S+T);const N=R-T;return this===_&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(S,T,R):Uint8Array.prototype.set.call(_,this.subarray(T,R),S),N},a.prototype.fill=function(_,S,T,R){if(typeof _=="string"){if(typeof S=="string"?(R=S,S=0,T=this.length):typeof T=="string"&&(R=T,T=this.length),R!==void 0&&typeof R!="string")throw new TypeError("encoding must be a string");if(typeof R=="string"&&!a.isEncoding(R))throw new TypeError("Unknown encoding: "+R);if(_.length===1){const z=_.charCodeAt(0);(R==="utf8"&&z<128||R==="latin1")&&(_=z)}}else typeof _=="number"?_=_&255:typeof _=="boolean"&&(_=Number(_));if(S<0||this.length<S||this.length<T)throw new RangeError("Out of range index");if(T<=S)return this;S=S>>>0,T=T===void 0?this.length:T>>>0,_||(_=0);let N;if(typeof _=="number")for(N=S;N<T;++N)this[N]=_;else{const z=a.isBuffer(_)?_:a.from(_,R),re=z.length;if(re===0)throw new TypeError('The value "'+_+'" is invalid for argument "value"');for(N=0;N<T-S;++N)this[N+S]=z[N%re]}return this};const ze={};function Re(M,_,S){ze[M]=class extends S{constructor(){super(),Object.defineProperty(this,"message",{value:_.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${M}]`,this.stack,delete this.name}get code(){return M}set code(R){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:R,writable:!0})}toString(){return`${this.name} [${M}]: ${this.message}`}}}Re("ERR_BUFFER_OUT_OF_BOUNDS",function(M){return M?`${M} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Re("ERR_INVALID_ARG_TYPE",function(M,_){return`The "${M}" argument must be of type number. Received type ${typeof _}`},TypeError),Re("ERR_OUT_OF_RANGE",function(M,_,S){let T=`The value of "${M}" is out of range.`,R=S;return Number.isInteger(S)&&Math.abs(S)>2**32?R=Ft(String(S)):typeof S=="bigint"&&(R=String(S),(S>BigInt(2)**BigInt(32)||S<-(BigInt(2)**BigInt(32)))&&(R=Ft(R)),R+="n"),T+=` It must be ${_}. Received ${R}`,T},RangeError);function Ft(M){let _="",S=M.length;const T=M[0]==="-"?1:0;for(;S>=T+4;S-=3)_=`_${M.slice(S-3,S)}${_}`;return`${M.slice(0,S)}${_}`}function Zt(M,_,S){kt(_,"offset"),(M[_]===void 0||M[_+S]===void 0)&&Lt(_,M.length-(S+1))}function vt(M,_,S,T,R,N){if(M>S||M<_){const z=typeof _=="bigint"?"n":"";let re;throw N>3?_===0||_===BigInt(0)?re=`>= 0${z} and < 2${z} ** ${(N+1)*8}${z}`:re=`>= -(2${z} ** ${(N+1)*8-1}${z}) and < 2 ** ${(N+1)*8-1}${z}`:re=`>= ${_}${z} and <= ${S}${z}`,new ze.ERR_OUT_OF_RANGE("value",re,M)}Zt(T,R,N)}function kt(M,_){if(typeof M!="number")throw new ze.ERR_INVALID_ARG_TYPE(_,"number",M)}function Lt(M,_,S){throw Math.floor(M)!==M?(kt(M,S),new ze.ERR_OUT_OF_RANGE(S||"offset","an integer",M)):_<0?new ze.ERR_BUFFER_OUT_OF_BOUNDS:new ze.ERR_OUT_OF_RANGE(S||"offset",`>= ${S?1:0} and <= ${_}`,M)}const xn=/[^+/0-9A-Za-z-_]/g;function Dt(M){if(M=M.split("=")[0],M=M.trim().replace(xn,""),M.length<2)return"";for(;M.length%4!==0;)M=M+"=";return M}function Kt(M,_){_=_||1/0;let S;const T=M.length;let R=null;const N=[];for(let z=0;z<T;++z){if(S=M.charCodeAt(z),S>55295&&S<57344){if(!R){if(S>56319){(_-=3)>-1&&N.push(239,191,189);continue}else if(z+1===T){(_-=3)>-1&&N.push(239,191,189);continue}R=S;continue}if(S<56320){(_-=3)>-1&&N.push(239,191,189),R=S;continue}S=(R-55296<<10|S-56320)+65536}else R&&(_-=3)>-1&&N.push(239,191,189);if(R=null,S<128){if((_-=1)<0)break;N.push(S)}else if(S<2048){if((_-=2)<0)break;N.push(S>>6|192,S&63|128)}else if(S<65536){if((_-=3)<0)break;N.push(S>>12|224,S>>6&63|128,S&63|128)}else if(S<1114112){if((_-=4)<0)break;N.push(S>>18|240,S>>12&63|128,S>>6&63|128,S&63|128)}else throw new Error("Invalid code point")}return N}function Lr(M){const _=[];for(let S=0;S<M.length;++S)_.push(M.charCodeAt(S)&255);return _}function ht(M,_){let S,T,R;const N=[];for(let z=0;z<M.length&&!((_-=2)<0);++z)S=M.charCodeAt(z),T=S>>8,R=S%256,N.push(R),N.push(T);return N}function Pt(M){return e.toByteArray(Dt(M))}function Ht(M,_,S,T){let R;for(R=0;R<T&&!(R+S>=_.length||R>=M.length);++R)_[R+S]=M[R];return R}function We(M,_){return M instanceof _||M!=null&&M.constructor!=null&&M.constructor.name!=null&&M.constructor.name===_.name}function dr(M){return M!==M}const Dr=function(){const M="0123456789abcdef",_=new Array(256);for(let S=0;S<16;++S){const T=S*16;for(let R=0;R<16;++R)_[T+R]=M[S]+M[R]}return _}();function Rn(M){return typeof BigInt>"u"?Ji:M}function Ji(){throw new Error("BigInt not supported")}})(t2);const C1=(t,e)=>t2.Buffer.from(t,e);function t7(t,e){const n=(r,o)=>e(C1(r),o)>>>0;return n.signed=(r,o)=>e(C1(r),o),n.unsigned=n,n.model=t,n}const n7=t7("crc-32",WB);function r2(t,e){return t.getUint8(e+0)===137&&t.getUint8(e+1)===80&&t.getUint8(e+2)===78&&t.getUint8(e+3)===71&&t.getUint8(e+4)===13&&t.getUint8(e+5)===10&&t.getUint8(e+6)===26&&t.getUint8(e+7)===10}function r7(t,e){return[String.fromCharCode(t.getUint8(e)),String.fromCharCode(t.getUint8(e+1)),String.fromCharCode(t.getUint8(e+2)),String.fromCharCode(t.getUint8(e+3))].join("")}function o7(t){return n7(t)}const k1=4,$1=4;function i7(t,e=0){const n={};if(!r2(t,e))throw new Error("Not a PNG");for(e+=8;e<=t.buffer.byteLength;){const r=e,o=t.getInt32(e);e+=4;const i=r7(t,e);if(i==="IDAT"&&n[i]){e+=o+k1+$1;continue}if(i==="IEND")break;n[i]={start:r,dataOffset:e+4,size:o},e+=o+k1+$1}return n}function s7(t,e){return{ppux:t.getUint32(e),ppuy:t.getUint32(e+4),unit:t.getUint8(e+4)}}function gy(t,e){return i7(t)[e]}function a7(t,e=1,n){let r=46,o=0;const i=gy(t,"pHYs");i&&(r=i.start,o=i.size);const s=gy(t,"IDAT");s&&(r=s.start,o=0);const a=new ArrayBuffer(21),l=new DataView(a);l.setUint32(0,9),l.setUint8(4,"p".charCodeAt(0)),l.setUint8(5,"H".charCodeAt(0)),l.setUint8(6,"Y".charCodeAt(0)),l.setUint8(7,"s".charCodeAt(0));const c=2835.5;l.setInt32(8,c*e),l.setInt32(12,c*e),l.setInt8(16,1);const d=new Uint8Array(a.slice(4,17));l.setInt32(17,o7(d));const u=t.buffer.slice(0,r),h=t.buffer.slice(r+o);return new Blob([u,a,h],n)}const Uv=["image/jpeg","image/png","image/gif","image/svg+xml"],o2=["video/mp4","video/quicktime"],l7=Uv.concat(o2).join(", "),i2=t=>Uv.includes(t);async function c7(t){return await new Promise((e,n)=>{const r=document.createElement("video");r.onloadeddata=()=>e({w:r.videoWidth,h:r.videoHeight}),r.onerror=o=>{console.error(o),n(new Error("Could not get video size"))},r.crossOrigin="anonymous",r.src=t})}async function u7(t){return fetch(t).then(function(e){return e.arrayBuffer()})}async function d7(t){return await new Promise((e,n)=>{const r=new Image;r.onload=async()=>{try{const o=await u7(t),i=new DataView(o);if(r2(i,0)){const s=gy(i,"pHYs");if(s){const a=s7(i,s.dataOffset);if(a.unit===0&&a.ppux===a.ppuy){const l=Math.round(a.ppux/2834.5);e({w:r.width/l,h:r.height/l});return}}}e({w:r.width,h:r.height})}catch(o){console.error(o),e({w:r.width,h:r.height})}},r.onerror=o=>{console.error(o),n(new Error("Could not get image size"))},r.crossOrigin="anonymous",r.src=t})}async function h7(t,e,n){return await new Promise(r=>{const o=new Image;o.onload=()=>{const i=document.createElement("canvas"),s=i.getContext("2d");if(!s)return;i.width=e*2,i.height=n*2,s.drawImage(o,0,0,i.width,i.height);const a=i.toDataURL();r(a)},o.crossOrigin="anonymous",o.src=t})}async function p7(t){return await new Promise((e,n)=>{const r=new FileReader;r.onerror=()=>n(r.error),r.onload=async()=>{let o=r.result;const i=i2(t.type),s=i?d7:c7;t.type==="video/quicktime"&&o.includes("video/quicktime")&&(o=o.replace("video/quicktime","video/mp4"));const a=await s(o),l=g7(a,{w:aN,h:lN});l!==a&&(t.type==="image/jpeg"||t.type==="image/png")&&(o=await h7(o,l.w,l.h));const c=pu.createCustomId(hv(o)),d=await f7(t),u={id:c,type:i?"image":"video",typeName:"asset",props:{name:t.name,src:o,w:l.w,h:l.h,mimeType:t.type,isAnimated:d.isAnimated}};e(u)},r.readAsDataURL(t)})}async function f7(t){return t.type==="image/gif"?await new Promise((e,n)=>{const r=new FileReader;r.onerror=()=>n(r.error),r.onload=()=>{e({isAnimated:r.result?VB(r.result):!1})},r.readAsArrayBuffer(t)}):{isAnimated:!i2(t.type)}}function g7(t,e){const n=t.w/e.w,r=t.h/e.h;return n<=1&&r<=1?t:n>r?{w:t.w/n,h:t.h/n}:{w:t.w/r,h:t.h/r}}async function Fv(t,e,n,r=!1){const o=new I(n.x,n.y),i=new Map,s=await Promise.all(e.map(async(p,g)=>{if(!p.type)throw new Error("No mime type");if(!Uv.concat(o2).includes(p.type))return console.warn(`${p.name} not loaded - Extension not allowed.`),null;try{const m=await t.onCreateAssetFromFile(p);if(m.type==="bookmark")return;if(!m)throw Error("Could not create an asset");return i.set(p,m),{id:Ut(),type:m.type,x:o.x+g,y:o.y,props:{w:m.props.w,h:m.props.h,opacity:"1"}}}catch(m){return console.error(m),null}})),a=Ee(s).sort((p,g)=>p.x-g.x);if(a.length===0)return;for(let p=0;p<a.length;p++){const g=a[p];if(p===0)g.x-=g.props.w/2,g.y-=g.props.h/2;else{const m=a[p-1];g.x=m.x+m.props.w,g.y=m.y}}const c=(await Promise.all(e.map(async(p,g)=>{const m=a[g];if(!m)return;const v=i.get(p);if(!v)return;let x=t.getAssetById(v.id);return x?(i.delete(p),m.props&&(m.props.assetId=x.id),m):(x=t.getAssetBySrc(v.props.src),x?(m.props&&(m.props.assetId=x.id),m):(m.props&&(m.props.assetId=v.id),m))}))).filter(o5);t.createAssets(Ee([...i.values()])),t.createShapes(c),t.setSelectedIds(c.map(p=>p.id));const{selectedIds:d,viewportPageBounds:u}=t,h=de.Common(Ee(d.map(p=>t.getPageBoundsById(p))));h&&!u.contains(h)&&t.zoomToSelection()}function s2(t,e,n,r){t.createShapes([{id:Ut(),type:"embed",x:n.x-(r.width||450)/2,y:n.y-(r.height||450)/2,props:{w:r.width,h:r.height,doesResize:r.doesResize,url:e,opacity:"1"}}],!0)}async function m7(t,e,n){const r=pu.createCustomId(hv(e)),o=t.getAssetById(r);if(o){t.createShapes([{id:t.createShapeId(),type:"bookmark",x:n.x-150,y:n.y-160,props:{assetId:o.id,url:o.props.src,opacity:"1"}}]);return}t.batch(async()=>{const i=Ut();t.createShapes([{id:i,type:"bookmark",x:n.x,y:n.y,props:{url:e,opacity:"1"}}],!0);const s=await t.onCreateBookmarkFromUrl(e);s&&(t.createAssets([{id:r,typeName:"asset",type:"bookmark",props:{src:e,description:s.description,image:s.image,title:s.title}}]),t.updateShapes([{id:i,type:"bookmark",props:{assetId:r,opacity:"1"}}]))})}async function y7(t,e,n){const r=new DOMParser().parseFromString(e,"image/svg+xml").querySelector("svg");if(!r)throw new Error("No <svg/> element present");let o=parseFloat(r.getAttribute("width")||"0"),i=parseFloat(r.getAttribute("height")||"0");if(!(o&&i)){document.body.appendChild(r);const a=r.getBoundingClientRect();document.body.removeChild(r),o=a.width,i=a.height}const s=await t.onCreateAssetFromFile(new File([e],"asset.svg",{type:"image/svg+xml"}));s.type!=="bookmark"&&(s.props.w=o,s.props.h=i),t.batch(()=>{t.createAssets([s]),t.createShapes([{id:Ut(),type:"image",x:n.x-o/2,y:n.y-i/2,props:{assetId:s.id,w:o,h:i,opacity:"1"}}],!0)})}const v7=t=>{try{const e=new URL(t);return e.protocol==="http:"||e.protocol==="https:"}catch{return!1}},w7=t=>{const e=t.split(/[\n\s]/);for(const n of e)try{const r=new URL(n);if(!(r.protocol==="http:"||r.protocol==="https:"))return}catch{return}return e2(e)},x7=t=>/^<svg/.test(t);function b7(t,e,n){return fetch(t).then(function(r){return r.arrayBuffer()}).then(function(r){return new File([r],e,{type:n})})}function S7(){const t=Z();return w.useMemo(function(){let r,o;function i(g){g.isKilled||g.button!==0&&g.button!==1&&g.button!==5||(fu(g.currentTarget,g),t.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...Bt(g,t.getContainer())}))}function s(g){g.isKilled||g.clientX===r&&g.clientY===o||(r=g.clientX,o=g.clientY,t.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...Bt(g,t.getContainer())}))}function a(g){g.isKilled||g.button!==0&&g.button!==1&&g.button!==5||(r=g.clientX,o=g.clientY,gu(g.currentTarget,g),t.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...Bt(g,t.getContainer())}))}function l(g){g.isKilled||t.dispatch({type:"pointer",target:"canvas",name:"pointer_enter",...Bt(g,t.getContainer())})}function c(g){g.isKilled||t.dispatch({type:"pointer",target:"canvas",name:"pointer_leave",...Bt(g,t.getContainer())})}function d(g){g.isKilled=!0,document.body.click(),Ve(g)}function u(g){g.isKilled=!0,g.target.tagName!=="A"&&g.target.tagName!=="TEXTAREA"&&Ve(g)}function h(g){Ve(g)}async function p(g){var v,x;if(Ve(g),!((x=(v=g.dataTransfer)==null?void 0:v.files)!=null&&x.length))return;const m=Array.from(g.dataTransfer.files).filter(b=>!b.name.endsWith(".tldr"));await Fv(t,m,t.screenToPage(g.clientX,g.clientY),!1)}return{onPointerDown:i,onPointerMove:s,onPointerUp:a,onPointerEnter:l,onPointerLeave:c,onDragOver:h,onDrop:p,onTouchStart:d,onTouchEnd:u}},[t])}function E7(){const t=Z();w.useEffect(()=>{const e=window.matchMedia("(pointer: coarse)"),n=()=>{t.isCoarsePointer=e.matches};return n(),e.addEventListener("change",n),()=>e.removeEventListener("change",n)},[t])}const a2=w.createContext(null);function P7({container:t,children:e}){return f.jsx(a2.Provider,{value:t,children:e})}function Tn(){return Zj(w.useContext(a2),"useContainer used outside of <Tldraw />")}function _7(){const t=Z(),e=Tn(),n=ge("isFocused",()=>t.isFocused,[t]);w.useEffect(()=>{if(!n)return;const r=c=>{if(c.altKey&&(t.isIn("zoom")||!t.root.path.value.endsWith(".idle"))&&!$l()&&Ve(c),c.isKilled)return;switch(c.isKilled=!0,c.key){case"=":{if(c.metaKey||c.ctrlKey){Ve(c);return}break}case"-":{if(c.metaKey||c.ctrlKey){Ve(c);return}break}case"0":{if(c.metaKey||c.ctrlKey){Ve(c);return}break}case"Tab":{if($l()||t.isMenuOpen)return;break}case",":{if(!$l()&&(Ve(c),!t.inputs.keys.has("Comma"))){const{x:u,y:h,z:p}=t.inputs.currentScreenPoint,{pageState:{hoveredId:g}}=t;t.inputs.keys.add("Comma");const m={type:"pointer",name:"pointer_down",point:{x:u,y:h,z:p},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:t.isPenMode,...g?{target:"shape",shape:t.getShapeById(g)}:{target:"canvas"}};t.dispatch(m);return}break}case"Escape":{t.inputs.keys.has("Escape")||(t.inputs.keys.add("Escape"),t.cancel(),e.focus());return}default:if($l()||t.isMenuOpen)return}const d={type:"keyboard",name:t.inputs.keys.has(c.code)?"key_repeat":"key_down",key:c.key,code:c.code,shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey};t.dispatch(d)},o=c=>{var u;if(c.isKilled||(c.isKilled=!0,$l()||t.isMenuOpen))return;if(c.key===","&&((u=document.activeElement)!=null&&u.ELEMENT_NODE&&Ve(c),t.inputs.keys.has(c.code))){const{x:h,y:p,z:g}=t.inputs.currentScreenPoint,{pageState:{hoveredId:m}}=t;t.inputs.keys.delete(c.code);const v={type:"pointer",name:"pointer_up",point:{x:h,y:p,z:g},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:t.isPenMode,...m?{target:"shape",shape:t.getShapeById(m)}:{target:"canvas"}};t.dispatch(v);return}const d={type:"keyboard",name:"key_up",key:c.key,code:c.code,shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey};t.dispatch(d)};function i(c){var d,u;if(e.contains(c.target)){const h=c.touches[0].pageX,p=c.touches[0].radiusX||0;(h-p<10||h+p>t.viewportScreenBounds.width-10)&&(((d=c.target)==null?void 0:d.tagName)==="BUTTON"&&((u=c.target)==null||u.click()),Ve(c))}}const s=c=>{e.contains(c.target)&&(c.ctrlKey||c.metaKey)&&Ve(c)};function a(){t.complete()}function l(){t.updateViewportScreenBounds()}return e.addEventListener("touchstart",i,{passive:!1}),document.addEventListener("wheel",s,{passive:!1}),document.addEventListener("gesturestart",Ve),document.addEventListener("gesturechange",Ve),document.addEventListener("gestureend",Ve),document.addEventListener("keydown",r),document.addEventListener("keyup",o),window.addEventListener("blur",a),window.addEventListener("focus",l),()=>{e.removeEventListener("touchstart",i),document.removeEventListener("wheel",s),document.removeEventListener("gesturestart",Ve),document.removeEventListener("gesturechange",Ve),document.removeEventListener("gestureend",Ve),document.removeEventListener("keydown",r),document.removeEventListener("keyup",o),window.removeEventListener("blur",a),window.removeEventListener("focus",l)}},[t,e,n])}const I7=["input","select","button","textarea"];function $l(){const{activeElement:t}=document;return!!(t&&(t.getAttribute("contenteditable")||I7.indexOf(t.tagName.toLowerCase())>-1))}const C7=["textarea","input"];function k7(t){const e=Z();w.useEffect(()=>{const n=t.current;if(!n)return;const r=o=>{var i;if(o instanceof PointerEvent&&o.pointerType==="pen"){o.isKilled=!0;const{target:s}=o;if(C7.includes((i=s.tagName)==null?void 0:i.toLocaleLowerCase())||e.isIn("select.editing_shape"))return;Ve(o)}};return n.addEventListener("touchstart",r),n.addEventListener("touchend",r),()=>{n.removeEventListener("touchstart",r),n.addEventListener("touchend",r)}},[e,t])}function $7(t,e,n){return Math.max(e,Math.min(t,n))}const sn={toVector(t,e){return t===void 0&&(t=e),Array.isArray(t)?t:[t,t]},add(t,e){return[t[0]+e[0],t[1]+e[1]]},sub(t,e){return[t[0]-e[0],t[1]-e[1]]},addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function T1(t,e,n){return e===0||Math.abs(e)===1/0?Math.pow(t,n*5):t*e*n/(e+n*t)}function M1(t,e,n,r=.15){return r===0?$7(t,e,n):t<e?-T1(e-t,n-e,r)+e:t>n?+T1(t-n,n-e,r)+n:t}function T7(t,[e,n],[r,o]){const[[i,s],[a,l]]=t;return[M1(e,i,s,r),M1(n,a,l,o)]}function M7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function A7(t){var e=M7(t,"string");return typeof e=="symbol"?e:String(e)}function fn(t,e,n){return e=A7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function gt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?A1(Object(n),!0).forEach(function(r){fn(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const l2={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function R1(t){return t?t[0].toUpperCase()+t.slice(1):""}const R7=["enter","leave"];function L7(t=!1,e){return t&&!R7.includes(e)}function D7(t,e="",n=!1){const r=l2[t],o=r&&r[e]||e;return"on"+R1(t)+R1(o)+(L7(n,o)?"Capture":"")}const O7=["gotpointercapture","lostpointercapture"];function j7(t){let e=t.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const r=O7.includes(e)?"capturecapture":"capture",o=!!~e.indexOf(r);return o&&(e=e.replace("capture","")),{device:e,capture:o,passive:n}}function N7(t,e=""){const n=l2[t],r=n&&n[e]||e;return t+r}function c2(t){return"touches"in t}function B7(t){return c2(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function z7(t){return Array.from(t.touches).filter(e=>{var n,r;return e.target===t.currentTarget||((n=t.currentTarget)===null||n===void 0||(r=n.contains)===null||r===void 0?void 0:r.call(n,e.target))})}function my(t,e){try{const n=e.clientX-t.clientX,r=e.clientY-t.clientY,o=(e.clientX+t.clientX)/2,i=(e.clientY+t.clientY)/2,s=Math.hypot(n,r);return{angle:-(Math.atan2(n,r)*180)/Math.PI,distance:s,origin:[o,i]}}catch{}return null}function U7(t){return z7(t).map(e=>e.identifier)}function L1(t,e){const[n,r]=Array.from(t.touches).filter(o=>e.includes(o.identifier));return my(n,r)}const D1=40,O1=800;function u2(t){let{deltaX:e,deltaY:n,deltaMode:r}=t;return r===1?(e*=D1,n*=D1):r===2&&(e*=O1,n*=O1),[e,n]}function F7(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:r,metaKey:o,ctrlKey:i}=t;Object.assign(e,{shiftKey:n,altKey:r,metaKey:o,ctrlKey:i})}return e}function Nh(t,...e){return typeof t=="function"?t(...e):t}function K7(){}function H7(...t){return t.length===0?K7:t.length===1?t[0]:function(){let e;for(const n of t)e=n.apply(this,arguments)||e;return e}}function j1(t,e){return Object.assign({},e,t||{})}const V7=32;class d2{constructor(e,n,r){this.ctrl=e,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:n,ingKey:r,args:o}=this;n[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=o,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const n=this.state,r=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=e.target,n.currentTarget=e.currentTarget,n.lastOffset=r.from?Nh(r.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=e.timeStamp)}computeValues(e){const n=this.state;n._values=e,n.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:n,config:r,shared:o}=this;n.args=this.args;let i=0;if(e&&(n.event=e,r.preventDefault&&e.cancelable&&n.event.preventDefault(),n.type=e.type,o.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,o.locked=!!document.pointerLockElement,Object.assign(o,F7(e)),o.down=o.pressed=o.buttons%2===1||o.touches>0,i=e.timeStamp-n.timeStamp,n.timeStamp=e.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const k=n._delta.map(Math.abs);sn.addTo(n._distance,k)}this.axisIntent&&this.axisIntent(e);const[s,a]=n._movement,[l,c]=r.threshold,{_step:d,values:u}=n;if(r.hasCustomTransform?(d[0]===!1&&(d[0]=Math.abs(s)>=l&&u[0]),d[1]===!1&&(d[1]=Math.abs(a)>=c&&u[1])):(d[0]===!1&&(d[0]=Math.abs(s)>=l&&Math.sign(s)*l),d[1]===!1&&(d[1]=Math.abs(a)>=c&&Math.sign(a)*c)),n.intentional=d[0]!==!1||d[1]!==!1,!n.intentional)return;const h=[0,0];if(r.hasCustomTransform){const[k,$]=u;h[0]=d[0]!==!1?k-d[0]:0,h[1]=d[1]!==!1?$-d[1]:0}else h[0]=d[0]!==!1?s-d[0]:0,h[1]=d[1]!==!1?a-d[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(h);const p=n.offset,g=n._active&&!n._blocked||n.active;g&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=o[this.ingKey]=n._active,e&&(n.first&&("bounds"in r&&(n._bounds=Nh(r.bounds,n)),this.setup&&this.setup()),n.movement=h,this.computeOffset()));const[m,v]=n.offset,[[x,b],[E,P]]=n._bounds;n.overflow=[m<x?-1:m>b?1:0,v<E?-1:v>P?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const C=n._active?r.rubberband||[0,0]:[0,0];if(n.offset=T7(n._bounds,n.offset,C),n.delta=sn.sub(n.offset,p),this.computeMovement(),g&&(!n.last||i>V7)){n.delta=sn.sub(n.offset,p);const k=n.delta.map(Math.abs);sn.addTo(n.distance,k),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&i>0&&(n.velocity=[k[0]/i,k[1]/i],n.timeDelta=i)}}emit(){const e=this.state,n=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;const o=this.handler(gt(gt(gt({},n),e),{},{[this.aliasKey]:e.values}));o!==void 0&&(e.memo=o)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function W7([t,e],n){const r=Math.abs(t),o=Math.abs(e);if(r>o&&r>n)return"x";if(o>r&&o>n)return"y"}class Y7 extends d2{constructor(...e){super(...e),fn(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=sn.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=sn.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const n=this.state,r=this.config;if(!n.axis&&e){const o=typeof r.axisThreshold=="object"?r.axisThreshold[B7(e)]:r.axisThreshold;n.axis=W7(n._movement,o)}n._blocked=(r.lockDirection||!!r.axis)&&!n.axis||!!r.axis&&r.axis!==n.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const X7=t=>t,N1=.15,h2={enabled(t=!0){return t},eventOptions(t,e,n){return gt(gt({},n.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[N1,N1];case!1:return[0,0];default:return sn.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return sn.toVector(t)},transform(t,e,n){const r=t||n.shared.transform;return this.hasCustomTransform=!!r,r||X7},threshold(t){return sn.toVector(t,0)}},G7=0,yu=gt(gt({},h2),{},{axis(t,e,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(t=G7){return t},bounds(t={}){if(typeof t=="function")return i=>yu.bounds(t(i));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:n=1/0,top:r=-1/0,bottom:o=1/0}=t;return[[e,n],[r,o]]}}),vu=typeof window<"u"&&window.document&&window.document.createElement;function q7(){return vu&&"ontouchstart"in window}function B1(){return q7()||vu&&window.navigator.maxTouchPoints>1}function Q7(){return vu&&"onpointerdown"in window}function Z7(){return vu&&"exitPointerLock"in window.document}function J7(){try{return"constructor"in GestureEvent}catch{return!1}}const Er={isBrowser:vu,gesture:J7(),touch:B1(),touchscreen:B1(),pointer:Q7(),pointerLock:Z7()},ez=250,tz=180,nz=.5,rz=50,oz=250,iz=10,z1={mouse:0,touch:0,pen:8};gt(gt({},yu),{},{device(t,e,{pointer:{touch:n=!1,lock:r=!1,mouse:o=!1}={}}){return this.pointerLock=r&&Er.pointerLock,Er.touch&&n?"touch":this.pointerLock?"mouse":Er.pointer&&!o?"pointer":Er.touch?"touch":"mouse"},preventScrollAxis(t,e,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&t?ez:void 0,!(!Er.touchscreen||n===!1))return t||(n!==void 0?"y":void 0)},pointerCapture(t,e,{pointer:{capture:n=!0,buttons:r=1,keys:o=!0}={}}){return this.pointerButtons=r,this.keys=o,!this.pointerLock&&this.device==="pointer"&&n},threshold(t,e,{filterTaps:n=!1,tapsThreshold:r=3,axis:o=void 0}){const i=sn.toVector(t,n?r:o?1:0);return this.filterTaps=n,this.tapsThreshold=r,i},swipe({velocity:t=nz,distance:e=rz,duration:n=oz}={}){return{velocity:this.transform(sn.toVector(t)),distance:this.transform(sn.toVector(e)),duration:n}},delay(t=0){switch(t){case!0:return tz;case!1:return 0;default:return t}},axisThreshold(t){return t?gt(gt({},z1),t):z1},keyboardDisplacement(t=iz){return t}});function p2(t){const[e,n]=t.overflow,[r,o]=t._delta,[i,s]=t._direction;(e<0&&r>0&&i<0||e>0&&r<0&&i>0)&&(t._movement[0]=t._movementBound[0]),(n<0&&o>0&&s<0||n>0&&o<0&&s>0)&&(t._movement[1]=t._movementBound[1])}const sz=30,az=100;class lz extends d2{constructor(...e){super(...e),fn(this,"ingKey","pinching"),fn(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){const{type:e,movement:n,lastOffset:r}=this.state;e==="wheel"?this.state.offset=sn.add(n,r):this.state.offset=[(1+n[0])*r[0],n[1]+r[1]]}computeMovement(){const{offset:e,lastOffset:n}=this.state;this.state.movement=[e[0]/n[0],e[1]-n[1]]}axisIntent(){const e=this.state,[n,r]=e._movement;if(!e.axis){const o=Math.abs(n)*sz-Math.abs(r);o<0?e.axis="angle":o>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&(this.state.axis==="scale"?e[1]=0:this.state.axis==="angle"&&(e[0]=0))}cancel(){const e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);const n=this.state,r=this.ctrl.touchIds;if(n._active&&n._touchIds.every(i=>r.has(i))||r.size<2)return;this.start(e),n._touchIds=Array.from(r).slice(0,2);const o=L1(e,n._touchIds);o&&this.pinchStart(e,o)}pointerStart(e){if(e.buttons!=null&&e.buttons%2!==1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);const n=this.state,r=n._pointerEvents,o=this.ctrl.pointerIds;if(n._active&&Array.from(r.keys()).every(s=>o.has(s))||(r.size<2&&r.set(e.pointerId,e),n._pointerEvents.size<2))return;this.start(e);const i=my(...Array.from(r.values()));i&&this.pinchStart(e,i)}pinchStart(e,n){const r=this.state;r.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;const n=L1(e,this.state._touchIds);n&&this.pinchMove(e,n)}pointerMove(e){const n=this.state._pointerEvents;if(n.has(e.pointerId)&&n.set(e.pointerId,e),!this.state._active)return;const r=my(...Array.from(n.values()));r&&this.pinchMove(e,r)}pinchMove(e,n){const r=this.state,o=r._values[1],i=n.angle-o;let s=0;Math.abs(i)>270&&(s+=Math.sign(i)),this.computeValues([n.distance,n.angle-360*s]),r.origin=n.origin,r.turns=s,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){const n=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch{}n._pointerEvents.has(e.pointerId)&&n._pointerEvents.delete(e.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();const n=this.state;n._active||(this.start(e),this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY];const r=n._movement;n._movement=[e.scale-1,e.rotation],n._delta=sn.sub(n._movement,r),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){const n=this.config.modifierKey;n&&!e[n]||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();const r=this.state;r._delta=[-u2(e)[1]/az*r.offset[0],0],sn.addTo(r._movement,r._delta),p2(r),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){const n=this.config.device;n&&(e(n,"start",this[n+"Start"].bind(this)),e(n,"change",this[n+"Move"].bind(this)),e(n,"end",this[n+"End"].bind(this)),e(n,"cancel",this[n+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}const cz=gt(gt({},h2),{},{device(t,e,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!Er.touch&&Er.gesture)return"gesture";if(Er.touch&&r)return"touch";if(Er.touchscreen){if(Er.pointer)return"pointer";if(Er.touch)return"touch"}},bounds(t,e,{scaleBounds:n={},angleBounds:r={}}){const o=s=>{const a=j1(Nh(n,s),{min:-1/0,max:1/0});return[a.min,a.max]},i=s=>{const a=j1(Nh(r,s),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof n!="function"&&typeof r!="function"?[o(),i()]:s=>[o(s),i(s)]},threshold(t,e,n){return this.lockDirection=n.axis==="lock",sn.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});gt(gt({},yu),{},{mouseOnly:(t=!0)=>t});class uz extends Y7{constructor(...e){super(...e),fn(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const n=this.state;n._delta=u2(e),sn.addTo(n._movement,n._delta),p2(n),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}const dz=yu;gt(gt({},yu),{},{mouseOnly:(t=!0)=>t});const Kv=new Map,yy=new Map;function hz(t){Kv.set(t.key,t.engine),yy.set(t.key,t.resolver)}const pz={key:"pinch",engine:lz,resolver:cz},fz={key:"wheel",engine:uz,resolver:dz};function gz(t,e){if(t==null)return{};var n={},r=Object.keys(t),o,i;for(i=0;i<r.length;i++)o=r[i],!(e.indexOf(o)>=0)&&(n[o]=t[o]);return n}function mz(t,e){if(t==null)return{};var n=gz(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}const yz={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=Er.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:e=!1}={}){return{passive:t,capture:e}},transform(t){return t}},vz=["target","eventOptions","window","enabled","transform"];function Fd(t={},e){const n={};for(const[r,o]of Object.entries(e))switch(typeof o){case"function":n[r]=o.call(n,t[r],r,t);break;case"object":n[r]=Fd(t[r],o);break;case"boolean":o&&(n[r]=t[r]);break}return n}function wz(t,e,n={}){const r=t,{target:o,eventOptions:i,window:s,enabled:a,transform:l}=r,c=mz(r,vz);if(n.shared=Fd({target:o,eventOptions:i,window:s,enabled:a,transform:l},yz),e){const d=yy.get(e);n[e]=Fd(gt({shared:n.shared},c),d)}else for(const d in c){const u=yy.get(d);u&&(n[d]=Fd(gt({shared:n.shared},c[d]),u))}return n}class f2{constructor(e,n){fn(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=n}add(e,n,r,o,i){const s=this._listeners,a=N7(n,r),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=gt(gt({},l),i);e.addEventListener(a,o,c);const d=()=>{e.removeEventListener(a,o,c),s.delete(d)};return s.add(d),d}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class xz{constructor(){fn(this,"_timeouts",new Map)}add(e,n,r=140,...o){this.remove(e),this._timeouts.set(e,window.setTimeout(n,r,...o))}remove(e){const n=this._timeouts.get(e);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class bz{constructor(e){fn(this,"gestures",new Set),fn(this,"_targetEventStore",new f2(this)),fn(this,"gestureEventStores",{}),fn(this,"gestureTimeoutStores",{}),fn(this,"handlers",{}),fn(this,"config",{}),fn(this,"pointerIds",new Set),fn(this,"touchIds",new Set),fn(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),Sz(this,e)}setEventIds(e){if(c2(e))return this.touchIds=new Set(U7(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,n){this.handlers=e,this.nativeHandlers=n}applyConfig(e,n){this.config=wz(e,n,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const n=this.config.shared,r={};let o;if(!(n.target&&(o=n.target(),!o))){if(n.enabled){for(const s of this.gestures){const a=this.config[s],l=U1(r,a.eventOptions,!!o);if(a.enabled){const c=Kv.get(s);new c(this,e,s).bind(l)}}const i=U1(r,n.eventOptions,!!o);for(const s in this.nativeHandlers)i(s,"",a=>this.nativeHandlers[s](gt(gt({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const i in r)r[i]=H7(...r[i]);if(!o)return r;for(const i in r){const{device:s,capture:a,passive:l}=j7(i);this._targetEventStore.add(o,s,"",r[i],{capture:a,passive:l})}}}}function ta(t,e){t.gestures.add(e),t.gestureEventStores[e]=new f2(t,e),t.gestureTimeoutStores[e]=new xz}function Sz(t,e){e.drag&&ta(t,"drag"),e.wheel&&ta(t,"wheel"),e.scroll&&ta(t,"scroll"),e.move&&ta(t,"move"),e.pinch&&ta(t,"pinch"),e.hover&&ta(t,"hover")}const U1=(t,e,n)=>(r,o,i,s={},a=!1)=>{var l,c;const d=(l=s.capture)!==null&&l!==void 0?l:e.capture,u=(c=s.passive)!==null&&c!==void 0?c:e.passive;let h=a?r:D7(r,o,d);n&&u&&(h+="Passive"),t[h]=t[h]||[],t[h].push(i)},Ez=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function Pz(t){const e={},n={},r=new Set;for(let o in t)Ez.test(o)?(r.add(RegExp.lastMatch),n[o]=t[o]):e[o]=t[o];return[n,e,r]}function na(t,e,n,r,o,i){if(!t.has(n)||!Kv.has(r))return;const s=n+"Start",a=n+"End",l=c=>{let d;return c.first&&s in e&&e[s](c),n in e&&(d=e[n](c)),c.last&&a in e&&e[a](c),d};o[r]=l,i[r]=i[r]||{}}function _z(t,e){const[n,r,o]=Pz(t),i={};return na(o,n,"onDrag","drag",i,e),na(o,n,"onWheel","wheel",i,e),na(o,n,"onScroll","scroll",i,e),na(o,n,"onPinch","pinch",i,e),na(o,n,"onMove","move",i,e),na(o,n,"onHover","hover",i,e),{handlers:i,config:e,nativeHandlers:r}}function Iz(t,e={},n,r){const o=xe.useMemo(()=>new bz(t),[]);if(o.applyHandlers(t,r),o.applyConfig(e,n),xe.useEffect(o.effect.bind(o)),xe.useEffect(()=>o.clean.bind(o),[]),e.target===void 0)return o.bind.bind(o)}function Cz(t){return t.forEach(hz),function(n,r){const{handlers:o,nativeHandlers:i,config:s}=_z(n,r||{});return Iz(o,s,void 0,i)}}var g2="Expected a function",F1=0/0,kz="[object Symbol]",$z=/^\s+|\s+$/g,Tz=/^[-+]0x[0-9a-f]+$/i,Mz=/^0b[01]+$/i,Az=/^0o[0-7]+$/i,Rz=parseInt,Lz=typeof zn=="object"&&zn&&zn.Object===Object&&zn,Dz=typeof self=="object"&&self&&self.Object===Object&&self,Oz=Lz||Dz||Function("return this")(),jz=Object.prototype,Nz=jz.toString,Bz=Math.max,zz=Math.min,Eg=function(){return Oz.Date.now()};function Uz(t,e,n){var r,o,i,s,a,l,c=0,d=!1,u=!1,h=!0;if(typeof t!="function")throw new TypeError(g2);e=K1(e)||0,Bh(n)&&(d=!!n.leading,u="maxWait"in n,i=u?Bz(K1(n.maxWait)||0,e):i,h="trailing"in n?!!n.trailing:h);function p(k){var $=r,A=o;return r=o=void 0,c=k,s=t.apply(A,$),s}function g(k){return c=k,a=setTimeout(x,e),d?p(k):s}function m(k){var $=k-l,A=k-c,D=e-$;return u?zz(D,i-A):D}function v(k){var $=k-l,A=k-c;return l===void 0||$>=e||$<0||u&&A>=i}function x(){var k=Eg();if(v(k))return b(k);a=setTimeout(x,m(k))}function b(k){return a=void 0,h&&r?p(k):(r=o=void 0,s)}function E(){a!==void 0&&clearTimeout(a),c=0,r=l=o=a=void 0}function P(){return a===void 0?s:b(Eg())}function C(){var k=Eg(),$=v(k);if(r=arguments,o=this,l=k,$){if(a===void 0)return g(l);if(u)return a=setTimeout(x,e),p(l)}return a===void 0&&(a=setTimeout(x,e)),s}return C.cancel=E,C.flush=P,C}function Fz(t,e,n){var r=!0,o=!0;if(typeof t!="function")throw new TypeError(g2);return Bh(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Uz(t,e,{leading:r,maxWait:e,trailing:o})}function Bh(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Kz(t){return!!t&&typeof t=="object"}function Hz(t){return typeof t=="symbol"||Kz(t)&&Nz.call(t)==kz}function K1(t){if(typeof t=="number")return t;if(Hz(t))return F1;if(Bh(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Bh(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace($z,"");var n=Mz.test(t);return n||Az.test(t)?Rz(t.slice(2),n?2:8):Tz.test(t)?F1:+t}var Vz=Fz;const m2=tl(Vz),H1=10,Wz=/Mac|iPod|iPhone|iPad/.test(typeof window>"u"?"node":window.navigator.platform);function y2(t){let{deltaY:e,deltaX:n}=t,r=0;if(t.ctrlKey||t.altKey||t.metaKey){const o=Math.sign(t.deltaY),i=Math.abs(t.deltaY);let s=e;i>H1&&(s=H1*o),r=s/100}else t.shiftKey&&!Wz&&(n=e,e=0);return{x:-n,y:-e,z:-r}}const Yz=Cz([fz,pz]);let ra;const Xz=t=>ra===void 0?(ra=t,!1):t-ra>120&&t-ra<160?(ra=t,!0):(ra=t,!1);function Gz(t){const e=Z(),n=w.useMemo(()=>{let r=null;const o=({event:m})=>{if(!e.isFocused||(r=null,Xz(Date.now())))return;if(e.editingId){const b=e.getShapeById(e.editingId);if(b&&e.getShapeUtil(b).canScroll(b)){const P=e.getPageBoundsById(e.editingId);if(P!=null&&P.containsPoint(e.inputs.currentPagePoint))return}}Ve(m);const v=y2(m);if(v.x===0&&v.y===0)return;const x={type:"wheel",name:"wheel",delta:v,shiftKey:m.shiftKey,altKey:m.altKey,ctrlKey:m.metaKey||m.ctrlKey};e.dispatch(x)};let i=1,s=1,a=1,l=0;const c=new I,d=new I,u=m=>{const v=t.current;r=null;const{event:x,origin:b,da:E}=m;x instanceof WheelEvent||(x.target===v||v!=null&&v.contains(x.target))&&(d.x=b[0],d.y=b[1],c.x=b[0],c.y=b[1],i=E[0],s=e.zoomLevel,e.dispatch({type:"pinch",name:"pinch_start",point:{x:b[0],y:b[1],z:e.zoomLevel},delta:{x:0,y:0},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey}))},h=m2(m=>{if(r===null){const v=Math.abs(l-i),x=I.Dist(c,d);m==="gesture"&&v||m==="touch"&&v>16?r="zooming":x>16&&(r="panning")}},32);return{onWheel:o,onPinchStart:u,onPinchEnd:m=>{const v=t.current,{event:x,origin:b,offset:E}=m;if(x instanceof WheelEvent||!(x.target===v||v!=null&&v.contains(x.target)))return;const P=E[0];r=null,requestAnimationFrame(()=>{e.dispatch({type:"pinch",name:"pinch_end",point:{x:b[0],y:b[1],z:P},delta:{x:b[0],y:b[1]},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey})})},onPinch:m=>{const v=t.current,{event:x,origin:b,offset:E,da:P}=m;if(x instanceof WheelEvent||!(x.target===v||v!=null&&v.contains(x.target)))return;const C=!("touches"in x);l=P[0],(C||l>64)&&(a=E[0]);const k=b[0]-d.x,$=b[1]-d.y;switch(d.x=b[0],d.y=b[1],h(C?"gesture":"touch"),r){case"zooming":{e.dispatch({type:"pinch",name:"pinch",point:{x:b[0],y:b[1],z:a},delta:{x:k,y:$},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey});break}case"panning":{e.dispatch({type:"pinch",name:"pinch",point:{x:b[0],y:b[1],z:s},delta:{x:k,y:$},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey});break}}}}},[e,t]);Yz(n,{target:t,eventOptions:{passive:!1},pinch:{from:()=>[e.zoomLevel,0],scaleBounds:()=>({from:e.zoomLevel,max:8,min:.05})}})}function Tl(t,e,n){const r=t.getShapeById(e),i=t.getShapeUtil(r).handles(r);return{shape:r,handle:i.find(s=>s.id===n)}}function qz(t,e){const n=Z();return w.useMemo(()=>{const r=d=>{if(d.isKilled)return;const u=Oh(d.currentTarget);fu(u,d);const{shape:h,handle:p}=Tl(n,t,e);p&&n.dispatch({type:"pointer",target:"handle",handle:p,shape:h,name:"pointer_down",...Bt(d,n.getContainer())})};let o,i;return{onPointerDown:r,onPointerMove:d=>{if(d.isKilled||d.clientX===o&&d.clientY===i)return;o=d.clientX,i=d.clientY;const{shape:u,handle:h}=Tl(n,t,e);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:u,name:"pointer_move",...Bt(d,n.getContainer())})},onPointerUp:d=>{if(d.isKilled)return;const u=Oh(d.currentTarget);gu(u,d);const{shape:h,handle:p}=Tl(n,t,e);p&&n.dispatch({type:"pointer",target:"handle",handle:p,shape:h,name:"pointer_up",...Bt(d,n.getContainer())})},onPointerEnter:d=>{if(d.isKilled)return;const{shape:u,handle:h}=Tl(n,t,e);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:u,name:"pointer_enter",...Bt(d,n.getContainer())})},onPointerLeave:d=>{if(d.isKilled)return;const{shape:u,handle:h}=Tl(n,t,e);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:u,name:"pointer_leave",...Bt(d,n.getContainer())})}}},[n,t,e])}const ql=8,V1=(t,e,n)=>new Promise((r,o)=>{const i=ql*e*t,s=document.createElement("canvas");s.width=i,s.height=i;const a=s.getContext("2d");if(!a)throw new Error("No canvas");a.fillStyle=n?"#212529":"#f8f9fa",a.fillRect(0,0,i,i),a.globalCompositeOperation="destination-out",a.lineCap="round",a.lineWidth=1.25*e*t;const l=8/12,c=d=>d*e*t;a.beginPath(),a.moveTo(c(l*1),c(l*3)),a.lineTo(c(l*3),c(l*1)),a.moveTo(c(l*5),c(l*7)),a.lineTo(c(l*7),c(l*5)),a.moveTo(c(l*9),c(l*11)),a.lineTo(c(l*11),c(l*9)),a.stroke(),s.toBlob(d=>{!d||Gt.throwToBlob.value?o():r(d)})}),W1=(t,e)=>{const n=document.createElement("canvas");return n.width=t[0],n.height=t[1],e(n.getContext("2d")),n.toDataURL()},Qz=()=>{const t=[];for(let e=1;e<=Math.ceil(gi);e++){const n=W1([1,1],o=>{o.fillStyle="#e8e8e8",o.fillRect(0,0,1,1)}),r=W1([1,1],o=>{o.fillStyle="#2c3036",o.fillRect(0,0,1,1)});t.push({zoom:e,url:n,darkMode:!1}),t.push({zoom:e,url:r,darkMode:!0})}return t},Zz=()=>{const e=Z().devicePixelRatio,[n,r]=w.useState(!1),o=w.useMemo(()=>Qz(),[]),[i,s]=w.useState(o);return w.useEffect(()=>{const l=[];for(let d=1;d<=Math.ceil(gi);d++)l.push(V1(e,d,!1).then(u=>({zoom:d,url:URL.createObjectURL(u),darkMode:!1}))),l.push(V1(e,d,!0).then(u=>({zoom:d,url:URL.createObjectURL(u),darkMode:!0})));let c=!1;return Promise.all(l).then(d=>{c||(s(d),r(!0))}),()=>{c=!0,r(!1)}},[e]),{context:f.jsx(f.Fragment,{children:i.map(l=>{const c=l.zoom+(l.darkMode?"_dark":"_light");return f.jsx("pattern",{id:Ah[c],width:ql,height:ql,patternUnits:"userSpaceOnUse",children:f.jsx("image",{href:l.url,width:ql,height:ql})},c)})}),isReady:n}},gr=8/12;function Jz(t){const e=document.createElement("div");return e.innerHTML=`
		<svg>
			<defs>
				<mask id="hash_pattern_mask">
					<rect x="0" y="0" width="8" height="8" fill="white" />
					<g
						strokeLinecap="round"
						stroke="black"
					>
						<line x1="${gr*1}" y1="${gr*3}" x2="${gr*3}" y2="${gr*1}" />
						<line x1="${gr*5}" y1="${gr*7}" x2="${gr*7}" y2="${gr*5}" />
						<line x1="${gr*9}" y1="${gr*11}" x2="${gr*11}" y2="${gr*9}" />
					</g>
				</mask>
				<pattern
					id="hash_pattern"
					width="8"
					height="8"
					patternUnits="userSpaceOnUse"
				>
					<rect x="0" y="0" width="8" height="8" fill="${t}" mask="url(#hash_pattern_mask)" />
				</pattern>
			</defs>
		</svg>
	`,e.querySelectorAll("defs > *")}function Ps(t,e,n=Cr){w.useEffect(()=>{const r=new uu(t,e);return r.attach(),r.execute(),()=>{r.detach()}},n)}function eU(){const t=Z(),e=Tn();w.useLayoutEffect(()=>{const n=m2(()=>{t.updateViewportScreenBounds()},200,{trailing:!0}),r=new ResizeObserver(o=>{o[0].contentRect&&n()});return e&&r.observe(e),n(),()=>{r.disconnect()}},[t,e])}const tU=()=>{const t=Z(),e=zI("time",Date.now());return xe.useEffect(()=>{const n=setInterval(()=>e.set(Date.now()),5e3);return()=>clearInterval(n)},[e]),w.useMemo(()=>t.store.query.records("user_presence",()=>({lastActivityTimestamp:{gt:e.value-rU},userId:{neq:t.userId}})),[t,e])},nU=Me(function(){const e=Z(),{viewportPageBounds:n,zoomLevel:r}=e,o=tU();return f.jsx(f.Fragment,{children:o.value.map(i=>f.jsx(oU,{presence:i,viewport:n,zoom:r},i.id))})}),rU=1e3*10,oU=Me(function({presence:e,viewport:n,zoom:r}){const o=Z(),{CollaboratorBrush:i,CollaboratorScribble:s,CollaboratorCursor:a,CollaboratorHint:l,CollaboratorShapeIndicator:c}=wn(),{userId:d,color:u,cursor:h,lastUsedInstanceId:p}=e,g=w.useMemo(()=>p?o.store.query.record("instance_page_state",()=>({instanceId:{eq:p},pageId:{eq:o.currentPageId}})):null,[o,p]),m=w.useMemo(()=>o.store.query.record("user",()=>({id:{eq:d}})),[o,d]);if(!p||!g||!m)return null;const v=o.store.get(p);if(!v||v.currentPageId!==o.currentPageId||!g.value||!m.value)return null;const{brush:x,scribble:b}=v,{selectedIds:E}=g.value,{name:P}=m.value,C=!(h.x<n.minX-12/r||h.y<n.minY-16/r||h.x>n.maxX-12/r||h.y>n.maxY-16/r);return f.jsxs(f.Fragment,{children:[x&&i?f.jsx(i,{className:"tl-collaborator__brush",brush:x,color:u,opacity:.1},d+"_brush"):null,C&&a?f.jsx(a,{className:"tl-collaborator__cursor",point:h,color:u,zoom:r,name:P!=="New User"?P:null},d+"_cursor"):l?f.jsx(l,{className:"tl-collaborator__cursor-hint",point:h,color:u,zoom:r,viewport:n},d+"_cursor_hint"):null,b&&s?f.jsx(s,{className:"tl-collaborator__scribble",scribble:b,color:u,zoom:r,opacity:.1},d+"_scribble"):null,c&&E.map(k=>f.jsx(c,{className:"tl-collaborator__shape-indicator",id:k,color:u,opacity:.5},d+"_"+k))]})});function iU(){const t=Z(),e=w.useMemo(()=>t.store.query.records("instance_presence"),[t]),n=vN("userIds",()=>e2(e.value.map(r=>r.userId)).sort(),{isEqual:(r,o)=>{var i;return r.join(",")===((i=o.join)==null?void 0:i.call(o,","))}},[e]);return ge(n)}function sU(t){const e=Z(),n=w.useMemo(()=>e.store.query.records("instance_presence",()=>({userId:{eq:t}})),[e,t]);return ge(`latestPresence:${t}`,()=>n.value.slice().sort((o,i)=>i.lastActivityTimestamp-o.lastActivityTimestamp)[0],[])??null}const aU=Me(function(){const e=iU();return f.jsx(f.Fragment,{children:e.map(n=>f.jsx(lU,{userId:n},n))})}),lU=Me(function({userId:e}){const n=Z(),{viewportPageBounds:r,zoomLevel:o}=n,{CollaboratorBrush:i,CollaboratorScribble:s,CollaboratorCursor:a,CollaboratorHint:l,CollaboratorShapeIndicator:c}=wn(),d=sU(e);if(!d||d.currentPageId!==n.currentPageId)return null;const{brush:u,scribble:h,selectedIds:p,userName:g,cursor:m,color:v}=d,x=!(m.x<r.minX-12/o||m.y<r.minY-16/o||m.x>r.maxX-12/o||m.y>r.maxY-16/o);return f.jsxs(f.Fragment,{children:[u&&i?f.jsx(i,{brush:u,color:v},e+"_brush"):null,x&&a?f.jsx(a,{point:m,color:v,zoom:o,name:g!=="New User"?g:null},e+"_cursor"):l?f.jsx(l,{point:m,color:v,zoom:o,viewport:r},e+"_cursor_hint"):null,h&&s?f.jsx(s,{scribble:h,color:v,zoom:o},e+"_scribble"):null,c&&p.map(b=>f.jsx(c,{id:b,color:v},e+"_"+b))]})}),cU=Me(function(){const e=Z(),n=w.useMemo(()=>({onPointerDown:h=>{if(h.isKilled)return;fu(h.currentTarget,h);const p={type:"pointer",target:"selection",name:"pointer_down",...Bt(h,e.getContainer())};e.dispatch(p)},onPointerMove:h=>{if(h.isKilled)return;const p={type:"pointer",target:"selection",name:"pointer_move",...Bt(h,e.getContainer())};e.dispatch(p)},onPointerUp:h=>{if(h.isKilled)return;gu(h.currentTarget,h);const p={type:"pointer",target:"selection",name:"pointer_up",...Bt(h,e.getContainer())};e.dispatch(p)},onPointerEnter:h=>{if(h.isKilled)return;const p={type:"pointer",target:"selection",name:"pointer_enter",...Bt(h,e.getContainer())};e.dispatch(p)},onPointerLeave:h=>{if(h.isKilled)return;const p={type:"pointer",target:"selection",name:"pointer_leave",...Bt(h,e.getContainer())};e.dispatch(p)}}),[e]),{selectionBounds:r,selectedIds:o}=e;if(!r)return null;const i=e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing");if(o.length===1){const a=e.getShapeById(o[0]);if(!a||e.getShapeUtil(a).hideSelectionBoundsBg(a))return null}const s=ee.toCssString(ee.Compose(ee.Translate(r.minX,r.minY),ee.Rotate(e.selectionRotation)));return f.jsx("div",{className:"tl-selection__bg",draggable:!1,style:{transform:s,width:U(Math.max(1,r.width)),height:U(Math.max(1,r.height)),pointerEvents:i?"all":"none",opacity:i?1:0},...n})}),Pg="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",_g="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",Ml='<g><path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/></g>',uU=`<path fill="currentcolor" d='m6.94 2v-1c-1.35866267-.08246172-2.66601117.53165299-3.47 1.63-.80398883-1.09834701-2.11133733-1.71246172-3.47-1.63v1c1.30781678-.16635468 2.55544738.59885876 3 1.84v5.1h-1v1h1v4.16c-.4476345 1.2386337-1.69302129 2.002471-3 1.84v1c1.35687108.0731933 2.6600216-.5389494 3.47-1.63.8099784 1.0910506 2.11312892 1.7031933 3.47 1.63v-1c-1.28590589.133063-2.49760499-.6252793-2.94-1.84v-4.18h1v-1h-1v-5.08c.43943906-1.21710975 1.65323743-1.97676587 2.94-1.84z' transform='translate(14 9)'/>`,dU="<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='%23fff'/><g stroke='%23000' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",hU='<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="%23fff"/><g stroke="%23000" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>';function Dn(t,e,n,r,o){const i=(-n-e)*(ct/180),s=Math.sin(i),a=Math.cos(i),l=1*a-1*s,c=1*s+1*a;return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${o};'><defs><filter id='shadow' color-interpolation-filters='sRGB'><feDropShadow dx='${l}' dy='${c}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${e+n} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+t.replaceAll('"',"'")+'</g></svg>") 16 16, pointer'}const pU={none:()=>"none",default:()=>"default",pointer:()=>"pointer",cross:()=>"crosshair",move:()=>"move",grab:(t,e,n)=>Dn(hU,t,0,e,n),grabbing:(t,e,n)=>Dn(dU,t,0,e,n),text:(t,e,n)=>Dn(uU,t,0,e,n),"resize-edge":(t,e,n)=>Dn(_g,t,0,e,n),"resize-corner":(t,e,n)=>Dn(Pg,t,0,e,n),"ew-resize":(t,e,n)=>Dn(_g,t,0,e,n),"ns-resize":(t,e,n)=>Dn(_g,t,90,e,n),"nesw-resize":(t,e,n)=>Dn(Pg,t,0,e,n),"nwse-resize":(t,e,n)=>Dn(Pg,t,90,e,n),rotate:(t,e,n)=>Dn(Ml,t,45,e,n),"nwse-rotate":(t,e,n)=>Dn(Ml,t,0,e,n),"nesw-rotate":(t,e,n)=>Dn(Ml,t,90,e,n),"senw-rotate":(t,e,n)=>Dn(Ml,t,180,e,n),"swne-rotate":(t,e,n)=>Dn(Ml,t,270,e,n),"zoom-in":()=>"zoom-in","zoom-out":()=>"zoom-out"};function Jn(t,e=0,n="black"){return pU[t](j8(e),!1,n)}function fU(){const t=Z(),e=Tn();Ps("useCursor",()=>{const{type:n,rotation:r,color:o}=t.cursor;e.style.setProperty("--tl-cursor",Jn(n,r,o))},[t,e])}function lo(t){const e=Z();return w.useMemo(function(){const o=c=>{if(c.isKilled||c.button!==0)return;const d=Oh(c.currentTarget);function u(){d.removeEventListener("pointerup",u),gu(d,c)}fu(d,c),d.addEventListener("pointerup",u),e.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:t,...Bt(c,e.getContainer())}),c.stopPropagation()};let i,s;function a(c){c.isKilled||c.button===0&&(c.clientX===i&&c.clientY===s||(i=c.clientX,s=c.clientY,e.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:t,...Bt(c,e.getContainer())})))}return{onPointerDown:o,onPointerMove:a,onPointerUp:c=>{c.isKilled||c.button===0&&e.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:t,...Bt(c,e.getContainer())})}}},[e,t])}function gU({size:t,width:e,height:n,hideAlternateHandles:r}){const o=U(t/3),i=o/2;return f.jsxs("svg",{className:"tl-overlays__item",children:[f.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${U(0-i)},${U(t)} 
						${U(0-i)},${U(0-i)} 
						${U(t)},${U(0-i)}`,strokeWidth:o,"data-wd":"selection.crop.top_left","aria-label":"top_left handle"}),f.jsx("line",{className:Se("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:U(e/2-t),y1:U(0-i),x2:U(e/2+t),y2:U(0-i),strokeWidth:o,"data-wd":"selection.crop.top","aria-label":"top handle"}),f.jsx("polyline",{className:Se("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${U(e-t)},${U(0-i)} 
						${U(e+i)},${U(0-i)} 
						${U(e+i)},${U(t)}`,strokeWidth:o,"data-wd":"selection.crop.top_right","aria-label":"top_right handle"}),f.jsx("line",{className:Se("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:U(e+i),y1:U(n/2-t),x2:U(e+i),y2:U(n/2+t),strokeWidth:o,"data-wd":"selection.crop.right","aria-label":"right handle"}),f.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${U(e+i)},${U(n-t)} 
						${U(e+i)},${U(n+i)}
						${U(e-t)},${U(n+i)}`,strokeWidth:o,"data-wd":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),f.jsx("line",{className:Se("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:U(e/2-t),y1:U(n+i),x2:U(e/2+t),y2:U(n+i),strokeWidth:o,"data-wd":"selection.crop.bottom","aria-label":"bottom handle"}),f.jsx("polyline",{className:Se("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${U(0+t)},${U(n+i)} 
						${U(0-i)},${U(n+i)}
						${U(0-i)},${U(n-t)}`,strokeWidth:o,"data-wd":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),f.jsx("line",{className:Se("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:U(0-i),y1:U(n/2-t),x2:U(0-i),y2:U(n/2+t),strokeWidth:o,"data-wd":"selection.crop.left","aria-label":"left handle"})]})}const mU=typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1,yU=Me(function(){var ht;const e=Z(),n=w.useRef(null),r=e.isReadOnly,o=lo("top"),i=lo("right"),s=lo("bottom"),a=lo("left"),l=lo("top_left"),c=lo("top_right"),d=lo("bottom_right"),u=lo("bottom_left"),h=!e.isMenuOpen&&e.cursor.type==="default",p=e.isCoarsePointer;let g=e.selectionBounds;const m=e.selectedShapes,v=m.length===1?m[0]:null,x=v?e.getShapeUtil(v).expandSelectionOutlinePx(v):0;if(Np(n,g==null?void 0:g.x,g==null?void 0:g.y,1,e.selectionRotation,{x:-x,y:-x}),!g)return null;g=g.clone().expandBy(x);const b=e.zoomLevel,E=e.selectionRotation,P=e.isChangingStyle,C=Math.max(1,g.width),k=Math.max(1,g.height),$=8/b,A=C<$*2,D=k<$*2,j=C<$*4,Y=k<$*4,V=C<$*5,q=k<$*5,F=p?1.75:1,X=6/b*F,ne=(j?X/2:X)*(F*.75),ie=(Y?X/2:X)*(F*.75),W=(v?!e.getShapeUtil(v).hideSelectionBoundsFg(v):!0)&&!P;let H=W&&e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle","select.editing_shape")||W&&e.isIn("select.resizing")&&v&&m[0].type==="text";mU&&H&&((ht=e.onlySelectedShape)==null?void 0:ht.type)==="embed"&&(H=!1);const G=e.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!P&&!r,Q=e.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!P&&!r,le=!p&&!(A||D)&&(Q||G)&&(v?!e.getShapeUtil(v).hideRotateHandle(v):!0),De=p&&(!j||!Y)&&(Q||G)&&(v?!e.getShapeUtil(v).hideRotateHandle(v):!0),Ie=Q&&(v?e.getShapeUtil(v).canResize(v)&&!e.getShapeUtil(v).hideResizeHandles(v):!0)&&!G,we=A||D,Ze=A&&D,je=V||q,ze=Ie||G,Re=!le,Ft=!Q||!De,Zt=!Q||!ze,vt=!Q||!ze||we,kt=!Q||!ze||we,Lt=!Q||!ze||Ze&&!G;let xn=p;xn&&m.every(Pt=>e.getShapeUtil(Pt).isAspectRatioLocked(Pt))&&(xn=!1);let Dt=!0;G?Dt=je:Ie&&(Dt=we||Ze||xn);const Kt=Math.min(24/b,k-ie*3),Lr=Q&&p&&(v==null?void 0:v.type)==="text"&&Kt*b>=4;return f.jsxs("svg",{ref:n,className:"tl-overlays__item tl-selection__fg","data-wd":"selection-foreground",children:[H&&f.jsx("rect",{className:Se("tl-selection__fg__outline"),width:U(C),height:U(k)}),f.jsx(nd,{"data-wd":"selection.rotate.top-left",cx:0,cy:0,targetSize:X,corner:"top_left_rotate",cursor:h?Jn("nwse-rotate",E):void 0,isHidden:Re}),f.jsx(nd,{"data-wd":"selection.rotate.top-right",cx:C+X*3,cy:0,targetSize:X,corner:"top_right_rotate",cursor:h?Jn("nesw-rotate",E):void 0,isHidden:Re}),f.jsx(nd,{"data-wd":"selection.rotate.bottom-left",cx:0,cy:k+X*3,targetSize:X,corner:"bottom_left_rotate",cursor:h?Jn("swne-rotate",E):void 0,isHidden:Re}),f.jsx(nd,{"data-wd":"selection.rotate.bottom-right",cx:C+X*3,cy:k+X*3,targetSize:X,corner:"bottom_right_rotate",cursor:h?Jn("senw-rotate",E):void 0,isHidden:Re})," ",f.jsx(wU,{"data-wd":"selection.rotate.mobile",cx:j?-X*1.5:C/2,cy:j?k/2:-X*1.5,size:$,isHidden:Ft}),f.jsx("rect",{className:Se("tl-transparent",{"tl-hidden":Dt}),"data-wd":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:U(0-(Y?ie*2:ie)),width:U(Math.max(1,C)),height:U(Math.max(1,ie*2)),style:h?{cursor:Jn("ns-resize",E)}:void 0,...o}),f.jsx("rect",{className:Se("tl-transparent",{"tl-hidden":Dt}),"data-wd":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:U(C-(j?0:ne)),y:0,height:U(Math.max(1,k)),width:U(Math.max(1,ne*2)),style:h?{cursor:Jn("ew-resize",E)}:void 0,...i}),f.jsx("rect",{className:Se("tl-transparent",{"tl-hidden":Dt}),"data-wd":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:U(k-(Y?0:ie)),width:U(Math.max(1,C)),height:U(Math.max(1,ie*2)),style:h?{cursor:Jn("ns-resize",E)}:void 0,...s}),f.jsx("rect",{className:Se("tl-transparent",{"tl-hidden":Dt}),"data-wd":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:U(0-(j?ne*2:ne)),y:0,height:U(Math.max(1,k)),width:U(Math.max(1,ne*2)),style:h?{cursor:Jn("ew-resize",E)}:void 0,...a}),f.jsx("rect",{className:Se("tl-transparent",{"tl-hidden":Zt}),"data-wd":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:U(0-(j?ne*2:ne*1.5)),y:U(0-(Y?ie*2:ie*1.5)),width:U(ne*3),height:U(ie*3),style:h?{cursor:Jn("nwse-resize",E)}:void 0,...l}),f.jsx("rect",{className:Se("tl-transparent",{"tl-hidden":vt}),"data-wd":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:U(C-(j?0:ne*1.5)),y:U(0-(Y?ie*2:ie*1.5)),width:U(ne*3),height:U(ie*3),style:h?{cursor:Jn("nesw-resize",E)}:void 0,...c}),f.jsx("rect",{className:Se("tl-transparent",{"tl-hidden":Lt}),"data-wd":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:U(C-(j?ne:ne*1.5)),y:U(k-(Y?ie:ie*1.5)),width:U(ne*3),height:U(ie*3),style:h?{cursor:Jn("nwse-resize",E)}:void 0,...d}),f.jsx("rect",{className:Se("tl-transparent",{"tl-hidden":kt}),"data-wd":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:U(0-(j?ne*3:ne*1.5)),y:U(k-(Y?0:ie*1.5)),width:U(ne*3),height:U(ie*3),style:h?{cursor:Jn("nesw-resize",E)}:void 0,...u}),Ie&&f.jsxs(f.Fragment,{children:[f.jsx("rect",{"data-wd":"selection.resize.top-left",className:Se("tl-corner-handle",{"tl-hidden":Zt}),"aria-label":"top_left handle",x:U(0-$/2),y:U(0-$/2),width:U($),height:U($)}),f.jsx("rect",{"data-wd":"selection.resize.top-right",className:Se("tl-corner-handle",{"tl-hidden":vt}),"aria-label":"top_right handle",x:U(C-$/2),y:U(0-$/2),width:U($),height:U($)}),f.jsx("rect",{"data-wd":"selection.resize.bottom-right",className:Se("tl-corner-handle",{"tl-hidden":Lt}),"aria-label":"bottom_right handle",x:U(C-$/2),y:U(k-$/2),width:U($),height:U($)}),f.jsx("rect",{"data-wd":"selection.resize.bottom-left",className:Se("tl-corner-handle",{"tl-hidden":kt}),"aria-label":"bottom_left handle",x:U(0-$/2),y:U(k-$/2),width:U($),height:U($)})]}),Lr&&f.jsxs(f.Fragment,{children:[f.jsx("rect",{"data-wd":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:U(0-$/4),y:U(k/2-Kt/2),rx:$/4,width:U($/2),height:U(Kt)}),f.jsx("rect",{"data-wd":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:$/4,x:U(C-$/4),y:U(k/2-Kt/2),width:U($/2),height:U(Kt)})]}),G&&f.jsx(gU,{size:$,width:C,height:k,hideAlternateHandles:je})]})}),nd=function({cx:e,cy:n,targetSize:r,corner:o,cursor:i,isHidden:s,"data-wd":a}){const l=lo(o);return f.jsx("rect",{className:Se("tl-transparent","tl-rotate-corner",{"tl-hidden":s}),"data-wd":a,"aria-label":`${o} target`,pointerEvents:"all",x:U(e-r*3),y:U(n-r*3),width:U(Math.max(1,r*3)),height:U(Math.max(1,r*3)),cursor:i,...l})},vU=Math.sqrt(Math.PI),wU=function({cx:e,cy:n,size:r,isHidden:o,"data-wd":i}){const s=lo("mobile_rotate");return f.jsxs("g",{children:[f.jsx("circle",{"data-wd":i,pointerEvents:"all",className:Se("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":o}),cx:e,cy:n,...s}),f.jsx("circle",{className:Se("tl-mobile-rotate__fg",{"tl-hidden":o}),cx:e,cy:n,r:r/vU})]})},Al=(t,e,n,r)=>o=>{if(n!=="pointer_move"&&t.pageState.editingId===e&&(o.isKilled=!0),o.isKilled)return;let i=Bt(o,t.getContainer());switch(n){case"pointer_down":{if(o.button!==0&&o.button!==1&&o.button!==2)return;fu(o.currentTarget,o),o.button===0&&r.add(`pointer_down:${o.pointerId}:0`);break}case"pointer_up":{const a=`pointer_down:${o.pointerId}:0`;r.has(a)&&(i={...i,button:0},r.delete(a)),gu(o.currentTarget,o);break}}const s=t.getShapeById(e);if(!s){console.error("Shape not found",e);return}t.dispatch({type:"pointer",target:"shape",shape:s,name:n,...i})};function xU(t){const e=Z();return xe.useMemo(()=>{const n=new Set;function r(c){c.isKilled=!0,Ve(c)}function o(c){c.isKilled=!0,Ve(c)}const i=Al(e,t,"pointer_move",n);let s,a;function l(c){if(!c.isKilled&&!(c.clientX===s&&c.clientY===a))return s=c.clientX,a=c.clientY,i(c)}return{onPointerDown:Al(e,t,"pointer_down",n),onPointerUp:Al(e,t,"pointer_up",n),onPointerEnter:Al(e,t,"pointer_enter",n),onPointerLeave:Al(e,t,"pointer_leave",n),onPointerMove:l,onTouchStart:r,onTouchEnd:o}},[e,t])}const bU={error:null};class Hv extends w.Component{constructor(){super(...arguments);y(this,"state",bU)}static getDerivedStateFromError(n){return{error:n}}componentDidCatch(n){var r,o;(o=(r=this.props).onError)==null||o.call(r,n)}render(){const{error:n}=this.state;return n!==null?this.props.fallback(n):this.props.children}}function Fp({children:t,fallback:e,...n}){return e===null?f.jsx(f.Fragment,{children:t}):f.jsx(Hv,{fallback:e,...n,children:t})}const Y1=Me(function({id:e,index:n,opacity:r,isCulled:o}){const i=Z(),{ShapeErrorFallback:s}=wn(),a=xU(e),l=w.useRef(null);Ps("set shape container transform position",()=>{const u=l.current;if(!u)return;const h=i.getShapeById(e),p=i.getPageTransformById(e);if(!h||!p)return null;const g=ee.toCssString(p);u.style.setProperty("transform",g)},[i]),Ps("set shape container clip path / color",()=>{const u=l.current,h=i.getShapeById(e);if(!u)return;if(!h)return null;const p=i.getClipPathById(e);u.style.setProperty("clip-path",p??"none"),"color"in h.props&&u.style.setProperty("color",i.getCssColor(h.props.color))},[i]),Ps("set shape height and width",()=>{const u=l.current,h=i.getShapeById(e);if(!u)return;if(!h)return null;const g=i.getShapeUtil(h).bounds(h);u.style.setProperty("width",Math.ceil(g.width)+"px"),u.style.setProperty("height",Math.ceil(g.height)+"px")},[i]),w.useLayoutEffect(()=>{const u=l.current;u&&(u.style.setProperty("opacity",r+""),u.style.setProperty("z-index",n+""))},[r,n]);const c=i.getShapeById(e);if(!c)return null;const d=i.getShapeUtil(c);return f.jsx("div",{ref:l,className:"tl-shape","data-shape-type":c.type,draggable:!1,onPointerDown:a.onPointerDown,onPointerMove:a.onPointerMove,onPointerUp:a.onPointerUp,onPointerEnter:a.onPointerEnter,onPointerLeave:a.onPointerLeave,children:o&&d.canUnmount(c)?f.jsx(EU,{shape:c,util:d}):f.jsx(Fp,{fallback:s?u=>f.jsx(s,{error:u}):null,onError:u=>i.annotateError(u,{origin:"react.shape",willCrashApp:!1}),children:f.jsx(SU,{shape:c,util:d})})},e)}),SU=w.memo(function({shape:e,util:n}){return Tv("InnerShape:"+n.type,()=>n.render(e))},(t,e)=>t.shape.props===e.shape.props),EU=w.memo(function({shape:e,util:n}){const r=n.bounds(e);return f.jsx("div",{className:"tl-shape__culled",style:{transform:`translate(${r.minX}px, ${r.minY}px)`,width:r.width,height:r.height}})},()=>!0);class PU{constructor(e){this.shape=e}equals(e){var n,r;return((n=this.shape)==null?void 0:n.props)===((r=e==null?void 0:e.shape)==null?void 0:r.props)}}const _U=({shape:t,util:e})=>Tv("Indicator:"+t.type,()=>e.indicator(t)),IU=({app:t,id:e})=>{const n=ge("shape",()=>new PU(t.store.get(e)),[t,e]),{ShapeIndicatorErrorFallback:r}=wn();return n.shape?f.jsx(Fp,{fallback:r?o=>f.jsx(r,{error:o}):null,onError:o=>t.annotateError(o,{origin:"react.shapeIndicator",willCrashApp:!1}),children:f.jsx(_U,{shape:n.shape,util:t.getShapeUtil(n.shape)},n.shape.id)}):null},CU=({id:t,className:e,color:n,opacity:r})=>{const o=Z(),i=ge("transform",()=>{const s=o.getPageTransformById(t);return s?s.toCssString():""},[o,t]);return f.jsx("svg",{className:Se("tl-overlays__item",e),children:f.jsx("g",{className:"tl-shape-indicator",transform:i,stroke:n??"var(--color-selected)",opacity:r,children:f.jsx(IU,{app:o,id:t})})})},Kp=w.memo(CU),Hp=Me(function({onDropOverride:e}){const n=Z(),{Background:r,SvgDefs:o}=wn(),i=w.useRef(null),s=w.useRef(null);eU(),_7(),E7(),Gz(i),k7(i),Ps("position layers",()=>{const d=s.current;if(!d)return;const{x:u,y:h,z:p}=n.camera,g=p>=1?sy(p,[1,8],[.125,.5],!0):sy(p,[.1,1],[-2,.125],!0);d.style.setProperty("transform",`scale(${U(p)}) translate(${U(u+g)}px,${U(h+g)}px)`)},[n]);const{context:a,isReady:l}=Zz(),c=S7();return e&&(c.onDrop=e(c.onDrop)),w.useEffect(()=>{if(l&&n.isSafari){const d=s.current;d&&requestAnimationFrame(()=>{d.style.display="none",requestAnimationFrame(()=>{d.style.display=""})})}},[n,l]),w.useEffect(()=>{var d;(d=i.current)==null||d.focus()},[]),f.jsxs("div",{ref:i,draggable:!1,className:"tl-canvas","data-wd":"canvas",...c,children:[r&&f.jsx(r,{}),f.jsx(kU,{}),f.jsx(HU,{}),f.jsxs("div",{ref:s,className:"tl-html-layer",draggable:!1,children:[f.jsx("svg",{className:"tl-svg-context",children:f.jsxs("defs",{children:[a,X1&&f.jsx(X1,{}),f.jsx(zU,{}),f.jsx(UU,{}),f.jsx(FU,{}),o&&f.jsx(o,{})]})}),f.jsx(cU,{}),f.jsx("div",{className:"tl-shapes",children:f.jsx(OU,{})}),f.jsxs("div",{className:"tl-overlays",children:[f.jsx(LU,{}),f.jsx(TU,{}),f.jsx($U,{}),f.jsx(MU,{}),f.jsx(jU,{}),f.jsx(NU,{}),f.jsx(BU,{}),f.jsx(AU,{}),f.jsx(yU,{}),Gt.newLiveCollaborators.value?f.jsx(aU,{}):f.jsx(nU,{})]})]})]})}),kU=Me(function(){const e=Z(),{Grid:n}=wn(),{x:r,y:o,z:i}=e.camera,s=e.isGridMode;return n&&s?f.jsx(n,{x:r,y:o,z:i,size:e.gridSize}):null}),$U=Me(function(){const e=Z(),n=e.scribble,r=e.zoomLevel,{Scribble:o}=wn();return o&&n?f.jsx(o,{className:"tl-user-scribble",scribble:n,zoom:r}):null}),TU=Me(function(){const e=Z(),{brush:n}=e,{Brush:r}=wn();return r&&n&&e.isIn("select.brushing")?f.jsx(r,{className:"tl-user-brush",brush:n}):null}),MU=Me(function(){const e=Z(),{zoomBrush:n}=e,{ZoomBrush:r}=wn();return r&&n&&e.isIn("zoom")?f.jsx(r,{className:"tl-user-brush",brush:n}):null}),AU=Me(function(){const e=Z(),{snaps:{lines:n},zoomLevel:r}=e,{SnapLine:o}=wn();return o&&n.length>0?f.jsx(f.Fragment,{children:n.map(i=>f.jsx(o,{className:"tl-user-snapline",line:i,zoom:r},i.id))}):null}),RU=48,LU=Me(function(){var d;const e=Z(),n=e.zoomLevel,r=e.isChangingStyle,o=e.onlySelectedShape,i=e.isInAny("select.idle","select.pointing_handle")&&!r&&!e.isReadOnly;if(!(o&&i))return null;const s=e.getShapeUtil(o),a=(d=s.handles)==null?void 0:d.call(s,o);if(!a)return null;const l=e.getPageTransform(o);if(!l)return null;const c=[];for(let u=0,h=a[u];u<a.length;u++,h=a[u]){if(h.type!=="vertex"){const p=a[u-1],g=a[u+1];if(p&&g&&Math.hypot(p.y-g.y,p.x-g.x)<RU/n)continue}c.push(h)}return c.sort(u=>u.type==="vertex"?1:-1),f.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:f.jsx("g",{transform:ee.toCssString(l),children:c.map(u=>f.jsx(DU,{shapeId:o.id,handle:u},u.id))})})}),DU=({shapeId:t,handle:e})=>{const n=qz(t,e.id),{Handle:r}=wn();return r?f.jsx("g",{"aria-label":"handle",transform:`translate(${e.x}, ${e.y})`,...n,children:f.jsx(r,{shapeId:t,handle:e})}):null},OU=Me(function(){const e=Z(),{renderingShapes:n}=e;return Gt.debugSvg.value?f.jsx(f.Fragment,{children:n.map(o=>f.jsxs(w.Fragment,{children:[f.jsx(Y1,{...o}),f.jsx(KU,{id:o.id})]},o.id+"_fragment"))}):f.jsx(f.Fragment,{children:n.map(o=>f.jsx(Y1,{...o},o.id+"_shape"))})}),jU=Me(function(){const e=Z();return e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!e.isChangingStyle?f.jsx(f.Fragment,{children:e.selectedIds.map(r=>f.jsx(Kp,{className:"tl-user-indicator__selected",id:r},r+"_indicator"))}):null}),NU=function(){const e=Z(),n=ge("hovered id and should display",()=>e.isInAny("select.idle","select.editing_shape")?e.pageState.hoveredId:null,[e]);return n?f.jsx(Kp,{className:"tl-user-indicator__hovered",id:n}):null},BU=Me(function(){const e=Z(),n=bh(e.hintingIds);return n.length?f.jsx(f.Fragment,{children:n.map(r=>f.jsx(Kp,{className:"tl-user-indicator__hint",id:r},r+"_hinting"))}):null});function X1(){return f.jsxs("g",{id:"cursor",children:[f.jsxs("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[f.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),f.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),f.jsxs("g",{fill:"white",transform:"translate(-12,-12)",children:[f.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),f.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),f.jsxs("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[f.jsx("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),f.jsx("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function zU(){return f.jsx("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function UU(){return f.jsx("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:f.jsx("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function FU(){return f.jsxs("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[f.jsx("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),f.jsx("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const KU=Me(function({id:e}){const n=Z(),r=n.getShapeById(e),[o,i]=w.useState(""),s=(r==null?void 0:r.parentId)===n.currentPageId;return w.useEffect(()=>{if(!s)return;let a=null;const l=du("shape to svg",async()=>{const c=Math.random();a=c;const d=n.getPageBoundsById(e),u=await n.getSvg([e],{padding:0});u&&d&&a===c&&(u.style.setProperty("overflow","visible"),u.setAttribute("preserveAspectRatio","xMidYMin slice"),u.style.setProperty("transform",`translate(${d.x}px, ${d.y+d.h+12}px)`),u.style.setProperty("border","1px solid black"),i(u==null?void 0:u.outerHTML))});return()=>{a=null,l()}},[n,e,s]),s?f.jsx("div",{style:{paddingTop:12,position:"absolute"},children:f.jsx("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:o}})}):null}),HU=()=>{const t=ge(Gt.logMessages);return f.jsx("div",{className:"debug__ui-logger",children:t.map((e,n)=>{const r=typeof e=="string"?e:JSON.stringify(e);return f.jsx("div",{className:"debug__ui-logger__line",children:r},n)})})},VU="https://github.com/tldraw/tldraw/issues/new";function WU(){}const Vv=({error:t,app:e})=>{const n=w.useRef(null),[r,o]=w.useState(!1),[i,s]=w.useState(!1),[a,l]=w.useState(!1),c=t instanceof Error?t.message:String(t),d=t instanceof Error?t.stack:null,u=ge("isDarkMode",()=>{try{if(e)return e.userDocumentSettings.isDarkMode}catch{}return null},[e]),[h,p]=w.useState(null);w.useLayoutEffect(()=>{var P;u!==null&&p(u);let b=(P=n.current)==null?void 0:P.parentElement,E=!1;for(;b;){if(b.classList.contains("tl-theme__dark")||b.classList.contains("tl-theme__light")){E=!0;break}b=b.parentElement}if(E){p(null);return}p(window.matchMedia("(prefetl-color-scheme: dark)").matches)},[u]),w.useEffect(()=>{if(i){const b=setTimeout(()=>{s(!1)},2e3);return()=>clearTimeout(b)}},[i]);const g=()=>{const b=document.createElement("textarea");b.value=d??c,document.body.appendChild(b),b.select(),document.execCommand("copy"),b.remove(),s(!0)},m=()=>{YN()},v=async()=>{GI()},x=new URL(VU);return x.searchParams.set("title",c),x.searchParams.set("labels","bug"),x.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${d??c}
\`\`\`

My browser: ${navigator.userAgent}`),f.jsxs("div",{ref:n,className:Se("tl-container tl-error-boundary",h===null?"":h?"tl-theme__dark":"tl-theme__light"),children:[f.jsx("div",{className:"tl-error-boundary__overlay"}),e&&f.jsx(Hv,{onError:WU,fallback:()=>null,children:f.jsx(Mv.Provider,{value:e,children:f.jsx("div",{className:"tl-overlay tl-error-boundary__canvas",children:f.jsx(Hp,{})})})}),f.jsx("div",{className:Se("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!a}),children:a?f.jsxs(f.Fragment,{children:[f.jsx("h2",{children:"Are you sure?"}),f.jsx("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),f.jsxs("div",{className:"tl-error-boundary__content__actions",children:[f.jsx("button",{onClick:()=>l(!1),children:"Cancel"}),f.jsx("button",{className:"tl-error-boundary__reset",onClick:v,children:"Reset data"})]})]}):f.jsxs(f.Fragment,{children:[f.jsx("h2",{children:"Something's gone wrong."}),f.jsxs("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",f.jsx("a",{href:x.toString(),children:"create a GitHub issue"})," or"," ",f.jsx("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),r&&f.jsxs("div",{className:"tl-error-boundary__content__error",children:[f.jsx("pre",{children:f.jsx("code",{children:d??c})}),f.jsx("button",{onClick:g,children:i?"Copied!":"Copy"})]}),f.jsxs("div",{className:"tl-error-boundary__content__actions",children:[f.jsx("button",{onClick:()=>o(!r),children:r?"Hide details":"Show details"}),f.jsxs("div",{className:"tl-error-boundary__content__actions__group",children:[f.jsx("button",{className:"tl-error-boundary__reset",onClick:()=>l(!0),children:"Reset data"}),f.jsx("button",{className:"tl-error-boundary__refresh",onClick:m,children:"Refresh Page"})]})]})]})})]})},YU=({x:t,y:e,z:n,size:r})=>f.jsxs("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[f.jsx("defs",{children:p1.map(({min:o,mid:i,step:s},a)=>{const l=s*r*n,c=.5+t*n,d=.5+e*n,u=c>0?c%l:l+c%l,h=d>0?d%l:l+d%l,p=n<i?sy(n,[o,i],[0,1]):1;return f.jsx("pattern",{id:`grid-${s}`,width:l,height:l,patternUnits:"userSpaceOnUse",children:f.jsx("circle",{className:"tl-grid-dot",cx:u,cy:h,r:1,opacity:p})},`grid-pattern-${a}`)})}),p1.map(({step:o},i)=>f.jsx("rect",{width:"100%",height:"100%",fill:`url(#grid-${o})`},`grid-rect-${i}`))]}),XU=({handle:t,className:e})=>f.jsxs("g",{className:Se("tl-handle",{"tl-handle__hint":t.type!=="vertex"},e),children:[f.jsx("circle",{className:"tl-handle__bg"}),f.jsx("circle",{className:"tl-handle__fg"})]}),G1=({scribble:t,zoom:e,color:n,opacity:r,className:o})=>{const i=Cc(X8(t.points,{size:t.size/e,start:{taper:!0,easing:Pn.linear},last:t.state==="stopping",simulatePressure:!1}));return f.jsx("svg",{className:o&&Se("tl-overlays__item",o),children:f.jsx("path",{className:"tl-scribble",d:i,fill:n??`var(--color-${t.color})`,opacity:r??t.opacity})})},GU=()=>f.jsx("div",{className:"tl-shape-error-boundary"}),qU=()=>f.jsx("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function QU({points:t,zoom:e}){const n=2.5/e,r=t.reduce((h,p)=>Math.min(h,p.x),1/0),o=t.reduce((h,p)=>Math.max(h,p.x),-1/0),i=t.reduce((h,p)=>Math.min(h,p.y),1/0),s=t.reduce((h,p)=>Math.max(h,p.y),-1/0),a=t.some(h=>h.x===r&&h.y===i);let l,c,d,u;return a?(l=r,c=i,d=o,u=s):(l=r,c=s,d=o,u=i),f.jsxs("g",{className:"tl-snap-line",children:[f.jsx("line",{x1:l,y1:c,x2:d,y2:u}),t.map((h,p)=>f.jsx("g",{transform:`translate(${h.x},${h.y})`,children:f.jsx("path",{className:"tl-snap-point",d:`M ${-n},${-n} L ${n},${n} M ${-n},${n} L ${n},${-n}`})},p))]})}function ZU({gaps:t,direction:e,zoom:n}){const r=3.5/n;let o=[-1/0,1/0],i=null;const s=e==="horizontal";for(const l of t){if(i=Ur(o[0],o[1],s?l.startEdge[0].y:l.startEdge[0].x,s?l.startEdge[1].y:l.startEdge[1].x),i)o=i;else continue;if(i=Ur(o[0],o[1],s?l.endEdge[0].y:l.endEdge[0].x,s?l.endEdge[1].y:l.endEdge[1].x),i)o=i;else continue}if(o===null)return null;const a=(o[0]+o[1])/2;return f.jsx("g",{className:"tl-snap-line",children:t.map(({startEdge:l,endEdge:c},d)=>f.jsx(w.Fragment,{children:s?f.jsxs(f.Fragment,{children:[f.jsx("line",{x1:l[0].x,y1:a-2*r,x2:l[1].x,y2:a+2*r}),f.jsx("line",{x1:c[0].x,y1:a-2*r,x2:c[1].x,y2:a+2*r}),f.jsx("line",{x1:l[0].x,y1:a,x2:c[0].x,y2:a}),f.jsx("line",{x1:(l[0].x+c[0].x)/2,y1:a-r,x2:(l[0].x+c[0].x)/2,y2:a+r})]}):f.jsxs(f.Fragment,{children:[f.jsx("line",{x1:a-2*r,y1:l[0].y,x2:a+2*r,y2:l[1].y}),f.jsx("line",{x1:a-2*r,y1:c[0].y,x2:a+2*r,y2:c[1].y}),f.jsx("line",{x1:a,y1:l[0].y,x2:a,y2:c[0].y}),f.jsx("line",{x1:a-r,y1:(l[0].y+c[0].y)/2,x2:a+r,y2:(l[0].y+c[0].y)/2})]})},d))})}const JU=({className:t,line:e,zoom:n})=>f.jsx("svg",{className:Se("tl-overlays__item",t),children:e.type==="points"?f.jsx(QU,{...e,zoom:n}):e.type==="gaps"?f.jsx(ZU,{...e,zoom:n}):null}),eF=()=>f.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",children:f.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[f.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"black"}),f.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"black",children:f.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})}),tF=()=>null,v2=w.createContext({});function nF({overrides:t,children:e}){return f.jsx(v2.Provider,{value:{Background:HN,SvgDefs:tF,Brush:wg,ZoomBrush:wg,CollaboratorBrush:wg,Cursor:P1,CollaboratorCursor:P1,CollaboratorHint:VN,CollaboratorShapeIndicator:Kp,Grid:YU,Scribble:G1,SnapLine:JU,Handle:XU,CollaboratorScribble:G1,ErrorFallback:Vv,ShapeErrorFallback:GU,ShapeIndicatorErrorFallback:qU,Spinner:eF,...t},children:e})}function wn(){return w.useContext(v2)}function Wv(t){const e=Z();return ge("isEditing",()=>e.editingId===t,[e,t])}function rF(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function oF(t){const e=new URL(t).host.replace("www.","");for(const n of Va)if(w2(n.hostnames,e)){const r=n.fromEmbedUrl(t);if(r)return{definition:n,url:r,embedUrl:t}}}const iF=t=>t.split("*").map(e=>rF(e)).join(".+"),w2=(t,e)=>!!t.find(n=>{const r=new RegExp(iF(n));return e.match(r)});function sF(t){const e=new URL(t).host.replace("www.","");for(const n of Va)if(w2(n.hostnames,e)){const r=n.toEmbedUrl(t);if(r)return{definition:n,embedUrl:r,url:t}}}function x2(t){return sF(t)??oF(t)}function xi(t){try{return x2(t)}catch(e){console.error(e)}}const aF=t=>Object.entries(t).filter(([e,n])=>n).map(([e])=>e).join(" ");class b2 extends Yi{constructor(){super(...arguments);y(this,"canUnmount",()=>!1);y(this,"canResize",n=>{var o;const r=xi(n.props.url);return!!((o=r==null?void 0:r.definition)!=null&&o.doesResize)});y(this,"hideSelectionBoundsBg",n=>!this.canResize(n));y(this,"hideSelectionBoundsFg",n=>!this.canResize(n));y(this,"canEdit",()=>!0);y(this,"isAspectRatioLocked",n=>{const r=xi(n.props.url);return(r==null?void 0:r.definition.isAspectRatioLocked)??!1});y(this,"onResize",(n,r)=>{const o=this.isAspectRatioLocked(n),i=xi(n.props.url);let s=(i==null?void 0:i.definition.minWidth)??200,a=(i==null?void 0:i.definition.minHeight)??200;if(o){const l=n.props.w/n.props.h;l>1?s*=l:a/=l}return VI(n,r,{minWidth:s,minHeight:a})})}defaultProps(){return{opacity:"1",w:300,h:300,url:"",doesResize:!0}}render(n){const{w:r,h:o,url:i}=n.props,s=Wv(n.id),a=w.useMemo(()=>x2(i),[i]),{Spinner:l}=wn(),c=ge("is hovering",()=>{const{editingId:p,hoveredId:g}=this.app.pageState;if(p&&g!==p){const m=this.app.getShapeById(p);if(m&&m.type==="embed")return!0}return!1},[]),d=this.app.getPageRotation(n),u=s||c;if((a==null?void 0:a.definition.type)==="github_gist"){const p=a.url.split("/").pop();if(p)return f.jsx(Ts,{className:"tl-embed-container",id:n.id,children:f.jsx(lF,{id:p,width:U(r),height:U(o),isInteractive:u,pageRotation:d})})}const h=aF({...uI,...(a==null?void 0:a.definition.overridePermissions)??{}});return f.jsx(Ts,{className:"tl-embed-container",id:n.id,children:a!=null&&a.definition?f.jsx("iframe",{className:`tl-embed tl-embed-${n.id}`,sandbox:h,src:a.embedUrl,width:U(r),height:U(o),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:u?"auto":"none",zIndex:u?"":"-1",boxShadow:Rv(d,$v),borderRadius:(a==null?void 0:a.definition.overrideOutlineRadius)??8,background:a==null?void 0:a.definition.backgroundColor}}):l?f.jsx("g",{transform:`translate(${(r-38)/2}, ${(o-38)/2})`,children:f.jsx(l,{})}):null})}indicator(n){const r=w.useMemo(()=>xi(n.props.url),[n.props.url]);return f.jsx("rect",{width:U(n.props.w),height:U(n.props.h),rx:(r==null?void 0:r.definition.overrideOutlineRadius)??8,ry:(r==null?void 0:r.definition.overrideOutlineRadius)??8})}}y(b2,"type","embed");function lF({id:t,file:e,isInteractive:n,width:r,height:o,style:i,pageRotation:s}){const a=w.useRef(null),l=e?`?file=${e}`:"",c=`https://gist.github.com/${t}.js${l}`;return f.jsx("iframe",{ref:a,className:"tl-embed",draggable:!1,width:U(r),height:U(o),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...i,pointerEvents:n?"all":"none",zIndex:n?"":"-1",boxShadow:Rv(s,$v)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=${c}><\/script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}const Tc=qn({type:"embed",getShapeUtil:()=>b2,validator:dI,migrations:hI}),cF=w.forwardRef(({id:t,name:e,isEditing:n},r)=>{const o=Z(),i=w.useCallback(l=>{l.key==="Enter"&&(l.stopPropagation(),l.currentTarget.blur(),o.setEditingId(null))},[o]),s=w.useCallback(l=>{const c=o.getShapeById(t);if(!c)return;const d=c.props.name,u=l.currentTarget.value.trim();d!==u&&o.updateShapes([{id:t,type:"frame",props:{name:u}}],!0)},[t,o]),a=w.useCallback(l=>{const c=o.getShapeById(t);if(!c)return;const d=c.props.name,u=l.currentTarget.value;d!==u&&o.updateShapes([{id:t,type:"frame",props:{name:u}}],!0)},[t,o]);return f.jsxs("div",{className:`tl-frame-label ${n?"tl-frame-label__editing":""}`,children:[f.jsx("input",{className:"tl-frame-name-input",ref:r,style:{display:n?void 0:"none"},value:e,autoFocus:!0,onKeyDown:i,onBlur:s,onChange:a}),BI(e,"Frame")+String.fromCharCode(8203)]})}),uF=function({id:e,name:n,width:r,height:o}){const i=Z(),s=Pv(i.getPageRotationById(e)),a=Wv(e),l=w.useRef(null);w.useEffect(()=>{const p=l.current;p&&a&&(p.focus(),p.select(),requestAnimationFrame(()=>{document.activeElement!==p&&(p.focus(),p.select())}))},[l,a]);const d=((s+Math.PI/4)*(2/Math.PI)+4)%4,u=["top","left","bottom","right"][Math.floor(d)];let h;switch(u){case"top":h="";break;case"right":h=`translate(${U(r)}px, 0px) rotate(90deg)`;break;case"bottom":h=`translate(${U(r)}px, ${U(o)}px) rotate(180deg)`;break;case"left":h=`translate(0px, ${U(o)}px) rotate(270deg)`;break}return f.jsx("div",{className:"tl-frame-heading",style:{overflow:a?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${Math.ceil(u==="top"||u==="bottom"?r:o)}px + var(--space-5))`,bottom:Math.ceil(o),transform:`${h} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},children:f.jsx("div",{className:"tl-frame-heading-hit-area",children:f.jsx(cF,{ref:l,id:e,name:n,isEditing:a})})})};class S2 extends Yi{constructor(){super(...arguments);y(this,"canBind",()=>!0);y(this,"canEdit",()=>!0);y(this,"canReceiveNewChildrenOfType",n=>!0);y(this,"canDropShapes",(n,r)=>!0);y(this,"onDragShapesOver",(n,r)=>r.every(o=>o.parentId===n.id)?{shouldHint:!1}:(this.app.reparentShapesById(r.map(o=>o.id),n.id),{shouldHint:!0}));y(this,"onDragShapesOut",(n,r)=>{const o=this.app.getShapeById(n.parentId);(o==null?void 0:o.type)==="group"?this.app.reparentShapesById(r.map(s=>s.id),o.id):this.app.reparentShapesById(r.map(s=>s.id),this.app.currentPageId)});y(this,"onResizeEnd",n=>{const r=this.app.getPageBounds(n),o=this.app.getSortedChildIds(n.id),i=[];for(const s of o){const a=this.app.getPageBoundsById(s);r.includes(a)||i.push(s)}i.length>0&&this.app.reparentShapesById(i,this.app.currentPageId)})}defaultProps(){return{opacity:"1",w:160*2,h:90*2,name:""}}render(n){const r=this.bounds(n);return f.jsxs(f.Fragment,{children:[f.jsxs(xr,{children:[f.jsx("rect",{className:"tl-hitarea-stroke",width:r.width,height:r.height}),f.jsx("rect",{className:"tl-frame__body",width:r.width,height:r.height,fill:"none"})]}),f.jsx(uF,{id:n.id,name:n.props.name,width:r.width,height:r.height})]})}toSvg(n,r,o){const i=document.createElementNS("http://www.w3.org/2000/svg","g"),s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("width",n.props.w.toString()),s.setAttribute("height",n.props.h.toString()),s.setAttribute("fill",o.solid),s.setAttribute("opacity",n.props.opacity),s.setAttribute("stroke",o.fill.black),s.setAttribute("stroke-width","1"),s.setAttribute("rx","1"),s.setAttribute("ry","1"),i.appendChild(s);const c=((Pv(this.app.getPageRotationById(n.id))+Math.PI/4)*(2/Math.PI)+4)%4,d=["top","left","bottom","right"][Math.floor(c)];let u;switch(d){case"top":u="";break;case"right":u=`translate(${U(n.props.w)}px, 0px) rotate(90deg)`;break;case"bottom":u=`translate(${U(n.props.w)}px, ${U(n.props.h)}px) rotate(180deg)`;break;case"left":u=`translate(0px, ${U(n.props.h)}px) rotate(270deg)`;break;default:u=""}const h={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:n.props.w+16,height:30,padding:8,lineHeight:1,fontStyle:"normal",fontWeight:"normal"};let p=BI(n.props.name,"Frame")+String.fromCharCode(8203);const g=this.app.textMeasure.getTextLines({text:p,wrap:!0,...h});p=g.length>1?g[0]+"…":g[0];const m=this.app.textMeasure.measureText({fontSize:12,fontFamily:"Inter, sans-serif",lineHeight:1,fontStyle:"normal",fontWeight:"normal",text:p,width:"fit-content",maxWidth:"unset",padding:"0px"}),v=document.createElementNS("http://www.w3.org/2000/svg","text");v.setAttribute("x","0"),v.setAttribute("y",-(8+m.h/2)+"px"),v.setAttribute("font-family",'"Inter", sans-serif'),v.setAttribute("font-size","12px"),v.setAttribute("font-weight","400"),v.style.setProperty("transform",u),v.textContent=p;const x=document.createElementNS("http://www.w3.org/2000/svg","rect");return x.setAttribute("x"," -4px"),x.setAttribute("y",-(16+m.h)+"px"),x.setAttribute("width",m.w+8+"px"),x.setAttribute("height",m.h+8+"px"),x.setAttribute("rx","4px"),x.setAttribute("ry","4px"),x.setAttribute("fill",o.background),i.appendChild(x),i.appendChild(v),i}indicator(n){const r=this.bounds(n);return f.jsx("rect",{width:U(r.width),height:U(r.height),className:"tl-frame-indicator"})}}y(S2,"type","frame");const Kd=qn({type:"frame",getShapeUtil:()=>S2,validator:pI,migrations:fI}),E2=xe.memo(function({id:e,type:n,text:r,size:o,labelColor:i,font:s,align:a,wrap:l}){const{rInput:c,isEmpty:d,isEditing:u,isEditableFromHover:h,handleFocus:p,handleChange:g,handleKeyDown:m,handleBlur:v}=Lv(e,n,r),x=u||h;return f.jsx("div",{className:"tl-text-label","data-font":s,"data-align":a,"data-hastext":!d,"data-isediting":u,"data-textwrap":!!l,children:f.jsxs("div",{className:"tl-text-label__inner",style:{fontSize:Pi[o],lineHeight:Pi[o]*Ct.lineHeight+"px",minHeight:d?Pi[o]*Ct.lineHeight+32:0,minWidth:d?33:0,color:i},children:[f.jsx("div",{className:"tl-text tl-text-content",dir:"ltr",children:Ho.normalizeTextForDom(r)}),x?f.jsx("textarea",{ref:c,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:u,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:r,onFocus:p,onChange:g,onKeyDown:m,onBlur:v,onContextMenu:yo}):null]})})}),dF=w.memo(function({w:e,h:n,strokeWidth:r,dash:o,color:i,fill:s}){const a=e/2,l=n/2,c=Math.max(0,a-r/2),d=Math.max(0,l-r/2),u=bc(c,d),{strokeDasharray:h,strokeDashoffset:p}=_n(u<64?u*2:u,r,{style:o,snap:4,closed:!0}),g=`M${a-c},${l}a${c},${d},0,1,1,${c*2},0a${c},${d},0,1,1,-${c*2},0`;return f.jsxs(f.Fragment,{children:[f.jsx(Xt,{d:g,color:i,fill:s}),f.jsx("path",{d:g,strokeWidth:r,width:U(e),height:U(n),fill:"none",stroke:"currentColor",strokeDasharray:h,strokeDashoffset:p,pointerEvents:"all"})]})});function hF({w:t,h:e,strokeWidth:n,dash:r,color:o,colors:i,fill:s}){const a=t/2,l=e/2,c=Math.max(0,a-n/2),d=Math.max(0,l-n/2),u=bc(c,d),{strokeDasharray:h,strokeDashoffset:p}=_n(u<64?u*2:u,n,{style:r,snap:4,closed:!0}),g=`M${a-c},${l}a${c},${d},0,1,1,${c*2},0a${c},${d},0,1,1,-${c*2},0`,m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttribute("d",g),m.setAttribute("stroke-width",n.toString()),m.setAttribute("width",t.toString()),m.setAttribute("height",e.toString()),m.setAttribute("fill","none"),m.setAttribute("stroke",i.fill[o]),m.setAttribute("stroke-dasharray",h),m.setAttribute("stroke-dashoffset",p);const v=Eo({d:g,fill:s,color:o,colors:i});return Wi(m,v)}function P2(t,e){if(e>t){const r=t/2;return`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${t},${e-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}const n=e/2;return`
    M${n},0
    L${t-n},0
    a${n},${n},0,1,1,0,${n*2}
    L${n},${e}
    a${n},${n},0,1,1,0,${-n*2}
    Z`}function _2(t,e){if(t>e){const r=e/2;return bc(r,r)+(t-r*2)*2}const n=t/2;return bc(n,n)+(e-n*2)*2}const pF=w.memo(function({w:e,h:n,strokeWidth:r,dash:o,color:i,fill:s}){const a=P2(e,n),l=_2(e,n),{strokeDasharray:c,strokeDashoffset:d}=_n(l<64?l*2:l,r,{style:o,snap:4,start:"outset",end:"outset",closed:!0});return f.jsxs(f.Fragment,{children:[f.jsx(Xt,{d:a,color:i,fill:s}),f.jsx("path",{d:a,strokeWidth:r,width:U(e),height:U(n),fill:"none",stroke:"currentColor",strokeDasharray:c,strokeDashoffset:d,pointerEvents:"all"})]})});function q1({w:t,h:e,strokeWidth:n,dash:r,color:o,colors:i,fill:s}){const a=P2(t,e),l=_2(t,e),{strokeDasharray:c,strokeDashoffset:d}=_n(l<64?l*2:l,n,{style:r,snap:4,closed:!0}),u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d",a),u.setAttribute("stroke-width",n.toString()),u.setAttribute("width",t.toString()),u.setAttribute("height",e.toString()),u.setAttribute("fill","none"),u.setAttribute("stroke",i.fill[o]),u.setAttribute("stroke-dasharray",c),u.setAttribute("stroke-dashoffset",d);const h=Eo({d:a,fill:s,color:o,colors:i});return Wi(u,h)}const fF=w.memo(function({dash:e,fill:n,color:r,strokeWidth:o,outline:i,lines:s}){const a="M"+i[0]+"L"+i.slice(1)+"Z";return f.jsxs(f.Fragment,{children:[f.jsx(Xt,{d:a,fill:n,color:r}),s&&s.map((l,c)=>f.jsx("path",{className:"tl-hitarea-stroke",fill:"none",d:`M${l[0].x},${l[0].y}L${l[1].x},${l[1].y}`},`line_bg_${c}`)),f.jsxs("g",{strokeWidth:o,stroke:"currentColor",fill:"none",pointerEvents:"all",children:[Array.from(Array(i.length)).map((l,c)=>{const d=i[c],u=i[(c+1)%i.length],h=I.Dist(d,u),{strokeDasharray:p,strokeDashoffset:g}=_n(h,o,{style:e,start:"outset",end:"outset"});return f.jsx("line",{x1:d.x,y1:d.y,x2:u.x,y2:u.y,strokeDasharray:p,strokeDashoffset:g},c)}),s&&s.map(([l,c],d)=>{const u=I.Dist(l,c),{strokeDasharray:h,strokeDashoffset:p}=_n(u,o,{style:e,start:"skip",end:"outset",snap:e==="dotted"?4:void 0});return f.jsx("path",{d:`M${l.x},${l.y}L${c.x},${c.y}`,stroke:"currentColor",strokeWidth:o,fill:"none",strokeDasharray:h,strokeDashoffset:p},`line_fg_${d}`)})]})]})});function gF({dash:t,fill:e,color:n,colors:r,strokeWidth:o,outline:i,lines:s}){const a=document.createElementNS("http://www.w3.org/2000/svg","g");if(a.setAttribute("stroke-width",o.toString()),a.setAttribute("stroke",r.fill[n]),a.setAttribute("fill","none"),Array.from(Array(i.length)).forEach((c,d)=>{const u=i[d],h=i[(d+1)%i.length],p=I.Dist(u,h),{strokeDasharray:g,strokeDashoffset:m}=_n(p,o,{style:t}),v=document.createElementNS("http://www.w3.org/2000/svg","line");v.setAttribute("x1",u.x.toString()),v.setAttribute("y1",u.y.toString()),v.setAttribute("x2",h.x.toString()),v.setAttribute("y2",h.y.toString()),v.setAttribute("stroke-dasharray",g.toString()),v.setAttribute("stroke-dashoffset",m.toString()),a.appendChild(v)}),s)for(const[c,d]of s){const u=I.Dist(c,d),{strokeDasharray:h,strokeDashoffset:p}=_n(u,o,{style:t,start:"skip",end:"skip",snap:t==="dotted"?4:2}),g=document.createElementNS("http://www.w3.org/2000/svg","line");g.setAttribute("x1",c.x.toString()),g.setAttribute("y1",c.y.toString()),g.setAttribute("x2",d.x.toString()),g.setAttribute("y2",d.y.toString()),g.setAttribute("stroke-dasharray",h.toString()),g.setAttribute("stroke-dashoffset",p.toString()),a.appendChild(g)}const l=Eo({d:"M"+i[0]+"L"+i.slice(1)+"Z",fill:e,color:n,colors:r});return Wi(a,l)}w.memo(function({id:e,w:n,h:r,strokeWidth:o,fill:i,color:s}){const a=Yv(e,n,r,o),l=k2(e,n,r,o);return f.jsxs(f.Fragment,{children:[f.jsx(Xt,{d:a,color:s,fill:i}),f.jsx("path",{d:l,fill:"currentColor",strokeWidth:0,pointerEvents:"all"})]})});function mF({id:t,w:e,h:n,strokeWidth:r,fill:o,color:i,colors:s}){const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",k2(t,e,n,r)),a.setAttribute("fill",s.fill[i]);const l=Eo({d:Yv(t,e,n,r),fill:o,color:i,colors:s});return Wi(a,l)}function I2(t){return{size:1+t,thinning:.25,end:{taper:t},start:{taper:t},streamline:0,smoothing:1,simulatePressure:!1}}function C2(t,e,n,r){const o=Bd(t),i=e/2,s=n/2,a=bc(i,s),l=[],c=dt*o(),d=dt+Ye/2+Math.abs(o())*Ye,u=Math.max(16,a/10);for(let h=0;h<u;h++){const p=h/(u-1),g=c+p*d,m=Math.cos(g),v=Math.sin(g);l.push(new I(i*m+e*.5+.05*o(),s*v+n/2+.05*o(),Math.min(1,.5+Math.abs(.5-(o()>0?Pn.easeInOutSine(p):Pn.easeInExpo(p)))/2)))}return Ra(l,I2(r))}function k2(t,e,n,r){const o=I2(r);return Cc(Sc(Ec(C2(t,e,n,r),o),o))}function Yv(t,e,n,r){return rc(C2(t,e,n,r))}const yF=w.memo(function({id:e,outline:n,lines:r,fill:o,color:i,strokeWidth:s}){const a=_c(e,n,s/3,s*2,2);let l=Pc(a);if(r)for(const[u,h]of r)l+=`M${u.x},${u.y}L${h.x},${h.y}`;const c=_c(e,n,0,s*2,1),d=Pc(c);return f.jsxs(f.Fragment,{children:[f.jsx(Xt,{d,fill:o,color:i}),f.jsx("path",{d:l,stroke:"currentColor",strokeWidth:s,fill:"none"})]})});function vF({id:t,outline:e,lines:n,fill:r,color:o,colors:i,strokeWidth:s}){const a=_c(t,e,s/3,s*2,2);let l=Pc(a);if(n)for(const[p,g]of n)l+=`M${p.x},${p.y}L${g.x},${g.y}`;const c=_c(t,e,0,s*2,1),d=Pc(c),u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d",l),u.setAttribute("fill","none"),u.setAttribute("stroke",i.fill[o]),u.setAttribute("stroke-width",s.toString());const h=Eo({d,fill:r,color:o,colors:i});return Wi(u,h)}const Q1=w.memo(function({w:e,h:n,strokeWidth:r,fill:o,color:i}){const s=e/2,a=n/2,l=Math.max(0,s),c=Math.max(0,a),d=`M${s-l},${a}a${l},${c},0,1,1,${l*2},0a${l},${c},0,1,1,-${l*2},0`;return f.jsxs(f.Fragment,{children:[f.jsx(Xt,{d,color:i,fill:o}),f.jsx("path",{d,stroke:`var(--palette-${i})`,strokeWidth:r,fill:"none"})]})});function wF({w:t,h:e,strokeWidth:n,fill:r,color:o,colors:i}){const s=t/2,a=e/2,l=Math.max(0,s),c=Math.max(0,a),d=`M${s-l},${a}a${l},${c},0,1,1,${l*2},0a${l},${c},0,1,1,-${l*2},0`,u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d",d),u.setAttribute("stroke-width",n.toString()),u.setAttribute("width",t.toString()),u.setAttribute("height",e.toString()),u.setAttribute("fill","none"),u.setAttribute("stroke",i.fill[o]);const h=Eo({d,fill:r,color:o,colors:i});return Wi(u,h)}const Z1=w.memo(function({w:e,h:n,strokeWidth:r,fill:o,color:i}){const s=Xv(e,n);return f.jsxs(f.Fragment,{children:[f.jsx(Xt,{d:s,color:i,fill:o}),f.jsx("path",{d:s,stroke:`var(--palette-${i})`,strokeWidth:r,fill:"none"})]})});function xF({w:t,h:e,strokeWidth:n,fill:r,color:o,colors:i}){const s=Xv(t,e),a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",s),a.setAttribute("stroke-width",n.toString()),a.setAttribute("width",t.toString()),a.setAttribute("height",e.toString()),a.setAttribute("fill","none"),a.setAttribute("stroke",i.fill[o]);const l=Eo({d:s,fill:r,color:o,colors:i});return Wi(a,l)}function Xv(t,e){let n;if(e>t){const r=t/2;n=`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${t},${e-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}else{const r=e/2;n=`
    M${r},0
    L${t-r},0
    a${r},${r},0,1,1,0,${r*2}
    L${r},${e}
    a${r},${r},0,1,1,0,${-r*2}
    Z`}return n}const bF=w.memo(function({outline:e,lines:n,fill:r,color:o,strokeWidth:i}){let s="M"+e[0]+"L"+e.slice(1)+"Z";if(n)for(const[a,l]of n)s+=`M${a.x},${a.y}L${l.x},${l.y}`;return f.jsxs(f.Fragment,{children:[f.jsx(Xt,{d:s,fill:r,color:o}),f.jsx("path",{d:s,stroke:`var(--palette-${o}`,strokeWidth:i,fill:"none"})]})});function SF({outline:t,lines:e,fill:n,color:r,strokeWidth:o,colors:i}){const s="M"+t[0]+"L"+t.slice(1)+"Z",a=s;let l=s;if(e)for(const[u,h]of e)l+=`M${u.x},${u.y}L${h.x},${h.y}`;const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",l),c.setAttribute("stroke-width",o.toString()),c.setAttribute("stroke",i.fill[r]),c.setAttribute("fill","none");const d=Eo({d:a,fill:n,color:r,colors:i});return Wi(c,d)}const Ig=16,mr=17*3;class $2 extends Yi{constructor(){super(...arguments);y(this,"canEdit",()=>!0);y(this,"onEditEnd",n=>{const{id:r,type:o,props:{text:i}}=n;i.trimEnd()!==n.props.text&&this.app.updateShapes([{id:r,type:o,props:{text:i.trimEnd()}}])});y(this,"onResize",(n,{initialBounds:r,handle:o,newPoint:i,scaleX:s,scaleY:a})=>{let l=r.width*s,c=r.height*a,d=0,u=0;if(n.props.text.trim()){let m=Math.max(Math.abs(l),mr),v=Math.max(Math.abs(c),mr);m<mr&&v===mr&&(m=mr),m===mr&&v<mr&&(v=mr);const x=rd(this.app,{...n,props:{...n.props,w:m,h:v}}),b=Math.max(Math.abs(l),x.w)*Math.sign(l),E=Math.max(Math.abs(c),x.h)*Math.sign(c);d=Math.abs(b)-Math.abs(l),u=Math.abs(E)-Math.abs(c),l=b,c=E}const h=new I(0,0);s<0&&(h.x+=l),(o==="left"||o==="top_left"||o==="bottom_left")&&(h.x+=s<0?d:-d),a<0&&(h.y+=c),(o==="top"||o==="top_left"||o==="top_right")&&(h.y+=a<0?u:-u);const{x:p,y:g}=h.rot(n.rotation).add(i);return{x:p,y:g,props:{w:Math.max(Math.abs(l),1),h:Math.max(Math.abs(c),1),growY:0}}});y(this,"onBeforeCreate",n=>{if(!n.props.text)return n.props.growY?{...n,props:{...n.props,growY:0}}:void 0;const r=n.props.h,o=rd(this.app,n).h;let i=null;if(o>r?i=o-r:n.props.growY&&(i=0),i!==null)return{...n,props:{...n.props,growY:i}}});y(this,"onBeforeUpdate",(n,r)=>{const o=n.props.text.trimEnd(),i=r.props.text.trimEnd();if(o===i&&n.props.font===r.props.font&&n.props.size===r.props.size)return;if(o&&!i)return{...r,props:{...r.props,growY:0}};const s=n.props.w,a=n.props.h,l=rd(this.app,r),c=l.w,d=l.h;if(!o&&i&&i.length===1){let h=Math.max(s,c),p=Math.max(a,d);return n.props.w<mr&&n.props.h<mr&&(h=Math.max(h,mr),p=Math.max(p,mr),h=Math.max(h,p),p=Math.max(h,p)),{...r,props:{...r.props,w:h,h:p,growY:0}}}let u=null;if(d>a?u=d-a:n.props.growY&&(u=0),u!==null)return{...r,props:{...r.props,growY:u,w:Math.max(r.props.w,c)}};if(c>n.props.w)return{...r,props:{...r.props,w:c}}});y(this,"onDoubleClick",n=>{if(this.app.inputs.altKey)switch(n.props.geo){case"rectangle":return{...n,props:{geo:"check-box"}};case"check-box":return{...n,props:{geo:"rectangle"}}}})}defaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",opacity:"1",font:"draw",text:"",align:"middle",growY:0,url:""}}hitTestLineSegment(n,r,o){const i=this.outline(n);for(let a=0;a<i.length;a++){const l=i[a],c=i[(a+1)%i.length];if(qo(r,o,l,c))return!0}const s=Rl(n.props,0);if(s!==void 0){for(const[a,l]of s)if(qo(r,o,a,l))return!0}return!1}hitTestPoint(n,r){const o=this.outline(n);if(n.props.fill==="none"){const i=this.app.zoomLevel,s=this.app.getStrokeWidth(n.props.size)/i;for(let l=0;l<o.length;l++){const c=o[l],d=o[(l+1)%o.length];if(I.DistanceToLineSegment(c,d,r)<s)return!0}const a=Rl(n.props,1);if(a!==void 0){for(const[l,c]of a)if(I.DistanceToLineSegment(l,c,r)<s)return!0}return!1}return $r(r,o)}getBounds(n){return new de(0,0,n.props.w,n.props.h+n.props.growY)}getCenter(n){return new I(n.props.w/2,(n.props.h+n.props.growY)/2)}getOutline(n){const r=Math.max(1,n.props.w),o=Math.max(1,n.props.h+n.props.growY),i=r/2,s=o/2;switch(n.props.geo){case"triangle":return[new I(i,0),new I(r,o),new I(0,o)];case"diamond":return[new I(i,0),new I(r,s),new I(i,o),new I(0,s)];case"pentagon":return hg(r,o,5);case"hexagon":return hg(r,o,6);case"octagon":return hg(r,o,8);case"ellipse":{const a=Math.pow(i-s,2)/Math.pow(i+s,2),l=ct*(i+s)*(1+3*a/(10+Math.sqrt(4-3*a)));let c=Math.max(4,Math.ceil(l/10));c=Math.ceil(c/4)*4;const d=dt/c,u=Math.cos(d),h=Math.sin(d);let p=0,g=1,m=0,v=1;const x=Array(c);for(let b=0;b<c;b++)x[b]=new I(i+i*g,s+s*p),m=h*g+u*p,v=u*g-h*p,p=m,g=v;return x}case"oval":{const l=Array(20);if(o>r)for(let c=0;c<10;c++){const d=-ct+ct*c/8,u=ct*c/(10-2);l[c]=new I(i+i*Math.cos(d),i+i*Math.sin(d)),l[c+10]=new I(i+i*Math.cos(u),o-i+i*Math.sin(u))}else for(let c=0;c<10;c++){const d=-Ye+ct*c/8,u=Ye+ct*-c/(10-2);l[c]=new I(r-s+s*Math.cos(d),o-s+s*Math.sin(d)),l[c+10]=new I(s-s*Math.cos(u),o-s+s*Math.sin(u))}return l}case"star":{const l=dt/5/2,c=Math.floor(5/4)*2,d=5*2-c,u=0,h=Math.floor(5/2)*2,p=Math.cos(-Ye+c*l)*r/2,g=Math.cos(-Ye+d*l)*r/2,m=Math.sin(-Ye+u*l)*o/2,v=Math.sin(-Ye+h*l)*o/2,x=r-Math.abs(p-g),b=o-Math.abs(v-m),E=r/2+g-(r/2-p),P=o/2+m-(o/2-v),C=1,k=(r-E)/2,$=(o-P)/2,A=(r+x)/2,D=(o+b)/2,j=A*C/2,Y=D*C/2;return Array.from(Array(5*2)).map((V,q)=>{const F=-Ye+q*l;return new I(k+(q%2?j:A)*Math.cos(F),$+(q%2?Y:D)*Math.sin(F))})}case"rhombus":{const a=Math.min(r*.38,o*.38);return[new I(a,0),new I(r,0),new I(r-a,o),new I(0,o)]}case"rhombus-2":{const a=Math.min(r*.38,o*.38);return[new I(0,0),new I(r-a,0),new I(r,o),new I(a,o)]}case"trapezoid":{const a=Math.min(r*.38,o*.38);return[new I(a,0),new I(r-a,0),new I(r,o),new I(0,o)]}case"arrow-right":{const a=Math.min(r,o)*.38,l=o*.16;return[new I(0,l),new I(r-a,l),new I(r-a,0),new I(r,o/2),new I(r-a,o),new I(r-a,o-l),new I(0,o-l)]}case"arrow-left":{const a=Math.min(r,o)*.38,l=o*.16;return[new I(a,0),new I(a,l),new I(r,l),new I(r,o-l),new I(a,o-l),new I(a,o),new I(0,o/2)]}case"arrow-up":{const a=r*.16,l=Math.min(r,o)*.38;return[new I(r/2,0),new I(r,l),new I(r-a,l),new I(r-a,o),new I(a,o),new I(a,l),new I(0,l)]}case"arrow-down":{const a=r*.16,l=Math.min(r,o)*.38;return[new I(a,0),new I(r-a,0),new I(r-a,o-l),new I(r,o-l),new I(r/2,o),new I(0,o-l),new I(a,o-l)]}case"check-box":case"x-box":case"rectangle":return[new I(0,0),new I(r,0),new I(r,o),new I(0,o)]}}render(n){const{id:r,type:o,props:i}=n,s=kc(),a=this.app.getStrokeWidth(i.size),{w:l,color:c,labelColor:d,fill:u,dash:h,growY:p,font:g,align:m,size:v,text:x}=i,b=()=>{const E=i.h+p;switch(i.geo){case"ellipse":{if(h==="solid"||h==="draw"&&s)return f.jsx(Q1,{strokeWidth:a,w:l,h:E,color:c,fill:u});if(h==="dashed"||h==="dotted")return f.jsx(dF,{id:r,strokeWidth:a,w:l,h:E,dash:h==="dashed"?h:v==="s"&&s?"dashed":h,color:c,fill:u});if(h==="draw")return f.jsx(Q1,{strokeWidth:a,w:l,h:E,color:c,fill:u});break}case"oval":{if(h==="solid"||h==="draw"&&s)return f.jsx(Z1,{strokeWidth:a,w:l,h:E,color:c,fill:u});if(h==="dashed"||h==="dotted")return f.jsx(pF,{id:r,strokeWidth:a,w:l,h:E,dash:h==="dashed"?h:v==="s"&&s?"dashed":h,color:c,fill:u});if(h==="draw")return f.jsx(Z1,{strokeWidth:a,w:l,h:E,color:c,fill:u});break}default:{const P=this.outline(n),C=Rl(n.props,a);if(h==="solid"||h==="draw"&&s)return f.jsx(bF,{fill:u,color:c,strokeWidth:a,outline:P,lines:C});if(h==="dashed"||h==="dotted")return f.jsx(fF,{dash:h==="dashed"?h:v==="s"&&s?"dashed":h,fill:u,color:c,strokeWidth:a,outline:P,lines:C});if(h==="draw")return f.jsx(yF,{id:r,fill:u,color:c,strokeWidth:a,outline:P,lines:C})}}};return f.jsxs(f.Fragment,{children:[f.jsx(xr,{id:r,children:b()}),f.jsx(E2,{id:r,type:o,font:g,fill:u,size:v,align:m,text:x,labelColor:this.app.getCssColor(d),wrap:!0}),"url"in n.props&&n.props.url&&f.jsx(mu,{url:n.props.url,zoomLevel:this.app.zoomLevel})]})}indicator(n){const{id:r,props:o}=n,{w:i,h:s,growY:a,size:l}=o,c=kc(),d=this.app.getStrokeWidth(l);switch(o.geo){case"ellipse":return o.dash==="draw"&&!c?f.jsx("path",{d:Yv(r,i,s+a,d)}):f.jsx("ellipse",{cx:i/2,cy:(s+a)/2,rx:i/2,ry:(s+a)/2});case"oval":return f.jsx("path",{d:Xv(i,s+a)});default:{const u=this.outline(n);let h;if(o.dash==="draw"&&!c){const g=_c(r,u,0,d*2,1);h=Pc(g)}else h="M"+u[0]+"L"+u.slice(1)+"Z";const p=Rl(n.props,d);if(p)for(const[g,m]of p)h+=`M${g.x},${g.y}L${m.x},${m.y}`;return f.jsx("path",{d:h})}}}toSvg(n,r,o){const{id:i,props:s}=n,a=this.app.getStrokeWidth(s.size);let l;switch(s.geo){case"ellipse":{switch(s.dash){case"draw":l=mF({id:i,w:s.w,h:s.h,color:s.color,fill:s.fill,strokeWidth:a,colors:o});break;case"solid":l=wF({strokeWidth:a,w:s.w,h:s.h,color:s.color,fill:s.fill,colors:o});break;default:l=hF({id:i,strokeWidth:a,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,colors:o});break}break}case"oval":{switch(s.dash){case"draw":l=q1({id:i,strokeWidth:a,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,colors:o});break;case"solid":l=xF({strokeWidth:a,w:s.w,h:s.h,color:s.color,fill:s.fill,colors:o});break;default:l=q1({id:i,strokeWidth:a,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,colors:o})}break}default:{const c=this.outline(n),d=Rl(n.props,a);switch(s.dash){case"draw":l=vF({id:i,fill:s.fill,color:s.color,strokeWidth:a,outline:c,lines:d,colors:o});break;case"solid":l=SF({fill:s.fill,color:s.color,strokeWidth:a,outline:c,lines:d,colors:o});break;default:l=gF({dash:s.dash,fill:s.fill,color:s.color,strokeWidth:a,outline:c,lines:d,colors:o});break}break}}if(s.text){const c=this.bounds(n),d={fontSize:Pi[n.props.size],fontFamily:r,textAlign:n.props.align,padding:16,lineHeight:Ct.lineHeight,fontStyle:"normal",fontWeight:"normal",width:Math.ceil(c.width),height:Math.ceil(c.height)},u=this.app.textMeasure.getTextLines({text:s.text,wrap:!0,...d}),h=document.createElementNS("http://www.w3.org/2000/svg","g"),p=rd(this.app,n),g=Dp(this.app,{...d,lines:u,strokeWidth:2,stroke:o.background,fill:o.background,width:p.w});g.setAttribute("transform",`translate(${(c.width-p.w)/2}, 0)`);const m=g.cloneNode(!0);if(m.setAttribute("fill",o.fill[n.props.labelColor]),m.setAttribute("stroke","none"),h.append(g),h.append(m),l.nodeName==="g")return l.appendChild(h),l;{const v=document.createElementNS("http://www.w3.org/2000/svg","g");return v.appendChild(l),v.appendChild(h),v}}return l}}y($2,"type","geo");function rd(t,e){const n=e.props.text.trimEnd();if(!n)return{w:0,h:0};const r=t.textMeasure.measureText({...Ct,text:"w",fontFamily:Ko[e.props.font],fontSize:Pi[e.props.size],width:"fit-content",maxWidth:"100px"}),o={s:2,m:3.5,l:5,xl:10},i=t.textMeasure.measureText({...Ct,text:n,fontFamily:Ko[e.props.font],fontSize:Pi[e.props.size],width:"fit-content",minWidth:r.w+"px",maxWidth:Math.max(0,Math.ceil(r.w+o[e.props.size]),Math.ceil(e.props.w-Ig*2))+"px"});return{w:i.w+Ig*2,h:i.h+Ig*2}}function Rl(t,e){switch(t.geo){case"x-box":return EF(t.w,t.h,e,t.dash);case"check-box":return PF(t.w,t.h);default:return}}function EF(t,e,n,r){const o=r==="draw"?.62:0;return r==="dashed"?[[new I(0,0),new I(t/2,e/2)],[new I(t,e),new I(t/2,e/2)],[new I(0,e),new I(t/2,e/2)],[new I(t,0),new I(t/2,e/2)]]:[[new I(n*o,n*o),new I(t-n*o,e-n*o)],[new I(n*o,e-n*o),new I(t-n*o,n*o)]]}function PF(t,e){const n=Math.min(t,e)*.82,r=(t-n)/2,o=(e-n)/2;return[[new I(r+n*.25,o+n*.52),new I(r+n*.45,o+n*.82)],[new I(r+n*.45,o+n*.82),new I(r+n*.82,o+n*.22)]]}const T2=qn({type:"geo",getShapeUtil:()=>$2,validator:gI,migrations:mI});function J1({bounds:t,zoomLevel:e,className:n}){return f.jsx("g",{className:n,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:t.sides.map((r,o)=>{const{strokeDasharray:i,strokeDashoffset:s}=_n(r[0].dist(r[1]),1/e,{style:"dashed",lengthRatio:4});return f.jsx("line",{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y,strokeDasharray:i,strokeDashoffset:s},o)})})}class M2 extends Po{constructor(){super(...arguments);y(this,"hideSelectionBoundsBg",()=>!1);y(this,"hideSelectionBoundsFg",()=>!0);y(this,"canBind",()=>!1);y(this,"onChildrenChange",n=>{const r=this.app.getSortedChildIds(n.id);if(r.length===0){this.app.pageState.focusLayerId===n.id&&this.app.popFocusLayer(),this.app.deleteShapes([n.id]);return}else if(r.length===1){this.app.pageState.focusLayerId===n.id&&this.app.popFocusLayer(),this.app.reparentShapesById(r,n.parentId),this.app.deleteShapes([n.id]);return}})}defaultProps(){return{opacity:"1"}}getBounds(n){const r=this.app.getSortedChildIds(n.id);if(r.length===0)return new de;const o=r.flatMap(i=>{const s=this.app.getShapeById(i);return this.app.getOutlineById(i).map(a=>ee.applyToPoint(this.app.getTransform(s),a))});return de.FromPoints(o)}getCenter(n){return this.bounds(n).center}getOutline(n){return this.bounds(n).corners}render(n){const{erasingIdsSet:r,pageState:{hintingIds:o,focusLayerId:i},zoomLevel:s}=this.app,a=r.has(n.id),l=o.length>0&&o.some(d=>{var u;return d!==n.id&&((u=this.app.getShapeById(d))==null?void 0:u.type)==="group"});if(!a&&(n.id!==i||l))return null;const c=this.bounds(n);return f.jsx(xr,{id:n.id,children:f.jsx(J1,{className:"tl-group",bounds:c,zoomLevel:s})})}indicator(n){const{camera:{z:r}}=this.app,o=this.bounds(n);return f.jsx(J1,{className:"",bounds:o,zoomLevel:r})}}y(M2,"type","group");const A2=qn({type:"group",getShapeUtil:()=>M2,validator:yI,migrations:vI});function eS(t){const e=Z();return ge("isCropping",()=>e.croppingId===t,[e,t])}const _F=async t=>new Promise((e,n)=>{const r=new Image;r.onload=()=>e(r),r.onerror=()=>n(new Error("Failed to load image")),r.crossOrigin="anonymous",r.src=t}),IF=async t=>{const e=await _F(t),n=document.createElement("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");if(r)return r.drawImage(e,0,0),n.toDataURL()};async function CF(t){const n=await(await fetch(t)).blob();return new Promise((r,o)=>{const i=new FileReader;i.onloadend=()=>r(i.result),i.onerror=o,i.readAsDataURL(n)})}class R2 extends Yi{constructor(){super(...arguments);y(this,"isAspectRatioLocked",()=>!0);y(this,"canCrop",()=>!0);y(this,"onDoubleClick",n=>{const r=n.props.assetId?this.app.getAssetById(n.props.assetId):void 0;!r||!(r.props.src&&"mimeType"in r.props&&r.props.mimeType==="image/gif")||this.app.updateShapes([{type:"image",id:n.id,props:{playing:!n.props.playing}}])});y(this,"onDoubleClickEdge",n=>{const r=n.props;if(!r||this.app.croppingId!==n.id)return;const o=Fn(r.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},i=1/(o.bottomRight.x-o.topLeft.x)*n.props.w,s=1/(o.bottomRight.y-o.topLeft.y)*n.props.h,a=new I(o.topLeft.x*i,o.topLeft.y*s).rot(n.rotation),l={id:n.id,type:n.type,x:n.x-a.x,y:n.y-a.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:i,h:s}};this.app.updateShapes([l])})}defaultProps(){return{opacity:"1",w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}render(n){var m,v;const r=tS(n),o=eS(n.id),i=FI(),[s,a]=w.useState(""),{Spinner:l}=wn(),{w:c,h:d}=n.props,u=n.props.assetId?this.app.getAssetById(n.props.assetId):void 0;if((u==null?void 0:u.type)==="bookmark")throw Error("Bookmark assets can't be rendered as images");const p=ge("onlySelectedShape",()=>{var x;return n.id===((x=this.app.onlySelectedShape)==null?void 0:x.id)},[this.app])&&o&&this.app.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),g=i&&(((m=u==null?void 0:u.props.mimeType)==null?void 0:m.includes("video"))||((v=u==null?void 0:u.props.mimeType)==null?void 0:v.includes("gif")));return w.useEffect(()=>{if(u!=null&&u.props.src&&"mimeType"in u.props&&(u==null?void 0:u.props.mimeType)==="image/gif"){let x=!1;return(async()=>{const E=await IF(u.props.src);x||E&&a(E)})(),()=>{x=!0}}},[i,u==null?void 0:u.props]),f.jsxs(f.Fragment,{children:[(u==null?void 0:u.props.src)&&p&&f.jsx("div",{style:r,children:f.jsx("div",{className:`tl-image tl-image-${n.id}-crop`,style:{opacity:.1,backgroundImage:`url(${!n.props.playing||g?s:u.props.src})`},draggable:!1})}),f.jsx(Ts,{id:n.id,style:{overflow:"hidden"},children:f.jsxs("div",{className:"tl-image-container",style:r,children:[u!=null&&u.props.src?f.jsx("div",{className:`tl-image tl-image-${n.id}`,style:{backgroundImage:`url(${!n.props.playing||g?s:u.props.src})`},draggable:!1}):l?f.jsx("g",{transform:`translate(${(c-38)/2}, ${(d-38)/2})`,children:f.jsx(l,{})}):null,(u==null?void 0:u.props.isAnimated)&&!n.props.playing&&f.jsx("div",{className:"tl-image__tg",children:"GIF"})]})}),"url"in n.props&&n.props.url&&f.jsx(mu,{url:n.props.url,zoomLevel:this.app.zoomLevel})]})}indicator(n){return eS(n.id)?null:f.jsx("rect",{width:U(n.props.w),height:U(n.props.h)})}async toSvg(n){const r=document.createElementNS("http://www.w3.org/2000/svg","g"),o=n.props.assetId?this.app.getAssetById(n.props.assetId):null;let i=(o==null?void 0:o.props.src)||"";i&&i.startsWith("http")&&(i=await CF(i)||"");const s=document.createElementNS("http://www.w3.org/2000/svg","image");s.setAttributeNS("http://www.w3.org/1999/xlink","href",i);const a=tS(n),l=n.props.crop;if(a&&l){const{transform:c,width:d,height:u}=a,h=[new I(l.topLeft.x*d,l.topLeft.y*u),new I(l.bottomRight.x*d,l.topLeft.y*u),new I(l.bottomRight.x*d,l.bottomRight.y*u),new I(l.topLeft.x*d,l.bottomRight.y*u)],p=document.createElementNS("http://www.w3.org/2000/svg","g");p.style.clipPath=`polygon(${h.map(g=>`${g.x}px ${g.y}px`).join(",")})`,s.setAttribute("width",d.toString()),s.setAttribute("height",u.toString()),s.style.transform=c,p.appendChild(s),r.appendChild(p)}else s.setAttribute("width",n.props.w.toString()),s.setAttribute("height",n.props.h.toString()),r.appendChild(s);return r}}y(R2,"type","image");const kF=qn({type:"image",getShapeUtil:()=>R2,validator:wI,migrations:xI});function tS(t){const e=t.props.crop,n=e==null?void 0:e.topLeft;if(!n)return;const r=1/(e.bottomRight.x-e.topLeft.x)*t.props.w,o=1/(e.bottomRight.y-e.topLeft.y)*t.props.h,i=-n.x*r,s=-n.y*o;return{transform:`translate(${i}px, ${s}px)`,width:r,height:o}}const tr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",$F="a0",L2="A00000000000000000000000000";function D2(t){if(t>="a"&&t<="z")return t.charCodeAt(0)-"a".charCodeAt(0)+2;if(t>="A"&&t<="Z")return"Z".charCodeAt(0)-t.charCodeAt(0)+2;throw new Error("Invalid index key head: "+t)}function O2(t){if(t.length!==D2(t.charAt(0)))throw new Error("invalid integer part of index key: "+t)}function nS(t){if(t===void 0)throw Error("n is undefined")}function rS(t){O2(t);const[e,...n]=t.split("");let r=!0;for(let o=n.length-1;r&&o>=0;o--){const i=tr.indexOf(n[o])+1;i===tr.length?n[o]="0":(n[o]=tr.charAt(i),r=!1)}if(r){if(e==="Z")return"a0";if(e==="z")return;const o=String.fromCharCode(e.charCodeAt(0)+1);return o>"a"?n.push("0"):n.pop(),o+n.join("")}else return e+n.join("")}function TF(t){O2(t);const[e,...n]=t.split("");let r=!0;for(let o=n.length-1;r&&o>=0;o--){const i=tr.indexOf(n[o])-1;i===-1?n[o]=tr.slice(-1):(n[o]=tr.charAt(i),r=!1)}if(r){if(e==="a")return"Z"+tr.slice(-1);if(e==="A")return;const o=String.fromCharCode(e.charCodeAt(0)-1);return o<"Z"?n.push(tr.slice(-1)):n.pop(),o+n.join("")}else return e+n.join("")}function ga(t,e){if(e!==void 0&&t>=e)throw new Error(t+" >= "+e);if(t.slice(-1)==="0"||e&&e.slice(-1)==="0")throw new Error("trailing zero");if(e){let o=0;for(;(t.charAt(o)||"0")===e.charAt(o);)o++;if(o>0)return e.slice(0,o)+ga(t.slice(o),e.slice(o))}const n=t?tr.indexOf(t.charAt(0)):0,r=e!==void 0?tr.indexOf(e.charAt(0)):tr.length;if(r-n>1){const o=Math.round(.5*(n+r));return tr.charAt(o)}else return e&&e.length>1?e.slice(0,1):tr.charAt(n)+ga(t.slice(1),void 0)}function Ql(t){const e=D2(t.charAt(0));if(e>t.length)throw new Error("invalid index: "+t);return t.slice(0,e)}function oS(t){if(t===L2)throw new Error("invalid index: "+t);const e=Ql(t);if(t.slice(e.length).slice(-1)==="0")throw new Error("invalid index: "+t)}function oa(t,e){if(t!==void 0&&oS(t),e!==void 0&&oS(e),t!==void 0&&e!==void 0&&t>=e)throw new Error(t+" >= "+e);if(t===void 0&&e===void 0)return $F;if(t===void 0){if(e===void 0)throw Error("b is undefined");const a=Ql(e),l=e.slice(a.length);if(a===L2)return a+ga("",l);if(a<e)return a;const c=TF(a);return nS(c),c}if(e===void 0){const a=Ql(t),l=t.slice(a.length),c=rS(a);return c===void 0?a+ga(l,void 0):c}const n=Ql(t),r=t.slice(n.length),o=Ql(e),i=e.slice(o.length);if(n===o)return n+ga(r,i);const s=rS(n);return nS(s),s<e?s:n+ga(r,void 0)}function Di(t,e,n){if(n===0)return[];if(n===1)return[oa(t,e)];if(e===void 0){let i=oa(t,e);const s=[i];for(let a=0;a<n-1;a++)i=oa(i,e),s.push(i);return s}if(t===void 0){let i=oa(t,e);const s=[i];for(let a=0;a<n-1;a++)i=oa(t,i),s.push(i);return s.reverse(),s}const r=Math.floor(n/2),o=oa(t,e);return[...Di(t,o,r),o,...Di(o,e,n-r-1)]}function ia(t,e,n){return Di(t,e,n)}function Cg(t,e){return Di(t,void 0,e)}function oc(t,e){return Di(t,e,1)[0]}function Oo(t){return Di(t,void 0,1)[0]}function MF(t){return Di(void 0,t,1)[0]}function j2(t){return["a1",...Di("a1",void 0,t)]}function jn(t,e){return t.index<e.index?-1:t.index>e.index?1:0}function AF(t,e){return t.id<e.id?-1:t.id>e.id?1:0}function N2(t){const{segments:e}=t,n=[];for(let r=0,o=e.length;r<o;r++){const s=e[r].lut,a=s.length-1;r>0?n.push(I.Lrp(s[0],s[1],.25)):n.push(s[0]);for(let l=1;l<a;l++)n.push(s[l]);r<o-1?n.push(I.Lrp(s[a-1],s[a],.75)):n.push(s[a])}return n}function B2(t){return{size:t,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function z2(t,e,n){const r=N2(e),o=B2(n);return Ra(r,o)}function RF(t,e,n){const r=B2(n);return Sc(Ec(z2(t,e,n),r),r)}function U2(t,e,n){const r=RF(t,e,n);return Cc(r)}function LF(t,e,n){if(t.props.dash==="draw"){const r=z2(t,e,n);return rc(r)}return e.path}function DF({shape:t,strokeWidth:e,spline:n,color:r}){const o=U2(t,n,e),i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("stroke-width","0"),i.setAttribute("stroke","none"),i.setAttribute("fill",r),i.setAttribute("d",o),i}function OF({dash:t,strokeWidth:e,spline:n,color:r}){const{segments:o}=n,i=document.createElementNS("http://www.w3.org/2000/svg","g");return i.setAttribute("stroke",r),i.setAttribute("stroke-width",e.toString()),o.forEach((s,a)=>{const l=document.createElementNS("http://www.w3.org/2000/svg","path"),{strokeDasharray:c,strokeDashoffset:d}=_n(s.length,e,{style:t,start:a>0?"outset":"none",end:a<o.length-1?"outset":"none"});l.setAttribute("stroke-dasharray",c.toString()),l.setAttribute("stroke-dashoffset",d.toString()),l.setAttribute("d",s.path),l.setAttribute("fill","none"),i.appendChild(l)}),i}function jF({strokeWidth:t,spline:e,color:n}){const{path:r}=e,o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("stroke-width",t.toString()),o.setAttribute("stroke",n),o.setAttribute("fill","none"),o.setAttribute("d",r),o}function NF(t,e,n,r){switch(t.props.dash){case"draw":return DF({shape:t,strokeWidth:r,spline:e,color:n});case"solid":return jF({strokeWidth:r,spline:e,color:n});default:return OF({strokeWidth:r,spline:e,dash:t.props.dash,color:n})}}const BF=new cl,zF=new cl;class F2 extends Po{constructor(){super(...arguments);y(this,"hideResizeHandles",()=>!0);y(this,"hideRotateHandle",()=>!0);y(this,"hideSelectionBoundsBg",()=>!0);y(this,"hideSelectionBoundsFg",()=>!0);y(this,"isClosed",()=>!1);y(this,"onResize",(n,r)=>{const{scaleX:o,scaleY:i}=r,s=Fn(n.props.handles);return Object.values(n.props.handles).forEach(({id:a,x:l,y:c})=>{s[a].x=l*o,s[a].y=c*i}),{props:{handles:s}}});y(this,"onHandleChange",(n,{handle:r})=>{const o=Fn(n);switch(r.id){case"start":case"end":{o.props.handles[r.id]={...o.props.handles[r.id],x:r.x,y:r.y};break}default:{const i="handle:"+r.index,s=n.props.handles[i];s?o.props.handles[i]={...s,x:r.x,y:r.y}:o.props.handles[i]={id:i,type:"vertex",canBind:!1,index:r.index,x:r.x,y:r.y};break}}return o})}defaultProps(){return{opacity:"1",dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,index:"a2",x:0,y:0}}}}getBounds(n){return cs(n).bounds}getCenter(n){return this.bounds(n).center}getHandles(n){return zF.get(n.props,()=>{const r=n.props.handles,o=cs(n),i=Object.values(r).sort(jn),s=i.slice();for(let a=0;a<o.segments.length;a++){const c=o.segments[a].getPoint(.5),d=oc(i[a].index,i[a+1].index);s.push({id:`mid-${a}`,type:"create",index:d,x:c.x,y:c.y})}return s.sort(jn)})}getOutline(n){return N2(cs(n))}hitTestPoint(n,r){const o=this.app.zoomLevel,i=this.app.getStrokeWidth(n.props.size)/o;return B8(r,this.outline(n),i)}hitTestLineSegment(n,r,o){return kv(r,o,this.outline(n))!==null}render(n){const r=kc(),o=cs(n),i=this.app.getStrokeWidth(n.props.size),{dash:s,color:a}=n.props;if(n.props.spline==="line"){if(s==="solid"){const l=o.points,c="M"+l[0]+"L"+l.slice(1);return f.jsxs(xr,{id:n.id,children:[f.jsx(Xt,{d:c,fill:"none",color:a}),f.jsx("path",{d:c,stroke:"currentColor",strokeWidth:i,fill:"none"})]})}if(s==="dashed"||s==="dotted"){const l=o.points,c="M"+l[0]+"L"+l.slice(1);return f.jsxs(xr,{id:n.id,children:[f.jsx(Xt,{d:c,fill:"none",color:a}),f.jsx("g",{stroke:"currentColor",strokeWidth:i,children:o.segments.map((d,u)=>{const{strokeDasharray:h,strokeDashoffset:p}=_n(d.length,i,{style:s,start:u>0?"outset":"none",end:u<o.segments.length-1?"outset":"none"});return f.jsx("path",{strokeDasharray:h,strokeDashoffset:p,d:d.path,fill:"none"},u)})})]})}if(s==="draw"){const l=o.points,[c,d]=d1(n.id,l,i);return f.jsxs(xr,{id:n.id,children:[f.jsx(Xt,{d:c,fill:"none",color:a}),f.jsx("path",{d,stroke:"currentColor",strokeWidth:i,fill:"none"})]})}}if(n.props.spline==="cubic"){const l=o.path;if(s==="solid"||s==="draw"&&r)return f.jsxs(xr,{id:n.id,children:[f.jsx(Xt,{d:l,fill:"none",color:a}),f.jsx("path",{strokeWidth:i,stroke:"currentColor",fill:"none",d:l})]});if(s==="dashed"||s==="dotted")return f.jsxs(xr,{id:n.id,children:[f.jsx(Xt,{d:l,fill:"none",color:a}),f.jsx("g",{stroke:"currentColor",strokeWidth:i,children:o.segments.map((c,d)=>{const{strokeDasharray:u,strokeDashoffset:h}=_n(c.length,i,{style:s,start:d>0?"outset":"none",end:d<o.segments.length-1?"outset":"none"});return f.jsx("path",{strokeDasharray:u,strokeDashoffset:h,d:c.path,fill:"none"},d)})})]});if(s==="draw")return f.jsxs(xr,{id:n.id,children:[f.jsx(Xt,{d:l,fill:"none",color:a}),f.jsx("path",{d:U2(n,o,i),strokeWidth:1,stroke:"currentColor",fill:"currentColor"})]})}}indicator(n){const r=this.app.getStrokeWidth(n.props.size),o=cs(n),{dash:i}=n.props;let s;if(n.props.spline==="line"){const a=o.points;if(i==="solid"||i==="dotted"||i==="dashed")s="M"+a[0]+"L"+a.slice(1);else{const[l]=d1(n.id,a,r);s=l}}else s=LF(n,o,r);return f.jsx("path",{d:s})}toSvg(n,r,o){const{color:i,size:s}=n.props,a=o.fill[i],l=cs(n);return NF(n,l,a,this.app.getStrokeWidth(s))}}y(F2,"type","line");const K2=qn({type:"line",getShapeUtil:()=>F2,validator:bI,migrations:SI});function cs(t){return BF.get(t.props,()=>{const{spline:e,handles:n}=t.props,r=Object.values(n).sort(jn).map(I.From);switch(e){case"cubic":return new _v(r,r.length===2?2:1.2,20);case"line":return new Iv(r)}})}const ho=200;class H2 extends Po{constructor(){super(...arguments);y(this,"canEdit",()=>!0);y(this,"hideResizeHandles",()=>!0);y(this,"hideSelectionBoundsBg",()=>!0);y(this,"hideSelectionBoundsFg",()=>!0);y(this,"onBeforeCreate",n=>iS(this.app,n,n.props.growY));y(this,"onBeforeUpdate",(n,r)=>{if(!(n.props.text===r.props.text&&n.props.font===r.props.font&&n.props.size===r.props.size))return iS(this.app,r,n.props.growY)});y(this,"onEditEnd",n=>{const{id:r,type:o,props:{text:i}}=n;i.trimEnd()!==n.props.text&&this.app.updateShapes([{id:r,type:o,props:{text:i.trimEnd()}}])})}defaultProps(){return{opacity:"1",color:"black",size:"m",text:"",font:"draw",align:"middle",growY:0,url:""}}getHeight(n){return ho+n.props.growY}getBounds(n){const r=this.getHeight(n);return new de(0,0,ho,r)}getOutline(n){return this.bounds(n).corners}getCenter(n){return new I(ho/2,this.getHeight(n)/2)}render(n){const{id:r,type:o,props:{color:i,font:s,size:a,align:l,text:c}}=n,d=i==="black"?"yellow":i;return f.jsxs(f.Fragment,{children:[f.jsx("div",{style:{position:"absolute",width:ho,height:this.getHeight(n)},children:f.jsxs("div",{className:"tl-note__container tl-hitarea-fill",style:{color:`var(--palette-${d})`,backgroundColor:`var(--palette-${d})`},children:[f.jsx("div",{className:"tl-note__scrim"}),f.jsx(E2,{id:r,type:o,font:s,size:a,align:l,text:c,labelColor:"inherit",wrap:!0})]})}),"url"in n.props&&n.props.url&&f.jsx(mu,{url:n.props.url,zoomLevel:this.app.zoomLevel})]})}indicator(n){return f.jsx("rect",{rx:"7",width:U(ho),height:U(this.getHeight(n))})}toSvg(n,r,o){const i=this.bounds(n),s=document.createElementNS("http://www.w3.org/2000/svg","g"),a=n.props.color==="black"?"yellow":n.props.color,l=document.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("rx","10"),l.setAttribute("width",ho.toString()),l.setAttribute("height",i.height.toString()),l.setAttribute("fill",o.fill[a]),l.setAttribute("stroke",o.fill[a]),l.setAttribute("stroke-width","1"),s.appendChild(l);const c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("rx","10"),c.setAttribute("width",ho.toString()),c.setAttribute("height",i.height.toString()),c.setAttribute("fill",o.background),c.setAttribute("opacity",".28"),s.appendChild(c);const d=17,u={fontSize:Pi[n.props.size],fontFamily:r,textAlign:n.props.align,width:i.width-d*2,height:i.height-d*2,padding:0,lineHeight:Ct.lineHeight,fontStyle:"normal",fontWeight:"normal"},h=this.app.textMeasure.getTextLines({text:n.props.text,wrap:!0,...u}),p=h.reduce((m,v)=>Math.max(m,this.app.textMeasure.measureText({...Ct,text:v.trim(),fontFamily:u.fontFamily,fontSize:u.fontSize,width:"fit-content",padding:"0px"}).w),0);n.props.align==="start"?u.padding=(i.width-p)/2:n.props.align==="end"?u.padding=-(i.width-p)/2:u.padding=d,u.width=i.width;const g=Dp(this.app,{lines:h,...u});return g.setAttribute("fill",o.text),g.setAttribute("transform",`translate(0 ${d})`),s.appendChild(g),s}}y(H2,"type","note");const vy=qn({getShapeUtil:()=>H2,type:"note",validator:EI,migrations:PI});function iS(t,e,n=0){const i=t.textMeasure.measureText({...Ct,text:e.props.text,fontFamily:Ko[e.props.font],fontSize:Pi[e.props.size],width:ho-34+"px"}).h+17*2;let s=null;if(i>ho?s=i-ho:n&&(s=0),s!==null)return{...e,props:{...e.props,growY:s}}}function UF(t,{initialBounds:e,scaleX:n,scaleY:r,newPoint:o}){const i=Math.max(.01,Math.min(Math.abs(n),Math.abs(r))),s=new I(0,0);n<0&&(s.x=-(e.width*i)),r<0&&(s.y=-(e.height*i));const{x:a,y:l}=I.Add(o,s.rot(t.rotation));return{x:a,y:l,props:{scale:i*t.props.scale}}}const FF=new cl;class V2 extends Po{constructor(){super(...arguments);y(this,"canEdit",()=>!0);y(this,"isAspectRatioLocked",()=>!0);y(this,"onResize",(n,r)=>{const{initialBounds:o,initialShape:i,scaleX:s,handle:a}=r;if(r.mode==="scale_shape"||a!=="right"&&a!=="left")return UF(n,r);{const l=o.width;let c=l*s;const d=new I(0,0);c=Math.max(1,Math.abs(c)),a==="left"?(d.x=l-c,s<0&&(d.x+=c)):s<0&&(d.x-=c);const{x:u,y:h}=d.rot(n.rotation).add(i);return{x:u,y:h,props:{w:c/i.props.scale,autoSize:!1}}}});y(this,"onBeforeCreate",n=>{if(!n.props.autoSize||n.props.text.trim())return;const r=this.getMinDimensions(n);return{...n,x:n.x-r.width/2,y:n.y-r.height/2}});y(this,"onEditEnd",n=>{const{id:r,type:o,props:{text:i}}=n,s=n.props.text.trimEnd();s.length===0?this.app.deleteShapes([n.id]):s!==n.props.text&&this.app.updateShapes([{id:r,type:o,props:{text:i.trimEnd()}}])});y(this,"onBeforeUpdate",(n,r)=>{if(!r.props.autoSize)return;const o=n.props.size!==r.props.size||n.props.align!==r.props.align||n.props.font!==r.props.font||n.props.scale!==1&&r.props.scale===1,i=n.props.text!==r.props.text;if(!o&&!i)return;const s=this.getMinDimensions(n),a=sS(this.app,r.props),l=s.width*n.props.scale,c=s.height*n.props.scale,d=a.width*r.props.scale,u=a.height*r.props.scale;let h;switch(r.props.align){case"middle":{h=new I((d-l)/2,i?0:(u-c)/2);break}case"end":{h=new I(d-l,i?0:(u-c)/2);break}default:{if(i)break;h=new I(0,(u-c)/2);break}}if(h){h.rot(r.rotation);const{x:p,y:g}=r;return{...r,x:p-h.x,y:g-h.y,props:{...r.props,w:d}}}else return{...r,props:{...r.props,w:d}}});y(this,"onDoubleClickEdge",n=>{if(!n.props.autoSize)return{id:n.id,type:n.type,props:{autoSize:!0}};if(n.props.scale!==1)return{id:n.id,type:n.type,props:{scale:1}}})}defaultProps(){return{opacity:"1",color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(n){return FF.get(n.props,r=>sS(this.app,r))}getBounds(n){const{scale:r}=n.props,{width:o,height:i}=this.getMinDimensions(n);return new de(0,0,o*r,i*r)}getOutline(n){const r=this.bounds(n);return[new I(0,0),new I(r.width,0),new I(r.width,r.height),new I(0,r.height)]}getCenter(n){const r=this.bounds(n);return new I(r.width/2,r.height/2)}render(n){const{id:r,type:o,props:{text:i}}=n,{width:s,height:a}=this.getMinDimensions(n),{rInput:l,isEmpty:c,isEditing:d,isEditableFromHover:u,handleFocus:h,handleChange:p,handleKeyDown:g,handleBlur:m}=Lv(r,o,i);return f.jsx(Ts,{id:n.id,children:f.jsxs("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":n.props.font,"data-align":n.props.align,"data-hastext":!c,"data-isediting":d||u,"data-textwrap":!0,style:{fontSize:ys[n.props.size],lineHeight:ys[n.props.size]*Ct.lineHeight+"px",transform:`scale(${n.props.scale})`,transformOrigin:"top left",width:Math.max(1,s),height:Math.max(ys[n.props.size]*Ct.lineHeight,a)},children:[f.jsx("div",{className:"tl-text tl-text-content",dir:"ltr",children:i}),d||u?f.jsx("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:d,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:i,onFocus:h,onChange:p,onKeyDown:g,onBlur:m,onTouchEnd:yo,onContextMenu:yo}):null]})})}indicator(n){const r=this.bounds(n);return f.jsx("rect",{width:U(r.width),height:U(r.height)})}toSvg(n,r,o){const i=this.bounds(n),s=n.props.text,a=i.width/(n.props.scale??1),l=i.height/(n.props.scale??1),c={fontSize:ys[n.props.size],fontFamily:r,textAlign:n.props.align,width:a,height:l,padding:0,lineHeight:Ct.lineHeight,fontStyle:"normal",fontWeight:"normal"},d=this.app.textMeasure.getTextLines({text:s,wrap:!0,...c}),u=o.fill[n.props.color],h=document.createElementNS("http://www.w3.org/2000/svg","g"),p=Dp(this.app,{lines:d,...c,stroke:o.background,strokeWidth:2,fill:o.background,padding:0}),g=p.cloneNode(!0);return g.setAttribute("fill",u),g.setAttribute("stroke","none"),h.append(p),h.append(g),h}}y(V2,"type","text");const Vp=qn({type:"text",getShapeUtil:()=>V2,validator:_I,migrations:II});function sS(t,e){const{font:n,text:r,autoSize:o,size:i,w:s}=e,a=16,l=ys[i],c=o?"fit-content":Math.floor(Math.max(a,s))+"px",d=t.textMeasure.measureText({...Ct,text:r,fontFamily:Ko[n],fontSize:l,width:c});return o&&(d.w+=1),{width:Math.max(a,d.w),height:Math.max(l,d.h)}}class W2 extends Yi{constructor(){super(...arguments);y(this,"canEdit",()=>!0);y(this,"isAspectRatioLocked",()=>!0)}defaultProps(){return{opacity:"1",w:100,h:100,assetId:null,time:0,playing:!0,url:""}}render(n){return f.jsx(VF,{shape:n,videoUtil:this})}indicator(n){return f.jsx("rect",{width:U(n.props.w),height:U(n.props.h)})}toSvg(n){const r=document.createElementNS("http://www.w3.org/2000/svg","g"),o=document.createElementNS("http://www.w3.org/2000/svg","image");return o.setAttributeNS("http://www.w3.org/1999/xlink","href",HF(n.id)),o.setAttribute("width",n.props.w.toString()),o.setAttribute("height",n.props.h.toString()),r.appendChild(o),r}}y(W2,"type","video");const KF=qn({type:"video",getShapeUtil:()=>W2,validator:CI,migrations:kI});function HF(t){const e=t.split(":")[1],n=document.querySelector(`.tl-video-shape-${e}`);if(n){const r=document.createElement("canvas");return r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0),r.toDataURL("image/png")}else throw new Error("Video with id "+e+" not found")}const VF=Me(function(e){const{Spinner:n}=wn(),{shape:r,videoUtil:o}=e,i=o.app.getBounds(r).w*o.app.zoomLevel>=110,s=r.props.assetId?o.app.getAssetById(r.props.assetId):null,{w:a,h:l,time:c,playing:d}=r.props,u=Wv(r.id),h=FI(),p=w.useRef(null),g=w.useCallback(P=>{const C=P.currentTarget;o.app.updateShapes([{type:"video",id:r.id,props:{playing:!0,time:C.currentTime}}])},[r.id,o.app]),m=w.useCallback(P=>{const C=P.currentTarget;o.app.updateShapes([{type:"video",id:r.id,props:{playing:!1,time:C.currentTime}}])},[r.id,o.app]),v=w.useCallback(P=>{const C=P.currentTarget;u&&o.app.updateShapes([{type:"video",id:r.id,props:{time:C.currentTime}}])},[u,r.id,o.app]),[x,b]=w.useState(!1),E=w.useCallback(P=>{const C=P.currentTarget;c!==C.currentTime&&(C.currentTime=c),d||C.pause(),b(!0)},[d,c]);return w.useEffect(()=>{const P=p.current;P&&x&&!u&&c!==P.currentTime&&(P.currentTime=c)},[u,x,c]),w.useEffect(()=>{if(h){const P=p.current;P.pause(),P.currentTime=0}},[p,h]),f.jsxs(f.Fragment,{children:[f.jsx(Ts,{id:r.id,children:f.jsx("div",{className:"tl-counter-scaled",children:s!=null&&s.props.src?f.jsx("video",{ref:p,className:`tl-video tl-video-shape-${r.id.split(":")[1]} tl-hitarea-stroke`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:u&&i,onPlay:g,onPause:m,onTimeUpdate:v,onLoadedData:E,hidden:!x,children:f.jsx("source",{src:s.props.src})}):n?f.jsx("g",{transform:`translate(${(a-38)/2}, ${(l-38)/2})`,children:f.jsx(n,{})}):null})}),"url"in r.props&&r.props.url&&f.jsx(mu,{url:r.props.url,zoomLevel:o.app.zoomLevel})]})}),Tx=class{constructor(e){y(this,"storeSchema");y(this,"shapes");y(this,"TLShape");y(this,"tools");const{shapes:n=[],tools:r=[],allowUnknownShapes:o=!1,derivePresenceState:i}=e;this.tools=r,this.shapes=[Mt,jp,XI,Tc,Kd,T2,A2,kF,K2,vy,Vp,KF,...n],this.storeSchema=$8({allowUnknownShapes:o,customShapeDefs:n,derivePresenceState:i}),this.TLShape=this.storeSchema.types.shape}createStore(e){let n=e.initialData;return n&&(n=T8(n)),new W_({schema:this.storeSchema,initialData:n,props:{userId:(e==null?void 0:e.userId)??$s.createId(),instanceId:(e==null?void 0:e.instanceId)??Fo.createId(),documentId:kh}})}};let _i=Tx;y(_i,"default",new Tx({}));function _t(){return Tp()}function WF(t,e){var o;let n=t;const r=new Set(e);for(;r.has(n);)n=(o=/^.*(\d+)$/.exec(n))!=null&&o[1]?n.replace(/(\d+)(?=\D?)$/,i=>(+i+1).toString()):`${n} 1`;return n}function aS(t,e){let n=null;for(const[r,o]of Object.entries(e))G_.has(r)&&(n||(n={...t}),n[r]=o);return n??t}function Y2({app:t}){const{selectionRotation:e,selectionPageCenter:n,inputs:{originPagePoint:r},selectedShapes:o}=t;return{selectionPageCenter:n,initialCursorAngle:n.angle(r),initialSelectionRotation:e,shapeSnapshots:o.map(i=>({shape:Uo(i),initialPagePoint:t.getPagePointById(i.id)}))}}function Hd({delta:t,app:e,snapshot:n,stage:r}){const{selectionPageCenter:o,shapeSnapshots:i}=n;e.updateShapes(i.map(({shape:a,initialPagePoint:l})=>{const c=vr(a.parentId)?e.getPageTransformById(a.parentId):ee.Identity(),d=I.RotWith(l,o,t),u=ee.applyToPoint(ee.Inverse(c),d),h=Pv(a.rotation+t);return{id:a.id,type:a.type,x:u.x,y:u.y,rotation:h}}));const s=[];i.forEach(({shape:a})=>{var u,h,p;const l=e.getShapeById(a.id);if(!l)return;const c=e.getShapeUtil(a);if(r==="start"||r==="one-off"){const g=(u=c.onRotateStart)==null?void 0:u.call(c,a);g&&s.push(g)}const d=(h=c.onRotate)==null?void 0:h.call(c,a,l);if(d&&s.push(d),r==="end"||r==="one-off"){const g=(p=c.onRotateEnd)==null?void 0:p.call(c,a,l);g&&s.push(g)}}),s.length>0&&e.updateShapes(s)}const YF=t=>{const e=t.query.filterHistory("shape"),n=t.query.records("shape",()=>({type:{eq:"arrow"}}));function r(){const o=n.value,i={};for(const s of o){const{start:a,end:l}=s.props;if(a.type==="binding"){const c=i[a.boundShapeId];c?c.push({arrowId:s.id,handleId:"start"}):i[a.boundShapeId]=[{arrowId:s.id,handleId:"start"}]}if(l.type==="binding"){const c=i[l.boundShapeId];c?c.push({arrowId:s.id,handleId:"end"}):i[l.boundShapeId]=[{arrowId:s.id,handleId:"end"}]}}return i}return ue("arrowBindingsIndex",(o,i)=>{if(Ma(o))return r();const s=o,a=e.getDiffSince(i);if(a===or)return r();let l;function c(h){l||(l={...s}),l[h]?l[h]===s[h]&&(l[h]=[...l[h]]):l[h]=[]}function d(h,p,g){c(h),l[h]=l[h].filter(m=>m.arrowId!==p||m.handleId!==g),l[h].length===0&&delete l[h]}function u(h,p,g){c(h),l[h].push({arrowId:p,handleId:g})}for(const h of a){for(const p of Object.values(h.added))if(Mt.is(p)){const{start:g,end:m}=p.props;g.type==="binding"&&u(g.boundShapeId,p.id,"start"),m.type==="binding"&&u(m.boundShapeId,p.id,"end")}for(const[p,g]of Object.values(h.updated))if(!(!Mt.is(p)||!Mt.is(g)))for(const m of["start","end"]){const v=p.props[m],x=g.props[m];v.type==="binding"&&x.type==="point"?d(v.boundShapeId,p.id,m):v.type==="point"&&x.type==="binding"?u(x.boundShapeId,g.id,m):v.type==="binding"&&x.type==="binding"&&v.boundShapeId!==x.boundShapeId&&(d(v.boundShapeId,p.id,m),u(x.boundShapeId,g.id,m))}for(const p of Object.values(h.removed))if(Mt.is(p)){const{start:g,end:m}=p.props;g.type==="binding"&&d(g.boundShapeId,p.id,"start"),m.type==="binding"&&d(m.boundShapeId,p.id,"end")}}return l??s})},XF=t=>{const e=t.query.ids("shape");function n(){const r={};return e.value.forEach(o=>{const i=t.get(o);r[i.parentId]||(r[i.parentId]=[]),r[i.parentId].push([o,i.index])}),Object.values(r).forEach(o=>o.sort((i,s)=>i[1]<s[1]?-1:1)),r}return ue("parentsToChildrenWithIndexes",(r,o)=>{if(Ma(r))return n();const i=t.history.getDiffSince(o);if(i===or)return n();if(i.length===0)return r;let s=null;const a=d=>{s||(s={...r}),s[d]?s[d]===r[d]&&(s[d]=[...s[d]]):s[d]=[]},l=new Set;let c;for(let d=0,u=i.length;d<u;d++){c=i[d];for(const h of Object.values(c.added))gs(h)&&(a(h.parentId),s[h.parentId].push([h.id,h.index]),l.add(s[h.parentId]));for(const[h,p]of Object.values(c.updated))if(gs(p)&&gs(h)){if(h.parentId!==p.parentId)a(h.parentId),a(p.parentId),s[h.parentId].splice(s[h.parentId].findIndex(g=>g[0]===p.id),1),s[p.parentId].push([p.id,p.index]),l.add(s[p.parentId]);else if(h.index!==p.index){a(p.parentId);const g=s[p.parentId].findIndex(m=>m[0]===p.id);s[p.parentId][g]=[p.id,p.index],l.add(s[p.parentId])}}for(const h of Object.values(c.removed))gs(h)&&(a(h.parentId),s[h.parentId].splice(s[h.parentId].findIndex(p=>p[0]===h.id),1))}for(const d of l)d.sort((u,h)=>u[1]<h[1]?-1:1);return s??r})},kg=(t,e,n)=>{for(;!it.isId(n.parentId);){const r=t.get(n.parentId);if(!r)return!1;n=r}return n.parentId===e},GF=(t,e)=>{const n=t.query.ids("shape");let r=null;function o(){const i=e();return r=i,new Set([...n.value].filter(s=>kg(t,i,t.get(s))))}return ue("_shapeIdsInCurrentPage",(i,s)=>{if(Ma(i))return o();const a=e();if(a!==r)return o();const l=t.history.getDiffSince(s);if(l===or)return o();const c=new zd(i);for(const u of l){for(const h of Object.values(u.added))gs(h)&&kg(t,a,h)&&c.add(h.id);for(const[h,p]of Object.values(u.updated))gs(p)&&(kg(t,a,p)?c.add(p.id):c.remove(p.id));for(const h of Object.keys(u.removed))vr(h)&&c.remove(h)}const d=c.get();return d?Yl(d.value,d.diff):i})},X2={top:10,left:10,bottom:10,right:10};function G2(t){const e=t.getContainer(),n=e.querySelector('*[data-tldraw-area="active-drawing"]'),r={...X2,width:0,height:0};if(n&&e){const o=e.getBoundingClientRect(),i=n.getBoundingClientRect();r.top=i.top,r.left=i.left,r.bottom=o.height-i.bottom,r.right=o.width-i.right}return r.width=t.viewportScreenBounds.width-r.left-r.right,r.height=t.viewportScreenBounds.height-r.top-r.bottom,r}function qF(t){const e=G2(t),n=t.zoomLevel;return e.left/=n,e.right/=n,e.top/=n,e.bottom/=n,e.width/=n,e.height/=n,e}class QF{constructor(e){y(this,"offsets",lt("activeAreaOffsets",X2));y(this,"updateOffsets",()=>{const e=qF(this.app);this.offsets.set(e)});y(this,"dispose",()=>{window.addEventListener("resize",this.updateOffsets)});this.app=e,window.addEventListener("resize",this.updateOffsets),this.app.disposables.add(this.dispose)}}const ZF=12;class JF{constructor(e){y(this,"state",lt("camera state","idle"));y(this,"timeoutRemaining",0);y(this,"decay",e=>{this.timeoutRemaining-=e,this.timeoutRemaining<=0&&(this.state.set("idle"),this.app.off("tick",this.decay),this.app.updateCullingBounds())});y(this,"tick",()=>{this.timeoutRemaining=ZF,this.state.__unsafe__getWithoutCapture()==="idle"&&(this.state.set("moving"),this.app.on("tick",this.decay))});this.app=e}}const e9=40;class t9{constructor(e){y(this,"_clickId","");y(this,"_clickTimeout");y(this,"_clickScreenPoint");y(this,"_previousScreenPoint");y(this,"_getClickTimeout",(e,n=_t())=>{this._clickId=n,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout(()=>{if(this._clickState===e&&this._clickId===n){switch(this._clickState){case"pendingTriple":{this.app.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break}case"pendingQuadruple":{this.app.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break}case"pendingOverflow":{this.app.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"});break}}this._clickState="idle"}},e==="idle"||e==="pendingDouble"?uN:dN)});y(this,"_clickState","idle");y(this,"lastPointerInfo",{});y(this,"transformPointerDownEvent",e=>{if(!this._clickState)return e;switch(this._clickScreenPoint=I.From(e.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>e9&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=e,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),e;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),e;default:return this._clickTimeout=this._getClickTimeout(this._clickState),e}});y(this,"transformPointerUpEvent",e=>{if(!this._clickState)return e;switch(this._clickScreenPoint=I.From(e.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return e}});y(this,"cancelDoubleClickTimeout",()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"});y(this,"handleMove",()=>{this._clickState!=="idle"&&this._clickScreenPoint&&this._clickScreenPoint.dist(this.app.inputs.currentScreenPoint)>(this.app.isCoarsePointer?hy:Ic)&&this.cancelDoubleClickTimeout()});this.app=e}get clickState(){return this._clickState}}class n9{constructor(e){y(this,"_currentMM");y(this,"dpr",lt("devicePixelRatio",typeof window>"u"?1:window.devicePixelRatio));y(this,"updateDevicePixelRatio",()=>{this.dpr.set(window.devicePixelRatio),this.rebind()});y(this,"dispose",()=>{var e;(e=this._currentMM)==null||e.removeEventListener("change",this.updateDevicePixelRatio)});this.app=e,this.rebind(),this.app.disposables.add(this.dispose)}rebind(){var e;this.dispose(),this._currentMM=this.getMedia(),(e=this._currentMM)==null||e.addEventListener("change",this.updateDevicePixelRatio)}getMedia(){if(window.matchMedia)return matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`)}}function ss(t){if(t){let e=lS;for(;t.length;)e=e.push(t.pop());return e}return lS}class r9{constructor(){y(this,"length",0);y(this,"head",null);y(this,"tail",this)}push(e){return new Gv(e,this)}toArray(){return Cr}[Symbol.iterator](){return{next(){return{value:void 0,done:!0}}}}}const lS=new r9;class Gv{constructor(e,n){y(this,"length");this.head=e,this.tail=n,this.length=n.length+1}push(e){return new Gv(e,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let e=this;return{next(){if(e.length){const n=e.head;return e=e.tail,{value:n,done:!1}}else return{value:void 0,done:!0}}}}}class o9{constructor(e,n,r){y(this,"_undos",lt("HistoryManager.undos",ss()));y(this,"_redos",lt("HistoryManager.redos",ss()));y(this,"_batchDepth",0);y(this,"_commands",{});y(this,"createCommand",(e,n,r)=>{if(this._commands[e])throw new Error(`Duplicate command: ${e}`);this._commands[e]=r;const o=(...i)=>{if(!this._batchDepth)return this.batch(()=>o(...i)),this.ctx;const s=n(...i);if(!s)return this.ctx;const{data:a,ephemeral:l,squashing:c,preservesRedoStack:d}=s;if(this.ignoringUpdates((u,h)=>(r.do(a),{undos:u,redos:h})),!l){const u=this._undos.value.head;c&&u&&u.type==="command"&&u.name===e&&u.preservesRedoStack===d?this._undos.update(h=>h.tail.push({...u,id:_t(),data:r.squash(u.data,a)})):this._undos.update(h=>h.push({type:"command",name:e,data:a,id:_t(),preservesRedoStack:d})),s.preservesRedoStack||this._redos.set(ss()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return o});y(this,"batch",e=>{try{this._batchDepth++,this._batchDepth===1?Hr(()=>{var r,o;const n=(r=this._undos.value.head)==null?void 0:r.id;e(),n!==((o=this._undos.value.head)==null?void 0:o.id)&&this.onBatchComplete()}):e()}catch(n){throw this.annotateError(n),n}finally{this._batchDepth--}return this});y(this,"ignoringUpdates",e=>{let n=this._undos.value,r=this._redos.value;this._undos.set(ss()),this._redos.set(ss());try{({undos:n,redos:r}=Hr(()=>e(n,r)))}finally{this._undos.set(n),this._redos.set(r)}});y(this,"_undo",({pushToRedoStack:e,toMark:n=void 0})=>(this.ignoringUpdates((r,o)=>{var i;if(r.length===0)return{undos:r,redos:o};for(;((i=r.head)==null?void 0:i.type)==="STOP";){const s=r.head;if(r=r.tail,e&&(o=o.push(s)),s.id===n)return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:o}}if(r.length===0)return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:o};for(;r.head;){const s=r.head;if(r=r.tail,e&&(o=o.push(s)),s.type==="STOP"){if(s.onUndo&&(!n||s.id===n))return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:o}}else this._commands[s.name].undo(s.data)}return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:o}}),this));y(this,"undo",()=>(this._undo({pushToRedoStack:!0}),this));y(this,"redo",()=>(this.ignoringUpdates((e,n)=>{var r;if(n.length===0)return{undos:e,redos:n};for(;((r=n.head)==null?void 0:r.type)==="STOP";)e=e.push(n.head),n=n.tail;if(n.length===0)return this.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:n};for(;n.head;){const o=n.head;if(e=e.push(n.head),n=n.tail,o.type==="STOP"){if(o.onRedo)break}else{const i=this._commands[o.name];i.redo?i.redo(o.data):i.do(o.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:n}}),this));y(this,"bail",()=>(this._undo({pushToRedoStack:!1}),this));y(this,"bailToMark",e=>(this._undo({pushToRedoStack:!1,toMark:e}),this));y(this,"mark",(e=_t(),n=!0,r=!0)=>{const o=this._undos.value.head;return o&&o.type==="STOP"&&o.id===e&&o.onUndo===n&&o.onRedo===r?o.id:(this._undos.update(i=>i.push({type:"STOP",id:e,onUndo:n,onRedo:r})),this.ctx.emit("mark-history",{id:e}),e)});this.ctx=e,this.onBatchComplete=n,this.annotateError=r}get numUndos(){return this._undos.value.length}get numRedos(){return this._redos.value.length}clear(){this._undos.set(ss()),this._redos.set(ss())}}var i9=Object.defineProperty,s9=Object.getOwnPropertyDescriptor,Wp=(t,e,n,r)=>{for(var o=r>1?void 0:r?s9(e,n):e,i=t.length-1,s;i>=0;i--)(s=t[i])&&(o=(r?s(e,n,o):s(o))||o);return r&&o&&i9(e,n,o),o};const be=t=>Math.round(t*10**8)/10**8;function Ao(t,e,n,r,o){const i=t.filter(a=>(r==="forward"?a.startNode.id===e:a.endNode.id===e)&&be(a.length)===be(n)&&Ur(a.breadthIntersection[0],a.breadthIntersection[1],o[0],o[1]));if(i.length===0)return[];const s=new Set;for(const a of i){const l=r==="forward"?a.endNode.id:a.startNode.id;s.has(l)||(s.add(l),i.push(...Ao(t,l,n,r,Ur(a.breadthIntersection[0],a.breadthIntersection[1],o[0],o[1]))))}return i}function a9(t){t.sort((e,n)=>n.gaps.length-e.gaps.length);for(let e=t.length-1;e>0;e--){const n=t[e];for(let r=e-1;r>=0;r--){const o=t[r];if(o.direction===n.direction&&n.gaps.every(i=>o.gaps.some(s=>be(i.startEdge[0].x)===be(s.startEdge[0].x)&&be(i.startEdge[0].y)===be(s.startEdge[0].y)&&be(i.startEdge[1].x)===be(s.startEdge[1].x)&&be(i.startEdge[1].y)===be(s.startEdge[1].y))&&o.gaps.some(s=>be(i.endEdge[0].x)===be(s.endEdge[0].x)&&be(i.endEdge[0].y)===be(s.endEdge[0].y)&&be(i.endEdge[1].x)===be(s.endEdge[1].x)&&be(i.endEdge[1].y)===be(s.endEdge[1].y)))){t.splice(e,1);break}}}}class wu{constructor(e){y(this,"_snapLines",lt("snapLines",void 0));this.app=e}get lines(){return this._snapLines.value??Cr}clear(){this.lines.length&&this._snapLines.set(void 0)}setLines(e){this._snapLines.set(e)}get snapPointsCache(){return this.app.store.createComputedCache("snapPoints",e=>{const n=this.app.getPageTransformById(e.id);return n?this.app.getShapeUtil(e).snapPoints(e).map((i,s)=>{const{x:a,y:l}=ee.applyToPoint(n,i);return{x:a,y:l,id:`${e.id}:${s}`}}):void 0})}get snapThreshold(){return 8/this.app.zoomLevel}get visibleShapesNotInSelection(){const e=this.app.selectedIds,n=new Set,r=i=>{const s=this.app.getSortedChildIds(i);for(const a of s){const l=this.app.getShapeById(a);if(l&&l.type!=="arrow"&&!e.includes(a)&&this.app.isShapeInViewport(l.id)){if(l.type==="group"){r(a);continue}n.add({id:l.id,pageBounds:this.app.getPageBoundsById(l.id)}),l.type!=="frame"&&r(a)}}},o=this.app.findCommonAncestor(Ee(e.map(i=>this.app.getShapeById(i))),i=>i.type==="frame");return r(o??this.app.currentPageId),n}get visibleSnapPointsNotInSelection(){const e=[];for(const n of this.visibleShapesNotInSelection){const r=this.snapPointsCache.get(n.id);r&&e.push(...r)}return e}get visibleGaps(){const e=[],n=[],r=[...this.visibleShapesNotInSelection].sort((i,s)=>i.pageBounds.minX-s.pageBounds.minX);for(let i=0;i<r.length;i++){const s=r[i];for(let a=i+1;a<r.length;a++){const l=r[a];s.pageBounds.maxX<l.pageBounds.minX&&Cl(s.pageBounds.minY,s.pageBounds.maxY,l.pageBounds.minY,l.pageBounds.maxY)&&e.push({startNode:s,endNode:l,startEdge:[new I(s.pageBounds.maxX,s.pageBounds.minY),new I(s.pageBounds.maxX,s.pageBounds.maxY)],endEdge:[new I(l.pageBounds.minX,l.pageBounds.minY),new I(l.pageBounds.minX,l.pageBounds.maxY)],length:l.pageBounds.minX-s.pageBounds.maxX,breadthIntersection:Ur(s.pageBounds.minY,s.pageBounds.maxY,l.pageBounds.minY,l.pageBounds.maxY)})}}const o=r.slice(0).sort((i,s)=>i.pageBounds.minY-s.pageBounds.minY);for(let i=0;i<o.length;i++){const s=o[i];for(let a=i+1;a<o.length;a++){const l=o[a];s.pageBounds.maxY<l.pageBounds.minY&&Cl(s.pageBounds.minX,s.pageBounds.maxX,l.pageBounds.minX,l.pageBounds.maxX)&&n.push({startNode:s,endNode:l,startEdge:[new I(s.pageBounds.minX,s.pageBounds.maxY),new I(s.pageBounds.maxX,s.pageBounds.maxY)],endEdge:[new I(l.pageBounds.minX,l.pageBounds.minY),new I(l.pageBounds.maxX,l.pageBounds.minY)],length:l.pageBounds.minY-s.pageBounds.maxY,breadthIntersection:Ur(s.pageBounds.minX,s.pageBounds.maxX,l.pageBounds.minX,l.pageBounds.maxX)})}}return{horizontal:e,vertical:n}}snapTranslate({lockedAxis:e,initialSelectionPageBounds:n,initialSelectionSnapPoints:r,dragDelta:o}){var v,x;const i=e==="x",s=e==="y",a=n.clone().translate(o),l=r.map(({x:b,y:E},P)=>({id:"selection:"+P,x:b+o.x,y:E+o.y})),c=this.visibleSnapPointsNotInSelection,d=[],u=[],h=new I(this.snapThreshold,this.snapThreshold);this.findPointSnaps({minOffset:h,nearestSnapsX:d,nearestSnapsY:u,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.findGapSnaps({selectionPageBounds:a,nearestSnapsX:d,nearestSnapsY:u,minOffset:h});const p=new I(i?0:((v=d[0])==null?void 0:v.nudge)??0,s?0:((x=u[0])==null?void 0:x.nudge)??0);h.x=0,h.y=0,d.length=0,u.length=0,l.forEach(b=>{b.x+=p.x,b.y+=p.y}),a.translate(p),this.findPointSnaps({minOffset:h,nearestSnapsX:d,nearestSnapsY:u,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.findGapSnaps({selectionPageBounds:a,nearestSnapsX:d,nearestSnapsY:u,minOffset:h});const g=this.getPointSnapLines({nearestSnapsX:d,nearestSnapsY:u}),m=this.getGapSnapLines({selectionPageBounds:a,nearestSnapsX:d,nearestSnapsY:u});return this._snapLines.set([...m,...g]),{nudge:p}}snapLineHandleTranslate({lineId:e,handleId:n,handlePoint:r}){const o=this.app.getShapeById(e);if(!o)return{nudge:new I(0,0)};const s=this.app.getShapeUtilByDef(K2).handles(o).sort(jn);if(s.length<3)return{nudge:new I(0,0)};const a=s.findIndex(m=>m.id===n),c=s[a].type==="vertex"?a/2:(a+1)/2,d=cs(o),u=1,h=this.app.getPageTransform(o),p=d.segments.slice(0,Math.max(0,c-u)).map(m=>ee.applyToPoints(h,m.lut)),g=d.segments.slice(c+u).map(m=>ee.applyToPoints(h,m.lut));return this.snapHandleTranslate({handlePoint:r,additionalOutlines:[...p,...g]})}snapHandleTranslate({handlePoint:e,additionalOutlines:n=[]}){var a,l;const r=this.visibleShapesNotInSelection,o=[];for(const c of r){const d=this.app.getShapeById(c.id);if(d.type==="text"||d.type==="icon")continue;const u=Fn(this.app.getOutlineById(c.id));((l=(a=this.app.getShapeUtil(d)).isClosed)==null?void 0:l.call(a,d))&&u.push(u[0]),o.push(ee.applyToPoints(this.app.getPageTransformById(d.id),u))}let i=this.snapThreshold,s=null;for(const c of[...o,...n])for(let d=0;d<c.length-1;d++){const u=c[d],h=c[d+1],p=I.DistanceToLineSegment(u,h,e);isNaN(p)||p<i&&(i=p,s=I.NearestPointOnLineSegment(u,h,e))}if(s){const c=[];return c.push({id:_t(),type:"points",points:[s]}),this._snapLines.set(c),{nudge:I.Sub(s,e)}}return{nudge:new I(0,0)}}snapResize({initialSelectionPageBounds:e,dragDelta:n,handle:r,isAspectRatioLocked:o,isResizingFromCenter:i}){var k,$;const{box:s,scaleX:a,scaleY:l}=de.Resize(e,r,i?n.x*2:n.x,i?n.y*2:n.y,o);let c=r;a<0&&(c=U8(c)),l<0&&(c=z8(c)),i&&(s.center=e.center);const d=c==="top"||c==="bottom",u=c==="left"||c==="right",h=cS(c,s),p=this.visibleSnapPointsNotInSelection,g=[],m=[],v=new I(this.snapThreshold,this.snapThreshold);this.findPointSnaps({minOffset:v,nearestSnapsX:g,nearestSnapsY:m,otherNodeSnapPoints:p,selectionSnapPoints:h});const x=new I(d?0:((k=g[0])==null?void 0:k.nudge)??0,u?0:(($=m[0])==null?void 0:$.nudge)??0);if(o&&F8(c)&&x.len()!==0){const A=g.length&&m.length?Math.abs(x.x)<Math.abs(x.y)?"x":"y":g.length?"x":"y",D=e.aspectRatio;A==="x"?(m.length=0,x.y=x.x/D,(c==="bottom_left"||c==="top_right")&&(x.y=-x.y)):(g.length=0,x.x=x.y*D,(c==="bottom_left"||c==="top_right")&&(x.x=-x.x))}const b=I.Add(n,x),{box:E}=de.Resize(e,r,i?b.x*2:b.x,i?b.y*2:b.y,o);i&&(E.center=e.center);const P=cS("any",E);g.length=0,m.length=0,v.x=0,v.y=0,this.findPointSnaps({minOffset:v,nearestSnapsX:g,nearestSnapsY:m,otherNodeSnapPoints:p,selectionSnapPoints:P});const C=this.getPointSnapLines({nearestSnapsX:g,nearestSnapsY:m});return this._snapLines.set([...C]),{nudge:x}}findPointSnaps({selectionSnapPoints:e,otherNodeSnapPoints:n,minOffset:r,nearestSnapsX:o,nearestSnapsY:i}){for(const s of e)for(const a of n){const l=I.Sub(s,a),c=Math.abs(l.x),d=Math.abs(l.y);be(c)<=be(r.x)&&(be(c)<be(r.x)&&(o.length=0),o.push({type:"points",points:{thisPoint:s,otherPoint:a},nudge:a.x-s.x}),r.x=c),be(d)<=be(r.y)&&(be(d)<be(r.y)&&(i.length=0),i.push({type:"points",points:{thisPoint:s,otherPoint:a},nudge:a.y-s.y}),r.y=d)}}findGapSnaps({selectionPageBounds:e,minOffset:n,nearestSnapsX:r,nearestSnapsY:o}){for(const i of this.visibleGaps.horizontal){if(!Cl(i.breadthIntersection[0],i.breadthIntersection[1],e.minY,e.maxY))continue;const a=i.startEdge[0].x+i.length/2-e.center.x;if(i.length>e.width&&be(Math.abs(a))<=be(n.x)){be(Math.abs(a))<be(n.x)&&(r.length=0),n.x=Math.abs(a);const m={type:"gap_center",gap:i,nudge:a},v=r.find(({type:b})=>b==="gap_center"),x=v&&Ur(i.breadthIntersection[0],i.breadthIntersection[1],v.gap.breadthIntersection[0],v.gap.breadthIntersection[1]);v&&v.gap.length>i.length&&x?r[r.indexOf(v)]=m:(!v||!x)&&r.push(m)}const c=i.startNode.pageBounds.minX-i.length,d=e.maxX,u=c-d;be(Math.abs(u))<=be(n.x)&&(be(Math.abs(u))<be(n.x)&&(r.length=0),n.x=Math.abs(u),r.push({type:"gap_duplicate",gap:i,protrusionDirection:"left",nudge:u}));const h=i.endNode.pageBounds.maxX+i.length,p=e.minX,g=h-p;be(Math.abs(g))<=be(n.x)&&(be(Math.abs(g))<be(n.x)&&(r.length=0),n.x=Math.abs(g),r.push({type:"gap_duplicate",gap:i,protrusionDirection:"right",nudge:g}))}for(const i of this.visibleGaps.vertical){if(!Cl(i.breadthIntersection[0],i.breadthIntersection[1],e.minX,e.maxX))continue;const a=i.startEdge[0].y+i.length/2-e.center.y;if(i.length>e.height&&be(Math.abs(a))<=be(n.y)){be(Math.abs(a))<be(n.y)&&(o.length=0),n.y=Math.abs(a);const m={type:"gap_center",gap:i,nudge:a},v=o.find(({type:b})=>b==="gap_center"),x=v&&Cl(v.gap.breadthIntersection[0],v.gap.breadthIntersection[1],i.breadthIntersection[0],i.breadthIntersection[1]);v&&v.gap.length>i.length&&x?o[o.indexOf(v)]=m:(!v||!x)&&o.push(m);continue}const c=i.startNode.pageBounds.minY-i.length,d=e.maxY,u=c-d;be(Math.abs(u))<=be(n.y)&&(be(Math.abs(u))<be(n.y)&&(o.length=0),n.y=Math.abs(u),o.push({type:"gap_duplicate",gap:i,protrusionDirection:"top",nudge:u}));const h=i.endNode.pageBounds.maxY+i.length,p=e.minY,g=h-p;be(Math.abs(g))<=be(n.y)&&(be(Math.abs(g))<be(n.y)&&(o.length=0),n.y=Math.abs(g),o.push({type:"gap_duplicate",gap:i,protrusionDirection:"bottom",nudge:g}))}}getPointSnapLines({nearestSnapsX:e,nearestSnapsY:n}){const r={},o={},i=[];if(e.length>0){for(const s of e)if(s.type==="points"){const a=be(s.points.otherPoint.x);r[a]||(r[a]=[]),r[a].push(s.points)}}if(n.length>0){for(const s of n)if(s.type==="points"){const a=be(s.points.otherPoint.y);o[a]||(o[a]=[]),o[a].push(s.points)}}for(const[s,a]of Object.entries(r).concat(Object.entries(o)))i.push({id:_t(),type:"points",points:bh(a.map(l=>I.From(l.otherPoint)).concat(a.map(l=>I.From(l.thisPoint))),(l,c)=>l.equals(c))});return i}getGapSnapLines({selectionPageBounds:e,nearestSnapsX:n,nearestSnapsY:r}){const o={top:e.sides[0],right:e.sides[1],bottom:[e.corners[3],e.corners[2]],left:[e.corners[0],e.corners[3]]},i=[];if(n.length>0)for(const s of n){if(s.type==="gap_center"){const a=(s.gap.length-e.width)/2,l=Ur(s.gap.breadthIntersection[0],s.gap.breadthIntersection[1],e.minY,e.maxY);i.push({type:"gaps",direction:"horizontal",id:_t(),gaps:[...Ao(this.visibleGaps.horizontal,s.gap.startNode.id,a,"backward",l),{startEdge:s.gap.startEdge,endEdge:o.left},{startEdge:o.right,endEdge:s.gap.endEdge},...Ao(this.visibleGaps.horizontal,s.gap.endNode.id,a,"forward",l)]})}if(s.type==="gap_duplicate"){const a=Ur(s.gap.breadthIntersection[0],s.gap.breadthIntersection[1],e.minY,e.maxY);i.push({type:"gaps",direction:"horizontal",id:_t(),gaps:s.protrusionDirection==="left"?[{startEdge:o.right,endEdge:[I.Add(s.gap.startEdge[0],{x:-s.gap.startNode.pageBounds.width,y:0}),I.Add(s.gap.startEdge[1],{x:-s.gap.startNode.pageBounds.width,y:0})]},{startEdge:s.gap.startEdge,endEdge:s.gap.endEdge},...Ao(this.visibleGaps.horizontal,s.gap.endNode.id,s.gap.length,"forward",a)]:[...Ao(this.visibleGaps.horizontal,s.gap.startNode.id,s.gap.length,"backward",a),{startEdge:s.gap.startEdge,endEdge:s.gap.endEdge},{startEdge:[I.Add(s.gap.endEdge[0],{x:s.gap.endNode.pageBounds.width,y:0}),I.Add(s.gap.endEdge[1],{x:s.gap.endNode.pageBounds.width,y:0})],endEdge:o.left}]})}}if(r.length>0)for(const s of r){if(s.type==="gap_center"){const a=(s.gap.length-e.height)/2,l=Ur(s.gap.breadthIntersection[0],s.gap.breadthIntersection[1],e.minX,e.maxX);i.push({type:"gaps",direction:"vertical",id:_t(),gaps:[...Ao(this.visibleGaps.vertical,s.gap.startNode.id,a,"backward",l),{startEdge:s.gap.startEdge,endEdge:o.top},{startEdge:o.bottom,endEdge:s.gap.endEdge},...Ao(this.visibleGaps.vertical,s.gap.endNode.id,a,"forward",l)]})}if(s.type==="gap_duplicate"){const a=Ur(s.gap.breadthIntersection[0],s.gap.breadthIntersection[1],e.minX,e.maxX);i.push({type:"gaps",direction:"vertical",id:_t(),gaps:s.protrusionDirection==="top"?[{startEdge:o.bottom,endEdge:[I.Add(s.gap.startEdge[0],{x:0,y:-s.gap.startNode.pageBounds.height}),I.Add(s.gap.startEdge[1],{x:0,y:-s.gap.startNode.pageBounds.height})]},{startEdge:s.gap.startEdge,endEdge:s.gap.endEdge},...Ao(this.visibleGaps.vertical,s.gap.endNode.id,s.gap.length,"forward",a)]:[...Ao(this.visibleGaps.vertical,s.gap.startNode.id,s.gap.length,"backward",a),{startEdge:s.gap.startEdge,endEdge:s.gap.endEdge},{startEdge:[I.Add(s.gap.endEdge[0],{x:0,y:s.gap.endNode.pageBounds.height}),I.Add(s.gap.endEdge[1],{x:0,y:s.gap.endNode.pageBounds.height})],endEdge:o.top}]})}}return a9(i),i}}Wp([ue],wu.prototype,"snapPointsCache",1);Wp([ue],wu.prototype,"visibleShapesNotInSelection",1);Wp([ue],wu.prototype,"visibleSnapPointsNotInSelection",1);Wp([ue],wu.prototype,"visibleGaps",1);function cS(t,e){const{minX:n,maxX:r,minY:o,maxY:i}=e,s=[];switch(t){case"top":case"left":case"top_left":case"any":s.push({id:"top_left",handle:"top_left",x:n,y:o})}switch(t){case"top":case"right":case"top_right":case"any":s.push({id:"top_right",handle:"top_right",x:r,y:o})}switch(t){case"bottom":case"right":case"bottom_right":case"any":s.push({id:"bottom_right",handle:"bottom_right",x:r,y:i})}switch(t){case"bottom":case"left":case"bottom_left":case"any":s.push({id:"bottom_left",handle:"bottom_left",x:n,y:i})}return s}const l9={start:"left",middle:"center",end:"right"};class c9{constructor(e){y(this,"measureText",e=>{const n=this.getTextElement();n.setAttribute("dir","ltr"),n.style.setProperty("font-family",e.fontFamily),n.style.setProperty("font-style",e.fontStyle),n.style.setProperty("font-weight",e.fontWeight),n.style.setProperty("font-size",e.fontSize+"px"),n.style.setProperty("line-height",e.lineHeight*e.fontSize+"px"),n.style.setProperty("width",e.width),n.style.setProperty("min-width",e.minWidth??null),n.style.setProperty("max-width",e.maxWidth),n.style.setProperty("padding",e.padding),n.textContent=Ho.normalizeTextForDom(e.text);const r=n.getBoundingClientRect();return{x:0,y:0,w:r.width,h:r.height}});this.app=e}getTextElement(){const e=document.querySelector(".tl-text-measure");e==null||e.remove();const n=document.createElement("div");return this.app.getContainer().appendChild(n),n.id=`__textMeasure_${_t()}`,n.classList.add("tl-text"),n.classList.add("tl-text-measure"),n.tabIndex=-1,n}getTextLines(e){const n=this.getTextElement();n.style.setProperty("width",e.width-e.padding*2+"px"),n.style.setProperty("height","min-content"),n.style.setProperty("dir","ltr"),n.style.setProperty("font-size",e.fontSize+"px"),n.style.setProperty("font-family",e.fontFamily),n.style.setProperty("font-weight",e.fontWeight),n.style.setProperty("line-height",e.lineHeight*e.fontSize+"px"),n.style.setProperty("text-align",l9[e.textAlign]);const r=e.text.replace(/ {2}/g,"	").split(/( |\t|\n)/).filter(Boolean).map(c=>c==="	"?vs:c),o=[];let i=[];n.textContent="";let s=n.offsetHeight,a=n.textContent;for(let c=0,d=r.length;c<d;c++){const u=r[c];if(n.textContent+=u,n.offsetHeight<=s){i.push(u),a=n.textContent;continue}if(u===`
`){i=[],o.push(i),a=n.textContent;continue}const p=n.textContent;n.textContent=a,n.textContent+=`
`;const g=[...u];n.textContent+=g[0],s=n.offsetHeight;let m=[g[0]];const v=[m];for(let b=1;b<g.length;b++){const E=g[b];n.textContent+=E;const P=n.offsetHeight;P>s?(m=[E],v.push(m),s=P):m.push(E)}const x=v.map(b=>[b.join("")]);o.push(...x),i=o[o.length-1],n.textContent=p,s=n.offsetHeight,a=n.textContent}return n.remove(),o.map(c=>c.join("").trimEnd())}}class u9{constructor(e){y(this,"raf");y(this,"isPaused",!0);y(this,"last",0);y(this,"t",0);y(this,"start",()=>{this.isPaused=!1,cancelAnimationFrame(this.raf),this.raf=requestAnimationFrame(this.tick),this.last=Date.now()});y(this,"tick",()=>{if(this.isPaused)return;const e=Date.now(),n=e-this.last;if(this.last=e,this.t+=n,this.t<16){this.raf=requestAnimationFrame(this.tick);return}this.t-=16,this.updatePointerVelocity(n),this.app.emit("tick",n),this.raf=requestAnimationFrame(this.tick)});y(this,"dispose",()=>{this.isPaused=!0,cancelAnimationFrame(this.raf)});y(this,"prevPoint",new I);y(this,"updatePointerVelocity",e=>{const{prevPoint:n,app:{inputs:{currentScreenPoint:r,pointerVelocity:o}}}=this;if(e===0)return;const i=I.Sub(r,n);this.prevPoint=r.clone();const s=i.len(),a=s?i.div(s):new I(0,0),l=o.clone().lrp(a.mul(s/e),.5);Math.abs(l.x)<.01&&(l.x=0),Math.abs(l.y)<.01&&(l.y=0),o.equals(l)||(this.app.inputs.pointerVelocity=l)});this.app=e,this.app.disposables.add(this.dispose),this.start()}}const d9={wheel:"onWheel",pointer_enter:"onPointerEnter",pointer_leave:"onPointerLeave",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"};class ye{constructor(e,n){y(this,"path");y(this,"id");y(this,"current");y(this,"type");y(this,"styles",[]);y(this,"initial");y(this,"children");y(this,"parent");y(this,"isActive",!1);y(this,"onWheel");y(this,"onPointerEnter");y(this,"onPointerLeave");y(this,"onPointerDown");y(this,"onPointerMove");y(this,"onPointerUp");y(this,"onDoubleClick");y(this,"onTripleClick");y(this,"onQuadrupleClick");y(this,"onRightClick");y(this,"onMiddleClick");y(this,"onKeyDown");y(this,"onKeyUp");y(this,"onKeyRepeat");y(this,"onCancel");y(this,"onComplete");y(this,"onInterrupt");y(this,"onEnter");y(this,"onExit");this.app=e;const{id:r,children:o,initial:i}=this.constructor;this.id=r,this.current=lt("toolState"+this.id,void 0),this.path=ue("toolPath"+this.id,()=>{const s=this.current.value;return this.id+(s?`.${s.path.value}`:"")}),this.parent=n??{},this.parent?o&&i?(this.type="branch",this.initial=i,this.children=Object.fromEntries(o().map(s=>[s.id,new s(this.app,this)])),this.current.set(this.children[this.initial])):this.type="leaf":(this.type="root",o&&i&&(this.initial=i,this.children=Object.fromEntries(o().map(s=>[s.id,new s(this.app,this)])),this.current.set(this.children[this.initial])))}transition(e,n){var i;const r=e.split(".");let o=this;for(let s=0;s<r.length;s++){const a=r[s],l=o.current.value,c=(i=o.children)==null?void 0:i[a];if(!c)throw Error(`${o.id} - no child state exists with the id ${a}.`);if((l==null?void 0:l.id)!==c.id&&(l==null||l.exit(n,a),o.current.set(c),c.enter(n,(l==null?void 0:l.id)||"initial"),!c.isActive))break;o=c}return this}handleEvent(e){var o;const n=d9[e.name],r=this.current.value;(o=this[n])==null||o.call(this,e),this.current.value===r&&this.isActive&&(r==null||r.handleEvent(e))}enter(e,n){var r;if(this.isActive=!0,(r=this.onEnter)==null||r.call(this,e,n),this.children&&this.initial&&this.isActive){const o=this.children[this.initial];this.current.set(o),o.enter(e,n)}}exit(e,n){var r,o;this.isActive=!1,(r=this.onExit)==null||r.call(this,e,n),this.isActive||(o=this.current.value)==null||o.exit(e,n)}}y(ye,"id"),y(ye,"initial"),y(ye,"children");var _m;let h9=(_m=class extends ye{constructor(){super(...arguments);y(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});y(this,"onEnter",()=>{this.app.setCursor({type:"cross"})});y(this,"onCancel",()=>{this.app.setSelectedTool("select")})}},y(_m,"id","idle"),_m);var Im;let p9=(Im=class extends ye{constructor(){super(...arguments);y(this,"shapeType","");y(this,"shape");y(this,"preciseTimeout",-1);y(this,"didTimeout",!1);y(this,"onEnter",()=>{var a,l,c;const{inputs:{currentPagePoint:n}}=this.app;this.didTimeout=!1,this.shapeType=this.parent.shapeType,this.app.mark("creating");const r=Ut();this.app.createShapes([{id:r,type:this.shapeType,x:n.x,y:n.y}]);const o=this.app.getShapeUtilByDef(Mt),i=this.app.getShapeById(r);if(!i)return;const s=(a=o.handles)==null?void 0:a.call(o,i);if(s){const d=this.app.getPointInShapeSpace(i,n),u=(l=o.onHandleChange)==null?void 0:l.call(o,i,{handle:{...s[0],x:d.x,y:d.y},isPrecise:!0});if(u){const h=(c=u.props)==null?void 0:c.start;(h==null?void 0:h.type)==="binding"&&this.app.setHintingIds([h.boundShapeId]),this.app.updateShapes([u],!0)}}this.app.select(r),this.shape=this.app.getShapeById(r),this.startPreciseTimeout()});y(this,"onExit",()=>{this.clearPreciseTimeout()});y(this,"onPointerMove",()=>{var n,r;if(this.shape&&this.app.inputs.isDragging){const o=this.app.getShapeUtil(this.shape),i=(n=o.handles)==null?void 0:n.call(o,this.shape);if(!i)throw this.app.bailToMark("creating"),Error("No handles found");if(!this.didTimeout){const s=this.app.getShapeUtilByDef(Mt),a=this.app.getShapeById(this.shape.id);if(!a)return;const l=s.handles(a);if(l){const{x:c,y:d}=this.app.getPointInShapeSpace(a,this.app.inputs.originPagePoint),u=(r=s.onHandleChange)==null?void 0:r.call(s,a,{handle:{...l[0],x:c,y:d},isPrecise:!1});u&&this.app.updateShapes([u],!0)}}this.app.setSelectedTool("select.dragging_handle",{shape:this.shape,handle:i.find(s=>s.id==="end"),isCreating:!0,onInteractionEnd:"arrow"})}});y(this,"onPointerUp",()=>{this.cancel()});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.cancel()});y(this,"onInterrupt",()=>{this.cancel()})}startPreciseTimeout(){this.preciseTimeout=window.setTimeout(()=>{this.isActive&&this.shape&&(this.didTimeout=!0)},300)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}cancel(){this.app.bailToMark("creating"),this.app.setHintingIds([]),this.parent.transition("idle",{})}},y(Im,"id","pointing"),Im);class Vd extends ye{constructor(){super(...arguments);y(this,"shapeType","arrow");y(this,"styles",["color","opacity","dash","size","arrowheadStart","arrowheadEnd","font","fill"])}}y(Vd,"id","arrow"),y(Vd,"initial","idle"),y(Vd,"children",()=>[h9,p9]);class q2 extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"initialShape");y(this,"util",this.app.getShapeUtilByDef(XI));y(this,"isPen",!1);y(this,"segmentMode","free");y(this,"didJustShiftClickToExtendPreviousShapeLine",!1);y(this,"pagePointWhereCurrentSegmentChanged",{});y(this,"pagePointWhereNextSegmentChanged",null);y(this,"lastRecordedPoint",{});y(this,"mergeNextPoint",!1);y(this,"currentLineLength",0);y(this,"canDraw",!1);y(this,"onEnter",n=>{this.info=n,this.canDraw=!this.app.isMenuOpen,this.lastRecordedPoint=this.app.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()});y(this,"onPointerMove",()=>{const{app:{inputs:n}}=this;this.isPen!==n.isPen&&this.cancel(),!this.canDraw&&n.isDragging&&(this.startShape(),this.canDraw=!0),this.canDraw&&(n.isPen?I.Dist(n.currentPagePoint,this.lastRecordedPoint)>=1/this.app.zoomLevel?(this.lastRecordedPoint=n.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateShapes())});y(this,"onKeyDown",n=>{if(n.key==="Shift")switch(this.segmentMode){case"free":{this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.app.inputs.currentPagePoint.clone();break}case"starting_free":this.segmentMode="starting_straight"}this.updateShapes()});y(this,"onKeyUp",n=>{if(n.key==="Shift")switch(this.app.snaps.clear(),this.segmentMode){case"straight":{this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.app.inputs.currentPagePoint.clone();break}case"starting_straight":{this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";break}}this.updateShapes()});y(this,"onExit",()=>{this.app.snaps.clear(),this.pagePointWhereCurrentSegmentChanged=this.app.inputs.currentPagePoint.clone()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.complete()});y(this,"onInterrupt",()=>{this.app.inputs.isDragging||(this.app.bail(),this.cancel())})}getIsClosed(n,r){const o=this.app.getStrokeWidth(r),i=n[0].points[0],s=n[n.length-1],a=s.points[s.points.length-1];return this.currentLineLength>o*4&&I.Dist(i,a)<o*2}startShape(){const{inputs:{originPagePoint:n,isPen:r}}=this.app;this.app.mark("draw create start"),this.isPen=r;const o=this.isPen?this.info.point.z*1.25:.5;if(this.segmentMode=this.app.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=n.clone(),this.initialShape){const s=this.app.getShapeById(this.initialShape.id);if(s&&this.segmentMode==="straight"){this.didJustShiftClickToExtendPreviousShapeLine=!0;const a=wr(s.props.segments);if(!a)throw Error("Expected a previous segment!");const l=wr(a.points);if(!l)throw Error("Expected a previous point!");const{x:c,y:d}=this.app.getPointInShapeSpace(s,n).toFixed(),u=this.isPen?this.info.point.z*1.25:.5,h={type:this.segmentMode,points:[{x:l.x,y:l.y,z:+u.toFixed(2)},{x:c,y:d,z:+u.toFixed(2)}]},p=ee.applyToPoint(this.app.getPageTransformById(s.id),l);this.pagePointWhereCurrentSegmentChanged=p,this.pagePointWhereNextSegmentChanged=null;const g=[...s.props.segments,h];this.currentLineLength=this.getLineLength(g),this.app.updateShapes([{id:s.id,type:"draw",props:{segments:g,isClosed:this.getIsClosed(g,s.props.size)}}]);return}}this.pagePointWhereCurrentSegmentChanged=n.clone();const i=Ut();this.app.createShapes([{id:i,type:"draw",x:n.x,y:n.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+o.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.app.getShapeById(i)}updateShapes(){const{inputs:n}=this.app,{initialShape:r}=this;if(!r)return;const{id:o,props:{size:i}}=r,s=this.app.getShapeById(o);if(!s)return;const{segments:a}=s.props,{x:l,y:c,z:d}=this.app.getPointInShapeSpace(s,n.currentPagePoint).toFixed(),u={x:l,y:c,z:this.isPen?+(d*1.25).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:h}=this;if(h===null)throw Error("We should have a point where the segment changed");if(I.Dist(h,n.currentPagePoint)>Ic){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const g=wr(a);if(!g)throw Error("Expected a previous segment!");const m=wr(g.points);if(!m)throw Error("Expected a previous last point!");let v;const x=this.app.getPointInShapeSpace(s,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if(g.type==="straight"){this.currentLineLength+=I.Dist(m,x),v={type:"straight",points:[{...m},x]};const b=this.app.getPageTransform(s);this.pagePointWhereCurrentSegmentChanged=ee.applyToPoint(b,m)}else v={type:"straight",points:[x,u]};this.app.updateShapes([{id:o,type:"draw",props:{segments:[...a,v],isClosed:this.getIsClosed(a,i)}}],!0)}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:h}=this;if(h===null)throw Error("We should have a point where the segment changed");if(I.Dist(h,n.currentPagePoint)>Ic){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const g=a.slice(),m=g[g.length-1],v=wr(m.points);if(!v)throw Error("No previous point!");const x={type:"free",points:[...I.PointsBetween(v,u,6).map(b=>b.toFixed().toJson())]};this.currentLineLength=this.getLineLength(a),this.app.updateShapes([{id:o,type:"draw",props:{segments:[...g,x],isClosed:this.getIsClosed(a,i)}}],!0)}break}case"straight":{const h=a.slice(),p=h[h.length-1],{pagePointWhereCurrentSegmentChanged:g}=this,{currentPagePoint:m,ctrlKey:v}=this.app.inputs;if(!g)throw Error("We should have a point where the segment changed");let x,b=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.app.inputs.isDragging&&(b=!v,this.didJustShiftClickToExtendPreviousShapeLine=!1):b=!v;let E=this.app.getPointInShapeSpace(s,m).toFixed().toJson(),P=!1,C;if((this.app.userDocumentSettings.isSnapMode?!v:v)&&h.length>2){let $,A=8/this.app.zoomLevel;for(let D=0,j=a.length-2;D<j;D++){const Y=a[D];if(!Y)break;if(Y.type==="free")continue;const V=Y.points[0],q=wr(Y.points);if(!(V&&q))continue;const F=I.NearestPointOnLineSegment(V,q,E),X=I.Dist(F,E);if(X<A){$=F.toFixed().toJson(),A=X,C=Y;break}}$&&(P=!0,E=$)}if(P&&C){const $=this.app.getPageTransform(s),A=C.points[0],D=wr(C.points);if(!D)throw Error("Expected a last point!");const j=ee.applyToPoint($,A),Y=ee.applyToPoint($,D),V=ee.applyToPoint($,E);this.app.snaps.setLines([{id:_t(),type:"points",points:[j,V,Y]}])}else{if(this.app.snaps.clear(),b){const $=I.Angle(g,m),D=Th($,24)-$;x=I.RotWith(m,g,D)}else x=m;E=this.app.getPointInShapeSpace(s,x).toFixed().toJson()}this.currentLineLength+=I.Dist(p.points[0],E),h[h.length-1]={...p,type:"straight",points:[p.points[0],E]},this.app.updateShapes([{id:o,type:"draw",props:{segments:h,isClosed:this.getIsClosed(a,i)}}],!0);break}case"free":{const h=a.slice(),p=h[h.length-1],g=[...p.points];if(g.length&&this.mergeNextPoint){const{z:m}=g[g.length-1];g[g.length-1]={x:u.x,y:u.y,z:m?Math.max(m,u.z):u.z}}else this.currentLineLength+=I.Dist(g[g.length-1],u),g.push(u);if(h[h.length-1]={...p,points:g},this.app.updateShapes([{id:o,type:"draw",props:{segments:h,isClosed:this.getIsClosed(a,i)}}],!0),g.length>500){this.app.updateShapes([{id:o,type:"draw",props:{isComplete:!0}}]);const{currentPagePoint:m}=this.app.inputs,v=this.app.createShapeId();this.app.createShapes([{id:v,type:"draw",x:m.x,y:m.y,props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(d*1.25).toFixed():.5}]}]}}]),this.initialShape=Uo(this.app.getShapeById(v)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.app.inputs.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(n){let r=0;for(const o of n)for(let i=0;i<o.points.length-1;i++){const s=o.points[i],a=o.points[i+1];r+=I.Sub(a,s).len2()}return Math.sqrt(r)}complete(){if(!this.canDraw){this.cancel();return}const{initialShape:n}=this;n&&(this.app.updateShapes([{id:n.id,type:n.type,props:{isComplete:!0}}]),this.parent.transition("idle",{}))}cancel(){this.parent.transition("idle",this.info)}}y(q2,"id","drawing");var Cm;let f9=(Cm=class extends ye{constructor(){super(...arguments);y(this,"onPointerDown",n=>{this.parent.transition("drawing",n)});y(this,"onEnter",()=>{this.app.setCursor({type:"cross"})});y(this,"onCancel",()=>{this.app.setSelectedTool("select")})}},y(Cm,"id","idle"),Cm);class Wd extends ye{constructor(){super(...arguments);y(this,"styles",["color","opacity","dash","fill","size"]);y(this,"onExit",()=>{const n=this.children.drawing;n.initialShape=void 0})}}y(Wd,"id","draw"),y(Wd,"initial","idle"),y(Wd,"children",()=>[f9,q2]);class Q2{constructor(e){y(this,"state");y(this,"points");y(this,"size");y(this,"color");y(this,"opacity");y(this,"onUpdate");y(this,"onComplete");y(this,"prev",null);y(this,"next",null);y(this,"resume",()=>{this.state="active"});y(this,"pause",()=>{this.state="starting"});y(this,"stop",()=>{this.state="stopping"});y(this,"addPoint",(e,n)=>{const{prev:r}=this,o={x:e,y:n,z:.5};r&&I.Dist(r,o)<1||(this.next=o)});y(this,"timeoutMs",0);y(this,"tick",e=>{this.timeoutMs+=e,this.timeoutMs>=16&&(this.timeoutMs=0);const{timeoutMs:n,state:r,prev:o,next:i,points:s}=this;switch(r){case"active":{i&&i!==o?(this.prev=i,s.push(i),s.length>8&&s.shift(),this.updateScribble()):n===0&&s.length>1&&(s.shift(),this.updateScribble());break}case"stopping":{if(n===0){if(s.length===1){this.state="paused",this.onComplete();return}this.size*=.9,s.shift(),this.updateScribble()}break}}});const{size:n=20,color:r="accent",opacity:o=.8,onComplete:i,onUpdate:s}=e;this.onUpdate=s,this.onComplete=i,this.size=n,this.color=r,this.opacity=o,this.points=[],this.state="starting",this.prev=null,this.next=null,this.resume()}getScribble(){return{state:this.state,size:this.size,color:this.color,opacity:this.opacity,points:[...this.points]}}updateScribble(){this.onUpdate(this.getScribble())}}class Z2 extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"scribble",{});y(this,"markId","");y(this,"excludedShapeIds",new Set);y(this,"onEnter",n=>{this.markId=this.app.mark("erase scribble begin"),this.info=n;const{originPagePoint:r}=this.app.inputs;this.excludedShapeIds=new Set(this.app.shapesArray.filter(o=>(o.type==="frame"||o.type==="group")&&this.app.isPointInShape(r,o)).map(o=>o.id)),this.startScribble(),this.update()});y(this,"startScribble",()=>{this.scribble=new Q2({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"muted-1",size:12}),this.app.on("tick",this.scribble.tick)});y(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.app.inputs.currentPagePoint;this.scribble.addPoint(n,r)});y(this,"onScribbleUpdate",n=>{this.app.setScribble(n)});y(this,"onScribbleComplete",()=>{this.app.off("tick",this.scribble.tick),this.app.setScribble(null)});y(this,"onExit",()=>{this.scribble.stop()});y(this,"onPointerMove",()=>{this.update()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.complete()})}update(){const{shapesArray:n,erasingIdsSet:r,inputs:{currentPagePoint:o,previousPagePoint:i}}=this.app,{excludedShapeIds:s}=this;this.pushPointToScribble();const a=new Set(r);for(const l of n){if(l.type==="group")continue;const c=this.app.getPageMaskById(l.id);if(c&&!$r(o,c))continue;const d=this.app.getShapeUtil(l),u=this.app.getPointInShapeSpace(l,i),h=this.app.getPointInShapeSpace(l,o);d.hitTestLineSegment(l,u,h)&&a.add(this.app.getOutermostSelectableShape(l).id)}this.app.setErasingIds([...a].filter(l=>!s.has(l)))}complete(){this.app.deleteShapes(this.app.pageState.erasingIds),this.app.setErasingIds([]),this.parent.transition("idle",{})}cancel(){this.app.setErasingIds([]),this.app.bailToMark(this.markId),this.parent.transition("idle",this.info)}}y(Z2,"id","erasing");var km;let g9=(km=class extends ye{constructor(){super(...arguments);y(this,"onPointerDown",n=>{this.parent.transition("pointing",n)})}},y(km,"id","idle"),km);var $m;let m9=($m=class extends ye{constructor(){super(...arguments);y(this,"onEnter",()=>{const{inputs:n}=this.app,r=new Set,o=r.size;for(const i of[...this.app.sortedShapesArray].reverse())if(this.app.isPointInShape(n.currentPagePoint,i)){if(i.type==="group")continue;const s=this.app.getOutermostSelectableShape(i);if(s.type==="frame"&&r.size>o)break;r.add(s.id)}this.app.setErasingIds([...r])});y(this,"onPointerMove",n=>{this.app.inputs.isDragging&&this.parent.transition("erasing",n)});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.complete()});y(this,"onInterrupt",()=>{this.cancel()})}complete(){const{erasingIds:n}=this.app;n.length&&(this.app.mark("erase end"),this.app.deleteShapes(n)),this.app.setErasingIds([]),this.parent.transition("idle",{})}cancel(){this.app.setErasingIds([]),this.parent.transition("idle",{})}},y($m,"id","pointing"),$m);class Yd extends ye{constructor(){super(...arguments);y(this,"onEnter",()=>{this.app.setCursor({type:"cross"})})}}y(Yd,"id","eraser"),y(Yd,"initial","idle"),y(Yd,"children",()=>[g9,m9,Z2]);var Tm;let y9=(Tm=class extends ye{constructor(){super(...arguments);y(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});y(this,"onEnter",()=>{this.app.setCursor({type:"cross"})});y(this,"onCancel",()=>{this.app.setSelectedTool("select")})}},y(Tm,"id","idle"),Tm);var Mm;let v9=(Mm=class extends ye{constructor(){super(...arguments);y(this,"markId","creating");y(this,"wasFocusedOnEnter",!1);y(this,"onEnter",()=>{const{isMenuOpen:n}=this.app;this.wasFocusedOnEnter=!n});y(this,"onPointerMove",n=>{if(this.app.inputs.isDragging){const{originPagePoint:r}=this.app.inputs,o=this.parent.shapeType,i=Ut();this.app.mark(this.markId),this.app.createShapes([{id:i,type:o,x:r.x,y:r.y,props:{w:1,h:1}}]),this.app.setSelectedIds([i]),this.app.setSelectedTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id})}});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.complete()});y(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.app.inputs;if(!this.wasFocusedOnEnter)return;this.app.mark(this.markId);const r=this.parent.shapeType,o=Ut();this.app.mark(this.markId),this.app.createShapes([{id:o,type:r,x:n.x,y:n.y}]);const i=this.app.getShapeById(o),{w:s,h:a}=this.app.getShapeUtil(i).defaultProps(),l=this.app.getDeltaInParentSpace(i,new I(s/2,a/2));this.app.updateShapes([{id:o,type:r,x:i.x-l.x,y:i.y-l.y}]),this.app.setSelectedIds([o]),this.app.instanceState.isToolLocked?this.parent.transition("idle",{}):this.app.setSelectedTool("select.idle")}cancel(){this.parent.transition("idle",{})}},y(Mm,"id","pointing"),Mm);class ic extends ye{constructor(){super(...arguments);y(this,"styles",["opacity"])}}y(ic,"id","box"),y(ic,"initial","idle"),y(ic,"children",()=>[y9,v9]);class wy extends ic{constructor(){super(...arguments);y(this,"shapeType","frame");y(this,"styles",["opacity"])}}y(wy,"id","frame"),y(wy,"initial","idle");var Am;let w9=(Am=class extends ye{constructor(){super(...arguments);y(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});y(this,"onEnter",()=>{this.app.setCursor({type:"cross"})});y(this,"onKeyUp",n=>{if(n.key==="Enter"){const r=this.app.onlySelectedShape;r&&r.type==="geo"&&(this.app.mark("editing shape"),this.app.setEditingId(r.id),this.app.setSelectedTool("select.editing_shape",{...n,target:"shape",shape:r}))}});y(this,"onCancel",()=>{this.app.setSelectedTool("select")})}},y(Am,"id","idle"),Am);var Rm;let x9=(Rm=class extends ye{constructor(){super(...arguments);y(this,"onPointerMove",n=>{if(this.app.inputs.isDragging){const{originPagePoint:r}=this.app.inputs,o=Ut();this.app.mark("creating"),this.app.createShapes([{id:o,type:"geo",x:r.x,y:r.y,props:{w:1,h:1,geo:this.app.instanceState.propsForNextShape.geo}}]),this.app.select(o),this.app.setSelectedTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.complete()});y(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.app.inputs,r=Ut();this.app.mark("creating"),this.app.createShapes([{id:r,type:"geo",x:n.x,y:n.y,props:{geo:this.app.instanceState.propsForNextShape.geo,w:1,h:1}}]);const o=this.app.getShapeById(r);if(!o)return;const i=o.props.geo==="star"?N8(5,200,200):new de(0,0,200,200),s=this.app.getDeltaInParentSpace(o,i.center);this.app.select(r),this.app.updateShapes([{id:o.id,type:"geo",x:o.x-s.x,y:o.y-s.y,props:{geo:this.app.instanceState.propsForNextShape.geo,w:i.width,h:i.height}}]),this.app.instanceState.isToolLocked?this.parent.transition("idle",{}):this.app.setSelectedTool("select",{})}cancel(){this.parent.transition("idle",{})}},y(Rm,"id","pointing"),Rm);class Xd extends ye{constructor(){super(...arguments);y(this,"styles",["color","opacity","dash","fill","size","geo","font","align"])}}y(Xd,"id","geo"),y(Xd,"initial","idle"),y(Xd,"children",()=>[w9,x9]);class J2 extends ye{constructor(){super(...arguments);y(this,"onEnter",()=>{this.update()});y(this,"onPointerMove",()=>{this.update()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()})}update(){const{currentScreenPoint:n,previousScreenPoint:r}=this.app.inputs,o=I.Sub(n,r);(Math.abs(o.x)>0||Math.abs(o.y)>0)&&this.app.pan(o.x,o.y)}complete(){this.app.slideCamera({speed:Math.min(2,this.app.inputs.pointerVelocity.len()),direction:this.app.inputs.pointerVelocity,friction:Ud}),this.parent.transition("idle",{})}}y(J2,"id","dragging");var Lm;let b9=(Lm=class extends ye{constructor(){super(...arguments);y(this,"onEnter",()=>{this.app.setCursor({type:"grab"})});y(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});y(this,"onCancel",()=>{this.app.setSelectedTool("select")})}},y(Lm,"id","idle"),Lm);var Dm;let S9=(Dm=class extends ye{constructor(){super(...arguments);y(this,"onEnter",()=>{this.app.stopCameraAnimation(),this.app.setCursor({type:"grabbing"})});y(this,"onPointerMove",n=>{this.app.inputs.isDragging&&this.parent.transition("dragging",n)});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()});y(this,"onInterrupt",()=>{this.complete()})}complete(){this.parent.transition("idle",{})}},y(Dm,"id","pointing"),Dm);class Gd extends ye{constructor(){super(...arguments);y(this,"styles",[]);y(this,"onDoubleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.app.inputs;this.app.zoomIn(r,{duration:220,easing:Pn.easeOutQuint})}});y(this,"onTripleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.app.inputs;this.app.zoomOut(r,{duration:320,easing:Pn.easeOutQuint})}});y(this,"onQuadrupleClick",n=>{if(n.phase==="settle"){const{zoomLevel:r,inputs:{currentScreenPoint:o}}=this.app;r===1?this.app.zoomToFit({duration:400,easing:Pn.easeOutQuint}):this.app.resetZoom(o,{duration:320,easing:Pn.easeOutQuint})}})}}y(Gd,"id","hand"),y(Gd,"initial","idle"),y(Gd,"children",()=>[b9,S9,J2]);var Om;let E9=(Om=class extends ye{constructor(){super(...arguments);y(this,"shapeId","");y(this,"onEnter",n=>{this.shapeId=n.shapeId,this.app.setCursor({type:"cross"})});y(this,"onPointerDown",()=>{this.parent.transition("pointing",{shapeId:this.shapeId})});y(this,"onCancel",()=>{this.app.setSelectedTool("select")})}},y(Om,"id","idle"),Om);var jm;let P9=(jm=class extends ye{constructor(){super(...arguments);y(this,"shapeType","");y(this,"shape",{});y(this,"markPointId","");y(this,"onEnter",n=>{const{inputs:r}=this.app,{currentPagePoint:o}=r;this.shapeType=this.parent.shapeType,this.markPointId=this.app.mark("creating");let i=!1;if(n.shapeId){const s=this.app.getShapeById(n.shapeId);s&&(i=!0,this.shape=s)}if(r.shiftKey&&i){const a=this.app.getShapeUtil(this.shape).handles(this.shape).filter(g=>g.type==="vertex").sort(jn),l=a[a.length-1],c=ee.applyToPoint(this.app.getParentTransform(this.shape),new I(this.shape.x,this.shape.y));let d,u,h;a.length===2&&a[1].x===1&&a[1].y===1?(d=a[1].index,u=a[1].id,h={...a[1],x:o.x-c.x,y:o.y-c.y}):(d=Oo(l.index),u="handle:"+d,h={x:o.x-c.x,y:o.y-c.y,index:d,canBind:!1,type:"vertex",id:u});const p=Uo(this.shape.props.handles);p[h.id]=h,this.app.updateShapes([{id:this.shape.id,type:this.shape.type,props:{handles:p}}])}else{const s=Ut();this.app.createShapes([{id:s,type:this.shapeType,x:o.x,y:o.y}]),this.app.select(s),this.shape=this.app.getShapeById(s)}});y(this,"onPointerMove",()=>{var n;if(this.shape&&this.app.inputs.isDragging){const r=this.app.getShapeUtil(this.shape),o=(n=r.handles)==null?void 0:n.call(r,this.shape);if(!o)throw this.app.bailToMark("creating"),Error("No handles found");this.app.setSelectedTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:wr(o),onInteractionEnd:"line"})}});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.complete()});y(this,"onInterrupt",()=>{this.parent.transition("idle",{}),this.app.bailToMark("creating"),this.app.snaps.clear()})}complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.app.snaps.clear()}cancel(){this.app.bailToMark(this.markPointId),this.parent.transition("idle",{shapeId:this.shape.id}),this.app.snaps.clear()}},y(jm,"id","pointing"),jm);class qd extends ye{constructor(){super(...arguments);y(this,"shapeType","line");y(this,"styles",["color","opacity","dash","size","spline"])}}y(qd,"id","line"),y(qd,"initial","idle"),y(qd,"children",()=>[E9,P9]);var Nm;let _9=(Nm=class extends ye{constructor(){super(...arguments);y(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});y(this,"onEnter",()=>{this.app.setCursor({type:"cross"})});y(this,"onCancel",()=>{this.app.setSelectedTool("select")})}},y(Nm,"id","idle"),Nm);var Bm;let I9=(Bm=class extends ye{constructor(){super(...arguments);y(this,"dragged",!1);y(this,"info",{});y(this,"wasFocusedOnEnter",!1);y(this,"markPointId","creating");y(this,"onEnter",()=>{this.wasFocusedOnEnter=!this.app.isMenuOpen});y(this,"onPointerMove",n=>{if(this.app.inputs.isDragging){this.app.mark(this.markPointId);const r=this.createShape();if(!r)return;this.app.setSelectedTool("select.translating",{...n,target:"shape",shape:r,isCreating:!0,editAfterComplete:!0,onInteractionEnd:"note"})}});y(this,"onPointerUp",()=>{this.complete()});y(this,"onInterrupt",()=>{this.cancel()});y(this,"onComplete",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()})}complete(){if(!this.wasFocusedOnEnter)return;this.app.mark(this.markPointId);const n=this.createShape();if(this.app.instanceState.isToolLocked)this.parent.transition("idle",{});else{if(!n)return;this.app.setEditingId(n.id),this.app.setSelectedTool("select.editing_shape",{...this.info,target:"shape",shape:n})}}cancel(){this.app.bailToMark(this.markPointId),this.parent.transition("idle",this.info)}createShape(){const{inputs:{originPagePoint:n}}=this.app,r=this.app.createShapeId();this.app.createShapes([{id:r,type:"note",x:n.x,y:n.y}],!0);const o=this.app.getShapeUtilByDef(vy),i=this.app.getShapeById(r);uv(vy.is(i));const s=o.bounds(i);return this.app.updateShapes([{id:r,type:"note",x:i.x-s.width/2,y:i.y-s.height/2}]),this.app.getShapeById(r)}},y(Bm,"id","pointing"),Bm);class Qd extends ye{constructor(){super(...arguments);y(this,"styles",["color","opacity","size","align","font"])}}y(Qd,"id","note"),y(Qd,"initial","idle"),y(Qd,"children",()=>[_9,I9]);class eC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"brush",new de);y(this,"initialSelectedIds",[]);y(this,"initialStartShape",null);y(this,"onEnter",n=>{const{altKey:r,currentPagePoint:o}=this.app.inputs;if(r){this.parent.transition("scribble_brushing",n);return}this.info=n,this.initialSelectedIds=this.app.selectedIds.slice(),this.initialStartShape=this.app.getShapesAtPoint(o)[0],this.onPointerMove()});y(this,"onExit",()=>{this.initialSelectedIds=[],this.app.setBrush(null)});y(this,"onPointerMove",()=>{this.hitTestShapes()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()});y(this,"onCancel",n=>{this.app.setSelectedIds(this.initialSelectedIds,!0),this.parent.transition("idle",n)});y(this,"onKeyDown",n=>{this.app.inputs.altKey?this.parent.transition("scribble_brushing",n):this.hitTestShapes()});y(this,"onKeyUp",()=>{this.hitTestShapes()});y(this,"onInterrupt",()=>{this.app.setBrush(null)})}complete(){this.parent.transition("idle",{})}hitTestShapes(){const{currentPageId:n,shapesArray:r,inputs:{originPagePoint:o,currentPagePoint:i,shiftKey:s,ctrlKey:a}}=this.app;this.brush.setTo(de.FromPoints([o,i]));const l=new Set(s?this.initialSelectedIds:[]);let c,d,u,h,p,g,m;const{corners:v}=this.brush;e:for(let x=0,b=r.length;x<b;x++){if(u=r[x],u.type==="group"||l.has(u.id)||(p=this.app.getPageBounds(u),!p))continue e;if(this.brush.contains(p)){this.handleHit(u,i,n,l,v);continue e}if(a||u.type==="frame")continue e;if(this.brush.collides(p)){if(h=this.app.getShapeUtil(u),g=this.app.getPageTransform(u),!g)continue e;m=ee.applyToPoints(ee.Inverse(g),v);t:for(let E=0;E<m.length;E++)if(c=m[E],d=m[(E+1)%m.length],h.hitTestLineSegment(u,c,d)){this.handleHit(u,i,n,l,v);break t}}}this.app.setBrush({...this.brush.toJson()}),this.app.setSelectedIds(Array.from(l),!0)}handleHit(n,r,o,i,s){if(n.parentId===o){i.add(n.id);return}const a=this.app.getOutermostSelectableShape(n),l=this.app.getPageMaskById(a.id);l&&Z8(l,s)!==null&&!$r(r,l)||i.add(a.id)}}y(eC,"id","brushing");function tC(t,e,n){if(!e)throw Error("Needs to translate a cropped shape!");const{crop:r}=e.props;if(!r)return;const o=t.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;o==="x"?n.x=0:o==="y"&&(n.y=0),n.rot(-e.rotation);const i=1/(r.bottomRight.x-r.topLeft.x)*e.props.w,s=1/(r.bottomRight.y-r.topLeft.y)*e.props.h,a=r.bottomRight.y-r.topLeft.y,l=r.bottomRight.x-r.topLeft.x,c=Fn(r);return c.topLeft.x=Math.min(1-l,Math.max(0,c.topLeft.x-n.x/i)),c.topLeft.y=Math.min(1-a,Math.max(0,c.topLeft.y-n.y/s)),c.bottomRight.x=c.topLeft.x+l,c.bottomRight.y=c.topLeft.y+a,{id:e.id,type:e.type,props:{crop:c}}}var zm;let C9=(zm=class extends ye{constructor(){super(...arguments);y(this,"onEnter",()=>{this.app.setCursor({type:"default"});const{onlySelectedShape:n}=this.app;this.app.on("change-history",this.cleanupCroppingState),this.app.mark("crop"),n&&this.app.setCroppingId(n.id)});y(this,"onExit",()=>{this.app.setCursor({type:"default"}),this.app.off("change-history",this.cleanupCroppingState)});y(this,"onCancel",()=>{this.app.setCroppingId(null),this.app.setSelectedTool("select.idle",{})});y(this,"onPointerDown",n=>{var r;if(!this.app.isMenuOpen){if(n.ctrlKey){this.app.setCroppingId(null),this.app.setSelectedTool("select.brushing",n);return}switch(n.target){case"canvas":{this.cancel();break}case"shape":{if(n.shape.id===this.app.croppingId){this.app.setSelectedTool("select.crop.pointing_crop",n);return}else(r=this.app.getShapeUtil(n.shape))!=null&&r.canCrop(n.shape)?(this.app.setCroppingId(n.shape.id),this.app.setSelectedIds([n.shape.id]),this.app.setSelectedTool("select.crop.pointing_crop",n)):this.cancel();break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.app.setSelectedTool("select.pointing_rotate_handle",{...n,onInteractionEnd:"select.crop"});break}case"top":case"right":case"bottom":case"left":{this.app.setSelectedTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{this.app.setSelectedTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}default:this.cancel()}break}}}});y(this,"onDoubleClick",n=>{var i;if(n.phase!=="up"||!this.app.croppingId)return;const r=this.app.getShapeById(this.app.croppingId);if(!r)return;const o=this.app.getShapeUtil(r);o&&n.target==="selection"&&((i=o.onDoubleClickEdge)==null||i.call(o,r))});y(this,"onKeyDown",()=>{this.nudgeCroppingImage(!1)});y(this,"onKeyRepeat",()=>{this.nudgeCroppingImage(!0)});y(this,"onKeyUp",n=>{switch(n.code){case"Enter":{this.app.setCroppingId(null),this.app.setSelectedTool("select.idle",{});break}}});y(this,"cleanupCroppingState",()=>{this.app.croppingId||this.app.setSelectedTool("select.idle",{})})}cancel(){this.app.setCroppingId(null),this.app.setSelectedTool("select.idle",{})}nudgeCroppingImage(n=!1){const{app:{inputs:{keys:r}}}=this,o=r.has("Shift"),i=new I(0,0);if(r.has("ArrowLeft")&&(i.x+=1),r.has("ArrowRight")&&(i.x-=1),r.has("ArrowUp")&&(i.y+=1),r.has("ArrowDown")&&(i.y-=1),i.equals(new I(0,0)))return;o&&i.mul(10);const s=this.app.getShapeById(this.app.croppingId);if(!s)return;const a=tC(this.app,s,i);a&&(n||this.app.mark("translate crop"),this.app.updateShapes([a]))}},y(zm,"id","idle"),zm);class nC extends ye{constructor(){super(...arguments);y(this,"onCancel",()=>{this.app.setSelectedTool("select.crop.idle",{})});y(this,"onPointerMove",n=>{this.app.inputs.isDragging&&this.app.setSelectedTool("select.crop.translating_crop",n)});y(this,"onPointerUp",n=>{this.app.setSelectedTool("select.crop.idle",n)})}}y(nC,"id","pointing_crop");class rC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"markId","translating crop");y(this,"snapshot",{});y(this,"onEnter",n=>{this.info=n,this.snapshot=this.createSnapshot(),this.app.mark(this.markId),this.app.setCursor({type:"move"}),this.updateShapes()});y(this,"onExit",()=>{this.app.setCursor({type:"default"})});y(this,"onPointerMove",()=>{this.updateShapes()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onKeyDown",n=>{switch(n.key){case"Alt":case"Shift":{this.updateShapes();return}}});y(this,"onKeyUp",n=>{switch(n.key){case"Enter":{this.complete();return}case"Alt":case"Shift":this.updateShapes()}})}complete(){this.updateShapes(),this.app.setSelectedTool("select.crop.idle",this.info)}cancel(){this.app.bailToMark(this.markId),this.app.setSelectedTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.app.onlySelectedShape}}updateShapes(){const n=this.snapshot.shape;if(!n)return;const{originPagePoint:r,currentPagePoint:o}=this.app.inputs,i=o.clone().sub(r),s=tC(this.app,n,i);s&&this.app.updateShapes([s],!0)}}y(rC,"id","translating_crop");class Zd extends ye{}y(Zd,"id","crop"),y(Zd,"initial","idle"),y(Zd,"children",()=>[C9,rC,nC]);const Wa={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class oC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"onEnter",n=>{this.info=n,this.updateCursor()});y(this,"onPointerMove",()=>{this.app.inputs.isDragging&&this.parent.transition("resizing",this.info)});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.cancel()});y(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const n=this.app.selectedShapes,r=Wa[this.info.handle];this.app.setCursor({type:r,rotation:n.length===1?n[0].rotation:0})}complete(){this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}y(oC,"id","pointing_resize_handle");class iC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"markId","");y(this,"snapshot",{});y(this,"onEnter",n=>{this.info=n,this.markId=this.app.mark("cropping"),this.snapshot=this.createSnapshot(),this.updateShapes()});y(this,"onPointerMove",()=>{this.updateShapes()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"getDefaultCrop",()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}))}updateCursor(){const n=this.app.selectedShapes[0];if(!n)return;const r=Wa[this.info.handle];this.app.setCursor({type:r,rotation:n.rotation})}updateShapes(){const{shape:n,cursorHandleOffset:r}=this.snapshot;if(!n||!this.app.getShapeUtil(n))return;const i=n.props,s=this.app.inputs.currentPagePoint.clone().sub(r),a=this.app.inputs.originPagePoint.clone().sub(r),l=s.clone().sub(a).rot(-n.rotation),c=i.crop??this.getDefaultCrop(),d=Fn(c),u=new I(n.x,n.y),h=new I(0,0),p=1/(c.bottomRight.x-c.topLeft.x)*i.w,g=1/(c.bottomRight.y-c.topLeft.y)*i.h;let m=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(g<fr)break;m=!0,d.topLeft.y=d.topLeft.y+l.y/g,g*(d.bottomRight.y-d.topLeft.y)<fr?(d.topLeft.y=d.bottomRight.y-fr/g,h.y=(d.topLeft.y-c.topLeft.y)*g):d.topLeft.y<=0?(d.topLeft.y=0,h.y=(d.topLeft.y-c.topLeft.y)*g):h.y=l.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(g<fr)break;m=!0,d.bottomRight.y=Math.min(1,d.bottomRight.y+l.y/g),g*(d.bottomRight.y-d.topLeft.y)<fr&&(d.bottomRight.y=d.topLeft.y+fr/g);break}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(p<fr)break;m=!0,d.topLeft.x=d.topLeft.x+l.x/p,p*(d.bottomRight.x-d.topLeft.x)<fr?(d.topLeft.x=d.bottomRight.x-fr/p,h.x=(d.topLeft.x-c.topLeft.x)*p):d.topLeft.x<=0?(d.topLeft.x=0,h.x=(d.topLeft.x-c.topLeft.x)*p):h.x=l.x;break}case"right":case"top_right":case"bottom_right":{if(p<fr)break;m=!0,d.bottomRight.x=Math.min(1,d.bottomRight.x+l.x/p),p*(d.bottomRight.x-d.topLeft.x)<fr&&(d.bottomRight.x=d.topLeft.x+fr/p);break}}if(!m)return;u.add(h.rot(n.rotation));const v={id:n.id,type:n.type,x:u.x,y:u.y,props:{crop:d,w:(d.bottomRight.x-d.topLeft.x)*p,h:(d.bottomRight.y-d.topLeft.y)*g}};this.app.updateShapes([v],!0),this.updateCursor()}complete(){this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,this.info):(this.app.setCroppingId(null),this.parent.transition("idle",{}))}cancel(){this.app.bailToMark(this.markId),this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,this.info):(this.app.setCroppingId(null),this.parent.transition("idle",{}))}createSnapshot(){const{selectionRotation:n,inputs:{originPagePoint:r}}=this.app,o=this.app.onlySelectedShape,i=this.app.selectionBounds,s=I.RotWith(i.getHandlePoint(this.info.handle),i.point,n),a=I.Sub(r,s);return{shape:o,cursorHandleOffset:a}}}y(iC,"id","cropping");class sC extends ye{constructor(){super(...arguments);y(this,"shapeId","");y(this,"initialHandle",{});y(this,"initialAdjacentHandle",null);y(this,"markId","");y(this,"initialPageTransform");y(this,"initialPageRotation");y(this,"info",{});y(this,"isPrecise",!1);y(this,"isPreciseId",null);y(this,"pointingId",null);y(this,"onEnter",n=>{const{shape:r,isCreating:o,handle:i}=n;this.info=n,this.shapeId=r.id,this.markId=o?"creating":this.app.mark("dragging handle"),this.initialHandle=Fn(i),this.initialPageTransform=this.app.getPageTransform(r),this.initialPageRotation=this.app.getPageRotation(r),this.app.setCursor({type:o?"cross":"grabbing",rotation:0});const s=this.app.getShapeUtil(r).handles(r).sort(jn),a=s.findIndex(c=>c.id===n.handle.id);this.initialAdjacentHandle=null;for(let c=a+1;c<s.length;c++){const d=s[c];if(d.type==="vertex"&&d.id!=="middle"&&d.id!==n.handle.id){this.initialAdjacentHandle=d;break}}if(!this.initialAdjacentHandle)for(let c=s.length-1;c>=0;c--){const d=s[c];if(d.type==="vertex"&&d.id!=="middle"&&d.id!==n.handle.id){this.initialAdjacentHandle=d;break}}const l=r.props[n.handle.id];this.isPrecise=!1,(l==null?void 0:l.type)==="binding"&&(this.app.setHintingIds([l.boundShapeId]),this.isPrecise=!I.Equals(l.normalizedAnchor,{x:.5,y:.5}),this.isPrecise?this.isPreciseId=l.boundShapeId:this.resetExactTimeout()),this.update()});y(this,"exactTimeout",-1);y(this,"onPointerMove",()=>{this.update()});y(this,"onKeyDown",()=>{this.update()});y(this,"onKeyUp",()=>{this.update()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onExit",()=>{this.app.setHintingIds([]),this.app.snaps.clear(),this.app.setCursor({type:"default"})})}resetExactTimeout(){this.exactTimeout!==-1&&this.clearExactTimeout(),this.exactTimeout=setTimeout(()=>{this.isActive&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){this.exactTimeout!==-1&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}complete(){this.app.snaps.clear();const{onInteractionEnd:n}=this.info;if(this.app.instanceState.isToolLocked&&n){this.app.setSelectedTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}cancel(){this.app.bailToMark(this.markId),this.app.snaps.clear();const{onInteractionEnd:n}=this.info;if(n){this.app.setSelectedTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}update(){var h;const{currentPagePoint:n,originPagePoint:r,shiftKey:o}=this.app.inputs,i=this.app.getShapeById(this.shapeId);if(!i)return;let s=I.Add(I.Rot(I.Sub(n,r),-this.initialPageRotation),this.initialHandle);if(o&&this.initialHandle.id!=="middle"){const{initialAdjacentHandle:p}=this;if(p){const g=I.Angle(p,s),v=Th(g,24)-g;s=I.RotWith(s,p,v)}}this.app.snaps.clear();const{ctrlKey:a}=this.app.inputs;if((this.app.userDocumentSettings.isSnapMode?!a:a)&&i.type==="line"){const p=ee.applyToPoint(this.app.getPageTransformById(i.id),s),g=this.app.snaps.snapLineHandleTranslate({lineId:i.id,handleId:this.initialHandle.id,handlePoint:p}),{nudge:m}=g;if(m.x||m.y){const v=this.app.getDeltaInShapeSpace(i,m);s=I.Add(s,v)}}const c=this.app.getShapeUtil(i),d=(h=c.onHandleChange)==null?void 0:h.call(c,i,{handle:{...this.initialHandle,x:s.x,y:s.y},isPrecise:this.isPrecise||this.app.inputs.altKey}),u={...i,...d};if(this.initialHandle.canBind){const p=u.props[this.initialHandle.id];(p==null?void 0:p.type)==="binding"?this.app.hintingIds[0]!==p.boundShapeId&&(this.app.setHintingIds([p.boundShapeId]),this.pointingId=p.boundShapeId,this.isPrecise=this.app.inputs.pointerVelocity.len()<.5||this.app.inputs.altKey,this.isPreciseId=this.isPrecise?p.boundShapeId:null,this.resetExactTimeout()):this.app.hintingIds.length>0&&(this.app.setHintingIds([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}d&&this.app.updateShapes([u],!0)}}y(sC,"id","dragging_handle");class aC extends ye{constructor(){super(...arguments);y(this,"onPointerEnter",n=>{switch(n.target){case"shape":{const{selectedIds:r,focusLayerId:o}=this.app,i=this.app.getOutermostSelectableShape(n.shape,s=>!r.includes(s.id));i.id!==o&&this.app.setHoveredId(i.id);break}}});y(this,"onPointerLeave",n=>{switch(n.target){case"shape":{this.app.setHoveredId(null);break}}});y(this,"onExit",()=>{var i;if(!this.app.pageState.editingId)return;const{editingId:n}=this.app.pageState;if(!n)return;this.app.setEditingId(null);const r=this.app.getShapeById(n),o=this.app.getShapeUtil(r);(i=o.onEditEnd)==null||i.call(o,r)});y(this,"onPointerDown",n=>{var r,o,i,s;switch(n.target){case"shape":{const{shape:a}=n,{editingId:l}=this.app.pageState;if(l){if(a.id===l)return;const c=this.app.getShapeById(l);if(c){const d=this.app.getShapeUtil(c);(r=d.onEditEnd)==null||r.call(d,c);const u=this.app.getShapeUtil(a);if(a.type===c.type&&((o=u.canEdit)!=null&&o.call(u,a))){this.app.setEditingId(a.id),this.app.setHoveredId(a.id),this.app.setSelectedIds([a.id]);return}}}}}this.parent.transition("idle",n),(s=(i=this.parent.current.value)==null?void 0:i.onPointerDown)==null||s.call(i,n)});y(this,"onComplete",n=>{this.parent.transition("idle",n)});y(this,"onCancel",n=>{this.parent.transition("idle",n)})}}y(aC,"id","editing_shape");var Um;let k9=(Um=class extends ye{constructor(){super(...arguments);y(this,"onPointerEnter",n=>{switch(n.target){case"canvas":break;case"shape":{const{selectedIds:r,focusLayerId:o}=this.app,i=this.app.getOutermostSelectableShape(n.shape,s=>!r.includes(s.id));i.id!==o&&this.app.setHoveredId(i.id);break}}});y(this,"onPointerLeave",n=>{switch(n.target){case"shape":{this.app.setHoveredId(null);break}}});y(this,"onPointerDown",n=>{if(this.app.isMenuOpen)return;const r=this.shouldEnterCropMode(n,!0);if(n.ctrlKey&&!r){this.parent.transition("brushing",n);return}switch(n.target){case"canvas":{this.parent.transition("pointing_canvas",n);break}case"shape":{this.parent.transition("pointing_shape",n);break}case"handle":{if(this.app.isReadOnly)break;this.app.inputs.altKey?this.parent.transition("pointing_shape",n):this.parent.transition("pointing_handle",n);break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.parent.transition("pointing_rotate_handle",n);break}case"top":case"right":case"bottom":case"left":{r?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{r?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}default:this.parent.transition("pointing_selection",n)}break}}});y(this,"onDoubleClick",n=>{var r,o,i,s;if(n.phase==="up")switch(n.target){case"canvas":{if(this.app.isReadOnly)break;this.createTextShapeAtPoint(n);break}case"selection":{if(this.app.isReadOnly)break;const{onlySelectedShape:a}=this.app;if(a){const l=this.app.getShapeUtil(a);if(n.handle==="right"||n.handle==="left"||n.handle==="top"||n.handle==="bottom"){const c=(r=l.onDoubleClickEdge)==null?void 0:r.call(l,a);if(c){this.app.mark("double click edge"),this.app.updateShapes([c]);return}}if(l.canCrop(a)){this.parent.transition("crop",n);return}l.canEdit(a)&&this.startEditingShape(a,n)}break}case"shape":{const{shape:a}=n,l=this.app.getShapeUtil(a);if(a.type!=="video"&&a.type!=="embed"&&this.app.isReadOnly)break;if(l.onDoubleClick){const c=(o=l.onDoubleClick)==null?void 0:o.call(l,a);if(c){this.app.updateShapes([c]);return}else if(l.canCrop(a)){this.app.mark("select and crop"),this.app.select((i=n.shape)==null?void 0:i.id),this.parent.transition("crop",n);return}}l.canEdit(a)?this.startEditingShape(a,n):this.createTextShapeAtPoint(n);break}case"handle":{if(this.app.isReadOnly)break;const{shape:a,handle:l}=n,c=this.app.getShapeUtil(a),d=(s=c.onDoubleClickHandle)==null?void 0:s.call(c,a,l);d?this.app.updateShapes([d]):c.canEdit(a)&&this.startEditingShape(a,n)}}});y(this,"onRightClick",n=>{switch(n.target){case"canvas":{this.app.selectNone();break}case"shape":{const{selectedIds:r}=this.app.pageState,{shape:o}=n,i=this.app.getOutermostSelectableShape(o,s=>!this.app.isSelected(s.id));r.includes(i.id)||(this.app.mark("selecting shape"),this.app.setSelectedIds([i.id]));break}}});y(this,"onEnter",()=>{this.app.setHoveredId(null),this.app.setCursor({type:"default"})});y(this,"onCancel",()=>{this.app.focusLayerId!==this.app.currentPageId&&this.app.selectedIds.length>0?this.app.popFocusLayer():(this.app.mark("clearing selection"),this.app.selectNone())});y(this,"onKeyDown",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!1);break}}});y(this,"onKeyRepeat",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!0);break}}});y(this,"onKeyUp",n=>{if(this.app.isReadOnly)switch(n.code){case"Enter":{if(this.shouldStartEditingShape()&&this.app.onlySelectedShape){this.startEditingShape(this.app.onlySelectedShape,{...n,target:"shape",shape:this.app.onlySelectedShape});return}break}}else switch(n.code){case"Enter":{const{selectedShapes:r}=this.app;if(r.every(o=>o.type==="group")){this.app.setSelectedIds(r.flatMap(o=>this.app.getSortedChildIds(o.id)));return}if(this.shouldStartEditingShape()&&this.app.onlySelectedShape){this.startEditingShape(this.app.onlySelectedShape,{...n,target:"shape",shape:this.app.onlySelectedShape});return}this.shouldEnterCropMode(n,!1)&&this.parent.transition("crop",n);break}}})}shouldStartEditingShape(){const{onlySelectedShape:n}=this.app;return n?this.app.getShapeUtil(n).canEdit(n):!1}shouldEnterCropMode(n,r){const o=this.app.onlySelectedShape;if(!o)return!1;const i=this.app.getShapeUtil(o);return r?i.canCrop(o)&&n.ctrlKey:i.canCrop(o)}startEditingShape(n,r){this.app.mark("editing shape"),this.app.setEditingId(n.id),this.parent.transition("editing_shape",r)}createTextShapeAtPoint(n){this.app.mark("creating text shape");const r=Ut(),{x:o,y:i}=this.app.inputs.currentPagePoint;this.app.createShapes([{id:r,type:"text",x:o,y:i,props:{text:"",autoSize:!0}}]);const s=this.app.getShapeById(r);if(!s)return;const a=this.app.getBounds(s);this.app.updateShapes([{id:r,type:"text",x:s.x-a.width/2,y:s.y-a.height/2}]),this.app.setEditingId(r),this.app.select(r),this.parent.transition("editing_shape",n)}nudgeSelectedShapes(n=!1){const{app:{inputs:{keys:r}}}=this,o=r.has("Shift"),i=new I(0,0);r.has("ArrowLeft")&&(i.x-=1),r.has("ArrowRight")&&(i.x+=1),r.has("ArrowUp")&&(i.y-=1),r.has("ArrowDown")&&(i.y+=1),!i.equals(new I(0,0))&&(n||this.app.mark("nudge shapes"),this.app.nudgeShapes(this.app.selectedIds,i,o))}},y(Um,"id","idle"),Um);class lC extends ye{constructor(){super(...arguments);y(this,"onEnter",()=>{const{inputs:n}=this.app;n.shiftKey||this.app.selectedIds.length>0&&(this.app.mark("selecting none"),this.app.selectNone())});y(this,"onPointerMove",n=>{this.app.inputs.isDragging&&this.parent.transition("brushing",n)});y(this,"onPointerUp",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()});y(this,"onInterrupt",()=>{this.parent.transition("idle",{})})}_clickWasInsideFocusedGroup(){const{focusLayerId:n,inputs:r}=this.app;if(!vr(n))return!1;const o=this.app.getShapeById(n);if(!o)return!1;const i=this.app.getPointInShapeSpace(o,r.currentPagePoint);return this.app.getShapeUtil(o).hitTestPoint(o,i)}complete(){const{shiftKey:n}=this.app.inputs;n||(this.app.selectNone(),this._clickWasInsideFocusedGroup()||this.app.setFocusLayer(null)),this.parent.transition("idle",{})}}y(lC,"id","pointing_canvas");class cC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"onEnter",n=>{this.info=n;const r=this.app.selectedShapes[0];r&&(this.updateCursor(r),this.app.setCroppingId(r.id))});y(this,"onPointerMove",()=>{this.app.inputs.isDragging&&this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})});y(this,"onPointerUp",()=>{this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,this.info):(this.app.setCroppingId(null),this.parent.transition("idle",{}))});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.cancel()});y(this,"onInterrupt",()=>{this.cancel()})}updateCursor(n){const r=Wa[this.info.handle];this.app.setCursor({type:r,rotation:n.rotation})}cancel(){this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,this.info):(this.app.setCroppingId(null),this.parent.transition("idle",{}))}}y(cC,"id","pointing_crop_handle");class uC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"onEnter",n=>{this.info=n;const r=n.shape.props[n.handle.id];(r==null?void 0:r.type)==="binding"&&this.app.setHintingIds([r.boundShapeId]),this.app.setCursor({type:"grabbing"})});y(this,"onExit",()=>{this.app.setHintingIds([]),this.app.setCursor({type:"default"})});y(this,"onPointerUp",()=>{this.parent.transition("idle",this.info)});y(this,"onPointerMove",()=>{this.app.inputs.isDragging&&this.parent.transition("dragging_handle",this.info)});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.cancel()});y(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle",{})}}y(uC,"id","pointing_handle");class dC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"onEnter",n=>{this.info=n,this.updateCursor()});y(this,"onPointerMove",()=>{const{isDragging:n}=this.app.inputs;n&&this.parent.transition("rotating",this.info)});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.cancel()});y(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const{selectionRotation:n}=this.app;this.app.setCursor({type:Wa[this.info.handle],rotation:n})}complete(){this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}y(dC,"id","pointing_rotate_handle");class hC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"onEnter",n=>{this.info=n});y(this,"onPointerUp",n=>{this.app.selectNone(),this.parent.transition("idle",n)});y(this,"onPointerMove",n=>{if(this.app.inputs.isDragging){if(this.app.isReadOnly)return;this.parent.transition("translating",n)}});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.cancel()});y(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle",{})}}y(hC,"id","pointing_selection");class pC extends ye{constructor(){super(...arguments);y(this,"eventTargetShape",{});y(this,"selectingShape",{});y(this,"didSelectOnEnter",!1);y(this,"onEnter",n=>{var s;if(this.eventTargetShape=n.shape,this.selectingShape=this.app.getOutermostSelectableShape(n.shape),this.app.getShapeUtil(n.shape).onClick||this.selectingShape.id===this.app.focusLayerId){this.didSelectOnEnter=!1;return}const o=this.app.isWithinSelection(this.selectingShape.id),i=this.app.selectedIds.length>1&&((s=this.app.selectionBounds)==null?void 0:s.containsPoint(this.app.inputs.currentPagePoint));if(this.didSelectOnEnter=!o&&this.selectingShape.id!==this.app.focusLayerId&&!i,this.didSelectOnEnter){const{inputs:a,selectedIds:l}=this.app,c=this.app.getParentShape(n.shape);c&&c.type==="group"&&this.app.cancelDoubleClick(),a.shiftKey&&!a.altKey?l.includes(this.selectingShape.id)||(this.app.mark("shift selecting shape"),this.app.setSelectedIds([...l,this.selectingShape.id])):(this.app.mark("selecting shape"),this.app.setSelectedIds([this.selectingShape.id]))}});y(this,"onPointerUp",n=>{var o;const{shape:r}=n;if(r){const i=this.app.getShapeUtil(r);if(i.onClick){const s=(o=i.onClick)==null?void 0:o.call(i,r);if(s){this.app.updateShapes([s]),this.parent.transition("idle",n);return}}}if(!this.didSelectOnEnter&&this.selectingShape.id!==this.app.focusLayerId){this.app.mark("selecting shape (pointer up)");const i=this.app.getOutermostSelectableShape(this.eventTargetShape,s=>!this.app.isSelected(s.id));if(this.app.selectedIds.includes(i.id))this.app.setSelectedIds(this.app.inputs.shiftKey?this.app.selectedIds.filter(s=>s!==this.selectingShape.id):[this.selectingShape.id]);else if(this.app.inputs.shiftKey){const s=this.app.getAncestors(i);this.app.setSelectedIds([...this.app.selectedIds.filter(a=>!s.find(l=>l.id===a)),i.id])}else this.app.setSelectedIds([i.id])}else this.selectingShape.id===this.app.focusLayerId&&(this.app.selectedIds.length>0?this.app.setSelectedIds([]):this.app.popFocusLayer());this.parent.transition("idle",n)});y(this,"onPointerMove",n=>{if(this.app.inputs.isDragging){if(this.app.isReadOnly)return;this.parent.transition("translating",n)}});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.cancel()});y(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle",{})}}y(pC,"id","pointing_shape");class fC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"markId","");y(this,"creationCursorOffset",{x:0,y:0});y(this,"editAfterComplete",!1);y(this,"snapshot",{});y(this,"onEnter",n=>{const{isCreating:r=!1,editAfterComplete:o=!1,creationCursorOffset:i={x:0,y:0}}=n;this.info=n,this.editAfterComplete=o,this.creationCursorOffset=i,n.isCreating&&this.app.setCursor({type:"cross",rotation:0}),this.snapshot=this._createSnapshot(),this.markId=r?"creating":this.app.mark("starting resizing"),this.handleResizeStart(),this.updateShapes()});y(this,"onPointerMove",()=>{this.updateShapes()});y(this,"onKeyDown",()=>{this.updateShapes()});y(this,"onKeyUp",()=>{this.updateShapes()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"onExit",()=>{this.app.snaps.clear()});y(this,"_createSnapshot",()=>{const{selectedIds:n,selectionRotation:r,inputs:{originPagePoint:o}}=this.app,i=this.app.selectionBounds,s=I.RotWith(i.getHandlePoint(this.info.handle),i.point,r),a=I.Sub(o,s),l=new Map;n.forEach(d=>{const u=this.app.getShapeById(d);if(u){if(l.set(u.id,this._createShapeSnapshot(u)),u.type==="frame"&&n.length===1)return;this.app.visitDescendants(u.id,h=>{const p=this.app.getShapeById(h);if(p&&(l.set(p.id,this._createShapeSnapshot(p)),p.type==="frame"))return!1})}});const c=![...l.values()].some(d=>!MI(d.pageRotation,r)||d.isAspectRatioLocked);return{shapeSnapshots:l,selectionBounds:i,cursorHandleOffset:a,selectionRotation:r,selectedIds:n,canShapesDeform:c,initialSelectionPageBounds:this.app.selectedPageBounds}});y(this,"_createShapeSnapshot",n=>{const r=this.app.getPageTransform(n),o=this.app.getShapeUtil(n);return{shape:n,bounds:o.bounds(n),pageTransform:r,pageRotation:ee.Decompose(r).rotation,isAspectRatioLocked:o.isAspectRatioLocked(n)}})}cancel(){this.app.bailToMark(this.markId),this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}complete(){if(this.handleResizeEnd(),this.editAfterComplete&&this.app.onlySelectedShape){this.app.setEditingId(this.app.onlySelectedShape.id),this.app.setSelectedTool("select"),this.app.root.current.value.transition("editing_shape",{});return}if(this.app.instanceState.isToolLocked&&this.info.onInteractionEnd){this.app.setSelectedTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle",{})}handleResizeStart(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:o})=>{var a;const i=this.app.getShapeUtil(o),s=(a=i.onResizeStart)==null?void 0:a.call(i,o);s&&r.push(s)}),r.length>0&&this.app.updateShapes(r)}handleResizeEnd(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:o})=>{var l;const i=this.app.getShapeById(o.id),s=this.app.getShapeUtil(o),a=(l=s.onResizeEnd)==null?void 0:l.call(s,o,i);a&&r.push(a)}),r.length>0&&this.app.updateShapes(r)}updateShapes(){const{altKey:n,shiftKey:r}=this.app.inputs,{shapeSnapshots:o,selectionBounds:i,cursorHandleOffset:s,selectedIds:a,selectionRotation:l,canShapesDeform:c}=this.snapshot,d=r||!c,{ctrlKey:u}=this.app.inputs,h=this.app.inputs.currentPagePoint.clone().sub(s).sub(this.creationCursorOffset),p=this.app.inputs.originPagePoint.clone().sub(s);this.app.isGridMode&&!u&&h.snapToGrid(this.app.gridSize);const g=this.info.handle,m=uS(g,Math.PI);if(this.app.snaps.clear(),(this.app.userDocumentSettings.isSnapMode?!u:u)&&l%Ye===0){const{nudge:$}=this.app.snaps.snapResize({dragDelta:I.Sub(h,p),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:uS(g,l),isAspectRatioLocked:d,isResizingFromCenter:n});h.add($)}const x=I.RotWith(n?i.center:i.getHandlePoint(m),i.point,l),b=I.Sub(h,x).rot(-l),E=I.Sub(p,x).rot(-l),P=I.DivV(b,E);Number.isFinite(P.x)||(P.x=1),Number.isFinite(P.y)||(P.y=1);const C=g==="top"||g==="bottom",k=g==="left"||g==="right";d?k?P.y=Math.abs(P.x):C?P.x=Math.abs(P.y):Math.abs(P.x)>Math.abs(P.y)?P.y=Math.abs(P.x)*(P.y<0?-1:1):P.x=Math.abs(P.y)*(P.x<0?-1:1):(C&&(P.x=1),k&&(P.y=1)),this.info.isCreating||this.updateCursor({dragHandle:g,isFlippedX:P.x<0,isFlippedY:P.y<0,rotation:l});for(const $ of o.keys()){const A=o.get($);this.app.resizeShape($,P,{initialBounds:A.bounds,dragHandle:g,initialPageTransform:A.pageTransform,initialShape:A.shape,mode:a.length===1&&$===a[0]?"resize_bounds":"scale_shape",scaleOrigin:x,scaleAxisRotation:l})}}updateCursor({dragHandle:n,isFlippedX:r,isFlippedY:o,rotation:i}){const s={...this.app.cursor};switch(n){case"top_left":case"bottom_right":{s.type="nwse-resize",r!==o&&(s.type="nesw-resize");break}case"top_right":case"bottom_left":{s.type="nesw-resize",r!==o&&(s.type="nwse-resize");break}}s.rotation=i,this.app.setCursor(s)}}y(fC,"id","resizing");const $g=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function uS(t,e){e=e%dt;const n=Math.round(e/(ct/4)),r=$g.indexOf(t);return $g[(r+n)%$g.length]}class gC extends ye{constructor(){super(...arguments);y(this,"snapshot",{});y(this,"info",{});y(this,"markId","");y(this,"onEnter",n=>{this.info=n,this.markId=this.app.mark("rotate start"),this.snapshot=Y2({app:this.app}),this.handleStart()});y(this,"onExit",()=>{this.app.setCursor({type:"none"}),this.snapshot={}});y(this,"onPointerMove",()=>{this.update()});y(this,"onKeyDown",()=>{this.update()});y(this,"onKeyUp",()=>{this.update()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"update",()=>{const n=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Hd({app:this.app,delta:n,snapshot:this.snapshot,stage:"update"}),this.app.setCursor({type:Wa[this.info.handle],rotation:n+this.snapshot.initialSelectionRotation})});y(this,"cancel",()=>{this.app.bailToMark(this.markId),this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)});y(this,"complete",()=>{Hd({app:this.app,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)})}handleStart(){const n=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Hd({app:this.app,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.app.setCursor({type:Wa[this.info.handle],rotation:n+this.snapshot.initialSelectionRotation})}_getRotationFromPointerPosition({snapToNearestDegree:n}){const{selectionPageCenter:r,inputs:{shiftKey:o,currentPagePoint:i}}=this.app,{initialCursorAngle:s,initialSelectionRotation:a}=this.snapshot,l=r.angle(i)-s;let c=a+l;if(o)c=Th(c,24);else if(n&&(c=Math.round(c/a1)*a1,this.app.isCoarsePointer)){const d=Th(c,4),u=$I(c,d);Math.abs(u)<O8(5)&&(c=d)}return c-a}}y(gC,"id","rotating");class xy extends ye{constructor(){super(...arguments);y(this,"hits",new Set);y(this,"size",0);y(this,"scribble",{});y(this,"initialSelectedIds",new Set);y(this,"newlySelectedIds",new Set);y(this,"onEnter",()=>{this.initialSelectedIds=new Set(this.app.inputs.shiftKey?this.app.selectedIds:[]),this.newlySelectedIds=new Set,this.size=0,this.hits.clear(),this.startScribble(),this.updateBrushSelection(),requestAnimationFrame(()=>{this.app.setBrush(null)})});y(this,"onExit",()=>{this.app.setErasingIds([]),this.scribble.stop()});y(this,"onPointerMove",()=>{this.updateBrushSelection()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onKeyDown",()=>{this.updateBrushSelection()});y(this,"onKeyUp",()=>{this.app.inputs.altKey?this.updateBrushSelection():this.parent.transition("brushing",{})});y(this,"startScribble",()=>{this.scribble=new Q2({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"selection-stroke",opacity:.32,size:12}),this.app.on("tick",this.scribble.tick)});y(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.app.inputs.currentPagePoint;this.scribble.addPoint(n,r)});y(this,"onScribbleUpdate",n=>{this.app.setScribble(n)});y(this,"onScribbleComplete",()=>{this.app.off("tick",this.scribble.tick),this.app.setScribble(null)});y(this,"onCancel",()=>{this.cancel()});y(this,"onComplete",()=>{this.complete()})}updateBrushSelection(){const{shapesArray:n,inputs:{originPagePoint:r,previousPagePoint:o,currentPagePoint:i}}=this.app;this.pushPointToScribble();const s=n;let a,l;for(let c=0,d=s.length;c<d;c++)if(a=s[c],l=this.app.getShapeUtil(a),!(a.type==="group"||this.newlySelectedIds.has(a.id)||a.type==="frame"&&l.hitTestPoint(a,this.app.getPointInShapeSpace(a,r)))&&l.hitTestLineSegment(a,this.app.getPointInShapeSpace(a,o),this.app.getPointInShapeSpace(a,i))){const u=this.app.getOutermostSelectableShape(a),h=this.app.getPageMaskById(u.id);if(h&&kv(o,i,h)!==null&&!$r(i,h))continue;this.newlySelectedIds.add(u.id)}this.app.setSelectedIds([...new Set([...this.newlySelectedIds,...this.initialSelectedIds])],!0)}complete(){this.parent.transition("idle",{})}cancel(){this.app.setSelectedIds([...this.initialSelectedIds],!0),this.parent.transition("idle",{})}}y(xy,"id","scribble_brushing"),y(xy,"canActivateInReadOnly",!0);const dS=100;class $9{constructor(e){y(this,"prevDroppingShapeId",null);y(this,"currDroppingShapeId",null);y(this,"droppingNodeTimer",null);y(this,"dispose",()=>{this.clear()});this.app=e,e.disposables.add(this.dispose)}updateDroppingNode(e,n){var r;if(this.droppingNodeTimer===null){const{currentPagePoint:o}=this.app.inputs;this.currDroppingShapeId=((r=this.app.getDroppingShape(o,e))==null?void 0:r.id)??null,this.setDragTimer(e,dS*10,n)}else this.app.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(e,dS,n))}setDragTimer(e,n,r){this.droppingNodeTimer=setTimeout(()=>{this.app.batch(()=>{this.handleDrag(e,r)}),this.droppingNodeTimer=null},n)}handleDrag(e,n){var l,c,d,u,h;const{currentPagePoint:r}=this.app.inputs;e=Ee(e.map(p=>this.app.getShapeById(p.id)));const o=((l=this.app.getDroppingShape(r,e))==null?void 0:l.id)??null;o!==this.currDroppingShapeId&&(this.prevDroppingShapeId=this.currDroppingShapeId,this.currDroppingShapeId=o);const{prevDroppingShapeId:i}=this;if(o===i)return;const s=i&&this.app.getShapeById(i),a=o&&this.app.getShapeById(o);if(this.prevDroppingShapeId=this.currDroppingShapeId,s&&((d=(c=this.app.getShapeUtil(s)).onDragShapesOut)==null||d.call(c,s,e)),a){const p=(h=(u=this.app.getShapeUtil(a)).onDragShapesOver)==null?void 0:h.call(u,a,e);p&&p.shouldHint&&this.app.setHintingIds([a.id])}else this.app.setHintingIds([]);n==null||n()}dropShapes(e){var r,o;const{currDroppingShapeId:n}=this;if(this.handleDrag(e),n){const i=this.app.getShapeById(n);if(!i)return;(o=(r=this.app.getShapeUtil(i)).onDropShapesOver)==null||o.call(r,i,e)}}clear(){this.prevDroppingShapeId=null,this.currDroppingShapeId=null,this.droppingNodeTimer!==null&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.app.setHintingIds([])}}class mC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"selectionSnapshot",{});y(this,"snapshot",{});y(this,"markId","");y(this,"isCloning",!1);y(this,"isCreating",!1);y(this,"editAfterComplete",!1);y(this,"dragAndDropManager",new $9(this.app));y(this,"onEnter",n=>{const{isCreating:r=!1,editAfterComplete:o=!1}=n;this.info=n,this.isCreating=r,this.editAfterComplete=o,this.markId=r?"creating":this.app.mark("translating"),this.handleEnter(n),this.app.on("tick",this.updateParent)});y(this,"updateParent",()=>{const{snapshot:n}=this;this.dragAndDropManager.updateDroppingNode(n.movingShapes,this.updateParentTransforms)});y(this,"onExit",()=>{this.app.off("tick",this.updateParent),this.selectionSnapshot={},this.snapshot={},this.app.snaps.clear(),this.app.setCursor({type:"default"}),this.dragAndDropManager.clear()});y(this,"onPointerMove",()=>{this.updateShapes()});y(this,"onKeyDown",()=>{if(this.app.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()});y(this,"onKeyUp",()=>{if(!this.app.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onComplete",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()});y(this,"updateParentTransforms",()=>{const{app:n,snapshot:{shapeSnapshots:r}}=this;r.forEach(o=>{const i=n.getShapeById(o.shape.id);if(!i)return null;const s=it.isId(i.parentId)?null:ee.Inverse(n.getPageTransformById(i.parentId));o.parentTransform=s})})}reset(){this.app.bailToMark(this.markId)}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId=this.app.mark("translating"),this.app.duplicateShapes(),this.snapshot=hS(this.app),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId=this.app.mark("translating"),this.updateShapes()}complete(){if(this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.app.instanceState.isToolLocked&&this.info.onInteractionEnd)this.app.setSelectedTool(this.info.onInteractionEnd);else if(this.editAfterComplete){const n=this.app.onlySelectedShape;n&&(this.app.setEditingId(n.id),this.app.setSelectedTool("select"),this.app.root.current.value.transition("editing_shape",{}))}else this.parent.transition("idle",{})}cancel(){this.reset(),this.info.onInteractionEnd?this.app.setSelectedTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleEnter(n){if(this.isCloning=!1,this.info=n,this.app.setCursor({type:"move"}),this.selectionSnapshot=hS(this.app),!this.isCreating&&this.app.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()}handleStart(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(o=>{var a;const i=this.app.getShapeUtil(o),s=(a=i.onTranslateStart)==null?void 0:a.call(i,o);s&&r.push(s)}),r.length>0&&this.app.updateShapes(r)}handleEnd(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(o=>{var l;const i=this.app.getShapeById(o.id),s=this.app.getShapeUtil(o),a=(l=s.onTranslateEnd)==null?void 0:l.call(s,o,i);a&&r.push(a)}),r.length>0&&this.app.updateShapes(r)}handleChange(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(o=>{var l;const i=this.app.getShapeById(o.id),s=this.app.getShapeUtil(o),a=(l=s.onTranslate)==null?void 0:l.call(s,o,i);a&&r.push(a)}),r.length>0&&this.app.updateShapes(r)}updateShapes(){const{snapshot:n}=this;this.dragAndDropManager.updateDroppingNode(n.movingShapes,this.updateParentTransforms),T9({app:this.app,shapeSnapshots:n.shapeSnapshots,averagePagePoint:n.averagePagePoint,initialSelectionPageBounds:n.initialPageBounds,initialSelectionSnapPoints:n.initialSnapPoints}),this.handleChange()}}y(mC,"id","translating");function hS(t){const e=[],n=[],r=Ee(t.selectedIds.map(o=>{const i=t.getShapeById(o);if(!i)return null;e.push(i);const s=t.getPagePointById(o);if(!s)return null;n.push(s);const a=it.isId(i.parentId)?null:ee.Inverse(t.getPageTransformById(i.parentId));return{shape:i,pagePoint:s,parentTransform:a}}));return{averagePagePoint:I.Average(n),movingShapes:e,shapeSnapshots:r,initialPageBounds:t.selectedPageBounds,initialSnapPoints:t.selectedIds.length===1?t.snaps.snapPointsCache.get(t.selectedIds[0]):t.selectedPageBounds?t.selectedPageBounds.snapPoints.map((o,i)=>({id:"selection:"+i,x:o.x,y:o.y})):[]}}function T9({app:t,shapeSnapshots:e,averagePagePoint:n,initialSelectionPageBounds:r,initialSelectionSnapPoints:o}){const{inputs:i,isGridMode:s,gridSize:a}=t,l=I.Sub(i.currentPagePoint,i.originPagePoint),c=t.inputs.shiftKey?Math.abs(l.x)<Math.abs(l.y)?"x":"y":null;if(c==="x"?l.x=0:c==="y"&&(l.y=0),t.snaps.clear(),(t.userDocumentSettings.isSnapMode?!i.ctrlKey:i.ctrlKey)&&t.inputs.pointerVelocity.len()<.5){const{nudge:p}=t.snaps.snapTranslate({dragDelta:l,initialSelectionPageBounds:r,lockedAxis:c,initialSelectionSnapPoints:o});l.add(p)}const u=I.Add(n,l);s&&!i.ctrlKey&&u.snapToGrid(a);const h=I.Sub(u,n);t.updateShapes(Ee(e.map(({shape:p,pagePoint:g,parentTransform:m})=>{const v=I.Add(g,h),x=m?ee.applyToPoint(m,v):v;return{id:p.id,type:p.type,x:x.x,y:x.y}})),!0)}class Jd extends ye{constructor(){super(...arguments);y(this,"styles",["color","opacity","dash","fill","size"]);y(this,"onExit",()=>{this.app.pageState.editingId&&this.app.setEditingId(null)})}}y(Jd,"id","select"),y(Jd,"initial","idle"),y(Jd,"children",()=>[Zd,iC,k9,lC,pC,mC,eC,xy,cC,hC,oC,aC,fC,gC,dC,uC,sC]);var Fm;let M9=(Fm=class extends ye{constructor(){super(...arguments);y(this,"onPointerEnter",n=>{switch(n.target){case"canvas":break;case"shape":{const{selectedIds:r,focusLayerId:o}=this.app,i=this.app.getOutermostSelectableShape(n.shape,s=>!r.includes(s.id));i.id!==o&&i.type==="text"&&this.app.setHoveredId(i.id);break}}});y(this,"onPointerLeave",n=>{switch(n.target){case"shape":{this.app.setHoveredId(null);break}}});y(this,"onPointerDown",n=>{const{hoveredId:r}=this.app;if(r){const o=this.app.getShapeById(r);if(o.type==="text"){requestAnimationFrame(()=>{this.app.setSelectedIds([o.id]),this.app.setEditingId(o.id),this.app.setSelectedTool("select.editing_shape",{...n,target:"shape",shape:o})});return}}this.parent.transition("pointing",n)});y(this,"onEnter",()=>{this.app.setCursor({type:"cross"})});y(this,"onKeyDown",n=>{if(n.key==="Enter"){const r=this.app.selectedShapes[0];r&&r.type==="geo"&&(this.app.setSelectedTool("select"),this.app.setEditingId(r.id),this.app.root.current.value.transition("editing_shape",{...n,target:"shape",shape:r}))}});y(this,"onCancel",()=>{this.app.setSelectedTool("select")})}},y(Fm,"id","idle"),Fm);var Km;let A9=(Km=class extends ye{constructor(){super(...arguments);y(this,"shape");y(this,"onExit",()=>{this.app.setHintingIds([])});y(this,"onPointerMove",n=>{if(this.app.inputs.isDragging){const{inputs:{originPagePoint:r}}=this.app,o=Ut();if(this.app.mark("creating"),this.app.createShapes([{id:o,type:"text",x:r.x,y:r.y,props:{text:"",autoSize:!1,w:20}}]),this.app.select(o),this.shape=this.app.getShapeById(o),!this.shape)return;this.app.setSelectedTool("select.resizing",{...n,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},editAfterComplete:!0,onInteractionEnd:"text"})}});y(this,"onPointerUp",()=>{this.complete()});y(this,"onComplete",()=>{this.cancel()});y(this,"onCancel",()=>{this.cancel()});y(this,"onInterrupt",()=>{this.cancel()})}complete(){var i;this.app.mark("creating text shape");const n=Ut(),{x:r,y:o}=this.app.inputs.currentPagePoint;this.app.createShapes([{id:n,type:"text",x:r,y:o,props:{text:"",autoSize:!0}}],!0),this.app.setEditingId(n),this.app.setSelectedTool("select"),(i=this.app.root.current.value)==null||i.transition("editing_shape",{})}cancel(){this.parent.transition("idle",{}),this.app.bailToMark("creating")}},y(Km,"id","pointing"),Km);class eh extends ye{constructor(){super(...arguments);y(this,"styles",["color","opacity","font","align","size"])}}y(eh,"id","text"),y(eh,"initial","idle"),y(eh,"children",()=>[M9,A9]);class yC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"onEnter",n=>{this.info=n});y(this,"onPointerDown",()=>{this.parent.transition("pointing",this.info)})}}y(yC,"id","idle");class vC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"onEnter",n=>{this.info=n});y(this,"onPointerUp",()=>{this.complete()});y(this,"onPointerMove",()=>{this.app.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)});y(this,"onCancel",()=>{this.cancel()})}complete(){const{currentScreenPoint:n}=this.app.inputs;this.app.inputs.altKey?this.app.zoomOut(n,{duration:220}):this.app.zoomIn(n,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}y(vC,"id","pointing");class wC extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"zoomBrush",new de);y(this,"onEnter",n=>{this.info=n,this.update()});y(this,"onExit",()=>{this.app.setZoomBrush(null)});y(this,"onPointerMove",()=>{this.update()});y(this,"onPointerUp",()=>{this.complete()});y(this,"onCancel",()=>{this.cancel()})}update(){const{inputs:{originPagePoint:n,currentPagePoint:r}}=this.app;this.zoomBrush.setTo(de.FromPoints([n,r])),this.app.setZoomBrush(this.zoomBrush.toJson())}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:n}=this,r=8/this.app.zoomLevel;if(n.width<r&&n.height<r){const o=this.app.inputs.currentScreenPoint;this.app.inputs.altKey?this.app.zoomOut(o,{duration:220}):this.app.zoomIn(o,{duration:220})}else{const o=this.app.inputs.altKey?this.app.zoomLevel/2:void 0;this.app.zoomToBounds(n.x,n.y,n.width,n.height,o,{duration:220})}this.parent.transition("idle",this.info)}}y(wC,"id","zoom_brushing");class th extends ye{constructor(){super(...arguments);y(this,"info",{});y(this,"onEnter",n=>{this.info=n,this.updateCursor()});y(this,"onExit",()=>{this.app.setZoomBrush(null),this.app.setCursor({type:"default"})});y(this,"onKeyDown",()=>{this.updateCursor()});y(this,"onKeyUp",n=>{this.updateCursor(),n.code==="KeyZ"&&this.complete()});y(this,"onInterrupt",()=>{this.complete()})}updateCursor(){this.app.inputs.altKey?this.app.setCursor({type:"zoom-out"}):this.app.setCursor({type:"zoom-in"})}complete(){this.info.onInteractionEnd&&this.info.onInteractionEnd!=="select"?this.app.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("select",{})}}y(th,"id","zoom"),y(th,"initial","idle"),y(th,"children",()=>[yC,wC,vC]);class nh extends ye{constructor(){super(...arguments);y(this,"onKeyDown",n=>{var r;switch(n.code){case"KeyZ":{if(!(n.shiftKey||n.ctrlKey)){const o=this.current.value;o&&((r=o.current.value)==null?void 0:r.id)==="idle"&&this.app.setSelectedTool("zoom",{...n,onInteractionEnd:o.id})}break}}})}}y(nh,"id","root"),y(nh,"initial","select"),y(nh,"children",()=>[Jd,Gd,Yd,Wd,eh,qd,Vd,Xd,Qd,wy,th]);var R9=Object.defineProperty,L9=Object.getOwnPropertyDescriptor,_e=(t,e,n,r)=>{for(var o=r>1?void 0:r?L9(e,n):e,i=t.length-1,s;i>=0;i--)(s=t[i])&&(o=(r?s(e,n,o):s(o))||o);return r&&o&&R9(e,n,o),o};function D9(t){return t.type==="arrow"||t.type==="line"||t.type==="draw"}var Hm;const xC=(Hm=class extends J8.EventEmitter{constructor({config:e=_i.default,store:n,getContainer:r}){super();y(this,"store");y(this,"config");y(this,"root");y(this,"_shapeIds");y(this,"disposables",new Set);y(this,"_dprManager",new n9(this));y(this,"_cameraManager",new JF(this));y(this,"_activeAreaManager",new QF(this));y(this,"_tickManager",new u9(this));y(this,"_updateDepth",0);y(this,"snaps",new wu(this));y(this,"isSafari");y(this,"isIos");y(this,"isChromeForIos");y(this,"_canMoveCamera",lt("can move camera",!0));y(this,"_isFocused",lt("_isFocused",!1));y(this,"getContainer");y(this,"_crashingError",null);y(this,"_openMenus",lt("open-menus",[]));y(this,"addOpenMenu",e=>{const n=new Set(this.openMenus);return n.has(e)||(n.add(e),this._openMenus.set([...n])),this});y(this,"deleteOpenMenu",e=>{const n=new Set(this.openMenus);return n.has(e)&&(n.delete(e),this._openMenus.set([...n])),this});y(this,"_isCoarsePointer",lt("isCoarsePointer",!1));y(this,"_isChangingStyle",lt("isChangingStyle",!1));y(this,"_isChangingStyleTimeout",-1);y(this,"_parentIdsToChildIds");y(this,"history",new o9(this,()=>this._complete(),e=>{this.annotateError(e,{origin:"history.batch",willCrashApp:!0}),this.crash(e)}));y(this,"shapeUtils");y(this,"_childIdsCache",new cl);y(this,"_selectionSharedProps",ue("_selectionSharedProps",()=>{const{selectedShapes:e}=this,n={};for(let r=0,o=e.length;r<o;r++)this._extractSharedProps(e[r],n);return n}));y(this,"_prevProps",{});y(this,"_invalidParents",new Set);y(this,"_isReadOnly",lt("isReadOnly",!1));y(this,"_isPenMode",lt("isPenMode",!1));y(this,"_touchEventsRemainingBeforeExitingPenMode",0);y(this,"_cullingBounds",lt("culling viewport",new de));y(this,"_cullingBoundsExpanded",lt("culling viewport expanded",new de));y(this,"_setFocusLayer",this.history.createCommand("setFocusLayer",e=>e===null&&!this.canUndo?void 0:{data:{prev:this.pageState.focusLayerId,next:e},preservesRedoStack:!0,squashing:!0},{do:({next:e})=>{this.store.update(this.pageState.id,n=>({...n,focusLayerId:e}))},undo:({prev:e})=>{this.store.update(this.pageState.id,n=>({...n,focusLayerId:e}))},squash({prev:e},{next:n}){return{prev:e,next:n}}}));y(this,"colors");y(this,"sizes",{s:2,m:3.5,l:5,xl:10});y(this,"inputs",{originPagePoint:new I,originScreenPoint:new I,previousPagePoint:new I,previousScreenPoint:new I,currentPagePoint:new I,currentScreenPoint:new I,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new I});y(this,"_clickManager",new t9(this));y(this,"_prevCursor","default");y(this,"_shiftKeyTimeout",-1);y(this,"_setShiftKeyTimeout",()=>{this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ShiftLeft"})});y(this,"_altKeyTimeout",-1);y(this,"_setAltKeyTimeout",()=>{this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"AltLeft"})});y(this,"_ctrlKeyTimeout",-1);y(this,"_setCtrlKeyTimeout",()=>{this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"CtrlLeft"})});y(this,"_restoreToolId","select");y(this,"_pinchStart",1);y(this,"_didPinch",!1);y(this,"_selectedIdsAtPointerDown",[]);y(this,"dispatch",e=>{if(this.crashingError)return this;const{inputs:n}=this,{type:r}=e;return this.batch(()=>{if(e.type==="misc"){(e.name==="cancel"||e.name==="complete")&&(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor}))),this.root.handleEvent(e);return}e.shiftKey?(clearInterval(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,n.shiftKey=!0):!e.shiftKey&&n.shiftKey&&this._shiftKeyTimeout===-1&&(this._shiftKeyTimeout=setTimeout(this._setShiftKeyTimeout,150)),e.altKey?(clearInterval(this._altKeyTimeout),this._altKeyTimeout=-1,n.altKey=!0):!e.altKey&&n.altKey&&this._altKeyTimeout===-1&&(this._altKeyTimeout=setTimeout(this._setAltKeyTimeout,150)),e.ctrlKey?(clearInterval(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,n.ctrlKey=!0):!e.ctrlKey&&n.ctrlKey&&this._ctrlKeyTimeout===-1&&(this._ctrlKeyTimeout=setTimeout(this._setCtrlKeyTimeout,150));const{originPagePoint:o,originScreenPoint:i,currentPagePoint:s,currentScreenPoint:a}=n;switch(n.isPointing||(n.isDragging=!1),r){case"pinch":{if(!this.canMoveCamera)return;switch(this._updateInputsFromEvent(e),e.name){case"pinch_start":{if(n.isPinching)return;n.isEditing||(this._pinchStart=this.camera.z,this._selectedIdsAtPointerDown.length||(this._selectedIdsAtPointerDown=this.selectedIds.slice()),this._didPinch=!0,n.isPinching=!0,this.interrupt());return}case"pinch":{if(!n.isPinching)return;const{point:{x:l,y:c,z:d=1},delta:{x:u,y:h}}=e,{camera:{x:p,y:g,z:m}}=this,v=Math.min(gi,Math.max(kl,d));this.setCamera(p+u/m-l/m+l/v,g+h/m-c/m+c/v,v);return}case"pinch_end":{if(!n.isPinching)return this;n.isPinching=!1;const{_selectedIdsAtPointerDown:l}=this;this.setSelectedIds(this._selectedIdsAtPointerDown,!0),this._selectedIdsAtPointerDown=[];const{camera:{x:c,y:d,z:u}}=this;let h;if(u>.9&&u<1.05?h=1:u>.49&&u<.505&&(h=.5),u>this._pinchStart-.1&&u<this._pinchStart+.05&&(h=this._pinchStart),h!==void 0){const{x:p,y:g}=this.viewportScreenCenter;this.animateCamera(c+(p/h-p)-(p/u-p),d+(g/h-g)-(g/u-g),h,{duration:100})}this._didPinch&&(this._didPinch=!1,requestAnimationFrame(()=>{this._didPinch||this.setSelectedIds(l,!0)}));return}}}case"wheel":{if(!this.canMoveCamera)return;if(!this.isMenuOpen){if(n.ctrlKey){const{x:l,y:c}=this.inputs.currentScreenPoint,{x:d,y:u,z:h}=this.camera,p=Math.min(gi,Math.max(kl,h+(e.delta.z??0)*h));this.setCamera(d+(l/p-l)-(l/h-l),u+(c/p-c)-(c/h-c),p);return}this.pan(e.delta.x,e.delta.y),!n.isDragging&&n.isPointing&&o.dist(s)>(this.isCoarsePointer?hy:Ic)/this.zoomLevel&&(n.isDragging=!0)}break}case"pointer":{if(n.isPinching)return;this._updateInputsFromEvent(e);const{isPen:l}=e;switch(e.name){case"pointer_down":{if(this._selectedIdsAtPointerDown=this.selectedIds.slice(),n.buttons.add(e.button),n.isPointing=!0,n.isDragging=!1,this.isPenMode)if(l)this._touchEventsRemainingBeforeExitingPenMode=3;else if(this._touchEventsRemainingBeforeExitingPenMode--,this._touchEventsRemainingBeforeExitingPenMode===0)this.setPenMode(!1);else return;else l&&this.setPenMode(!0);if(e.button===5?(this._restoreToolId=this.currentToolId,this.complete(),this.setSelectedTool("eraser")):e.button===1&&(this.inputs.isPanning||(this._prevCursor=this.instanceState.cursor.type),this.inputs.isPanning=!0),this.inputs.isPanning)return this.stopCameraAnimation(),this.setCursor({type:"grabbing"}),this;i.setTo(a),o.setTo(s);break}case"pointer_move":{if(!l&&this.isPenMode)return;if(this.inputs.isPanning&&this.inputs.isPointing){const{currentScreenPoint:c,previousScreenPoint:d}=this.inputs,u=I.Sub(c,d);this.pan(u.x,u.y);return}!n.isDragging&&n.isPointing&&o.dist(s)>(this.isCoarsePointer?hy:Ic)/this.zoomLevel&&(n.isDragging=!0);break}case"pointer_up":{if(n.buttons.delete(e.button),n.isPointing=!1,n.isDragging=!1,this.isMenuOpen||!l&&this.isPenMode)return;n.isPanning?e.button===1?this.inputs.keys.has(" ")?(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:Ud}),this.setCursor({type:"grab"})):(n.isPanning=!1,this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:Ud}),this.setCursor({type:this._prevCursor})):e.button===0&&(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:Ud}),this.setCursor({type:"grab"})):e.button===5&&(this.complete(),this.setSelectedTool(this._restoreToolId));break}}break}case"keyboard":{switch(e.name){case"key_down":{n.keys.add(e.code),!e.ctrlKey&&e.code==="Space"&&(this.inputs.isPanning||(this._prevCursor=this.instanceState.cursor.type),this.inputs.isPanning=!0,this.setCursor({type:this.inputs.isPointing?"grabbing":"grab"}));break}case"key_up":{n.keys.delete(e.code),e.code==="Space"&&!this.inputs.buttons.has(1)&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor}));break}}break}}if(e.type==="pointer"&&(e.button===1?e.name="middle_click":e.button===2&&(e.name="right_click"),e.isPen===this.isPenMode))switch(e.name){case"pointer_down":{const l=this._clickManager.transformPointerDownEvent(e);if(e.name!==l.name){this.root.handleEvent(e),this.emit("event",e),this.root.handleEvent(l),this.emit("event",l);return}break}case"pointer_up":{const l=this._clickManager.transformPointerUpEvent(e);if(e.name!==l.name){this.root.handleEvent(e),this.emit("event",e),this.root.handleEvent(l),this.emit("event",l);return}break}case"pointer_move":{this._clickManager.handleMove();break}}this.root.handleEvent(e),this.emit("event",e)}),this});y(this,"_createShapes",this.history.createCommand("createShapes",(e,n=!1)=>{if(this.isReadOnly||e.length<=0)return null;const{shapeIds:r,selectedIds:o}=this,i=n?o:void 0,s=e.length+r.size>ls;s&&od(this);const a=s?e.slice(0,ls-r.size):e;return a.length===0?null:{data:{currentPageId:this.currentPageId,createdIds:e.map(l=>l.id),prevSelectedIds:i,partials:a,select:n}}},{do:({createdIds:e,partials:n,select:r})=>{var a,l;const{focusLayerId:o}=this;n=n.map(c=>{if(!c.parentId||!this.store.get(c.parentId)&&!n.find(d=>d.id===c.parentId)){c={...c};const d=this.getParentIdForNewShapeAtPoint({x:c.x??0,y:c.y??0},c.type);if(c.parentId=d,vr(d)){const u=this.getPointInShapeSpace(this.getShapeById(d),{x:c.x??0,y:c.y??0});c.x=u.x,c.y=u.y,c.rotation=-this.getPageRotationById(d)+(c.rotation??0)}return c}return c});const i=new Map,s=[];for(const c of n){const d=this.getShapeUtil(c);let u=c.index;if(!u){const v=c.parentId??o;i.has(v)||i.set(v,this.getHighestIndexForParent(v)),u=i.get(v),i.set(v,Oo(u))}const h=d.defaultProps(),{propsForNextShape:p}=this.instanceState;for(const v in h)if(v in p){if(v==="url")continue;h[v]=p[v]}let g=this.config.TLShape.create({...c,index:u,parentId:c.parentId??o,props:"props"in c?{...h,...c.props}:h});if(g.index===void 0)throw Error("no index!");const m=(l=(a=this.getShapeUtil(g)).onBeforeCreate)==null?void 0:l.call(a,g);m&&(g=m),s.push(g)}this.store.put(s),r&&this.store.update(this.pageState.id,c=>({...c,selectedIds:e}))},undo:({createdIds:e,prevSelectedIds:n})=>{this.store.remove(e),n&&this.store.update(this.pageState.id,r=>({...r,selectedIds:n}))}}));y(this,"animatingShapes",new Map);y(this,"_updateShapes",this.history.createCommand("updateShapes",(e,n=!1)=>{if(this.isReadOnly)return null;const r=Ee(e),o=Object.fromEntries(Ee(r.map(({id:a})=>this.getShapeById(a))).map(a=>[a.id,a]));if(r.length<=0)return null;const i=Ee(r.map(a=>{const l=o[a.id];if(!l)return null;let c=null;for(const[d,u]of Object.entries(a))switch(d){case"id":case"type":case"typeName":continue;default:u!==l[d]&&(c||(c={...l}),d==="props"?c.props={...l.props,...u}:c[d]=u)}return c??l})),s=Object.fromEntries(i.map(a=>[a.id,a]));return{data:{snapshots:o,updates:s},squashing:n}},{do:({updates:e})=>{var r,o;const n=Object.values(e);for(let i=0;i<n.length;i++){const s=n[i],a=this.store.get(s.id);if(!a)continue;const l=(o=(r=this.getShapeUtil(s)).onBeforeUpdate)==null?void 0:o.call(r,a,s);l&&(n[i]=l)}this.store.put(n)},undo:({snapshots:e})=>{this.store.put(Object.values(e))},squash(e,n){return{snapshots:{...n.snapshots,...e.snapshots},updates:{...e.updates,...n.updates}}}}));y(this,"_deleteShapes",this.history.createCommand("delete_shapes",e=>{if(this.isReadOnly||e.length===0)return null;const n=[...this.pageState.selectedIds],r=new Set(e);for(const l of e)this.visitDescendants(l,c=>{r.add(c)});const o=[...r],i=this._arrowBindingsIndex.value,s=Ee(o.flatMap(l=>{const c=this.getShapeById(l),d=i[l];return d&&d.length>0?d.map(({arrowId:u})=>this.getShapeById(u)).concat(c):c})),a=n.filter(l=>!r.has(l));return{data:{deletedIds:o,snapshots:s,prevSelectedIds:n,postSelectedIds:a}}},{do:({deletedIds:e,postSelectedIds:n})=>{this.store.remove(e),this.store.update(this.pageState.id,r=>({...r,selectedIds:n}))},undo:({snapshots:e,prevSelectedIds:n})=>{this.store.put(e),this.store.update(this.pageState.id,r=>({...r,selectedIds:n}))}}));y(this,"_updateUserDocumentSettings",this.history.createCommand("updateUserDocumentSettings",(e,n=!1)=>{const r=this.userDocumentSettings,o={...r,...e};return{data:{prev:r,next:o},ephemeral:n}},{do:({next:e})=>{this.store.put([e])},undo:({prev:e})=>{this.store.put([e])}}));y(this,"_updatePage",this.history.createCommand("updatePage",(e,n=!1)=>{if(this.isReadOnly)return null;const r=this.getPageById(e.id);return r?{data:{prev:r,partial:e},squashing:n}:null},{do:({partial:e})=>{this.store.update(e.id,n=>({...n,...e}))},undo:({prev:e,partial:n})=>{this.store.update(n.id,()=>e)},squash(e,n){return{prev:{...e.prev,...n.prev},partial:n.partial}}}));y(this,"_createPage",this.history.createCommand("createPage",(e,n=it.createId(),r)=>{var h,p;if(this.isReadOnly||this.pages.length>=Mh)return null;const o=this.pages,i=r??((h=o[o.length-1])==null?void 0:h.index)??"a1",s=(p=o[o.findIndex(g=>g.index===i)+1])==null?void 0:p.index,a={...this.pageState},l={...this.instanceState};e=WF(e,o.map(g=>g.name));const c=it.create({id:n,name:e,index:s&&i!==s?oc(i,s):Oo(i)}),d=xc.create({}),u=Ha.create({pageId:c.id,instanceId:this.instanceId,cameraId:d.id});return{data:{prevPageState:a,prevTabState:l,newPage:c,newTabPageState:u,newCamera:d}}},{do:({newPage:e,newTabPageState:n,newCamera:r})=>{this.store.put([e,r,n,{...this.instanceState,currentPageId:e.id}]),this.updateCullingBounds()},undo:({newPage:e,prevPageState:n,prevTabState:r,newTabPageState:o})=>{this.store.put([n,r]),this.store.remove([o.id,e.id,o.cameraId]),this.updateCullingBounds()}}));y(this,"_deletePage",this.history.createCommand("delete_page",e=>{if(this.isReadOnly)return null;const{pages:n}=this;if(n.length===1)return null;const r=this.getPageById(e),o=this._pageStates.value.filter(i=>i.pageId===e);if(!r)return null;if(e===this.currentPageId){const i=n.findIndex(a=>a.id===e),s=n[i-1]??n[i+1];this.setCurrentPageId(s.id)}return{data:{id:e,deletedPage:r,deletedPageStates:o}}},{do:({deletedPage:e,deletedPageStates:n})=>{const{pages:r}=this;if(r.length!==1){if(e.id===this.currentPageId){const o=r.findIndex(s=>s.id===e.id),i=r[o-1]??r[o+1];this.setCurrentPageId(i.id)}this.store.remove(n.map(o=>o.id)),this.store.remove([e.id]),this.updateCullingBounds()}},undo:({deletedPage:e,deletedPageStates:n})=>{this.store.put([e]),this.store.put(n),this.updateCullingBounds()}}));y(this,"_setInstancePageState",this.history.createCommand("setInstancePageState",(e,n=!1)=>({data:{prev:this.store.get(e.id??this.pageState.id),partial:e},ephemeral:n}),{do:({prev:e,partial:n})=>{this.store.update(e.id,r=>({...r,...n}))},undo:({prev:e})=>{this.store.update(e.id,()=>e)}}));y(this,"updateUserPresence",({cursor:e,color:n,viewportPageBounds:r}={})=>{const o=this._currentUserPresence.value;if(!o){console.error("No presence found for current user");return}this.store.put([{...o,cursor:e??o.cursor,color:n??o.color,viewportPageBounds:r??o.viewportPageBounds,lastUsedInstanceId:this.instanceId,lastActivityTimestamp:Date.now()}])});y(this,"_setSelectedIds",this.history.createCommand("setSelectedIds",(e,n=!1)=>{const r=this.pageState.selectedIds,o=new Set(this.pageState.selectedIds);return e.length===o.size&&e.every(i=>o.has(i))?null:{data:{ids:e,prevSelectedIds:r},squashing:n,preservesRedoStack:!0}},{do:({ids:e})=>{this.store.update(this.pageState.id,n=>({...n,selectedIds:e}))},undo:({prevSelectedIds:e})=>{this.store.update(this.pageState.id,()=>({...this.pageState,selectedIds:e}))},squash(e,n){return{ids:n.ids,prevSelectedIds:e.prevSelectedIds}}}));y(this,"_createAssets",this.history.createCommand("createAssets",e=>this.isReadOnly||e.length<=0?null:{data:{assets:e}},{do:({assets:e})=>{this.store.put(e)},undo:({assets:e})=>{this.store.remove(e.map(n=>n.id))}}));y(this,"_deleteAssets",this.history.createCommand("deleteAssets",e=>{if(this.isReadOnly||e.length<=0)return;const n=Ee(e.map(r=>this.store.get(r)));return{data:{ids:e,prev:n}}},{do:({ids:e})=>{this.store.remove(e)},undo:({prev:e})=>{this.store.put(e)}}));y(this,"_updateAssets",this.history.createCommand("updateAssets",e=>this.isReadOnly||e.length<=0?void 0:{data:{snapshots:{},assets:e}},{do:({assets:e,snapshots:n})=>{this.store.put(e.map(r=>{const o=this.store.get(r.id);return n[r.id]=o,{...o,...r}}))},undo:({snapshots:e})=>{this.store.put(Object.values(e))}}));y(this,"_setCurrentPageId",this.history.createCommand("setCurrentPage",(e,{stopFollowing:n=!0}={})=>{if(!this.store.has(e)){console.error("Tried to set the current page id to a page that doesn't exist.");return}return n&&this.instanceState.followingUserId&&this.stopFollowingUser(),{data:{toId:e,fromId:this.currentPageId},squashing:!0,preservesRedoStack:!0}},{do:({toId:e})=>{if(!this.getPageStateByPageId(e)){const n=xc.create({});this.store.put([n,Ha.create({pageId:e,instanceId:this.instanceId,cameraId:n.id})])}this.store.put([{...this.instanceState,currentPageId:e}]),this.updateUserPresence({viewportPageBounds:this.viewportPageBounds.toJson()}),this.updateCullingBounds()},undo:({fromId:e})=>{this.store.put([{...this.instanceState,currentPageId:e}]),this.updateUserPresence({viewportPageBounds:this.viewportPageBounds.toJson()}),this.updateCullingBounds()},squash:({fromId:e},{toId:n})=>({toId:n,fromId:e})}));y(this,"_updateInstanceState",this.history.createCommand("updateTabState",(e,n=!1,r=!1)=>{const o=this.instanceState,i={...o,...e};return{data:{prev:o,next:i},squashing:r,ephemeral:n}},{do:({next:e})=>{this.store.put([e])},undo:({prev:e})=>{this.store.put([e])},squash({prev:e},{next:n}){return{prev:e,next:n}}}));y(this,"_willSetInitialBounds",!0);y(this,"_viewportAnimation",null);y(this,"startFollowingUser",e=>{var a;const n=this.store.query.record("user_presence",()=>({userId:{eq:e}})),r=this.store.query.record("instance",()=>({userId:{eq:e}}));if(!r||!n)throw new Error("Couldn't find user to follow");if(((a=r.value)==null?void 0:a.followingUserId)===this.userId)return;Hr(()=>{this.stopFollowingUser(),this.updateInstanceState({followingUserId:e})});const o=()=>{this.removeListener("tick",s),this.removeListener("stop-following",o)};let i=!1;const s=()=>{const l=r.value,c=n.value;if(!l||!c){this.stopFollowingUser();return}const d=l.currentPageId===this.currentPageId,u=d?eN:1;d||this.setCurrentPageId(l.currentPageId,{stopFollowing:!1});const{center:h,width:p,height:g}=this.viewportPageBounds,{width:m,height:v,center:x}=de.From(c.viewportPageBounds),b=l.followingUserId===this.userId,E=p+(m-p)*u,P=g+(v-g)*u,C=b?g/P:Math.min(p/E,g/P),k=Vr(this.camera.z*C,kl,gi),$=this.viewportScreenBounds.w/k,A=this.viewportScreenBounds.h/k,D=x.sub(h),j=I.Add(h,I.Mul(D,u)),Y=I.Sub(j,h).len(),V=Math.abs(k-this.camera.z);if(Y<tN&&V<rN){i=!0;return}i&&Y<nN&&V<oN||(i=!1,this.stopCameraAnimation(),this.setCamera(-(j.x-$/2),-(j.y-A/2),k,{stopFollowing:!1}))};return this.once("stop-following",o),this.addListener("tick",s),this});y(this,"stopFollowingUser",()=>(this.updateInstanceState({followingUserId:null}),this.emit("stop-following"),this));y(this,"textMeasure");if(n.schema!==e.storeSchema)throw new Error("Store schema does not match schema given to App");this.config=e,this.store=n,this.getContainer=r??(()=>document.body),this.textMeasure=new c9(this),this.shapeUtils=Object.fromEntries(e.shapes.map(a=>[a.type,a.createShapeUtils(this)])),typeof window<"u"&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1),this.colors=new Map(xC.styles.color.map(a=>[a.id,`var(--palette-${a.id})`])),this.root=new nh(this),this.root.children&&e.tools.forEach(a=>{this.root.children[a.id]=new a(this)}),this.store.onBeforeDelete=a=>{a.typeName==="shape"?this._shapeWillBeDeleted(a):a.typeName==="page"&&this._pageWillBeDeleted(a)},this.store.onAfterChange=(a,l)=>{this._updateDepth++,this._updateDepth>1e3&&console.error("[onAfterChange] Maximum update depth exceeded, bailing out."),a.typeName==="shape"&&l.typeName==="shape"?this._shapeDidChange(a,l):a.typeName==="instance_page_state"&&l.typeName==="instance_page_state"&&this._tabStateDidChange(a,l),this._updateDepth--},this.store.onAfterCreate=a=>{a.typeName==="shape"&&Mt.is(a)&&this._arrowDidUpdate(a)},this._shapeIds=GF(this.store,()=>this.currentPageId),this._parentIdsToChildIds=XF(this.store),this.disposables.add(this.store.listen(a=>{this.emit("change",a)}));const o=this.getContainer(),i=()=>{this._isFocused.set(!0)},s=()=>{this._isFocused.set(!1)};o.addEventListener("focusin",i),o.addEventListener("focus",i),o.addEventListener("focusout",s),o.addEventListener("blur",s),this.disposables.add(()=>{o.removeEventListener("focusin",i),o.removeEventListener("focus",i),o.removeEventListener("focusout",s),o.removeEventListener("blur",s)}),this.store.ensureStoreIsUsable(),this.setInstancePageState({editingId:null,hoveredId:null,erasingIds:[]},!0),this.root.enter(void 0,"initial"),this.instanceState.followingUserId&&this.stopFollowingUser(),this.updateCullingBounds(),requestAnimationFrame(()=>{this._tickManager.start()})}get canMoveCamera(){return this._canMoveCamera.value}set canMoveCamera(e){this._canMoveCamera.set(e)}get isFocused(){return this._isFocused.value}get userId(){return this.store.props.userId}get instanceId(){return this.store.props.instanceId}annotateError(e,{origin:n,willCrashApp:r,tags:o,extras:i}){const s=this.createErrorAnnotations(n,r);dv(e,{tags:{...s.tags,...o},extras:{...s.extras,...i}}),r&&this.store.markAsPossiblyCorrupted()}createErrorAnnotations(e,n){try{return{tags:{origin:e,willCrashApp:n},extras:{activeStateNode:this.root.path.value,selectedShapes:this.selectedShapes,editingShape:this.editingId?this.getShapeById(this.editingId):void 0,inputs:this.inputs}}}catch{return{tags:{origin:e,willCrashApp:n},extras:{}}}}get crashingError(){return this._crashingError}crash(e){this._crashingError=e,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:e})}get devicePixelRatio(){return this._dprManager.dpr.value}get openMenus(){return this._openMenus.value}get isMenuOpen(){return this.openMenus.length>0}get isCoarsePointer(){return this._isCoarsePointer.value}set isCoarsePointer(e){this._isCoarsePointer.set(e)}get isChangingStyle(){return this._isChangingStyle.value}set isChangingStyle(e){this._isChangingStyle.set(e),clearTimeout(this._isChangingStyleTimeout),e&&(this._isChangingStyleTimeout=setTimeout(()=>this.isChangingStyle=!1,2e3))}get _pageTransformCache(){return this.store.createComputedCache("pageTransformCache",e=>{if(it.isId(e.parentId))return this.getTransform(e);const n=this._pageTransformCache.get(e.parentId);return ee.Compose(n,this.getTransform(e))})}get _pageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",e=>{const n=this._pageTransformCache.get(e.id);return n?de.FromPoints(ee.applyToPoints(n,this.getShapeUtil(e).outline(e))):new de})}get _pageMaskCache(){return this.store.createComputedCache("pageMaskCache",e=>{if(it.isId(e.parentId))return;const n=this.getAncestorsById(e.id).filter(o=>o.type==="frame");return n.length===0?void 0:n.map(o=>ee.applyToPoints(this._pageTransformCache.get(o.id),this.getOutline(o))).reduce((o,i)=>i&&o?dy(o,i)??void 0:void 0)})}getPageMaskById(e){return this._pageMaskCache.get(e)}get _clipPathCache(){return this.store.createComputedCache("clipPathCache",e=>{const n=this._pageMaskCache.get(e.id);if(!n)return;const r=this._pageTransformCache.get(e.id);return r?n.length===0?"polygon(0px 0px, 0px 0px, 0px 0px)":`polygon(${ee.applyToPoints(ee.Inverse(r),n).map(i=>`${i.x}px ${i.y}px`).join(",")})`:void 0})}getClipPathById(e){return this._clipPathCache.get(e)}dispose(){this.disposables.forEach(e=>e()),this.disposables.clear()}undo(){return this.history.undo()}get canUndo(){return this.history.numUndos>0}redo(){return this.history.redo(),this}get canRedo(){return this.history.numRedos>0}mark(e,n,r){return this.history.mark(e,n,r)}bail(){return this.history.bail(),this}bailToMark(e){return this.history.bailToMark(e),this}batch(e){return this.history.batch(e),this}getShapeUtil(e){return this.shapeUtils[e.type]}getShapeUtilByDef(e){return this.shapeUtils[e.type]}getSortedChildIds(e){const n=this._parentIdsToChildIds.value[e];return n?this._childIdsCache.get(n,()=>n.map(([r])=>r)):Cr}visitDescendants(e,n){const r=this.getSortedChildIds(e);for(const o of r)n(o)!==!1&&this.visitDescendants(o,n)}get erasingIds(){return this.pageState.erasingIds}get hintingIds(){return this.pageState.hintingIds}get erasingIdsSet(){return new Set(this.erasingIds)}_extractSharedProps(e,n){if(e.type==="group"){const r=this._parentIdsToChildIds.value[e.id];if(!r)return;for(let o=0,i=r.length;o<i;o++)this._extractSharedProps(this.getShapeById(r[o][0]),n)}else{const r=Object.entries(e.props);let o;for(let i=0,s=r.length;i<s;i++)if(o=r[i],!fN.has(o[0]))switch(n[o[0]]){case void 0:{n[o[0]]=o[1];break}case null:case o[1]:continue;default:n[o[0]]=null}}}get props(){let e;if(this.isIn("select")&&this.selectedIds.length>0)e=this._selectionSharedProps.value;else{const n=this.root.current.value;if(n.styles.length===0)e=null;else{const{propsForNextShape:r}=this.instanceState;e=Object.fromEntries(n.styles.map(o=>[o,r[o]]))}}return JSON.stringify(this._prevProps)===JSON.stringify(e)?this._prevProps:(this._prevProps=e,e)}get shapeIds(){return this._shapeIds.value}_complete(){var r;const{lastUpdatedPageId:e,lastUsedTabId:n}=this.userDocumentSettings;(n!==this.instanceId||e!==this.currentPageId)&&this.store.put([{...this.userDocumentSettings,lastUsedTabId:this.instanceId,lastUpdatedPageId:this.currentPageId}]);for(const o of this._invalidParents){this._invalidParents.delete(o);const i=this.getShapeById(o);if(!i)continue;const s=this.getShapeUtil(i),a=(r=s.onChildrenChange)==null?void 0:r.call(s,i);a!=null&&a.length&&this.updateShapes(a,!0)}this.updateUserPresence(),this.emit("update")}get _arrowBindingsIndex(){return YF(this.store)}getArrowsBoundTo(e){return this._arrowBindingsIndex.value[e]||Cr}_reparentArrow(e){const n=this.getShapeById(e);if(!n)return;const{start:r,end:o}=n.props,i=r.type==="binding"?this.getShapeById(r.boundShapeId):void 0,s=o.type==="binding"?this.getShapeById(o.boundShapeId):void 0,a=this.getParentPageId(n);if(!a)return;let l;if(i&&s)l=this.findCommonAncestor([i,s])??a;else if(i||s)l=a;else return;l&&l!==n.parentId&&this.reparentShapesById([e],l);const c=this.getShapeById(e),d=this.getNearestSiblingShape(c,i),u=this.getNearestSiblingShape(c,s);let h;if(d&&u)h=d.index>u.index?d:u;else if(d&&!u)h=d;else if(u&&!d)h=u;else return;let p;const g=this.getSortedChildIds(h.parentId).map(m=>this.getShapeById(m)).filter(m=>m.index>h.index);if(g.length){const m=g.find(v=>v.type!=="arrow");if(c.index>h.index&&(!m||c.index<m.index))return;p=oc(h.index,g[0].index)}else p=Oo(h.index);p!==c.index&&this.updateShapes([{id:e,type:"arrow",index:p}])}_unbindArrowTerminal(e,n){const{x:r,y:o}=Yr(this,e)[n];this.store.put([{...e,props:{...e.props,[n]:{type:"point",x:r,y:o}}}])}get _allPageStates(){return this.store.query.records("instance_page_state")}_shapeWillBeDeleted(e){e.parentId&&vr(e.parentId)&&this._invalidParents.add(e.parentId);const n=this._arrowBindingsIndex.value[e.id];if(n!=null&&n.length)for(const{arrowId:s,handleId:a}of n){const l=this.getShapeById(s);l&&this._unbindArrowTerminal(l,a)}const r=this._allPageStates.value,o=new Set([e.id]),i=Ee(r.map(s=>this._cleanupInstancePageState(s,o)));i.length&&this.store.put(i)}_arrowDidUpdate(e){for(const n of["start","end"]){const r=e.props[n];if(r.type!=="binding")continue;const o=this.getShapeById(r.boundShapeId),i=this.getParentPageId(e)===this.getParentPageId(o);(!o||!i)&&this._unbindArrowTerminal(e,n)}this._reparentArrow(e.id)}_cleanupInstancePageState(e,n){let r=null;const o=e.selectedIds.filter(a=>!n.has(a));o.length!==e.selectedIds.length&&(r||(r={...e}),r.selectedIds=o);const i=e.erasingIds.filter(a=>!n.has(a));i.length!==e.erasingIds.length&&(r||(r={...e}),r.erasingIds=i),e.hoveredId&&n.has(e.hoveredId)&&(r||(r={...e}),r.hoveredId=null),e.editingId&&n.has(e.editingId)&&(r||(r={...e}),r.editingId=null);const s=e.hintingIds.filter(a=>!n.has(a));return s.length!==e.hintingIds.length&&(r||(r={...e}),r.hintingIds=s),e.focusLayerId&&n.has(e.focusLayerId)&&(r||(r={...e}),r.focusLayerId=null),r}_shapeDidChange(e,n){if(Mt.is(n)&&this._arrowDidUpdate(n),e.parentId!==n.parentId){const r=o=>{const i=this._arrowBindingsIndex.value[o];if(i!=null&&i.length)for(const s of i)this._reparentArrow(s.arrowId)};r(n.id),this.visitDescendants(n.id,r)}if(e.parentId!==n.parentId&&it.isId(n.parentId)){const r=new Set([e.id]);this.visitDescendants(e.id,o=>{r.add(o)});for(const o of this.store.query.records("instance_page_state").value){if(o.pageId===n.parentId)continue;const i=this._cleanupInstancePageState(o,r);i&&this.store.put([i])}}e.parentId&&vr(e.parentId)&&this._invalidParents.add(e.parentId),n.parentId!==e.parentId&&vr(n.parentId)&&this._invalidParents.add(n.parentId)}_tabStateDidChange(e,n){if((e==null?void 0:e.selectedIds)!==(n==null?void 0:n.selectedIds)){const r=n.selectedIds.filter(i=>{var a,l;let s=(a=this.getShapeById(i))==null?void 0:a.parentId;for(;vr(s);){if(n.selectedIds.includes(s))return!1;s=(l=this.getShapeById(s))==null?void 0:l.parentId}return!0}),o=r.length===0?n==null?void 0:n.focusLayerId:this.findCommonAncestor(Ee(r.map(i=>this.getShapeById(i))),i=>i.type==="group");(r.length!==n.selectedIds.length||o!=n.focusLayerId)&&this.store.put([{...n,selectedIds:r,focusLayerId:o??null}])}}_pageWillBeDeleted(e){var o;const n=this.store.query.exec("instance",{currentPageId:{eq:e.id}});if(!n.length)return;const r=(o=this.pages.find(i=>i.id!==e.id))==null?void 0:o.id;r&&this.store.put(n.map(i=>({...i,currentPageId:r})))}get documentSettings(){return this.store.get(kh)}get gridSize(){return this.documentSettings.gridSize}get userSettings(){return this.store.get(this.userId)}get isSnapMode(){return this.userDocumentSettings.isSnapMode}setSnapMode(e){return e!==this.isSnapMode&&this.updateUserDocumentSettings({isSnapMode:e},!0),this}get isDarkMode(){return this.userDocumentSettings.isDarkMode}setDarkMode(e){return e!==this.isDarkMode&&this.updateUserDocumentSettings({isDarkMode:e},!0),this}get isFocusMode(){return this.instanceState.isFocusMode}setFocusMode(e){return e!==this.isFocusMode&&this.updateInstanceState({isFocusMode:e},!0),this}get isToolLocked(){return this.instanceState.isToolLocked}setToolLocked(e){return e!==this.isToolLocked&&this.updateInstanceState({isToolLocked:e},!0),this}get _userDocumentSettings(){return this.store.query.record("user_document",()=>({userId:{eq:this.userId}}))}get userDocumentSettings(){return this._userDocumentSettings.value}get isGridMode(){return this.userDocumentSettings.isGridMode}setGridMode(e){return e!==this.isGridMode&&this.updateUserDocumentSettings({isGridMode:e},!0),this}setReadOnly(e){return this._isReadOnly.set(e),e&&this.setSelectedTool("hand"),this}get isReadOnly(){return this._isReadOnly.value}get isPenMode(){return this._isPenMode.value}setPenMode(e){return e&&(this._touchEventsRemainingBeforeExitingPenMode=3),e!==this.isPenMode&&this._isPenMode.set(e),this}get user(){return this.store.get(this.userId)}get instanceState(){return this.store.get(this.instanceId)}get cursor(){return this.instanceState.cursor}get brush(){return this.instanceState.brush}get zoomBrush(){return this.instanceState.zoomBrush}get scribble(){return this.instanceState.scribble}get _pageState(){return this.store.query.record("instance_page_state",()=>({pageId:{eq:this.currentPageId},instanceId:{eq:this.instanceId}}),"app._pageState")}get pageState(){return this._pageState.value}get camera(){return this.store.get(this.pageState.cameraId)}get zoomLevel(){return this.camera.z}get selectedIds(){return this.pageState.selectedIds}get selectedIdsSet(){return new Set(this.selectedIds)}get _pages(){return this.store.query.records("page")}get pages(){return this._pages.value.sort(jn)}get currentPage(){return this.getPageById(this.currentPageId)}get currentPageId(){return this.instanceState.currentPageId}getPageById(e){return this.store.get(e)}get _pageStates(){return this.store.query.records("instance_page_state",()=>({instanceId:{eq:this.instanceId}}))}getPageStateByPageId(e){return this._pageStates.value.find(n=>n.pageId===e)}getPageInfoById(e){return this.store.get(e)}getShapesInPage(e){const n=this.store.query.exec("shape",{parentId:{eq:e}});return this.getShapesAndDescendantsInOrder(n.map(r=>r.id))}getTransform(e){return this.getShapeUtil(e).transform(e)}getParentTransform(e){return it.isId(e.parentId)?ee.Identity():this._pageTransformCache.get(e.parentId)??ee.Identity()}getPageTransform(e){return this.getPageTransformById(e.id)}getPageTransformById(e){return this._pageTransformCache.get(e)}getPagePointById(e){const n=this.getPageTransformById(e);if(n)return ee.applyToPoint(n,new I)}getPageCenter(e){const n=this.getPageTransformById(e.id);if(!n)return null;const o=this.getShapeUtil(e).center(e);return ee.applyToPoint(n,o)}getPageCenterById(e){const n=this.getShapeById(e);return this.getPageCenter(n)}getPageRotation(e){return this.getPageRotationById(e.id)}getPageRotationById(e){const n=this.getPageTransformById(e);return n?ee.Decompose(n).rotation:0}getBounds(e){return this.getShapeUtil(e).bounds(e)}getBoundsById(e){const n=this.getShapeById(e);if(n)return this.getBounds(n)}getPageBounds(e){return this.getPageBoundsById(e.id)}getPageBoundsById(e){return this._pageBoundsCache.get(e)}getMaskedPageBounds(e){return this.getMaskedPageBoundsById(e.id)}getMaskedPageBoundsById(e){const n=this._pageBoundsCache.get(e);if(!n)return;const r=this._pageMaskCache.get(e);if(r){const o=dy(r,n.corners);return o?de.FromPoints(o):void 0}return n}getOutline(e){return this.getShapeUtil(e).outline(e)}getOutlineById(e){return this.getOutline(this.getShapeById(e))}getAncestors(e,n=[]){const r=e.parentId;if(it.isId(r))return n.reverse(),n;const o=this.store.get(r);return n.push(o),this.getAncestors(o,n)}getAncestorsById(e,n=[]){const r=this.getShapeById(e);return this.getAncestors(r,n)}findAncestor(e,n){const r=e.parentId;if(it.isId(r))return;const o=this.getShapeById(r);if(o)return n(o)?o:this.findAncestor(o,n)}hasAncestor(e,n){return e?e.parentId===n?!0:this.hasAncestor(this.getParentShape(e),n):!1}findCommonAncestor(e,n){var s;if(e.length===0)return;if(e.length===1){const a=e[0].parentId;return it.isId(a)?void 0:n?(s=this.findAncestor(e[0],n))==null?void 0:s.id:a}const[r,...o]=e;let i=this.getParentShape(r);for(;i;){if(n&&!n(i)){i=this.getParentShape(i);continue}if(o.every(a=>this.hasAncestor(a,i.id)))return i.id;i=this.getParentShape(i)}}isShapeInViewport(e){const n=this.getPageBoundsById(e);return n?this.viewportPageBounds.includes(n):!1}get renderingShapes(){const{currentPageId:e,cullingBounds:n,cullingBoundsExpanded:r,erasingIdsSet:o,editingId:i}=this,s=[],a=(l,c,d)=>{const u=this.getShapeById(l);if(!u)return;let h=+u.props.opacity*c,p=!1;!d&&o.has(l)&&(p=!0,h*=.32);const g=this.getMaskedPageBoundsById(l),m=g?n.includes(g):!1,v=g?i!==l&&!r.includes(g):!0;s.push({id:l,index:s.length,opacity:h,isCulled:v,isInViewport:m}),this.getSortedChildIds(l).forEach(x=>{a(x,h,d||p)})};return this.getSortedChildIds(e).forEach(l=>a(l,1,!1)),s.sort(AF)}get allShapesCommonBounds(){let e=null;return this.shapeIds.forEach(n=>{const r=this.getMaskedPageBoundsById(n);r&&(e?e.expand(r):e=r.clone())}),e}getPageCorners(e){const n=this.getAncestors(e),r=this.getBounds(e).corners,o=ee.Compose(...n.flatMap(i=>[ee.Translate(i.x,i.y),ee.Rotate(i.rotation)]),ee.Translate(e.x,e.y),ee.Rotate(e.rotation,0,0));return ee.applyToPoints(o,r)}isPointInShape(e,n){const r=this.getShapeUtil(n),o=this._pageMaskCache.get(n.id);return o&&!$r(e,o)?!1:r.hitTestPoint(n,this.getPointInShapeSpace(n,e))}getShapesAtPoint(e){return this.shapesArray.filter(n=>{const r=this._pageMaskCache.get(n.id);return r?$r(e,r):this.getShapeUtil(n).hitTestPoint(n,this.getPointInShapeSpace(n,e))})}getPointInShapeSpace(e,n){return ee.applyToPoint(ee.Inverse(this.getPageTransform(e)),n)}getPointInParentSpace(e,n){const r=this.getShapeById(e);if(!r)return new I(0,0);if(it.isId(r.parentId))return I.From(n);const o=this.getPageTransformById(r.parentId);return o?ee.applyToPoint(ee.Inverse(o),n):I.From(n)}getDeltaInShapeSpace(e,n){const r=this.getPageTransform(e);return r?I.Rot(n,-ee.Decompose(r).rotation):I.From(n)}getDeltaInParentSpace(e,n){if(it.isId(e.parentId))return I.From(n);const r=this.getShapeById(e.parentId);return r?this.getDeltaInShapeSpace(r,n):I.From(n)}getParentsMappedToChildren(e){const n=e.map(o=>this.store.get(o)),r=new Map;return n.forEach(o=>{var i;r.has(o.parentId)||r.set(o.parentId,new Set),(i=r.get(o.parentId))==null||i.add(o)}),r}updateViewportScreenBounds(e=!1){const n=this.getContainer();if(!n)return this;const r=n.getBoundingClientRect(),o=new de(0,0,Math.max(r.width,1),Math.max(r.height,1)),i=o.equals(this.viewportScreenBounds),{_willSetInitialBounds:s}=this;if(i)this._willSetInitialBounds=!1;else if(s)this._willSetInitialBounds=!1,this.updateInstanceState({screenBounds:o.toJson()},!0,!0);else{const{zoomLevel:l}=this;if(e){const c=this.viewportPageCenter;this.updateInstanceState({screenBounds:o.toJson()},!0,!0);const d=this.viewportPageCenter;this.instanceState.followingUserId||this.pan((d.x-c.x)*l,(d.y-c.y)*l)}else{const c=this.screenToPage(0,0);this.updateInstanceState({screenBounds:o.toJson()},!0,!0);const d=this.screenToPage(0,0);this.instanceState.followingUserId||this.pan((d.x-c.x)*l,(d.y-c.y)*l)}}this._cameraManager.tick(),this.updateCullingBounds();const{editingId:a}=this;return a&&this.panZoomIntoView([a]),this}get viewportScreenBounds(){const{x:e,y:n,w:r,h:o}=this.instanceState.screenBounds;return new de(e,n,r,o)}get viewportScreenCenter(){return this.viewportScreenBounds.center}get viewportPageBounds(){const{x:e,y:n,w:r,h:o}=this.viewportScreenBounds,i=this.screenToPage(e,n),s=this.screenToPage(e+r,n+o);return new de(i.x,i.y,s.x-i.x,s.y-i.y)}get cullingBounds(){return this._cullingBounds.value}get cullingBoundsExpanded(){return this._cullingBoundsExpanded.value}updateCullingBounds(){const{viewportPageBounds:e}=this;return e.equals(this._cullingBounds.__unsafe__getWithoutCapture())?this:(this._cullingBounds.set(e.clone()),this._cullingBoundsExpanded.set(e.clone().expandBy(100/this.zoomLevel)),this)}get viewportPageCenter(){return this.viewportPageBounds.center}screenToPage(e,n,r=.5,o=this.camera){const{screenBounds:i}=this.store.unsafeGetWithoutCapture(this.instanceId),{x:s,y:a,z:l=1}=o;return{x:(e-i.x)/l-s,y:(n-i.y)/l-a,z:r}}pageToScreen(e,n,r=.5,o=this.camera){const{x:i,y:s,z:a=1}=o;return{x:e+i*a,y:n+s*a,z:r}}get focusLayerId(){return this.pageState.focusLayerId??this.currentPageId}get focusLayerShape(){const e=this.pageState.focusLayerId;if(e)return this.getShapeById(e)}popFocusLayer(){const e=this.pageState.focusLayerId,n=e&&this.getShapeById(e);if(n){const r=this.findAncestor(n,o=>o.type==="group");this.setFocusLayer((r==null?void 0:r.id)??null),this.select(n.id)}else this.setFocusLayer(null),this.selectNone();return this}setFocusLayer(e){return this._setFocusLayer(e),this}setHintingIds(e){return this.store.update(this.pageState.id,n=>({...n,hintingIds:bh(e)})),this}get editingId(){return this.pageState.editingId}get croppingId(){return this.pageState.croppingId}get editingShape(){return this.editingId?this.getShapeById(this.editingId)??null:null}setEditingId(e){if(!e)this.setInstancePageState({editingId:null});else if(e!==this.editingId){const n=this.getShapeById(e),r=this.getShapeUtil(n);if(n&&r.canEdit(n)){this.setInstancePageState({editingId:e,hoveredId:null},!1);const{viewportPageBounds:o}=this,i=r.getEditingBounds(n),s=this.getPageTransformById(e),a=de.FromPoints(ee.applyToPoints(s,i.corners));o.contains(a)||(a.width>o.width||a.height>o.height?this.zoomToBounds(a.minX,a.minY,a.width,a.height):this.centerOnPoint(a.midX,a.midY))}}return this}setCroppingId(e){if(e!==this.croppingId)if(!e)this.setInstancePageState({croppingId:null}),this.isInAny("select.crop","select.pointing_crop_handle","select.cropping")&&this.setSelectedTool("select.idle");else{const n=this.getShapeById(e),r=this.getShapeUtil(n);n&&r.canCrop(n)&&this.setInstancePageState({croppingId:e,hoveredId:null})}return this}getParentIdForNewShapeAtPoint(e,n){const r=this.sortedShapesArray;for(let o=r.length-1;o>=0;o--){const i=r[o],s=this.getShapeUtil(i);if(!s.canReceiveNewChildrenOfType(n))continue;const a=this.getMaskedPageBoundsById(i.id);if(a&&a.containsPoint(e)&&s.hitTestPoint(i,this.getPointInShapeSpace(i,e)))return i.id}return this.focusLayerId}getDroppingShape(e,n=[]){const r=this.sortedShapesArray;for(let o=r.length-1;o>=0;o--){const i=r[o];if(n.find(l=>l.id===i.id||this.hasAncestor(i,l.id)))continue;const s=this.getShapeUtil(i);if(!s.canDropShapes(i,n))continue;const a=this.getMaskedPageBoundsById(i.id);if(a&&a.containsPoint(e)&&s.hitTestPoint(i,this.getPointInShapeSpace(i,e)))return i}}getOutermostSelectableShape(e,n){let r=e,o=e;for(;o;){if(o.type==="group"&&this.focusLayerId!==o.id&&!this.hasAncestor(this.focusLayerShape,o.id)&&((n==null?void 0:n(o))??!0))r=o;else if(this.focusLayerId===o.id)break;o=this.getParentShape(o)}return r}get selectedPageBounds(){const{pageState:{selectedIds:e}}=this;return e.length===0?null:de.Common(Ee(e.map(n=>this.getPageBoundsById(n))))}get selectionRotation(){const{selectedIds:e}=this;if(e.length===0)return 0;if(e.length===1)return this.getPageRotationById(this.selectedIds[0]);const n=e.map(r=>this.getPageRotationById(r)%(Math.PI/2));return n.every(r=>Math.abs(r-n[0])<Math.PI/180)?this.getPageRotationById(e[0]):0}get selectionBounds(){const{selectedIds:e}=this;if(e.length===0)return;const{selectionRotation:n}=this;if(n===0)return this.selectedPageBounds;if(e.length===1){const i=this.getBounds(this.getShapeById(e[0])).clone();return i.point=ee.applyToPoint(this.getPageTransformById(e[0]),i.point),i}const r=this.selectedIds.flatMap(i=>{const s=this.getPageTransformById(i);return s?this.getOutlineById(i).map(a=>ee.applyToPoint(s,a)):[]}).map(i=>I.Rot(i,-n)),o=de.FromPoints(r);return o.point=o.point.rot(n),o}get selectionPageCenter(){const{selectionBounds:e,selectionRotation:n}=this;return e?I.RotWith(e.center,e.point,n):null}get shapesArray(){return Array.from(this.shapeIds).map(e=>this.store.get(e))}get sortedShapesArray(){const e=new Set(this.shapesArray.sort(jn)),n=[];function r(o){n.push(o),e.delete(o),e.forEach(i=>{i.parentId===o.id&&r(i)})}return e.forEach(o=>{const i=this.getShapeById(o.parentId);gs(i)||r(o)}),n}get selectedShapes(){const{selectedIds:e}=this.pageState;return Ee(e.map(n=>this.store.get(n)))}get onlySelectedShape(){const{selectedShapes:e}=this;return e.length===1?e[0]:null}getShapeById(e){if(vr(e))return this.store.get(e)}getParentShape(e){if(!(e===void 0||!vr(e.parentId)))return this.store.get(e.parentId)}getNearestSiblingShape(e,n){return n?n.parentId===e.parentId?n:this.findAncestor(n,o=>o.parentId===e.parentId):void 0}getParentPageId(e){if(e!==void 0)return it.isId(e.parentId)?e.parentId:this.getParentPageId(this.getShapeById(e.parentId))}isShapeInPage(e,n=this.currentPageId){let r=!1;if(e.parentId===n)r=!0;else{let o=this.getShapeById(e.parentId);e:for(;o;){if(o.parentId===n){r=!0;break e}o=this.getShapeById(o.parentId)}}return r}getCssColor(e){return this.colors.get(e)}getStrokeWidth(e){return this.sizes[e]}get currentToolId(){var r;const e=this.root.current.value;let n=e==null?void 0:e.id;if(n==="select"||n==="zoom"){const o=e==null?void 0:e.current.value;n=((r=o==null?void 0:o.info)==null?void 0:r.onInteractionEnd)??"select"}return n??"select"}setSelectedTool(e,n={}){return this.root.transition(e,n),this}getStateDescendant(e){var o;const n=e.split(".").reverse();let r=this.root;for(;n.length>0;){const i=n.pop();if(!i)return r;const s=(o=r.children)==null?void 0:o[i];if(!s)return;r=s}return r}isIn(e){const n=e.split(".").reverse();let r=this.root;for(;n.length>0;){const o=n.pop();if(!o)return!0;const i=r.current.value;if((i==null?void 0:i.id)===o){if(n.length===0)return!0;r=i;continue}else return!1}return!1}isInAny(...e){return e.some(n=>this.isIn(n))}_updateInputsFromEvent(e){const{previousScreenPoint:n,previousPagePoint:r,currentScreenPoint:o,currentPagePoint:i}=this.inputs,{screenBounds:s}=this.store.unsafeGetWithoutCapture(this.instanceId),{x:a,y:l,z:c}=e.point,{x:d,y:u,z:h}=this.camera;n.setTo(o),r.setTo(i);const p=(a-s.x)/h-d,g=(l-s.y)/h-u;o.set(a,l),i.set(p,g,c??.5),this.inputs.isPen=e.type==="pointer"&&e.isPen,e.name==="pointer_down"&&(this.inputs.pointerVelocity=new I),this.updateUserPresence({cursor:i.toJson()})}cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}replaceStoreContentsWithRecordsForOtherDocument(e){Hr(()=>{this.store.clear();const[n,r]=qj(e,i=>i.typeName==="shape");this.store.put(r,"initialize"),this.store.ensureStoreIsUsable(),this.store.put(n,"initialize"),this.history.clear(),this.updateViewportScreenBounds(),this.updateCullingBounds();const o=this.allShapesCommonBounds;o&&this.zoomToBounds(o.minX,o.minY,o.width,o.height,1)})}getContent(e=this.selectedIds){if(!e||e.length===0)return;const n={};let r=bh(e.map(s=>this.getShapeById(s)).sort(jn).flatMap(s=>{const a=[s];return this.visitDescendants(s.id,l=>{a.push(this.getShapeById(l))}),a}));r=r.map(s=>{if(n[s.id]=this.getPageTransformById(s.id),s=Uo(s),Mt.is(s)){const a=s.props.start.type==="binding"?s.props.start.boundShapeId:void 0,l=s.props.end.type==="binding"?s.props.end.boundShapeId:void 0,c=this.getShapeUtilByDef(Mt).getArrowInfo(s);if(s.props.start.type==="binding"&&!r.some(u=>u.id===a))if(c!=null&&c.isValid){const{x:u,y:h}=c.start.point;s.props.start={type:"point",x:u,y:h}}else{const{start:u}=Yr(this,s);s.props.start={type:"point",x:u.x,y:u.y}}if(s.props.end.type==="binding"&&!r.some(u=>u.id===l))if(c!=null&&c.isValid){const{x:u,y:h}=c.end.point;s.props.end={type:"point",x:u,y:h}}else{const{end:u}=Yr(this,s);s.props.end={type:"point",x:u.x,y:u.y}}const d=Gl(s)?Dh(this,s):py(this,s);if(c!=null&&c.isValid&&(d!=null&&d.isValid)&&!Gl(s)){const u=I.Med(c.start.handle,c.end.handle),h=I.Dist(c.middle,u),p=I.Dist(d.middle,u);s.props.bend<0?s.props.bend+=p-h:s.props.bend-=p-h}return s}return s});const o=[];r.forEach(s=>{if(r.find(a=>a.id===s.parentId)===void 0){const a=this.getPagePointById(s.id),l=this.getPageRotationById(s.id);s.x=a.x,s.y=a.y,s.rotation=l,s.parentId=this.currentPageId,o.push(s.id)}});const i=new Set;return r.forEach(s=>{"assetId"in s.props&&s.props.assetId!==null&&i.add(s.props.assetId)}),{shapes:r,rootShapeIds:o,schema:this.store.schema.serialize(),assets:Ee(Array.from(i).map(s=>this.getAssetById(s)))}}putContent(e,n={}){if(this.isReadOnly)return this;if(!e.schema)throw Error("Could not put content: content is missing a schema.");const{select:r=!1,preserveIds:o=!1,preservePosition:i=!1}=n;let{point:s=void 0}=n;const{currentPageId:a}=this,{assets:l,shapes:c,rootShapeIds:d}=e,u=new Map(c.map(P=>[P.id,Ut()]));let h=this.currentPageId,p=1/0,g=[];for(const P of this.selectedShapes){if(p===0)break;const C=this.getAncestors(P);P.type==="frame"&&C.push(P);const k=P.type==="frame"?C.length+1:C.length;if(k<p)p=k,g=C,h=P.type==="frame"?P.id:P.parentId;else if(k===p){if(g.length!==C.length)throw Error(`Ancestors: ${g.length} !== ${C.length}`);if(g.length===0){h=a;break}else{h=a;for(let $=0;$<g.length&&C[$]===g[$];$++)h=C[$].id}}}let m=!1;if(!it.isId(h)){const P=this.getShapeById(h);if(P){if(!this.viewportPageBounds.includes(this.getPageBounds(P)))h=a;else if(d.length===1){const C=c.find(k=>k.id===d[0]);Kd.is(P)&&Kd.is(C)&&C.props.w===(P==null?void 0:P.props.w)&&C.props.h===(P==null?void 0:P.props.h)&&(m=!0)}}else h=a}m||(m=u.has(h)),m&&(h=this.getShapeById(h).parentId);let v=this.getHighestIndexForParent(h);const x=[],b=c.map(P=>{let C;if(o)C=Fn(P),u.set(P.id,P.id);else{const k=u.get(P.id);C=Fn({...P,id:k})}if(d.includes(P.id)&&(C.parentId=a,x.push(C)),u.has(C.parentId)?C.parentId=u.get(P.parentId):(d.push(C.id),C.index=v,v=Oo(v)),Mt.is(C)){if(C.props.start.type==="binding"){const k=u.get(C.props.start.boundShapeId);C.props.start=k?{...C.props.start,boundShapeId:k}:{type:"point",x:0,y:0}}if(C.props.end.type==="binding"){const k=u.get(C.props.end.boundShapeId);C.props.end=k?{...C.props.end,boundShapeId:k}:{type:"point",x:0,y:0}}}return C});if(b.length+this.shapeIds.size>ls)return od(this),this;let E=[];if(l){for(let C=0;C<l.length;C++){const k=l[C],$=this.store.schema.migratePersistedRecord(k,e.schema);if($.type==="success")l[C]=$.value;else throw Error(`Could not put content: could not migrate content for asset:
${JSON.stringify(k,null,2)}`)}const P=[];E=l.filter(C=>!this.store.has(C.id)).map(C=>{var k;return(C.type==="image"||C.type==="video")&&(C.props.src&&((k=C.props.src)!=null&&k.startsWith("data:image"))?(P.push(Uo(C)),C.props.src=null):P.push(Uo(C))),C}),Promise.allSettled(P.map(async C=>{const k=await b7(C.props.src,C.props.name,C.props.mimeType??"image/png"),$=await this.onCreateAssetFromFile(k);return[C,$]})).then(C=>{this.updateAssets(Ee(C.map(k=>k.status==="fulfilled"?{...k.value[1],id:k.value[0].id}:void 0)))})}for(let P=0;P<b.length;P++){const C=b[P],k=this.store.schema.migratePersistedRecord(C,e.schema);if(k.type==="success")b[P]=k.value;else throw Error(`Could not put content: could not migrate content for shape:
${JSON.stringify(C,null,2)}`)}return this.batch(()=>{E.length>0&&this.createAssets(E),this.createShapes(b,r),h!==a&&this.reparentShapesById(x.map(k=>k.id),h);const P=b.map(k=>this.getShapeById(k.id)),C=de.Common(P.map(k=>this.getPageBounds(k)));if(s===void 0)if(it.isId(h)){const{viewportPageBounds:k}=this;i||k.includes(de.From(C))?s=C.center:s=k.center}else{const k=this.getShapeById(h);s=this.getShapeUtil(k).center(k)}if(x.length===1){const k=x[0];if(k.type==="frame")for(;this.getShapesAtPoint(s).some($=>Kd.is($)&&$.props.w===k.props.w&&$.props.h===k.props.h);)s.x+=C.w+16}this.updateShapes(x.map(k=>{const $={x:(k.x??0)-(C.x+C.w/2),y:(k.y??0)-(C.y+C.h/2)};return{id:k.id,type:k.type,x:s.x+$.x,y:s.y+$.y}}))}),this}createShapeId(e){return e?P8(e):Ut()}getHighestIndexForParent(e){const n=this._parentIdsToChildIds.value[e];return!n||n.length===0?"a1":Oo(n[n.length-1][1])}createShapes(e,n=!1){return this._createShapes(e,n),this}animateShapes(e,n={}){const{duration:r=500,ease:o=Pn.linear}=n,i=_t();let s=r,a;const l=[];e.forEach(u=>{if(!u)return;const h={partial:u,values:[]},p=this.getShapeById(u.id);if(p){for(const g of["x","y","rotation"])u[g]!==void 0&&p[g]!==u[g]&&h.values.push({prop:g,from:p[g],to:u[g]});l.push(h),this.animatingShapes.set(p.id,i)}});let c;const d=u=>{if(s-=u,s<0){const{animatingShapes:p}=this,g=e.filter(m=>m&&p.get(m.id)===i);g.length&&this.updateShapes(g,!1),this.removeListener("tick",d);return}a=o(1-s/r);const{animatingShapes:h}=this;try{const p=[];for(let g=0;g<l.length;g++)c=l[g],h.get(c.partial.id)===i&&p.push({id:c.partial.id,type:c.partial.type,...c.values.reduce((m,{prop:v,from:x,to:b})=>(m[v]=x+(b-x)*a,m),{})});this._updateShapes(p,!0)}catch{}};return this.addListener("tick",d),this}updateShapes(e,n=!1){if(this.animatingShapes.size>0){let r;for(let o=0;o<e.length;o++)r=e[o],r&&this.animatingShapes.delete(r.id)}return this._updateShapes(e,n),this}deleteShapes(e=this.selectedIds){return this._deleteShapes(e),this}updateUserDocumentSettings(e,n=!1){return this._updateUserDocumentSettings(e,n),this}updatePage(e,n=!1){return this._updatePage(e,n),this}createPage(e,n=it.createId(),r){return this._createPage(e,n,r),this}duplicatePage(e=this.currentPageId,n=it.createId()){if(this.pages.length>=Mh)return;const r=this.getPageById(e);if(!r)return;const o={...this.camera},i=this.getContent(this.getSortedChildIds(r.id));this.batch(()=>{if(this.createPage(r.name+" Copy",n,r.index),this.setCurrentPageId(n),this.setCamera(o.x,o.y,o.z),i)return this.putContent(i)})}deletePage(e){this._deletePage(e)}setInstancePageState(e,n=!1){this._setInstancePageState(e,n)}updateUser(e){const n={...this.user,...e};this.store.put([n])}get _currentUserPresence(){return this.store.query.record("user_presence",()=>({userId:{eq:this.userId}}))}get userPresence(){return this._currentUserPresence.value}setSelectedIds(e,n=!1){return this._setSelectedIds(e,n),this}isSelected(e){return this.selectedIdsSet.has(e)}isWithinSelection(e){const n=this.getShapeById(e);return n?this.isSelected(e)?!0:!!this.findAncestor(n,r=>this.isSelected(r.id)):!1}get _assets(){return this.store.query.records("asset")}get assets(){return this._assets.value}createAssets(e){return this._createAssets(e),this}deleteAssets(e){return this._deleteAssets(e),this}updateAssets(e){return this._updateAssets(e),this}getAssetBySrc(e){return this.assets.find(n=>n.props.src===e)}getAssetById(e){return this.store.get(e)}async getSvg(e=this.selectedIds.length?this.selectedIds:Object.keys(this.shapeIds),n={}){var D,j,Y;if(e.length===0)return;if(!window.document)throw Error("No document");const{scale:r=1,background:o=!1,padding:i=hN,darkMode:s=this.userDocumentSettings.isDarkMode,preserveAspectRatio:a=!1}=n,l=this.getContainer(),c=getComputedStyle(l),d=document.createElement("div");d.className=`tl-container tl-theme__${s?"dark":"light"}`,document.body.appendChild(d);const u=getComputedStyle(d),h=new Map,p={fill:Object.fromEntries(Ju.color.map(V=>[V.id,u.getPropertyValue(`--palette-${V.id}`)])),pattern:Object.fromEntries(Ju.color.map(V=>[V.id,u.getPropertyValue(`--palette-${V.id}-pattern`)])),semi:Object.fromEntries(Ju.color.map(V=>[V.id,u.getPropertyValue(`--palette-${V.id}-semi`)])),text:u.getPropertyValue("--color-text"),background:u.getPropertyValue("--color-background"),solid:u.getPropertyValue("--palette-solid")};document.body.removeChild(d);const g=this.getShapesAndDescendantsInOrder(e),m=de.FromPoints(g.map(V=>{const q=this.getPageMaskById(V.id);if(q)return q;const F=this.getPageTransform(V);return ee.applyToPoints(F,this.getOutline(V))}).flat()),v=e.length===1&&g[0].type==="frame";v||m.expandBy(i);const x=m.width*r,b=m.height*r,E=window.document.createElementNS("http://www.w3.org/2000/svg","svg");a&&E.setAttribute("preserveAspectRatio",a),E.setAttribute("direction","ltr"),E.setAttribute("width",x+""),E.setAttribute("height",b+""),E.setAttribute("viewBox",`${m.minX} ${m.minY} ${m.width} ${m.height}`),E.setAttribute("stroke-linecap","round"),E.setAttribute("stroke-linejoin","round"),o?v?E.style.setProperty("background",p.solid):E.style.setProperty("background-color",p.background):E.style.setProperty("background-color","transparent");const P=window.document.createElementNS("http://www.w3.org/2000/svg","defs");for(const V of Array.from(Jz(p.solid)))P.appendChild(V);try{(j=(D=document.body).focus)==null||j.call(D)}catch{}E.append(P);let C;for(let V=0,q=g.length;V<q;V++){if(C=g[V],v&&V===0)continue;let F;"font"in C.props&&C.props.font&&(h.has(C.props.font)?F=h.get(C.props.font):(F=c.getPropertyValue(`--tl-font-${C.props.font}`),h.set(C.props.font,F)));const X=this.getShapeUtil(C);let ne=await((Y=X.toSvg)==null?void 0:Y.call(X,C,F,p));if(!ne){const G=this.getPageBounds(C),Q=window.document.createElementNS("http://www.w3.org/2000/svg","rect");Q.setAttribute("width",G.width+""),Q.setAttribute("height",G.height+""),Q.setAttribute("fill",p.solid),Q.setAttribute("stroke",p.pattern.grey),Q.setAttribute("stroke-width","1"),ne=Q}const ie=ne;let W=this.getPageTransform(C).toCssString();"scale"in C.props&&C.props.scale!==1&&(W=`${W} scale(${C.props.scale}, ${C.props.scale})`),ie.setAttribute("transform",W),"opacity"in C.props&&ie.setAttribute("opacity",C.props.opacity+"");const H=this.getPageMaskById(C.id);if(ie&&H){const G=document.createElementNS("http://www.w3.org/2000/svg","clipPath");P.appendChild(G);const Q=Tp();G.id=Q;const le=document.createElementNS("http://www.w3.org/2000/svg","path");le.setAttribute("d",`M${H.map(({x:Ie,y:we})=>`${Ie},${we}`).join("L")}Z`),G.appendChild(le);const De=document.createElementNS("http://www.w3.org/2000/svg","g");De.setAttribute("clip-path",`url(#${Q})`),De.appendChild(ie),E.appendChild(De)}else E.appendChild(ie)}let k="";const $=window.document.createElementNS("http://www.w3.org/2000/svg","style"),A=[];"fonts"in document&&document.fonts.forEach(V=>A.push(V));for(const V of A){const q=new FileReader;let F=!1;if(h.forEach(ie=>{ie.includes(V.family)&&(F=!0)}),!F)continue;const X=V.$$_url,ne=V.$$_fontface;if(X){const ie=await(await fetch(X)).blob(),W=await new Promise((G,Q)=>{q.onload=()=>G(q.result),q.onerror=()=>Q(q.error),q.readAsDataURL(ie)}),H=`
`+ne.replaceAll(X,W);k+=H}}return $.textContent=k,P.append($),E}renamePage(e,n,r=!1){return this.isReadOnly?this:(this.updatePage({id:e,name:n},r),this)}moveShapesToPage(e,n){if(e.length===0)return this;if(this.isReadOnly)return this;const{currentPageId:r}=this;if(n===r)return this;if(!this.store.has(n))return this;const o=this.getContent(e);if(!o)return this;if(this.getShapesInPage(n).length+o.shapes.length>ls)return od(this,n),this;const i=this.camera.z;return this.history.batch(()=>{this.deleteShapes(e),this.setCurrentPageId(n),this.setFocusLayer(null),this.selectNone(),this.putContent(o,{select:!0,preserveIds:!0,preservePosition:!0});const{center:{x:s,y:a}}=this.selectionBounds;this.setCamera(this.camera.x,this.camera.y,i),this.centerOnPoint(s,a)}),this}lockShapes(e=this.pageState.selectedIds){return this.isReadOnly?this:this}reorderShapes(e,n){if(this.isReadOnly)return this;if(n.length===0)return this;const r=this.getParentsMappedToChildren(n),o=[];switch(e){case"toBack":{r.forEach((i,s)=>{const a=Ee(this.getSortedChildIds(s).map(u=>this.getShapeById(u)));if(i.size===a.length)return;let l,c;for(const u of a){if(!i.has(u)){c=u.index;break}i.delete(u),l=u.index}if(i.size===0)return;const d=ia(l,c,i.size);Array.from(i.values()).sort(jn).forEach((u,h)=>o.push({id:u.id,type:u.type,index:d[h]}))});break}case"toFront":{r.forEach((i,s)=>{const a=Ee(this.getSortedChildIds(s).map(h=>this.getShapeById(h))),l=a.length;if(i.size===l)return;let c,d;for(let h=l-1;h>-1;h--){const p=a[h];if(!i.has(p)){c=p.index;break}i.delete(p),d=p.index}if(i.size===0)return;const u=ia(c,d,i.size);Array.from(i.values()).sort(jn).forEach((h,p)=>o.push({id:h.id,type:h.type,index:u[p]}))});break}case"forward":{r.forEach((i,s)=>{var m;const a=Ee(this.getSortedChildIds(s).map(v=>this.getShapeById(v))),l=a.length;if(i.size===l)return;const c=new Set(Array.from(i).map(v=>a.indexOf(v)));let d=-1,u=!1,h,p,g;for(let v=0;v<l;v++){const x=c.has(v);if(!u&&x)u=!0,d=v,p=void 0;else if(u&&!x){u=!1,g=v-d,h=a[v].index,p=(m=a[v+1])==null?void 0:m.index;const b=ia(h,p,g);for(let E=0;E<g;E++){const P=a[d+E];o.push({id:P.id,type:P.type,index:b[E]})}}}});break}case"backward":{r.forEach((i,s)=>{var p;const a=Ee(this.getSortedChildIds(s).map(g=>this.getShapeById(g))),l=a.length;if(i.size===l)return;const c=new Set(Array.from(i).map(g=>a.indexOf(g)));let d=-1,u=!1,h;for(let g=l-1;g>-1;g--){const m=c.has(g);if(!u&&m)u=!0,d=g;else if(u&&!m){u=!1,h=d-g;const v=ia((p=a[g-1])==null?void 0:p.index,a[g].index,h);for(let x=0;x<h;x++){const b=a[g+x+1];o.push({id:b.id,type:b.type,index:v[x]})}}}});break}}return this.updateShapes(o),this}sendToBack(e=this.pageState.selectedIds){return this.reorderShapes("toBack",e),this}sendBackward(e=this.pageState.selectedIds){return this.reorderShapes("backward",e),this}bringForward(e=this.pageState.selectedIds){return this.reorderShapes("forward",e),this}bringToFront(e=this.pageState.selectedIds){return this.reorderShapes("toFront",e),this}flipShapes(e,n=this.selectedIds){if(this.isReadOnly)return this;let r=Ee(n.map(i=>this.getShapeById(i)));if(!r.length)return this;r=r.map(i=>i.type==="group"?this.getSortedChildIds(i.id).map(s=>this.getShapeById(s)):i).flat();const o=de.Common(Ee(r.map(i=>this.getPageBounds(i)))).center;return this.batch(()=>{for(const i of r){const a=this.getShapeUtil(i).bounds(i),l=this.getPageTransformById(i.id);l&&this.resizeShape(i.id,{x:e==="horizontal"?-1:1,y:e==="vertical"?-1:1},{initialBounds:a,initialPageTransform:l,initialShape:i,mode:"scale_shape",scaleOrigin:o,scaleAxisRotation:0})}}),this}stackShapes(e,n=this.pageState.selectedIds,r){if(this.isReadOnly)return this;const o=Ee(n.map(g=>this.getShapeById(g))).filter(g=>!(!g||Mt.is(g)&&(g.props.start.type==="binding"||g.props.end.type==="binding"))),i=o.length;if(r===void 0&&i<3||i<2)return this;const s=Object.fromEntries(o.map(g=>[g.id,this.getPageBounds(g)]));let a,l,c,d;e==="horizontal"?(a="x",l="minX",c="maxX",d="width"):(a="y",l="minY",c="maxY",d="height");let u;if(r===void 0){const g=[];o.sort((v,x)=>s[v.id][l]-s[x.id][l]);for(let v=0;v<i-1;v++){const x=o[v],b=o[v+1],E=s[x.id],C=s[b.id][l]-E[c],k=g.find($=>$.gap===C);k?k.count++:g.push({gap:C,count:1})}let m=0;g.forEach(v=>{v.count>m&&(m=v.count,u=v.gap)}),m===1&&(u=Math.max(0,g.reduce((v,x)=>v+x.gap*x.count,0)/(i-1)))}else u=r;const h=[];let p=s[o[0].id][c];return o.forEach((g,m)=>{var P,C;if(m===0)return;const v={x:0,y:0};v[a]=p+u-s[g.id][a];const x=this.getParentShape(g),b=x?I.Rot(v,-this.getPageRotation(x)):v,E=(C=(P=this.getShapeUtil(g)).onTranslateStart)==null?void 0:C.call(P,g);h.push(E?{...E,[a]:g[a]+b[a]}:{id:g.id,type:g.type,[a]:g[a]+b[a]}),p+=s[g.id][d]+u}),this.updateShapes(h),this}packShapes(e=this.pageState.selectedIds,n=16){var C,k;if(this.isReadOnly)return this;if(e.length<2)return this;const r=Ee(e.map($=>this.getShapeById($)).filter($=>!(!$||Mt.is($)&&($.props.start.type==="binding"||$.props.end.type==="binding")))),o={},i={};let s,a,l=0;for(let $=0;$<r.length;$++)s=r[$],a=this.getPageBounds(s),o[s.id]=a,i[s.id]=a.clone(),l+=a.width*a.height;const c=de.Common(Ee(Object.values(o))),d=c.width;r.sort(($,A)=>o[A.id].height-o[$.id].height);const u=Math.max(Math.ceil(Math.sqrt(l/.95)),d),h=[new de(c.x,c.y,u,1/0)];let p=0,g=0,m,v;for(let $=0;$<r.length;$++){s=r[$],a=i[s.id];for(let A=h.length-1;A>=0;A--)if(m=h[A],!(a.width>m.width||a.height>m.height)){a.x=m.x,a.y=m.y,g=Math.max(g,a.maxY),p=Math.max(p,a.maxX),a.width===m.width&&a.height===m.height?(v=h.pop(),A<h.length&&(h[A]=v)):a.height===m.height?(m.x+=a.width+n,m.width-=a.width+n):a.width===m.width?(m.y+=a.height+n,m.height-=a.height+n):(h.push(new de(m.x+(a.width+n),m.y,m.width-(a.width+n),a.height)),m.y+=a.height+n,m.height-=a.height+n);break}}const x=de.Common(Object.values(i)),b=I.Sub(c.center,x.center);let E;const P=[];for(let $=0;$<r.length;$++){s=r[$],a=o[s.id],E=i[s.id];const A=this.getDeltaInParentSpace(s,I.Sub(E.point,a.point).add(b)),D={id:s.id,type:s.type,x:s.x+A.x,y:s.y+A.y},j=(k=(C=this.getShapeUtil(s)).onTranslateStart)==null?void 0:k.call(C,{...s,...D});j?P.push({...D,...j}):P.push(D)}return P.length&&this.updateShapes(P),this}alignShapes(e,n=this.pageState.selectedIds){if(this.isReadOnly)return this;if(n.length<2)return this;const r=Ee(n.map(a=>this.getShapeById(a))),o=Object.fromEntries(r.map(a=>[a.id,this.getPageBounds(a)])),i=de.Common(Ee(Object.values(o))),s=[];return r.forEach(a=>{var p,g;const l=o[a.id];if(!l)return;const c={x:0,y:0};switch(e){case"top":{c.y=i.minY-l.minY;break}case"center-vertical":{c.y=i.midY-l.minY-l.height/2;break}case"bottom":{c.y=i.maxY-l.minY-l.height;break}case"left":{c.x=i.minX-l.minX;break}case"center-horizontal":{c.x=i.midX-l.minX-l.width/2;break}case"right":{c.x=i.maxX-l.minX-l.width;break}}const d=this.getParentShape(a),u=d?I.Rot(c,-this.getPageRotation(d)):c,h=(g=(p=this.getShapeUtil(a)).onTranslateStart)==null?void 0:g.call(p,a);s.push(h?{...h,x:a.x+u.x,y:a.y+u.y}:{id:a.id,type:a.type,x:a.x+u.x,y:a.y+u.y})}),this.updateShapes(s),this}distributeShapes(e,n=this.pageState.selectedIds){if(this.isReadOnly)return this;if(n.length<3)return this;const r=n.length,o=Ee(n.map(x=>this.getShapeById(x))),i=Object.fromEntries(o.map(x=>[x.id,this.getPageBounds(x)]));let s,a,l,c,d;e==="horizontal"?(s="x",a="minX",l="maxX",c="midX",d="width"):(s="y",a="minY",l="maxY",c="midY",d="height");const u=[],h=o.sort((x,b)=>i[x.id][a]-i[b.id][a])[0],p=o.sort((x,b)=>i[b.id][l]-i[x.id][l])[0],g=i[h.id][c],m=(i[p.id][c]-g)/(r-1),v=g+m;return o.filter(x=>x!==h&&x!==p).sort((x,b)=>i[x.id][c]-i[b.id][c]).forEach((x,b)=>{var $,A;const E={x:0,y:0};E[s]=v+m*b-i[x.id][d]/2-i[x.id][s];const P=this.getParentShape(x),C=P?I.Rot(E,-this.getPageRotation(P)):E,k=(A=($=this.getShapeUtil(x)).onTranslateStart)==null?void 0:A.call($,x);u.push(k?{...k,[s]:x[s]+C[s]}:{id:x.id,type:x.type,[s]:x[s]+C[s]})}),this.updateShapes(u),this}_resizeUnalignedShape(e,n,r){const{type:o}=r.initialShape,i=new I(n.x,n.y);if(Math.abs(n.x)>Math.abs(n.y)?i.x=Math.sign(n.x)*Math.abs(n.y):i.y=Math.sign(n.y)*Math.abs(n.x),this.resizeShape(e,i,{initialShape:r.initialShape,initialBounds:r.initialBounds}),Math.sign(n.x)*Math.sign(n.y)<0){let{rotation:g}=ee.Decompose(r.initialPageTransform);g-=2*g,this.updateShapes([{id:e,type:o,rotation:g}],!0)}const s=ee.applyToPoint(r.initialPageTransform,r.initialBounds.center),a=this._scalePagePoint(s,r.scaleOrigin,n,r.scaleAxisRotation),l=this.getPageCenterById(e),c=this.getPagePointById(e);if(!l||!c)return this;const d=I.Sub(a,l),u=I.Add(c,d),{x:h,y:p}=this.getPointInParentSpace(e,u);return this.updateShapes([{id:e,type:o,x:h,y:p}],!0),this}_scalePagePoint(e,n,r,o){const i=I.RotWith(e,n,-o).sub(n),s=I.MulV(i,r);return I.Add(s,n).rotWith(n,o)}resizeShape(e,n,r){var u;if(this.isReadOnly)return this;Number.isFinite(n.x)||(n=new I(1,n.y)),Number.isFinite(n.y)||(n=new I(n.x,1));const o=(r==null?void 0:r.initialShape)??this.getShapeById(e);if(!o)return this;const i=(r==null?void 0:r.scaleOrigin)??((u=this.getPageBoundsById(e))==null?void 0:u.center);if(!i)return this;const s=this.getPageRotationById(e);if(s==null)return this;const a=(r==null?void 0:r.scaleAxisRotation)??s,l=(r==null?void 0:r.initialPageTransform)??this.getPageTransformById(e);if(!l)return this;const c=(r==null?void 0:r.initialBounds)??this.getBoundsById(e);if(!c)return this;if(!MI(s,a))return this._resizeUnalignedShape(e,n,{...r,initialBounds:c,scaleOrigin:i,scaleAxisRotation:a,initialPageTransform:l,initialShape:o});const d=this.getShapeUtil(o);if(d.isAspectRatioLocked(o)&&(Math.abs(n.x)>Math.abs(n.y)?n=new I(n.x,Math.sign(n.y)*Math.abs(n.x)):n=new I(Math.sign(n.x)*Math.abs(n.y),n.y)),d.onResize&&d.canResize(o)){const h=this._scalePagePoint(ee.applyToPoint(l,new I(0,0)),i,n,a),p=this.getPointInParentSpace(o.id,h),g=new I(n.x,n.y),m=nc((s-a)%Math.PI,0);g.x=m?n.x:n.y,g.y=m?n.y:n.x;const v=ee.applyToPoint(l,new I),{x,y:b}=this.getPointInParentSpace(o.id,v);this.updateShapes([{id:e,type:o.type,x:p.x,y:p.y,...d.onResize({...o,x,y:b},{newPoint:p,handle:(r==null?void 0:r.dragHandle)??"bottom_right",mode:(r==null?void 0:r.mode)??"scale_shape",scaleX:g.x,scaleY:g.y,initialBounds:c,initialShape:o})}],!0)}else{const h=ee.applyToPoint(l,c.center),p=this._scalePagePoint(h,i,n,a),g=this.getPointInParentSpace(o.id,h),m=this.getPointInParentSpace(o.id,p),v=I.Sub(m,g);this.updateShapes([{id:e,type:o.type,x:o.x+v.x,y:o.y+v.y}],!0)}return this}stretchShapes(e,n=this.pageState.selectedIds){if(this.isReadOnly)return this;if(n.length<2)return this;const r=Ee(n.map(l=>this.getShapeById(l))),o=Object.fromEntries(r.map(l=>[l.id,this.getBounds(l)])),i=Object.fromEntries(r.map(l=>[l.id,this.getPageBounds(l)])),s=de.Common(Ee(Object.values(i))),a=[];switch(e){case"vertical":{this.batch(()=>{for(const l of r){if(this.getPageRotation(l)%dt)continue;const d=o[l.id],u=i[l.id],h=this.getDeltaInParentSpace(l,new I(0,s.minY-u.minY)),{x:p,y:g}=I.Add(h,l);this.updateShapes([{id:l.id,type:l.type,x:p,y:g}],!0);const m=new I(1,s.height/u.height);this.resizeShape(l.id,m,{initialBounds:d,scaleOrigin:new I(u.center.x,s.minY),scaleAxisRotation:0})}});break}case"horizontal":{this.batch(()=>{for(const l of r){const c=o[l.id],d=i[l.id];if(this.getPageRotation(l)%dt)continue;const h=this.getDeltaInParentSpace(l,new I(s.minX-d.minX,0)),{x:p,y:g}=I.Add(h,l);this.updateShapes([{id:l.id,type:l.type,x:p,y:g}],!0);const m=new I(s.width/d.width,1);this.resizeShape(l.id,m,{initialBounds:c,scaleOrigin:new I(s.minX,d.center.y),scaleAxisRotation:0})}});break}}return this.updateShapes(a),this}reparentShapesById(e,n,r){const o=[],i=it.isId(n)?ee.Identity():this.getPageTransformById(n),s=i.decompose().rotation;let a=[];const l=Ee(this.getSortedChildIds(n).map(d=>this.getShapeById(d)));if(r){const d=l.find(u=>u.index===r);if(d){const u=l[l.indexOf(d)+1];u?a=ia(r,u.index,e.length):a=Cg(r,e.length)}else{const u=l.sort(jn).find(h=>h.index>r);u?a=ia(r,u.index,e.length):a=Cg(r,e.length)}}else{const d=l.length&&l[l.length-1];a=d?Cg(d.index,e.length):j2(e.length)}let c;for(let d=0;d<e.length;d++){c=e[d];const u=this.getShapeById(c),h=this.getPagePointById(c);if(!u||!h)continue;const p=ee.applyToPoint(ee.Inverse(i),h),g=this.getPageRotation(u)-s;o.push({id:u.id,type:u.type,parentId:n,x:p.x,y:p.y,rotation:g,index:a[d]})}return this.updateShapes(o),this}select(...e){return this.setSelectedIds(e),this}deselect(...e){const{selectedIds:n}=this;return n.length>0&&e.length>0&&this.setSelectedIds(n.filter(r=>!e.includes(r))),this}selectAll(){const e=this.getSortedChildIds(this.currentPageId);return e.length<=0?this:(this.setSelectedIds(e),this)}getShapesAndDescendantsInOrder(e){const n=[],r=new Set,o=[...e];for(;o.length>0;){const a=o.pop();if(!a)break;r.has(a)||(n.push(a),this.getSortedChildIds(a).forEach(l=>{o.push(l)}))}const i=n.map(a=>this.getShapeById(a)).filter(a=>a.type!=="group"),{sortedShapesArray:s}=this;return i.sort((a,l)=>s.indexOf(a)-s.indexOf(l)),i}selectNone(){return this.selectedIds.length>0&&this.setSelectedIds([]),this}setCurrentPageId(e,{stopFollowing:n=!0}={}){return this._setCurrentPageId(e,{stopFollowing:n}),this}updateInstanceState(e,n=!1,r=!1){return this._updateInstanceState(e,n,r),this}get hoveredId(){return this.pageState.hoveredId}get hoveredShape(){return this.hoveredId?this.getShapeById(this.hoveredId)??null:null}setHoveredId(e=null){return e===this.pageState.hoveredId?this:(this.setInstancePageState({hoveredId:e},!0),this)}setErasingIds(e=[]){const n=this.erasingIdsSet;return e.length===n.size&&e.every(r=>n.has(r))?this:(this.setInstancePageState({erasingIds:e},!0),this)}setCursor(e){const n=this.cursor,r={...n,rotation:0,...e};return n.type===r.type&&n.rotation===r.rotation&&n.color===r.color||this.updateInstanceState({cursor:r},!0),this}setScribble(e=null){return this.updateInstanceState({scribble:e},!0),this}setBrush(e=null){return!e&&!this.brush?this:(this.updateInstanceState({brush:e},!0),this)}setZoomBrush(e=null){return!e&&!this.zoomBrush?this:(this.updateInstanceState({zoomBrush:e},!0),this)}rotateShapesBy(e,n){if(e.length<=0)return this;const r=Y2({app:this});return Hd({delta:n,snapshot:r,app:this,stage:"one-off"}),this}nudgeShapes(e,n,r=!1,o=!1){var l,c;if(e.length<=0)return this;const i=this.isGridMode?r?this.gridSize*cN:this.gridSize:r?iN:sN,s=I.Mul(n,i),a=[];for(const d of e){const u=this.getShapeById(d);if(!u)throw Error(`Could not find a shape with the id ${d}.`);const h=this.getDeltaInParentSpace(u,s),p=(c=(l=this.getShapeUtil(u)).onTranslateStart)==null?void 0:c.call(l,u);a.push(p?{...p,x:u.x+h.x,y:u.y+h.y}:{id:d,x:u.x+h.x,y:u.y+h.y,type:u.type})}return this.updateShapes(a,o),this}duplicateShapes(e=this.selectedIds,n){if(e.length<=0)return this;const r=new Set(e),o=[],i=[...e];for(;i.length>0;){const l=i.pop();if(!l)break;o.push(l),this.getSortedChildIds(l).forEach(c=>i.push(c))}o.reverse();const s=new Map(o.map(l=>[l,this.createShapeId()])),a=Ee(o.map(l=>{const c=this.getShapeById(l);if(!c)return null;const d=s.get(l);let u=0,h=0;if(n&&r.has(l)){const P=this.getParentTransform(c),C=new I(n.x,n.y).rot(-ee.Decompose(P).rotation);u=C.x,h=C.y}const p=c.parentId??this.currentPageId,g=this.getSortedChildIds(p),m=g.indexOf(c.id),v=g[m+1],x=v?this.getShapeById(v):null,b=x?oc(c.index,x.index):Oo(c.index);let E=Fn(c);if(Mt.is(c)&&Mt.is(E)){const P=this.getShapeUtilByDef(Mt).getArrowInfo(c);let C,k;if(c.props.start.type==="binding"&&(C=s.get(c.props.start.boundShapeId),!C))if(P!=null&&P.isValid){const{x:A,y:D}=P.start.point;E.props.start={type:"point",x:A,y:D}}else{const{start:A}=Yr(this,c);E.props.start={type:"point",x:A.x,y:A.y}}if(c.props.end.type==="binding"&&(k=s.get(c.props.end.boundShapeId),!k))if(P!=null&&P.isValid){const{x:A,y:D}=P.end.point;E.props.end={type:"point",x:A,y:D}}else{const{end:A}=Yr(this,c);E.props.start={type:"point",x:A.x,y:A.y}}const $=Gl(E)?Dh(this,E):py(this,E);if(P!=null&&P.isValid&&($!=null&&$.isValid)&&!Gl(c)){const A=I.Med(P.start.handle,P.end.handle),D=I.Dist(P.middle,A),j=I.Dist($.middle,A);E.props.bend<0?E.props.bend+=j-D:E.props.bend-=j-D}E.props.start.type==="binding"&&C&&(E.props.start.boundShapeId=C),E.props.end.type==="binding"&&k&&(E.props.end.boundShapeId=k)}return E={...E,id:d,x:c.x+u,y:c.y+h,index:b},E}));return a.forEach(l=>{vr(l.parentId)&&s.has(l.parentId)&&(l.parentId=s.get(l.parentId))}),this.history.batch(()=>{const l=a.length+this.shapeIds.size>ls;l&&od(this);const c=l?a.slice(0,ls-this.shapeIds.size):a,d=c.map(u=>u.id);if(this.createShapes(c),this.setSelectedIds(d),n!==void 0){const{viewportPageBounds:u,selectedPageBounds:h}=this;h&&!u.contains(h)&&this.centerOnPoint(h.center.x,h.center.y,{duration:No})}}),this}setProp(e,n,r=!1,o=!1){const i=[],s=a=>{const l=this.getSortedChildIds(a);for(const c of l){const d=this.getShapeById(c);(d==null?void 0:d.type)==="group"&&s(d.id),i.push(d)}};return this.history.batch(()=>{if(this.updateInstanceState({propsForNextShape:aS(this.instanceState.propsForNextShape,{[e]:n})},r,o),this.isIn("select")){const{pageState:{selectedIds:a}}=this;if(a.length>0){const l=Ee(a.map(c=>{const d=this.getShapeById(c);if((d==null?void 0:d.type)==="group"){const u=this.getSortedChildIds(d.id);for(const h of u){const p=this.getShapeById(h);(p==null?void 0:p.type)==="group"&&s(p.id),i.push(p)}return i}else return d})).flat().filter(c=>c.props[e]!==void 0&&(c==null?void 0:c.type)!=="group");if(this.updateShapes(l.map(c=>{const d={...c.props,[e]:n};return e==="color"&&"labelColor"in d&&(d.labelColor="black"),{id:c.id,type:c.type,props:d}}),r),e!=="color"&&e!=="opacity"){const c=[];for(const d of l){const u=this.getShapeById(d.id);if(!u)continue;const h=this.getShapeUtil(u),p=h.bounds(d),g=h.bounds(u),m={id:d.id,type:d.type};let v=!1;if(p.width!==g.width)if(v=!0,Vp.is(d))switch(d.props.align){case"middle":{m.x=u.x+(p.width-g.width)/2;break}case"end":{m.x=u.x+p.width-g.width;break}}else m.x=u.x+(p.width-g.width)/2;p.height!==g.height&&(v=!0,m.y=u.y+(p.height-g.height)/2),v&&c.push(m)}c.length&&this.updateShapes(c,r)}}}this.updateInstanceState({propsForNextShape:aS(this.instanceState.propsForNextShape,{[e]:n})},r,o)}),this}_setCamera(e,n,r=this.camera.z){const o=this.camera;if(o.x===e&&o.y===n&&o.z===r)return this;const i={...o,x:e,y:n,z:r};return this.batch(()=>{this.store.put([i]);const{currentScreenPoint:s}=this.inputs;this.dispatch({type:"pointer",target:"canvas",name:"pointer_move",point:s,pointerId:0,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,button:0,isPen:this.isPenMode??!1}),this.updateUserPresence({viewportPageBounds:this.viewportPageBounds.toJson()}),this._cameraManager.tick()}),this}setCamera(e,n,r=this.camera.z,{stopFollowing:o=!0}={}){return this.stopCameraAnimation(),o&&this.instanceState.followingUserId&&this.stopFollowingUser(),e=Number.isNaN(e)?0:e,n=Number.isNaN(n)?0:n,r=Number.isNaN(r)?1:r,this._setCamera(e,n,r),this}animateCamera(e,n,r=this.camera.z,o=h1){e=Number.isNaN(e)?0:e,n=Number.isNaN(n)?0:n,r=Number.isNaN(r)?1:r;const{width:i,height:s}=this.viewportScreenBounds,a=i/r,l=s/r,c=new de(-e,-n,a,l);return this._animateToViewport(c,o)}centerOnPoint(e,n,r){if(!this.canMoveCamera)return this;const{viewportPageBounds:{width:o,height:i},camera:s}=this;return r!=null&&r.duration?this.animateCamera(-(e-o/2),-(n-i/2),s.z,r):this.setCamera(-(e-o/2),-(n-i/2),s.z),this}zoomToContent(){const e=this.selectedPageBounds??this.allShapesCommonBounds;return e&&this.zoomToBounds(e.minX,e.minY,e.width,e.height,Math.min(1,this.zoomLevel),{duration:220}),this}zoomToFit(e){if(!this.canMoveCamera)return this;const n=[...this.shapeIds];if(n.length<=0)return this;const r=de.Common(Ee(n.map(o=>this.getPageBoundsById(o))));return this.zoomToBounds(r.minX,r.minY,r.width,r.height,void 0,e),this}resetZoom(e=this.viewportScreenCenter,n){if(!this.canMoveCamera)return this;const{x:r,y:o,z:i}=this.camera,{x:s,y:a}=e;return n!=null&&n.duration?this.animateCamera(r+(s/1-s)-(s/i-s),o+(a/1-a)-(a/i-a),1,n):this.setCamera(r+(s/1-s)-(s/i-s),o+(a/1-a)-(a/i-a),1),this}zoomIn(e=this.viewportScreenCenter,n){if(!this.canMoveCamera)return this;const{x:r,y:o,z:i}=this.camera;let s=gi;for(let c=1;c<Zs.length;c++){const d=Zs[c-1],u=Zs[c];if(!(u-i<=(u-d)/2)){s=u;break}}const{x:a,y:l}=e;return n!=null&&n.duration?this.animateCamera(r+(a/s-a)-(a/i-a),o+(l/s-l)-(l/i-l),s,n):this.setCamera(r+(a/s-a)-(a/i-a),o+(l/s-l)-(l/i-l),s),this}zoomOut(e=this.viewportScreenCenter,n){if(!this.canMoveCamera)return this;const{x:r,y:o,z:i}=this.camera;let s=kl;for(let c=Zs.length-1;c>0;c--){const d=Zs[c-1],u=Zs[c];if(!(u-i>=(u-d)/2)){s=d;break}}const{x:a,y:l}=e;return n!=null&&n.duration?this.animateCamera(r+(a/s-a)-(a/i-a),o+(l/s-l)-(l/i-l),s,n):this.setCamera(r+(a/s-a)-(a/i-a),o+(l/s-l)-(l/i-l),s),this}zoomToSelection(e){if(!this.canMoveCamera)return this;const n=this.selectedIds;if(n.length<=0)return this;const r=de.Common(Ee(n.map(o=>this.getPageBoundsById(o))));return this.zoomToBounds(r.minX,r.minY,r.width,r.height,Math.max(1,this.camera.z),e),this}panZoomIntoView(e,n){if(!this.canMoveCamera)return this;if(e.length<=0)return this;const r=de.Common(Ee(e.map(i=>this.getPageBoundsById(i)))),{viewportPageBounds:o}=this;if(o.h<r.h||o.w<r.w)return this.zoomToBounds(r.minX,r.minY,r.width,r.height,this.camera.z,n),this;{const i=this._activeAreaManager.offsets.value,s=o.y+i.top,a=o.maxY-i.right,l=o.maxY-i.bottom,c=o.x+i.left,d=r.y,u=r.maxX,h=r.maxY,p=r.x;let g=0,m=0;l<h?m=l-h:s>d&&(m=s-d),a<u?g=a-u:c>p&&(g=c-p);const{camera:v}=this;n!=null&&n.duration?this.animateCamera(v.x+g,v.y+m,v.z,n):this.setCamera(v.x+g,v.y+m,v.z)}return this}zoomToBounds(e,n,r,o,i,s){if(!this.canMoveCamera)return this;const{viewportScreenBounds:a}=this,l=Math.min(256,a.width*.28);let c=Vr(Math.min((a.width-l)/r,(a.height-l)/o),kl,gi);return i!==void 0&&(c=Math.min(i,c)),s!=null&&s.duration?this.animateCamera(-e+(a.width-r*c)/2/c,-n+(a.height-o*c)/2/c,c,s):this.setCamera(-e+(a.width-r*c)/2/c,-n+(a.height-o*c)/2/c,c),this}pan(e,n,r){if(!this.canMoveCamera)return this;const{camera:o}=this,{x:i,y:s,z:a}=o,l=new I(e,n).div(a);return(r==null?void 0:r.duration)??0>0?this.animateCamera(i+l.x,s+l.y,a,r):(this.setCamera(i+l.x,s+l.y,a),this)}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_animateViewport(e){if(!this._viewportAnimation)return;const n=()=>{this.removeListener("tick",this._animateViewport),this.removeListener("stop-camera-animation",n),this._viewportAnimation=null};this.once("stop-camera-animation",n),this._viewportAnimation.elapsed+=e;const{elapsed:r,easing:o,duration:i,start:s,end:a}=this._viewportAnimation;if(r>i){const b=this.viewportScreenBounds.width/a.width,E=-a.x,P=-a.y;this._setCamera(E,P,b),n();return}const l=i-r,c=o(1-l/i),d=s.minX+(a.minX-s.minX)*c,u=s.minY+(a.minY-s.minY)*c,h=s.maxX+(a.maxX-s.maxX)*c,p=s.maxY+(a.maxY-s.maxY)*c,g=new de(d,u,h-d,p-u),m=this.viewportScreenBounds.width/g.width,v=-g.x,x=-g.y;this._setCamera(v,x,m)}_animateToViewport(e,n={}){const{duration:r=0,easing:o=Pn.easeInOutCubic}=n,i=this.viewportPageBounds.clone();return this.stopCameraAnimation(),this.instanceState.followingUserId&&this.stopFollowingUser(),this._viewportAnimation={elapsed:0,duration:r,easing:o,start:i,end:e},this.addListener("tick",this._animateViewport),this}slideCamera(e={}){if(!this.canMoveCamera)return this;const{speed:n,direction:r,friction:o,speedThreshold:i=.01}=e;let s=n;this.stopCameraAnimation();const a=()=>{this.removeListener("tick",l),this.removeListener("stop-camera-animation",a)};this.once("stop-camera-animation",a);const l=c=>{const{x:d,y:u,z:h}=this.camera,p=r.clone().mul(s*c/h);s*=1-o,s<i?a():this._setCamera(d+p.x,u+p.y,h)};return this.addListener("tick",l),this}animateToShape(e,n=h1){if(!this.canMoveCamera)return this;const r=G2(this),o=r.width/r.height,i=this.getPageBoundsById(e);if(!i)return this;const s=i.width/i.height,a=i.clone(),l=i.width/r.width;return a.width+=(r.left+r.right)*l,a.height+=(r.top+r.bottom)*l,a.x-=r.left*l,a.y-=r.top*l,s>o?(a.height=i.width/o,a.y-=(a.height-i.height)/2):(a.width=i.height*o,a.x-=(a.width-i.width)/2),this._animateToViewport(a,n)}blur(){return this.complete(),this.getContainer().blur(),this._isFocused.set(!1),this}focus(){return this.getContainer().focus(),this._isFocused.set(!0),this}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}async onCreateAssetFromFile(e){return await p7(e)}async onCreateBookmarkFromUrl(e){var n,r,o;try{const s=await(await fetch(e,{method:"GET",mode:"no-cors"})).text(),a=new DOMParser().parseFromString(s,"text/html");return{image:((n=a.head.querySelector('meta[property="og:image"]'))==null?void 0:n.getAttribute("content"))??"",title:((r=a.head.querySelector('meta[property="og:title"]'))==null?void 0:r.getAttribute("content"))??"",description:((o=a.head.querySelector('meta[property="og:description"]'))==null?void 0:o.getAttribute("content"))??""}}catch(i){return console.error(i),{image:"",title:"",description:""}}}groupShapes(e=this.selectedIds,n=Ut()){var u;if(this.isReadOnly)return this;if(e.length<=1)return this;const r=Ee(e.map(h=>this.getShapeById(h))),o=r.sort(jn).map(h=>h.id),i=de.Common(Ee(r.map(h=>this.getPageBounds(h)))),{x:s,y:a}=i.point,l=this.findCommonAncestor(r)??this.currentPageId;if(this.currentToolId!=="select")return this;this.isIn("select.idle")||this.cancel();const c=r.filter(h=>h.parentId===l).sort(jn),d=(u=c[c.length-1])==null?void 0:u.index;return this.batch(()=>{this.createShapes([{id:n,type:"group",parentId:l,index:d,x:s,y:a,props:{opacity:"1"}}]),this.reparentShapesById(o,n),this.select(n)}),this}ungroupShapes(e=this.selectedIds){if(this.isReadOnly)return this;if(e.length===0)return this;if(this.currentToolId!=="select")return this;this.isIn("select.idle")||this.cancel();const n=new Set,r=Ee(e.map(i=>this.getShapeById(i))),o=[];return r.forEach(i=>{A2.is(i)?o.push(i):n.add(i.id)}),o.length===0?this:(this.batch(()=>{let i;for(let s=0,a=o.length;s<a;s++){i=o[s];const l=this.getSortedChildIds(i.id);for(let c=0,d=l.length;c<d;c++)n.add(l[c]);this.reparentShapesById(l,i.parentId,i.index)}this.deleteShapes(o.map(s=>s.id)),this.select(...n)}),this)}},y(Hm,"styles",Ju),Hm);let Pe=xC;_e([ue],Pe.prototype,"openMenus",1);_e([ue],Pe.prototype,"isMenuOpen",1);_e([ue],Pe.prototype,"_pageTransformCache",1);_e([ue],Pe.prototype,"_pageBoundsCache",1);_e([ue],Pe.prototype,"_pageMaskCache",1);_e([ue],Pe.prototype,"_clipPathCache",1);_e([ue],Pe.prototype,"canUndo",1);_e([ue],Pe.prototype,"canRedo",1);_e([ue],Pe.prototype,"erasingIds",1);_e([ue],Pe.prototype,"hintingIds",1);_e([ue],Pe.prototype,"erasingIdsSet",1);_e([ue],Pe.prototype,"props",1);_e([ue],Pe.prototype,"_arrowBindingsIndex",1);_e([ue],Pe.prototype,"_allPageStates",1);_e([ue],Pe.prototype,"documentSettings",1);_e([ue],Pe.prototype,"_userDocumentSettings",1);_e([ue],Pe.prototype,"_pageState",1);_e([ue],Pe.prototype,"camera",1);_e([ue],Pe.prototype,"zoomLevel",1);_e([ue],Pe.prototype,"selectedIds",1);_e([ue],Pe.prototype,"selectedIdsSet",1);_e([ue],Pe.prototype,"_pages",1);_e([ue],Pe.prototype,"pages",1);_e([ue],Pe.prototype,"_pageStates",1);_e([ue],Pe.prototype,"renderingShapes",1);_e([ue],Pe.prototype,"allShapesCommonBounds",1);_e([ue],Pe.prototype,"viewportScreenBounds",1);_e([ue],Pe.prototype,"viewportScreenCenter",1);_e([ue],Pe.prototype,"viewportPageBounds",1);_e([ue],Pe.prototype,"cullingBounds",1);_e([ue],Pe.prototype,"cullingBoundsExpanded",1);_e([ue],Pe.prototype,"viewportPageCenter",1);_e([ue],Pe.prototype,"editingShape",1);_e([ue],Pe.prototype,"selectedPageBounds",1);_e([ue],Pe.prototype,"selectionRotation",1);_e([ue],Pe.prototype,"selectionBounds",1);_e([ue],Pe.prototype,"selectionPageCenter",1);_e([ue],Pe.prototype,"shapesArray",1);_e([ue],Pe.prototype,"sortedShapesArray",1);_e([ue],Pe.prototype,"selectedShapes",1);_e([ue],Pe.prototype,"onlySelectedShape",1);_e([ue],Pe.prototype,"_currentUserPresence",1);_e([ue],Pe.prototype,"_assets",1);_e([ue],Pe.prototype,"hoveredId",1);_e([ue],Pe.prototype,"hoveredShape",1);function od(t,e=t.currentPageId){const n=t.getPageById(e).name;t.emit("max-shapes",{name:n,pageId:e,count:ls})}let qv={fonts:{draw:"/fonts/Shantell_Sans-Normal-SemiBold.woff2",serif:"/fonts/IBMPlexSerif-Medium.woff2",sansSerif:"/fonts/IBMPlexSans-Medium.woff2",monospace:"/fonts/IBMPlexMono-Medium.woff2"}};function O9(t){qv=t}function j9(){const t=Z(),e=Tn(),n=ge("isDarkMode",()=>t.userDocumentSettings.isDarkMode,[t]);xe.useEffect(()=>{n?(e.setAttribute("data-color-mode","dark"),e.classList.remove("tl-theme__light"),e.classList.add("tl-theme__dark"),t.setCursor({color:"white"})):(e.setAttribute("data-color-mode","light"),e.classList.remove("tl-theme__dark"),e.classList.add("tl-theme__light"),t.setCursor({color:"black"}))},[t,e,n])}function N9(t){const e=w.useRef();return w.useLayoutEffect(()=>{e.current=t}),w.useDebugValue(t),w.useCallback((...n)=>{const r=e.current;return uv(r,"fn does not exist"),r(...n)},[])}function B9(){const[t,e]=w.useState(0);w.useEffect(()=>e(n=>n+1),[])}const id=(t,e)=>{const[n,r]=w.useState(2);return w.useEffect(()=>{const{url:o,style:i="normal",weight:s="500",display:a,featureSettings:l,stretch:c,unicodeRange:d,variant:u}=e;let h=!1;r(2);const p={style:i,weight:s,display:a,featureSettings:l,stretch:c,unicodeRange:d,variant:u},g=new FontFace(t,`url(${o})`,p);return g.load().then(()=>{h||(document.fonts.add(g),r(0))}).catch(m=>{h||(console.error(m),r(1))}),g.$$_url=o,g.$$_fontface=`
@font-face {
	font-family: ${g.family};
	font-stretch: ${g.stretch};
	font-weight: ${g.weight};
	font-style: ${g.style};
	src: url("${o}") format("woff2")
}`,()=>{document.fonts.delete(g),h=!0}},[t,e]),n};function z9(t){return{draw:{url:t.fonts.draw},serif:{url:t.fonts.serif},sansSerif:{url:t.fonts.sansSerif},monospace:{url:t.fonts.monospace}}}function U9(t){const e=w.useMemo(()=>z9(t),[t]),n=[id("tldraw_draw",e.draw),id("tldraw_serif",e.serif),id("tldraw_sans",e.sansSerif),id("tldraw_mono",e.monospace)];return{error:n.some(r=>r===1),done:!n.some(r=>r===2)}}let bC=!1;if(typeof window<"u"){const t=window.navigator.userAgent,e=!!t.match(/iPad/i)||!!t.match(/iPhone/i),n=!!t.match(/WebKit/i);bC=e&&n&&!t.match(/CriOS/i)}function F9(){const t=Z();w.useEffect(()=>{if(!bC)return;function e(n){(n.target instanceof HTMLInputElement&&n.target.type==="text"||n.target instanceof HTMLTextAreaElement)&&t.complete()}return document.addEventListener("focusout",e),()=>document.removeEventListener("focusout",e)},[t])}function K9(){const t=Z(),e=Tn();w.useEffect(()=>{const n=i=>e.style.setProperty("--tl-zoom",i.toString()),r=D_(n,100),o=new uu("useZoomCss",()=>{t.shapeIds.size<300?n(t.zoomLevel):r(t.zoomLevel)});return o.attach(),o.execute(),()=>{o.detach()}},[t,e])}function Qv(t){const[e,n]=xe.useState(null),{components:r,...o}=t,i=(r==null?void 0:r.ErrorFallback)===void 0?Vv:r==null?void 0:r.ErrorFallback;return f.jsx("div",{ref:n,draggable:!1,className:"tl-container tl-theme__light",tabIndex:0,children:f.jsx(Fp,{fallback:i?s=>f.jsx(i,{error:s}):null,onError:s=>dv(s,{tags:{origin:"react.tldraw-before-app"}}),children:e&&f.jsx(P7,{container:e,children:f.jsx(nF,{overrides:r,children:f.jsx(H9,{...o})})})})})}function H9({config:t=_i.default,userId:e,instanceId:n,store:r,...o}){const{done:i,error:s}=U9(o.assetUrls??qv);r??(r=t.createStore({userId:e??$s.createId(),instanceId:n??Fo.createId()}));let a;if(r instanceof W_)a=r;else{if(r.error)throw r.error;if(!r.store)return f.jsx(pS,{children:"Connecting..."});a=r.store}return n&&a.props.instanceId!==n&&console.error(`The store's instanceId (${a.props.instanceId}) does not match the instanceId prop (${n}). This may cause unexpected behavior.`),e&&a.props.userId!==e&&console.error(`The store's userId (${a.props.userId}) does not match the userId prop (${e}). This may cause unexpected behavior.`),s?f.jsx(X9,{children:"Could not load assets. Please refresh the page."}):i?f.jsx(V9,{...o,store:a,config:t}):f.jsx(pS,{children:"Loading assets..."})}function V9({onMount:t,config:e,isDarkMode:n,children:r,onCreateAssetFromFile:o,onCreateBookmarkFromUrl:i,store:s,autoFocus:a}){const l=Tn(),[c,d]=xe.useState(null),{ErrorFallback:u}=wn();xe.useLayoutEffect(()=>{const g=new Pe({store:s,getContainer:()=>l,config:e});return d(g),a&&g.focus(),window.app=g,()=>{g.dispose(),d(m=>m===g?null:m)}},[l,e,s,a]),xe.useEffect(()=>{c&&(o&&(c.onCreateAssetFromFile=o),i&&(c.onCreateBookmarkFromUrl=i))},[c,o,i]);const h=N9(g=>{t==null||t(g),g.emit("mount")});xe.useEffect(()=>{c&&(n!==void 0&&c.updateUserDocumentSettings({isDarkMode:n}),window.tldrawReady=!0,h(c))},[c,h,n]);const p=w.useSyncExternalStore(w.useCallback(g=>c?(c.on("crash",g),()=>c.off("crash",g)):()=>{},[c]),()=>(c==null?void 0:c.crashingError)??null);return c?f.jsx(Fp,{fallback:u?g=>f.jsx(u,{error:g,app:c}):null,onError:g=>c.annotateError(g,{origin:"react.tldraw",willCrashApp:!0}),children:p?f.jsx(Y9,{crashingError:p}):f.jsx(Mv.Provider,{value:c,children:f.jsx(W9,{children:r})})}):null}function W9({children:t}){return K9(),fU(),j9(),F9(),B9(),t}function Y9({crashingError:t}){throw t}function pS({children:t}){const{Spinner:e}=wn();return f.jsxs("div",{className:"tl-loading",children:[e?f.jsx(e,{}):null,t]})}function X9({children:t}){return f.jsx("div",{className:"tl-loading",children:t})}function SC(t){const e=t.cloneNode(!0);return t.setAttribute("width",+t.getAttribute("width")+""),t.setAttribute("height",+t.getAttribute("height")+""),new XMLSerializer().serializeToString(e).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1")}async function EC(t,e){const{type:n,quality:r,scale:o}=e,i=+t.getAttribute("width"),s=+t.getAttribute("height"),a=await PC(t),l=await new Promise(u=>{const h=new Image;h.crossOrigin="anonymous",h.onload=async()=>{await new Promise(m=>setTimeout(m,250));const p=document.createElement("canvas"),g=p.getContext("2d");p.width=i*o,p.height=s*o,g.imageSmoothingEnabled=!0,g.imageSmoothingQuality="high",g.drawImage(h,0,0,i*o,s*o),URL.revokeObjectURL(a),u(p)},h.onerror=()=>{u(null)},h.src=a});if(!l)return null;const c=await new Promise(u=>l.toBlob(h=>{(!h||Gt.throwToBlob.value)&&u(null),u(h)},"image/"+n,r));if(!c)return null;const d=new DataView(await c.arrayBuffer());return a7(d,o,{type:"image/"+n})}async function PC(t){const e=t.cloneNode(!0);e.setAttribute("encoding",'UTF-8"');const n=new FileReader,r=Array.from(e.querySelectorAll("image"));for(const o of r){const i=o.getAttribute("xlink:href");if(i&&!i.startsWith("data:")){const s=await(await fetch(i)).blob(),a=await new Promise((l,c)=>{n.onload=()=>l(n.result),n.onerror=()=>c(n.error),n.readAsDataURL(s)});o.setAttribute("xlink:href",a)}}return G9(e)}function G9(t){const e=new XMLSerializer().serializeToString(t);return`data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(e)))}`}function Tg(t,e){const n=document.createElement("a");n.href=t,n.download=e,n.click()}function q9(t,e="_blank"){Dv.openWindow(t,e)}function Q9(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
• If your hard disk is full, try clearing up some space and then reload the page.`)}function Z9(){window.alert(`Oops! We could not access to your browser's storage—and the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}const J9=(t,e)=>e.some(n=>t instanceof n);let fS,gS;function eK(){return fS||(fS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tK(){return gS||(gS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _C=new WeakMap,by=new WeakMap,IC=new WeakMap,Mg=new WeakMap,Zv=new WeakMap;function nK(t){const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{n(Vo(t.result)),o()},s=()=>{r(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",s)});return e.then(n=>{n instanceof IDBCursor&&_C.set(n,t)}).catch(()=>{}),Zv.set(e,t),e}function rK(t){if(by.has(t))return;const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{n(),o()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)});by.set(t,e)}let Sy={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return by.get(t);if(e==="objectStoreNames")return t.objectStoreNames||IC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Vo(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function oK(t){Sy=t(Sy)}function iK(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ag(this),e,...n);return IC.set(r,e.sort?e.sort():[e]),Vo(r)}:tK().includes(t)?function(...e){return t.apply(Ag(this),e),Vo(_C.get(this))}:function(...e){return Vo(t.apply(Ag(this),e))}}function sK(t){return typeof t=="function"?iK(t):(t instanceof IDBTransaction&&rK(t),J9(t,eK())?new Proxy(t,Sy):t)}function Vo(t){if(t instanceof IDBRequest)return nK(t);if(Mg.has(t))return Mg.get(t);const e=sK(t);return e!==t&&(Mg.set(t,e),Zv.set(e,t)),e}const Ag=t=>Zv.get(t);function aK(t,e,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const s=indexedDB.open(t,e),a=Vo(s);return r&&s.addEventListener("upgradeneeded",l=>{r(Vo(s.result),l.oldVersion,l.newVersion,Vo(s.transaction),l)}),n&&s.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),o&&l.addEventListener("versionchange",c=>o(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}function lK(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Vo(n).then(()=>{})}const cK=["get","getKey","getAll","getAllKeys","count"],uK=["put","add","delete","clear"],Rg=new Map;function mS(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Rg.get(e))return Rg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=uK.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||cK.includes(n)))return;const i=async function(s,...a){const l=this.transaction(s,o?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),o&&l.done]))[0]};return Rg.set(e,i),i}oK(t=>({...t,get:(e,n,r)=>mS(e,n)||t.get(e,n,r),has:(e,n)=>!!mS(e,n)||t.has(e,n)}));const La="TLDRAW_TAB_ID_v2",Fe=globalThis.window;function dK(){return Fe?["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(Fe.navigator.platform)||Fe.navigator.userAgent.includes("Mac")&&"ontouchend"in document:!1}const CC="TLDRAW_USER_DATA_v2",sc=lt("globalUserData",JSON.parse((Fe==null?void 0:Fe.localStorage.getItem(CC))||"null")??$s.create({}));du("set global user data",()=>{Fe&&Fe.localStorage.setItem(CC,JSON.stringify(sc.value))});function kC(){return sc.value}function hK(t){const e=sc.value.id;return t.listen(({changes:n})=>{for(const r of Object.values(n.added))r.typeName==="user"&&e===r.id&&sc.set(r);for(const[r,o]of Object.values(n.updated))o.typeName==="user"&&e===o.id&&sc.set(o)})}const $C="TLDRAW_DEFAULT_DOCUMENT_NAME_v2",TC=(Fe==null?void 0:Fe.localStorage.getItem($C))??_t();Fe==null||Fe.localStorage.setItem($C,TC);const Jv="TLDRAW_DOCUMENT_v2",zh=(Fe==null?void 0:Fe[La])??(Fe==null?void 0:Fe.sessionStorage[La])??Fo.createId();Fe&&(Fe[La]=zh,dK()?Fe.sessionStorage[La]=zh:delete Fe.sessionStorage[La]);Fe==null||Fe.addEventListener("beforeunload",()=>{Fe.sessionStorage[La]=zh});const MC="TLDRAW_DB_NAME_INDEX_v2";function ew(){const t=JSON.parse((Fe==null?void 0:Fe.localStorage.getItem(MC))||"[]")??[];return Array.isArray(t)?t:[]}function pK(t){const e=new Set(ew());e.add(t),Fe==null||Fe.localStorage.setItem(MC,JSON.stringify([...e]))}async function tw(t,e){pK(t);const n=await aK(t,2,{upgrade(r){r.objectStoreNames.contains("records")||r.createObjectStore("records"),r.createObjectStore("schema")}});try{return await e(n)}finally{n.close()}}async function fK(t,e){const n=Jv+t;if(ew().includes(n))return await tw(n,async r=>{var a;if((a=e==null?void 0:e.didCancel)!=null&&a.call(e))return;const o=r.transaction(["records","schema"],"readonly"),i=o.objectStore("records"),s=o.objectStore("schema");return{records:await i.getAll(),schema:await s.get("schema")}})}async function gK(t,e,n,r){const o=Jv+t;await tw(o,async i=>{var c;const s=i.transaction(["records","schema"],"readwrite"),a=s.objectStore("records"),l=s.objectStore("schema");for(const[d,u]of Object.entries(n.added))await a.put(u,d);for(const[d,u]of Object.values(n.updated))await a.put(u,u.id);for(const d of Object.keys(n.removed))await a.delete(d);if(l.put(e.serialize(),"schema"),(c=r==null?void 0:r.didCancel)!=null&&c.call(r))return s.abort();await s.done})}async function mK(t,e,n,r){const o=Jv+t;await tw(o,async i=>{var c;const s=i.transaction(["records","schema"],"readwrite"),a=s.objectStore("records"),l=s.objectStore("schema");await a.clear();for(const[d,u]of Object.entries(n))await a.put(u,d);if(l.put(e.serialize(),"schema"),(c=r==null?void 0:r.didCancel)!=null&&c.call(r))return s.abort();await s.done})}const yK=350,vK=1e4,wK=t=>t;class xK{constructor(e){y(this,"onmessage")}postMessage(e){}close(){}}const bK=typeof BroadcastChannel>"u"?xK:BroadcastChannel;class SK{constructor(e,{universalPersistenceKey:n,onLoad:r,onLoadError:o},i=new bK(`tldraw-tab-sync-${n}`)){y(this,"disposables",new Set);y(this,"diffQueue",[]);y(this,"didDispose",!1);y(this,"shouldDoFullDBWrite",!0);y(this,"isReloading",!1);y(this,"universalPersistenceKey");y(this,"serializedSchema");y(this,"isDebugging",!1);y(this,"initTime",Date.now());y(this,"isPersisting",!1);y(this,"didLastWriteError",!1);y(this,"scheduledPersistTimeout",null);this.store=e,this.channel=i,typeof window<"u"&&(window.tlsync=this),this.universalPersistenceKey=n,this.serializedSchema=this.store.schema.serialize(),this.disposables.add(e.listen(({changes:s,source:a})=>{this.debug("changes",s,a),a==="user"&&(this.diffQueue.push(s),this.channel.postMessage(wK({type:"diff",instanceId:this.store.props.instanceId,changes:s,schema:this.serializedSchema})),this.schedulePersist())})),this.connect(r,o)}debug(...e){this.isDebugging&&console.debug(...e)}async connect(e,n){this.debug("connecting");let r;try{r=await fK(this.universalPersistenceKey)}catch(o){n(o),Z9(),typeof window<"u"&&window.location.reload();return}if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose)try{if(r){const o=Object.fromEntries(r.records.map(s=>[s.id,s])),i=this.store.schema.migrateStoreSnapshot(o,r.schema??this.store.schema.serializeEarliestVersion());if(i.type==="error"){console.error("failed to migrate store",i),n(new Error(`Failed to migrate store: ${i.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(i.value),"initialize")})}this.channel.onmessage=({data:o})=>{var a,l;this.debug("got message",o);const i=o,s=b5(this.serializedSchema,i.schema??this.store.schema.serializeEarliestVersion());if(s===-1){if(Date.now()-this.initTime<5e3){n(new Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,(l=(a=window==null?void 0:window.location)==null?void 0:a.reload)==null||l.call(a);return}else if(s===1){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}if(i.type==="diff"){this.debug("applying diff");const c=$p(i.changes.removed,this.store.props.instanceId);Hr(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(i.changes)}),c&&this.store.ensureStoreIsUsable()})}},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),e(this)}catch(o){if(this.debug("error loading data from store",o),this.didDispose)return;n(o);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(e=>e())}schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),!this.scheduledPersistTimeout&&(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?vK:yK))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),!this.isPersisting&&(this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist())}async doPersist(){uv(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");const e=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await mK(this.universalPersistenceKey,this.store.schema,this.store.serialize(),{didCancel:()=>this.didDispose});else{const n=gv(e);await gK(this.universalPersistenceKey,this.store.schema,n)}this.didLastWriteError=!1}catch(n){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",n),Q9(),typeof window<"u"&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}async function EK({shouldReload:t=!0}={}){sessionStorage.clear(),await Promise.all(ew().map(e=>lK(e))),localStorage.clear(),t&&window.location.reload()}typeof window<"u"&&(window.__tldraw__hardReset=EK);function AC({universalPersistenceKey:t,instanceId:e,userId:n,config:r=_i.default}){const[o,i]=w.useState(null);return w.useEffect(()=>{const s=_t();i({id:s,syncedStore:{status:"loading"}});const a=u=>{i(h=>(h==null?void 0:h.id)===s?{id:s,syncedStore:u}:h)},l=r.createStore({userId:n,instanceId:e}),c=new SK(l,{universalPersistenceKey:t,onLoad(){a({status:"synced",store:l})},onLoadError(u){a({status:"error",error:u})}}),d=hK(l);return()=>{i(u=>(u==null?void 0:u.id)===s?null:u),d(),c.close()}},[e,t,r,n]),(o==null?void 0:o.syncedStore)??{status:"loading"}}function oe(){return oe=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oe.apply(this,arguments)}function fe(t,e,{checkForDefaultPrevented:n=!0}={}){return function(o){if(t==null||t(o),n===!1||!o.defaultPrevented)return e==null?void 0:e(o)}}function PK(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function Yp(...t){return e=>t.forEach(n=>PK(n,e))}function qe(...t){return w.useCallback(Yp(...t),t)}function to(t,e=[]){let n=[];function r(i,s){const a=w.createContext(s),l=n.length;n=[...n,s];function c(u){const{scope:h,children:p,...g}=u,m=(h==null?void 0:h[t][l])||a,v=w.useMemo(()=>g,Object.values(g));return w.createElement(m.Provider,{value:v},p)}function d(u,h){const p=(h==null?void 0:h[t][l])||a,g=w.useContext(p);if(g)return g;if(s!==void 0)return s;throw new Error(`\`${u}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,d]}const o=()=>{const i=n.map(s=>w.createContext(s));return function(a){const l=(a==null?void 0:a[t])||i;return w.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return o.scopeName=t,[r,_K(o,...e)]}function _K(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const s=r.reduce((a,{useScope:l,scopeName:c})=>{const u=l(i)[`__scope${c}`];return{...a,...u}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return n.scopeName=e.scopeName,n}const nr=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},IK=mh["useId".toString()]||(()=>{});let CK=0;function Wo(t){const[e,n]=w.useState(IK());return nr(()=>{t||n(r=>r??String(CK++))},[t]),t||(e?`radix-${e}`:"")}function ln(t){const e=w.useRef(t);return w.useEffect(()=>{e.current=t}),w.useMemo(()=>(...n)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...n)},[])}function Xi({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,o]=kK({defaultProp:e,onChange:n}),i=t!==void 0,s=i?t:r,a=ln(n),l=w.useCallback(c=>{if(i){const u=typeof c=="function"?c(t):c;u!==t&&a(u)}else o(c)},[i,t,o,a]);return[s,l]}function kK({defaultProp:t,onChange:e}){const n=w.useState(t),[r]=n,o=w.useRef(r),i=ln(e);return w.useEffect(()=>{o.current!==r&&(i(r),o.current=r)},[r,o,i]),n}var RC={exports:{}},cr={},LC={exports:{}},DC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,H){var G=W.length;W.push(H);e:for(;0<G;){var Q=G-1>>>1,le=W[Q];if(0<o(le,H))W[Q]=H,W[G]=le,G=Q;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var H=W[0],G=W.pop();if(G!==H){W[0]=G;e:for(var Q=0,le=W.length,De=le>>>1;Q<De;){var Ie=2*(Q+1)-1,we=W[Ie],Ze=Ie+1,je=W[Ze];if(0>o(we,G))Ze<le&&0>o(je,we)?(W[Q]=je,W[Ze]=G,Q=Ze):(W[Q]=we,W[Ie]=G,Q=Ie);else if(Ze<le&&0>o(je,G))W[Q]=je,W[Ze]=G,Q=Ze;else break e}}return H}function o(W,H){var G=W.sortIndex-H.sortIndex;return G!==0?G:W.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],c=[],d=1,u=null,h=3,p=!1,g=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(W){for(var H=n(c);H!==null;){if(H.callback===null)r(c);else if(H.startTime<=W)r(c),H.sortIndex=H.expirationTime,e(l,H);else break;H=n(c)}}function P(W){if(m=!1,E(W),!g)if(n(l)!==null)g=!0,ne(C);else{var H=n(c);H!==null&&ie(P,H.startTime-W)}}function C(W,H){g=!1,m&&(m=!1,x(A),A=-1),p=!0;var G=h;try{for(E(H),u=n(l);u!==null&&(!(u.expirationTime>H)||W&&!Y());){var Q=u.callback;if(typeof Q=="function"){u.callback=null,h=u.priorityLevel;var le=Q(u.expirationTime<=H);H=t.unstable_now(),typeof le=="function"?u.callback=le:u===n(l)&&r(l),E(H)}else r(l);u=n(l)}if(u!==null)var De=!0;else{var Ie=n(c);Ie!==null&&ie(P,Ie.startTime-H),De=!1}return De}finally{u=null,h=G,p=!1}}var k=!1,$=null,A=-1,D=5,j=-1;function Y(){return!(t.unstable_now()-j<D)}function V(){if($!==null){var W=t.unstable_now();j=W;var H=!0;try{H=$(!0,W)}finally{H?q():(k=!1,$=null)}}else k=!1}var q;if(typeof b=="function")q=function(){b(V)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,X=F.port2;F.port1.onmessage=V,q=function(){X.postMessage(null)}}else q=function(){v(V,0)};function ne(W){$=W,k||(k=!0,q())}function ie(W,H){A=v(function(){W(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,ne(C))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(W){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var G=h;h=H;try{return W()}finally{h=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,H){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var G=h;h=W;try{return H()}finally{h=G}},t.unstable_scheduleCallback=function(W,H,G){var Q=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?Q+G:Q):G=Q,W){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=G+le,W={id:d++,callback:H,priorityLevel:W,startTime:G,expirationTime:le,sortIndex:-1},G>Q?(W.sortIndex=G,e(c,W),n(l)===null&&W===n(c)&&(m?(x(A),A=-1):m=!0,ie(P,G-Q))):(W.sortIndex=le,e(l,W),g||p||(g=!0,ne(C))),W},t.unstable_shouldYield=Y,t.unstable_wrapCallback=function(W){var H=h;return function(){var G=h;h=H;try{return W.apply(this,arguments)}finally{h=G}}}})(DC);LC.exports=DC;var $K=LC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OC=w,sr=$K;function te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jC=new Set,Mc={};function Fs(t,e){Ya(t,e),Ya(t+"Capture",e)}function Ya(t,e){for(Mc[t]=e,t=0;t<e.length;t++)jC.add(e[t])}var Qo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ey=Object.prototype.hasOwnProperty,TK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yS={},vS={};function MK(t){return Ey.call(vS,t)?!0:Ey.call(yS,t)?!1:TK.test(t)?vS[t]=!0:(yS[t]=!0,!1)}function AK(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function RK(t,e,n,r){if(e===null||typeof e>"u"||AK(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Mn(t,e,n,r,o,i,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=s}var cn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){cn[t]=new Mn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];cn[e]=new Mn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){cn[t]=new Mn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){cn[t]=new Mn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){cn[t]=new Mn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){cn[t]=new Mn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){cn[t]=new Mn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){cn[t]=new Mn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){cn[t]=new Mn(t,5,!1,t.toLowerCase(),null,!1,!1)});var nw=/[\-:]([a-z])/g;function rw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(nw,rw);cn[e]=new Mn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(nw,rw);cn[e]=new Mn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(nw,rw);cn[e]=new Mn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){cn[t]=new Mn(t,1,!1,t.toLowerCase(),null,!1,!1)});cn.xlinkHref=new Mn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){cn[t]=new Mn(t,1,!1,t.toLowerCase(),null,!0,!0)});function ow(t,e,n,r){var o=cn.hasOwnProperty(e)?cn[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(RK(e,n,o,r)&&(n=null),r||o===null?MK(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ni=OC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sd=Symbol.for("react.element"),ma=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),iw=Symbol.for("react.strict_mode"),Py=Symbol.for("react.profiler"),NC=Symbol.for("react.provider"),BC=Symbol.for("react.context"),sw=Symbol.for("react.forward_ref"),_y=Symbol.for("react.suspense"),Iy=Symbol.for("react.suspense_list"),aw=Symbol.for("react.memo"),pi=Symbol.for("react.lazy"),zC=Symbol.for("react.offscreen"),wS=Symbol.iterator;function Ll(t){return t===null||typeof t!="object"?null:(t=wS&&t[wS]||t["@@iterator"],typeof t=="function"?t:null)}var yt=Object.assign,Lg;function Zl(t){if(Lg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Lg=e&&e[1]||""}return`
`+Lg+t}var Dg=!1;function Og(t,e){if(!t||Dg)return"";Dg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),i=r.stack.split(`
`),s=o.length-1,a=i.length-1;1<=s&&0<=a&&o[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==i[a]){if(s!==1||a!==1)do if(s--,a--,0>a||o[s]!==i[a]){var l=`
`+o[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{Dg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Zl(t):""}function LK(t){switch(t.tag){case 5:return Zl(t.type);case 16:return Zl("Lazy");case 13:return Zl("Suspense");case 19:return Zl("SuspenseList");case 0:case 2:case 15:return t=Og(t.type,!1),t;case 11:return t=Og(t.type.render,!1),t;case 1:return t=Og(t.type,!0),t;default:return""}}function Cy(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ya:return"Fragment";case ma:return"Portal";case Py:return"Profiler";case iw:return"StrictMode";case _y:return"Suspense";case Iy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case BC:return(t.displayName||"Context")+".Consumer";case NC:return(t._context.displayName||"Context")+".Provider";case sw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case aw:return e=t.displayName||null,e!==null?e:Cy(t.type)||"Memo";case pi:e=t._payload,t=t._init;try{return Cy(t(e))}catch{}}return null}function DK(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cy(e);case 8:return e===iw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Oi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function UC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function OK(t){var e=UC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(s){r=""+s,i.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ad(t){t._valueTracker||(t._valueTracker=OK(t))}function FC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=UC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Uh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ky(t,e){var n=e.checked;return yt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xS(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Oi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function KC(t,e){e=e.checked,e!=null&&ow(t,"checked",e,!1)}function $y(t,e){KC(t,e);var n=Oi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ty(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ty(t,e.type,Oi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function bS(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ty(t,e,n){(e!=="number"||Uh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Jl=Array.isArray;function Da(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Oi(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function My(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(te(91));return yt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function SS(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(te(92));if(Jl(n)){if(1<n.length)throw Error(te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Oi(n)}}function HC(t,e){var n=Oi(e.value),r=Oi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ES(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function VC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ay(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?VC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ld,WC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ld=ld||document.createElement("div"),ld.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ld.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ac(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ac={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jK=["Webkit","ms","Moz","O"];Object.keys(ac).forEach(function(t){jK.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ac[e]=ac[t]})});function YC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ac.hasOwnProperty(t)&&ac[t]?(""+e).trim():e+"px"}function XC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=YC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var NK=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ry(t,e){if(e){if(NK[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(te(62))}}function Ly(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dy=null;function lw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Oy=null,Oa=null,ja=null;function PS(t){if(t=Su(t)){if(typeof Oy!="function")throw Error(te(280));var e=t.stateNode;e&&(e=Zp(e),Oy(t.stateNode,t.type,e))}}function GC(t){Oa?ja?ja.push(t):ja=[t]:Oa=t}function qC(){if(Oa){var t=Oa,e=ja;if(ja=Oa=null,PS(t),e)for(t=0;t<e.length;t++)PS(e[t])}}function QC(t,e){return t(e)}function ZC(){}var jg=!1;function JC(t,e,n){if(jg)return t(e,n);jg=!0;try{return QC(t,e,n)}finally{jg=!1,(Oa!==null||ja!==null)&&(ZC(),qC())}}function Rc(t,e){var n=t.stateNode;if(n===null)return null;var r=Zp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(te(231,e,typeof n));return n}var jy=!1;if(Qo)try{var Dl={};Object.defineProperty(Dl,"passive",{get:function(){jy=!0}}),window.addEventListener("test",Dl,Dl),window.removeEventListener("test",Dl,Dl)}catch{jy=!1}function BK(t,e,n,r,o,i,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var lc=!1,Fh=null,Kh=!1,Ny=null,zK={onError:function(t){lc=!0,Fh=t}};function UK(t,e,n,r,o,i,s,a,l){lc=!1,Fh=null,BK.apply(zK,arguments)}function FK(t,e,n,r,o,i,s,a,l){if(UK.apply(this,arguments),lc){if(lc){var c=Fh;lc=!1,Fh=null}else throw Error(te(198));Kh||(Kh=!0,Ny=c)}}function Ks(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ek(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _S(t){if(Ks(t)!==t)throw Error(te(188))}function KK(t){var e=t.alternate;if(!e){if(e=Ks(t),e===null)throw Error(te(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return _S(o),t;if(i===r)return _S(o),e;i=i.sibling}throw Error(te(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s){for(a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?t:e}function tk(t){return t=KK(t),t!==null?nk(t):null}function nk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=nk(t);if(e!==null)return e;t=t.sibling}return null}var rk=sr.unstable_scheduleCallback,IS=sr.unstable_cancelCallback,HK=sr.unstable_shouldYield,VK=sr.unstable_requestPaint,It=sr.unstable_now,WK=sr.unstable_getCurrentPriorityLevel,cw=sr.unstable_ImmediatePriority,ok=sr.unstable_UserBlockingPriority,Hh=sr.unstable_NormalPriority,YK=sr.unstable_LowPriority,ik=sr.unstable_IdlePriority,Xp=null,vo=null;function XK(t){if(vo&&typeof vo.onCommitFiberRoot=="function")try{vo.onCommitFiberRoot(Xp,t,void 0,(t.current.flags&128)===128)}catch{}}var Xr=Math.clz32?Math.clz32:QK,GK=Math.log,qK=Math.LN2;function QK(t){return t>>>=0,t===0?32:31-(GK(t)/qK|0)|0}var cd=64,ud=4194304;function ec(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,i=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~o;a!==0?r=ec(a):(i&=s,i!==0&&(r=ec(i)))}else s=n&~o,s!==0?r=ec(s):i!==0&&(r=ec(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,i=e&-e,o>=i||o===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Xr(e),o=1<<n,r|=t[n],e&=~o;return r}function ZK(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JK(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,i=t.pendingLanes;0<i;){var s=31-Xr(i),a=1<<s,l=o[s];l===-1?(!(a&n)||a&r)&&(o[s]=ZK(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function By(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sk(){var t=cd;return cd<<=1,!(cd&4194240)&&(cd=64),t}function Ng(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function xu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Xr(e),t[e]=n}function eH(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-Xr(n),i=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~i}}function uw(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Xr(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var Xe=0;function ak(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var lk,dw,ck,uk,dk,zy=!1,dd=[],Ii=null,Ci=null,ki=null,Lc=new Map,Dc=new Map,mi=[],tH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function CS(t,e){switch(t){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Ci=null;break;case"mouseover":case"mouseout":ki=null;break;case"pointerover":case"pointerout":Lc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dc.delete(e.pointerId)}}function Ol(t,e,n,r,o,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},e!==null&&(e=Su(e),e!==null&&dw(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function nH(t,e,n,r,o){switch(e){case"focusin":return Ii=Ol(Ii,t,e,n,r,o),!0;case"dragenter":return Ci=Ol(Ci,t,e,n,r,o),!0;case"mouseover":return ki=Ol(ki,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return Lc.set(i,Ol(Lc.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Dc.set(i,Ol(Dc.get(i)||null,t,e,n,r,o)),!0}return!1}function hk(t){var e=ws(t.target);if(e!==null){var n=Ks(e);if(n!==null){if(e=n.tag,e===13){if(e=ek(n),e!==null){t.blockedOn=e,dk(t.priority,function(){ck(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function rh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Uy(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Dy=r,n.target.dispatchEvent(r),Dy=null}else return e=Su(n),e!==null&&dw(e),t.blockedOn=n,!1;e.shift()}return!0}function kS(t,e,n){rh(t)&&n.delete(e)}function rH(){zy=!1,Ii!==null&&rh(Ii)&&(Ii=null),Ci!==null&&rh(Ci)&&(Ci=null),ki!==null&&rh(ki)&&(ki=null),Lc.forEach(kS),Dc.forEach(kS)}function jl(t,e){t.blockedOn===e&&(t.blockedOn=null,zy||(zy=!0,sr.unstable_scheduleCallback(sr.unstable_NormalPriority,rH)))}function Oc(t){function e(o){return jl(o,t)}if(0<dd.length){jl(dd[0],t);for(var n=1;n<dd.length;n++){var r=dd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ii!==null&&jl(Ii,t),Ci!==null&&jl(Ci,t),ki!==null&&jl(ki,t),Lc.forEach(e),Dc.forEach(e),n=0;n<mi.length;n++)r=mi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<mi.length&&(n=mi[0],n.blockedOn===null);)hk(n),n.blockedOn===null&&mi.shift()}var Na=ni.ReactCurrentBatchConfig,Wh=!0;function oH(t,e,n,r){var o=Xe,i=Na.transition;Na.transition=null;try{Xe=1,hw(t,e,n,r)}finally{Xe=o,Na.transition=i}}function iH(t,e,n,r){var o=Xe,i=Na.transition;Na.transition=null;try{Xe=4,hw(t,e,n,r)}finally{Xe=o,Na.transition=i}}function hw(t,e,n,r){if(Wh){var o=Uy(t,e,n,r);if(o===null)Xg(t,e,r,Yh,n),CS(t,r);else if(nH(o,t,e,n,r))r.stopPropagation();else if(CS(t,r),e&4&&-1<tH.indexOf(t)){for(;o!==null;){var i=Su(o);if(i!==null&&lk(i),i=Uy(t,e,n,r),i===null&&Xg(t,e,r,Yh,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else Xg(t,e,r,null,n)}}var Yh=null;function Uy(t,e,n,r){if(Yh=null,t=lw(r),t=ws(t),t!==null)if(e=Ks(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ek(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yh=t,null}function pk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WK()){case cw:return 1;case ok:return 4;case Hh:case YK:return 16;case ik:return 536870912;default:return 16}default:return 16}}var bi=null,pw=null,oh=null;function fk(){if(oh)return oh;var t,e=pw,n=e.length,r,o="value"in bi?bi.value:bi.textContent,i=o.length;for(t=0;t<n&&e[t]===o[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===o[i-r];r++);return oh=o.slice(t,1<r?1-r:void 0)}function ih(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hd(){return!0}function $S(){return!1}function ur(t){function e(n,r,o,i,s){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?hd:$S,this.isPropagationStopped=$S,this}return yt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hd)},persist:function(){},isPersistent:hd}),e}var hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fw=ur(hl),bu=yt({},hl,{view:0,detail:0}),sH=ur(bu),Bg,zg,Nl,Gp=yt({},bu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Nl&&(Nl&&t.type==="mousemove"?(Bg=t.screenX-Nl.screenX,zg=t.screenY-Nl.screenY):zg=Bg=0,Nl=t),Bg)},movementY:function(t){return"movementY"in t?t.movementY:zg}}),TS=ur(Gp),aH=yt({},Gp,{dataTransfer:0}),lH=ur(aH),cH=yt({},bu,{relatedTarget:0}),Ug=ur(cH),uH=yt({},hl,{animationName:0,elapsedTime:0,pseudoElement:0}),dH=ur(uH),hH=yt({},hl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),pH=ur(hH),fH=yt({},hl,{data:0}),MS=ur(fH),gH={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mH={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yH={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vH(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=yH[t])?!!e[t]:!1}function gw(){return vH}var wH=yt({},bu,{key:function(t){if(t.key){var e=gH[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ih(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?mH[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gw,charCode:function(t){return t.type==="keypress"?ih(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ih(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xH=ur(wH),bH=yt({},Gp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),AS=ur(bH),SH=yt({},bu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gw}),EH=ur(SH),PH=yt({},hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),_H=ur(PH),IH=yt({},Gp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CH=ur(IH),kH=[9,13,27,32],mw=Qo&&"CompositionEvent"in window,cc=null;Qo&&"documentMode"in document&&(cc=document.documentMode);var $H=Qo&&"TextEvent"in window&&!cc,gk=Qo&&(!mw||cc&&8<cc&&11>=cc),RS=String.fromCharCode(32),LS=!1;function mk(t,e){switch(t){case"keyup":return kH.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var va=!1;function TH(t,e){switch(t){case"compositionend":return yk(e);case"keypress":return e.which!==32?null:(LS=!0,RS);case"textInput":return t=e.data,t===RS&&LS?null:t;default:return null}}function MH(t,e){if(va)return t==="compositionend"||!mw&&mk(t,e)?(t=fk(),oh=pw=bi=null,va=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gk&&e.locale!=="ko"?null:e.data;default:return null}}var AH={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function DS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!AH[t.type]:e==="textarea"}function vk(t,e,n,r){GC(r),e=Xh(e,"onChange"),0<e.length&&(n=new fw("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var uc=null,jc=null;function RH(t){$k(t,0)}function qp(t){var e=ba(t);if(FC(e))return t}function LH(t,e){if(t==="change")return e}var wk=!1;if(Qo){var Fg;if(Qo){var Kg="oninput"in document;if(!Kg){var OS=document.createElement("div");OS.setAttribute("oninput","return;"),Kg=typeof OS.oninput=="function"}Fg=Kg}else Fg=!1;wk=Fg&&(!document.documentMode||9<document.documentMode)}function jS(){uc&&(uc.detachEvent("onpropertychange",xk),jc=uc=null)}function xk(t){if(t.propertyName==="value"&&qp(jc)){var e=[];vk(e,jc,t,lw(t)),JC(RH,e)}}function DH(t,e,n){t==="focusin"?(jS(),uc=e,jc=n,uc.attachEvent("onpropertychange",xk)):t==="focusout"&&jS()}function OH(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return qp(jc)}function jH(t,e){if(t==="click")return qp(e)}function NH(t,e){if(t==="input"||t==="change")return qp(e)}function BH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zr=typeof Object.is=="function"?Object.is:BH;function Nc(t,e){if(Zr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Ey.call(e,o)||!Zr(t[o],e[o]))return!1}return!0}function NS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function BS(t,e){var n=NS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=NS(n)}}function bk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?bk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Sk(){for(var t=window,e=Uh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Uh(t.document)}return e}function yw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function zH(t){var e=Sk(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&bk(n.ownerDocument.documentElement,n)){if(r!==null&&yw(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!t.extend&&i>r&&(o=r,r=i,i=o),o=BS(n,i);var s=BS(n,r);o&&s&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UH=Qo&&"documentMode"in document&&11>=document.documentMode,wa=null,Fy=null,dc=null,Ky=!1;function zS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ky||wa==null||wa!==Uh(r)||(r=wa,"selectionStart"in r&&yw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),dc&&Nc(dc,r)||(dc=r,r=Xh(Fy,"onSelect"),0<r.length&&(e=new fw("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=wa)))}function pd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xa={animationend:pd("Animation","AnimationEnd"),animationiteration:pd("Animation","AnimationIteration"),animationstart:pd("Animation","AnimationStart"),transitionend:pd("Transition","TransitionEnd")},Hg={},Ek={};Qo&&(Ek=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function Qp(t){if(Hg[t])return Hg[t];if(!xa[t])return t;var e=xa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ek)return Hg[t]=e[n];return t}var Pk=Qp("animationend"),_k=Qp("animationiteration"),Ik=Qp("animationstart"),Ck=Qp("transitionend"),kk=new Map,US="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gi(t,e){kk.set(t,e),Fs(e,[t])}for(var Vg=0;Vg<US.length;Vg++){var Wg=US[Vg],FH=Wg.toLowerCase(),KH=Wg[0].toUpperCase()+Wg.slice(1);Gi(FH,"on"+KH)}Gi(Pk,"onAnimationEnd");Gi(_k,"onAnimationIteration");Gi(Ik,"onAnimationStart");Gi("dblclick","onDoubleClick");Gi("focusin","onFocus");Gi("focusout","onBlur");Gi(Ck,"onTransitionEnd");Ya("onMouseEnter",["mouseout","mouseover"]);Ya("onMouseLeave",["mouseout","mouseover"]);Ya("onPointerEnter",["pointerout","pointerover"]);Ya("onPointerLeave",["pointerout","pointerover"]);Fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HH=new Set("cancel close invalid load scroll toggle".split(" ").concat(tc));function FS(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,FK(r,e,void 0,t),t.currentTarget=null}function $k(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&o.isPropagationStopped())break e;FS(o,a,c),i=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&o.isPropagationStopped())break e;FS(o,a,c),i=l}}}if(Kh)throw t=Ny,Kh=!1,Ny=null,t}function rt(t,e){var n=e[Xy];n===void 0&&(n=e[Xy]=new Set);var r=t+"__bubble";n.has(r)||(Tk(e,t,2,!1),n.add(r))}function Yg(t,e,n){var r=0;e&&(r|=4),Tk(n,t,r,e)}var fd="_reactListening"+Math.random().toString(36).slice(2);function Bc(t){if(!t[fd]){t[fd]=!0,jC.forEach(function(n){n!=="selectionchange"&&(HH.has(n)||Yg(n,!1,t),Yg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[fd]||(e[fd]=!0,Yg("selectionchange",!1,e))}}function Tk(t,e,n,r){switch(pk(e)){case 1:var o=oH;break;case 4:o=iH;break;default:o=hw}n=o.bind(null,e,n,t),o=void 0,!jy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function Xg(t,e,n,r,o){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===o||a.nodeType===8&&a.parentNode===o)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===o||l.nodeType===8&&l.parentNode===o))return;s=s.return}for(;a!==null;){if(s=ws(a),s===null)return;if(l=s.tag,l===5||l===6){r=i=s;continue e}a=a.parentNode}}r=r.return}JC(function(){var c=i,d=lw(n),u=[];e:{var h=kk.get(t);if(h!==void 0){var p=fw,g=t;switch(t){case"keypress":if(ih(n)===0)break e;case"keydown":case"keyup":p=xH;break;case"focusin":g="focus",p=Ug;break;case"focusout":g="blur",p=Ug;break;case"beforeblur":case"afterblur":p=Ug;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=TS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=lH;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=EH;break;case Pk:case _k:case Ik:p=dH;break;case Ck:p=_H;break;case"scroll":p=sH;break;case"wheel":p=CH;break;case"copy":case"cut":case"paste":p=pH;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=AS}var m=(e&4)!==0,v=!m&&t==="scroll",x=m?h!==null?h+"Capture":null:h;m=[];for(var b=c,E;b!==null;){E=b;var P=E.stateNode;if(E.tag===5&&P!==null&&(E=P,x!==null&&(P=Rc(b,x),P!=null&&m.push(zc(b,P,E)))),v)break;b=b.return}0<m.length&&(h=new p(h,g,null,n,d),u.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==Dy&&(g=n.relatedTarget||n.fromElement)&&(ws(g)||g[Zo]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=n.relatedTarget||n.toElement,p=c,g=g?ws(g):null,g!==null&&(v=Ks(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(m=TS,P="onMouseLeave",x="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(m=AS,P="onPointerLeave",x="onPointerEnter",b="pointer"),v=p==null?h:ba(p),E=g==null?h:ba(g),h=new m(P,b+"leave",p,n,d),h.target=v,h.relatedTarget=E,P=null,ws(d)===c&&(m=new m(x,b+"enter",g,n,d),m.target=E,m.relatedTarget=v,P=m),v=P,p&&g)t:{for(m=p,x=g,b=0,E=m;E;E=sa(E))b++;for(E=0,P=x;P;P=sa(P))E++;for(;0<b-E;)m=sa(m),b--;for(;0<E-b;)x=sa(x),E--;for(;b--;){if(m===x||x!==null&&m===x.alternate)break t;m=sa(m),x=sa(x)}m=null}else m=null;p!==null&&KS(u,h,p,m,!1),g!==null&&v!==null&&KS(u,v,g,m,!0)}}e:{if(h=c?ba(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var C=LH;else if(DS(h))if(wk)C=NH;else{C=OH;var k=DH}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=jH);if(C&&(C=C(t,c))){vk(u,C,n,d);break e}k&&k(t,h,c),t==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Ty(h,"number",h.value)}switch(k=c?ba(c):window,t){case"focusin":(DS(k)||k.contentEditable==="true")&&(wa=k,Fy=c,dc=null);break;case"focusout":dc=Fy=wa=null;break;case"mousedown":Ky=!0;break;case"contextmenu":case"mouseup":case"dragend":Ky=!1,zS(u,n,d);break;case"selectionchange":if(UH)break;case"keydown":case"keyup":zS(u,n,d)}var $;if(mw)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else va?mk(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(gk&&n.locale!=="ko"&&(va||A!=="onCompositionStart"?A==="onCompositionEnd"&&va&&($=fk()):(bi=d,pw="value"in bi?bi.value:bi.textContent,va=!0)),k=Xh(c,A),0<k.length&&(A=new MS(A,t,null,n,d),u.push({event:A,listeners:k}),$?A.data=$:($=yk(n),$!==null&&(A.data=$)))),($=$H?TH(t,n):MH(t,n))&&(c=Xh(c,"onBeforeInput"),0<c.length&&(d=new MS("onBeforeInput","beforeinput",null,n,d),u.push({event:d,listeners:c}),d.data=$))}$k(u,e)})}function zc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xh(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Rc(t,n),i!=null&&r.unshift(zc(t,i,o)),i=Rc(t,e),i!=null&&r.push(zc(t,i,o))),t=t.return}return r}function sa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function KS(t,e,n,r,o){for(var i=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,o?(l=Rc(n,i),l!=null&&s.unshift(zc(n,l,a))):o||(l=Rc(n,i),l!=null&&s.push(zc(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var VH=/\r\n?/g,WH=/\u0000|\uFFFD/g;function HS(t){return(typeof t=="string"?t:""+t).replace(VH,`
`).replace(WH,"")}function gd(t,e,n){if(e=HS(e),HS(t)!==e&&n)throw Error(te(425))}function Gh(){}var Hy=null,Vy=null;function Wy(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Yy=typeof setTimeout=="function"?setTimeout:void 0,YH=typeof clearTimeout=="function"?clearTimeout:void 0,VS=typeof Promise=="function"?Promise:void 0,XH=typeof queueMicrotask=="function"?queueMicrotask:typeof VS<"u"?function(t){return VS.resolve(null).then(t).catch(GH)}:Yy;function GH(t){setTimeout(function(){throw t})}function Gg(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),Oc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Oc(e)}function $i(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function WS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var pl=Math.random().toString(36).slice(2),go="__reactFiber$"+pl,Uc="__reactProps$"+pl,Zo="__reactContainer$"+pl,Xy="__reactEvents$"+pl,qH="__reactListeners$"+pl,QH="__reactHandles$"+pl;function ws(t){var e=t[go];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Zo]||n[go]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=WS(t);t!==null;){if(n=t[go])return n;t=WS(t)}return e}t=n,n=t.parentNode}return null}function Su(t){return t=t[go]||t[Zo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ba(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(te(33))}function Zp(t){return t[Uc]||null}var Gy=[],Sa=-1;function qi(t){return{current:t}}function at(t){0>Sa||(t.current=Gy[Sa],Gy[Sa]=null,Sa--)}function tt(t,e){Sa++,Gy[Sa]=t.current,t.current=e}var ji={},vn=qi(ji),Hn=qi(!1),As=ji;function Xa(t,e){var n=t.type.contextTypes;if(!n)return ji;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Vn(t){return t=t.childContextTypes,t!=null}function qh(){at(Hn),at(vn)}function YS(t,e,n){if(vn.current!==ji)throw Error(te(168));tt(vn,e),tt(Hn,n)}function Mk(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(te(108,DK(t)||"Unknown",o));return yt({},n,r)}function Qh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ji,As=vn.current,tt(vn,t),tt(Hn,Hn.current),!0}function XS(t,e,n){var r=t.stateNode;if(!r)throw Error(te(169));n?(t=Mk(t,e,As),r.__reactInternalMemoizedMergedChildContext=t,at(Hn),at(vn),tt(vn,t)):at(Hn),tt(Hn,n)}var jo=null,Jp=!1,qg=!1;function Ak(t){jo===null?jo=[t]:jo.push(t)}function ZH(t){Jp=!0,Ak(t)}function Qi(){if(!qg&&jo!==null){qg=!0;var t=0,e=Xe;try{var n=jo;for(Xe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}jo=null,Jp=!1}catch(o){throw jo!==null&&(jo=jo.slice(t+1)),rk(cw,Qi),o}finally{Xe=e,qg=!1}}return null}var Ea=[],Pa=0,Zh=null,Jh=0,Pr=[],_r=0,Rs=null,Bo=1,zo="";function us(t,e){Ea[Pa++]=Jh,Ea[Pa++]=Zh,Zh=t,Jh=e}function Rk(t,e,n){Pr[_r++]=Bo,Pr[_r++]=zo,Pr[_r++]=Rs,Rs=t;var r=Bo;t=zo;var o=32-Xr(r)-1;r&=~(1<<o),n+=1;var i=32-Xr(e)+o;if(30<i){var s=o-o%5;i=(r&(1<<s)-1).toString(32),r>>=s,o-=s,Bo=1<<32-Xr(e)+o|n<<o|r,zo=i+t}else Bo=1<<i|n<<o|r,zo=t}function vw(t){t.return!==null&&(us(t,1),Rk(t,1,0))}function ww(t){for(;t===Zh;)Zh=Ea[--Pa],Ea[Pa]=null,Jh=Ea[--Pa],Ea[Pa]=null;for(;t===Rs;)Rs=Pr[--_r],Pr[_r]=null,zo=Pr[--_r],Pr[_r]=null,Bo=Pr[--_r],Pr[_r]=null}var ir=null,rr=null,ut=!1,Wr=null;function Lk(t,e){var n=Ir(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function GS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ir=t,rr=$i(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ir=t,rr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Rs!==null?{id:Bo,overflow:zo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ir(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ir=t,rr=null,!0):!1;default:return!1}}function qy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Qy(t){if(ut){var e=rr;if(e){var n=e;if(!GS(t,e)){if(qy(t))throw Error(te(418));e=$i(n.nextSibling);var r=ir;e&&GS(t,e)?Lk(r,n):(t.flags=t.flags&-4097|2,ut=!1,ir=t)}}else{if(qy(t))throw Error(te(418));t.flags=t.flags&-4097|2,ut=!1,ir=t}}}function qS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ir=t}function md(t){if(t!==ir)return!1;if(!ut)return qS(t),ut=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Wy(t.type,t.memoizedProps)),e&&(e=rr)){if(qy(t))throw Dk(),Error(te(418));for(;e;)Lk(t,e),e=$i(e.nextSibling)}if(qS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){rr=$i(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}rr=null}}else rr=ir?$i(t.stateNode.nextSibling):null;return!0}function Dk(){for(var t=rr;t;)t=$i(t.nextSibling)}function Ga(){rr=ir=null,ut=!1}function xw(t){Wr===null?Wr=[t]:Wr.push(t)}var JH=ni.ReactCurrentBatchConfig;function zr(t,e){if(t&&t.defaultProps){e=yt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var ep=qi(null),tp=null,_a=null,bw=null;function Sw(){bw=_a=tp=null}function Ew(t){var e=ep.current;at(ep),t._currentValue=e}function Zy(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ba(t,e){tp=t,bw=_a=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Un=!0),t.firstContext=null)}function Tr(t){var e=t._currentValue;if(bw!==t)if(t={context:t,memoizedValue:e,next:null},_a===null){if(tp===null)throw Error(te(308));_a=t,tp.dependencies={lanes:0,firstContext:t}}else _a=_a.next=t;return e}var xs=null;function Pw(t){xs===null?xs=[t]:xs.push(t)}function Ok(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,Pw(e)):(n.next=o.next,o.next=n),e.interleaved=n,Jo(t,r)}function Jo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var fi=!1;function _w(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ti(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ke&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,Jo(t,n)}return o=r.interleaved,o===null?(e.next=e,Pw(r)):(e.next=o.next,o.next=e),r.interleaved=e,Jo(t,n)}function sh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,uw(t,n)}}function QS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=s:i=i.next=s,n=n.next}while(n!==null);i===null?o=i=e:i=i.next=e}else o=i=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function np(t,e,n,r){var o=t.updateQueue;fi=!1;var i=o.firstBaseUpdate,s=o.lastBaseUpdate,a=o.shared.pending;if(a!==null){o.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==s&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(i!==null){var u=o.baseState;s=0,d=c=l=null,a=i;do{var h=a.lane,p=a.eventTime;if((r&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,m=a;switch(h=e,p=n,m.tag){case 1:if(g=m.payload,typeof g=="function"){u=g.call(p,u,h);break e}u=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(p,u,h):g,h==null)break e;u=yt({},u,h);break e;case 2:fi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=o.effects,h===null?o.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=p,l=u):d=d.next=p,s|=h;if(a=a.next,a===null){if(a=o.shared.pending,a===null)break;h=a,a=h.next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}while(1);if(d===null&&(l=u),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=d,e=o.shared.interleaved,e!==null){o=e;do s|=o.lane,o=o.next;while(o!==e)}else i===null&&(o.shared.lanes=0);Ds|=s,t.lanes=s,t.memoizedState=u}}function ZS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(te(191,o));o.call(r)}}}var Nk=new OC.Component().refs;function Jy(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:yt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ef={isMounted:function(t){return(t=t._reactInternals)?Ks(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=In(),o=Ai(t),i=Yo(r,o);i.payload=e,n!=null&&(i.callback=n),e=Ti(t,i,o),e!==null&&(Gr(e,t,o,r),sh(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=In(),o=Ai(t),i=Yo(r,o);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ti(t,i,o),e!==null&&(Gr(e,t,o,r),sh(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=In(),r=Ai(t),o=Yo(n,r);o.tag=2,e!=null&&(o.callback=e),e=Ti(t,o,r),e!==null&&(Gr(e,t,r,n),sh(e,t,r))}};function JS(t,e,n,r,o,i,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,s):e.prototype&&e.prototype.isPureReactComponent?!Nc(n,r)||!Nc(o,i):!0}function Bk(t,e,n){var r=!1,o=ji,i=e.contextType;return typeof i=="object"&&i!==null?i=Tr(i):(o=Vn(e)?As:vn.current,r=e.contextTypes,i=(r=r!=null)?Xa(t,o):ji),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ef,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function eE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ef.enqueueReplaceState(e,e.state,null)}function e0(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs=Nk,_w(t);var i=e.contextType;typeof i=="object"&&i!==null?o.context=Tr(i):(i=Vn(e)?As:vn.current,o.context=Xa(t,i)),o.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Jy(t,e,i,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&ef.enqueueReplaceState(o,o.state,null),np(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function Bl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,t));var o=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(s){var a=o.refs;a===Nk&&(a=o.refs={}),s===null?delete a[i]:a[i]=s},e._stringRef=i,e)}if(typeof t!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,t))}return t}function yd(t,e){throw t=Object.prototype.toString.call(e),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function tE(t){var e=t._init;return e(t._payload)}function zk(t){function e(x,b){if(t){var E=x.deletions;E===null?(x.deletions=[b],x.flags|=16):E.push(b)}}function n(x,b){if(!t)return null;for(;b!==null;)e(x,b),b=b.sibling;return null}function r(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function o(x,b){return x=Ri(x,b),x.index=0,x.sibling=null,x}function i(x,b,E){return x.index=E,t?(E=x.alternate,E!==null?(E=E.index,E<b?(x.flags|=2,b):E):(x.flags|=2,b)):(x.flags|=1048576,b)}function s(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,b,E,P){return b===null||b.tag!==6?(b=rm(E,x.mode,P),b.return=x,b):(b=o(b,E),b.return=x,b)}function l(x,b,E,P){var C=E.type;return C===ya?d(x,b,E.props.children,P,E.key):b!==null&&(b.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===pi&&tE(C)===b.type)?(P=o(b,E.props),P.ref=Bl(x,b,E),P.return=x,P):(P=hh(E.type,E.key,E.props,null,x.mode,P),P.ref=Bl(x,b,E),P.return=x,P)}function c(x,b,E,P){return b===null||b.tag!==4||b.stateNode.containerInfo!==E.containerInfo||b.stateNode.implementation!==E.implementation?(b=om(E,x.mode,P),b.return=x,b):(b=o(b,E.children||[]),b.return=x,b)}function d(x,b,E,P,C){return b===null||b.tag!==7?(b=Is(E,x.mode,P,C),b.return=x,b):(b=o(b,E),b.return=x,b)}function u(x,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return b=rm(""+b,x.mode,E),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case sd:return E=hh(b.type,b.key,b.props,null,x.mode,E),E.ref=Bl(x,null,b),E.return=x,E;case ma:return b=om(b,x.mode,E),b.return=x,b;case pi:var P=b._init;return u(x,P(b._payload),E)}if(Jl(b)||Ll(b))return b=Is(b,x.mode,E,null),b.return=x,b;yd(x,b)}return null}function h(x,b,E,P){var C=b!==null?b.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return C!==null?null:a(x,b,""+E,P);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case sd:return E.key===C?l(x,b,E,P):null;case ma:return E.key===C?c(x,b,E,P):null;case pi:return C=E._init,h(x,b,C(E._payload),P)}if(Jl(E)||Ll(E))return C!==null?null:d(x,b,E,P,null);yd(x,E)}return null}function p(x,b,E,P,C){if(typeof P=="string"&&P!==""||typeof P=="number")return x=x.get(E)||null,a(b,x,""+P,C);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case sd:return x=x.get(P.key===null?E:P.key)||null,l(b,x,P,C);case ma:return x=x.get(P.key===null?E:P.key)||null,c(b,x,P,C);case pi:var k=P._init;return p(x,b,E,k(P._payload),C)}if(Jl(P)||Ll(P))return x=x.get(E)||null,d(b,x,P,C,null);yd(b,P)}return null}function g(x,b,E,P){for(var C=null,k=null,$=b,A=b=0,D=null;$!==null&&A<E.length;A++){$.index>A?(D=$,$=null):D=$.sibling;var j=h(x,$,E[A],P);if(j===null){$===null&&($=D);break}t&&$&&j.alternate===null&&e(x,$),b=i(j,b,A),k===null?C=j:k.sibling=j,k=j,$=D}if(A===E.length)return n(x,$),ut&&us(x,A),C;if($===null){for(;A<E.length;A++)$=u(x,E[A],P),$!==null&&(b=i($,b,A),k===null?C=$:k.sibling=$,k=$);return ut&&us(x,A),C}for($=r(x,$);A<E.length;A++)D=p($,x,A,E[A],P),D!==null&&(t&&D.alternate!==null&&$.delete(D.key===null?A:D.key),b=i(D,b,A),k===null?C=D:k.sibling=D,k=D);return t&&$.forEach(function(Y){return e(x,Y)}),ut&&us(x,A),C}function m(x,b,E,P){var C=Ll(E);if(typeof C!="function")throw Error(te(150));if(E=C.call(E),E==null)throw Error(te(151));for(var k=C=null,$=b,A=b=0,D=null,j=E.next();$!==null&&!j.done;A++,j=E.next()){$.index>A?(D=$,$=null):D=$.sibling;var Y=h(x,$,j.value,P);if(Y===null){$===null&&($=D);break}t&&$&&Y.alternate===null&&e(x,$),b=i(Y,b,A),k===null?C=Y:k.sibling=Y,k=Y,$=D}if(j.done)return n(x,$),ut&&us(x,A),C;if($===null){for(;!j.done;A++,j=E.next())j=u(x,j.value,P),j!==null&&(b=i(j,b,A),k===null?C=j:k.sibling=j,k=j);return ut&&us(x,A),C}for($=r(x,$);!j.done;A++,j=E.next())j=p($,x,A,j.value,P),j!==null&&(t&&j.alternate!==null&&$.delete(j.key===null?A:j.key),b=i(j,b,A),k===null?C=j:k.sibling=j,k=j);return t&&$.forEach(function(V){return e(x,V)}),ut&&us(x,A),C}function v(x,b,E,P){if(typeof E=="object"&&E!==null&&E.type===ya&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case sd:e:{for(var C=E.key,k=b;k!==null;){if(k.key===C){if(C=E.type,C===ya){if(k.tag===7){n(x,k.sibling),b=o(k,E.props.children),b.return=x,x=b;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===pi&&tE(C)===k.type){n(x,k.sibling),b=o(k,E.props),b.ref=Bl(x,k,E),b.return=x,x=b;break e}n(x,k);break}else e(x,k);k=k.sibling}E.type===ya?(b=Is(E.props.children,x.mode,P,E.key),b.return=x,x=b):(P=hh(E.type,E.key,E.props,null,x.mode,P),P.ref=Bl(x,b,E),P.return=x,x=P)}return s(x);case ma:e:{for(k=E.key;b!==null;){if(b.key===k)if(b.tag===4&&b.stateNode.containerInfo===E.containerInfo&&b.stateNode.implementation===E.implementation){n(x,b.sibling),b=o(b,E.children||[]),b.return=x,x=b;break e}else{n(x,b);break}else e(x,b);b=b.sibling}b=om(E,x.mode,P),b.return=x,x=b}return s(x);case pi:return k=E._init,v(x,b,k(E._payload),P)}if(Jl(E))return g(x,b,E,P);if(Ll(E))return m(x,b,E,P);yd(x,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,b!==null&&b.tag===6?(n(x,b.sibling),b=o(b,E),b.return=x,x=b):(n(x,b),b=rm(E,x.mode,P),b.return=x,x=b),s(x)):n(x,b)}return v}var qa=zk(!0),Uk=zk(!1),Eu={},wo=qi(Eu),Fc=qi(Eu),Kc=qi(Eu);function bs(t){if(t===Eu)throw Error(te(174));return t}function Iw(t,e){switch(tt(Kc,e),tt(Fc,t),tt(wo,Eu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ay(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ay(e,t)}at(wo),tt(wo,e)}function Qa(){at(wo),at(Fc),at(Kc)}function Fk(t){bs(Kc.current);var e=bs(wo.current),n=Ay(e,t.type);e!==n&&(tt(Fc,t),tt(wo,n))}function Cw(t){Fc.current===t&&(at(wo),at(Fc))}var ft=qi(0);function rp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Qg=[];function kw(){for(var t=0;t<Qg.length;t++)Qg[t]._workInProgressVersionPrimary=null;Qg.length=0}var ah=ni.ReactCurrentDispatcher,Zg=ni.ReactCurrentBatchConfig,Ls=0,mt=null,Nt=null,Yt=null,op=!1,hc=!1,Hc=0,eV=0;function hn(){throw Error(te(321))}function $w(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Zr(t[n],e[n]))return!1;return!0}function Tw(t,e,n,r,o,i){if(Ls=i,mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ah.current=t===null||t.memoizedState===null?oV:iV,t=n(r,o),hc){i=0;do{if(hc=!1,Hc=0,25<=i)throw Error(te(301));i+=1,Yt=Nt=null,e.updateQueue=null,ah.current=sV,t=n(r,o)}while(hc)}if(ah.current=ip,e=Nt!==null&&Nt.next!==null,Ls=0,Yt=Nt=mt=null,op=!1,e)throw Error(te(300));return t}function Mw(){var t=Hc!==0;return Hc=0,t}function co(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?mt.memoizedState=Yt=t:Yt=Yt.next=t,Yt}function Mr(){if(Nt===null){var t=mt.alternate;t=t!==null?t.memoizedState:null}else t=Nt.next;var e=Yt===null?mt.memoizedState:Yt.next;if(e!==null)Yt=e,Nt=t;else{if(t===null)throw Error(te(310));Nt=t,t={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},Yt===null?mt.memoizedState=Yt=t:Yt=Yt.next=t}return Yt}function Vc(t,e){return typeof e=="function"?e(t):e}function Jg(t){var e=Mr(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=Nt,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var a=s=null,l=null,c=i;do{var d=c.lane;if((Ls&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=u,s=r):l=l.next=u,mt.lanes|=d,Ds|=d}c=c.next}while(c!==null&&c!==i);l===null?s=r:l.next=a,Zr(r,e.memoizedState)||(Un=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do i=o.lane,mt.lanes|=i,Ds|=i,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function em(t){var e=Mr(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(o!==null){n.pending=null;var s=o=o.next;do i=t(i,s.action),s=s.next;while(s!==o);Zr(i,e.memoizedState)||(Un=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Kk(){}function Hk(t,e){var n=mt,r=Mr(),o=e(),i=!Zr(r.memoizedState,o);if(i&&(r.memoizedState=o,Un=!0),r=r.queue,Aw(Yk.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Yt!==null&&Yt.memoizedState.tag&1){if(n.flags|=2048,Wc(9,Wk.bind(null,n,r,o,e),void 0,null),qt===null)throw Error(te(349));Ls&30||Vk(n,e,o)}return o}function Vk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Wk(t,e,n,r){e.value=n,e.getSnapshot=r,Xk(e)&&Gk(t)}function Yk(t,e,n){return n(function(){Xk(e)&&Gk(t)})}function Xk(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zr(t,n)}catch{return!0}}function Gk(t){var e=Jo(t,1);e!==null&&Gr(e,t,1,-1)}function nE(t){var e=co();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vc,lastRenderedState:t},e.queue=t,t=t.dispatch=rV.bind(null,mt,t),[e.memoizedState,t]}function Wc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function qk(){return Mr().memoizedState}function lh(t,e,n,r){var o=co();mt.flags|=t,o.memoizedState=Wc(1|e,n,void 0,r===void 0?null:r)}function tf(t,e,n,r){var o=Mr();r=r===void 0?null:r;var i=void 0;if(Nt!==null){var s=Nt.memoizedState;if(i=s.destroy,r!==null&&$w(r,s.deps)){o.memoizedState=Wc(e,n,i,r);return}}mt.flags|=t,o.memoizedState=Wc(1|e,n,i,r)}function rE(t,e){return lh(8390656,8,t,e)}function Aw(t,e){return tf(2048,8,t,e)}function Qk(t,e){return tf(4,2,t,e)}function Zk(t,e){return tf(4,4,t,e)}function Jk(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function e$(t,e,n){return n=n!=null?n.concat([t]):null,tf(4,4,Jk.bind(null,e,t),n)}function Rw(){}function t$(t,e){var n=Mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$w(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function n$(t,e){var n=Mr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$w(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function r$(t,e,n){return Ls&21?(Zr(n,e)||(n=sk(),mt.lanes|=n,Ds|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Un=!0),t.memoizedState=n)}function tV(t,e){var n=Xe;Xe=n!==0&&4>n?n:4,t(!0);var r=Zg.transition;Zg.transition={};try{t(!1),e()}finally{Xe=n,Zg.transition=r}}function o$(){return Mr().memoizedState}function nV(t,e,n){var r=Ai(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},i$(t))s$(e,n);else if(n=Ok(t,e,n,r),n!==null){var o=In();Gr(n,t,r,o),a$(n,e,r)}}function rV(t,e,n){var r=Ai(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(i$(t))s$(e,o);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var s=e.lastRenderedState,a=i(s,n);if(o.hasEagerState=!0,o.eagerState=a,Zr(a,s)){var l=e.interleaved;l===null?(o.next=o,Pw(e)):(o.next=l.next,l.next=o),e.interleaved=o;return}}catch{}finally{}n=Ok(t,e,o,r),n!==null&&(o=In(),Gr(n,t,r,o),a$(n,e,r))}}function i$(t){var e=t.alternate;return t===mt||e!==null&&e===mt}function s$(t,e){hc=op=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function a$(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,uw(t,n)}}var ip={readContext:Tr,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useInsertionEffect:hn,useLayoutEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useMutableSource:hn,useSyncExternalStore:hn,useId:hn,unstable_isNewReconciler:!1},oV={readContext:Tr,useCallback:function(t,e){return co().memoizedState=[t,e===void 0?null:e],t},useContext:Tr,useEffect:rE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,lh(4194308,4,Jk.bind(null,e,t),n)},useLayoutEffect:function(t,e){return lh(4194308,4,t,e)},useInsertionEffect:function(t,e){return lh(4,2,t,e)},useMemo:function(t,e){var n=co();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=co();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=nV.bind(null,mt,t),[r.memoizedState,t]},useRef:function(t){var e=co();return t={current:t},e.memoizedState=t},useState:nE,useDebugValue:Rw,useDeferredValue:function(t){return co().memoizedState=t},useTransition:function(){var t=nE(!1),e=t[0];return t=tV.bind(null,t[1]),co().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=mt,o=co();if(ut){if(n===void 0)throw Error(te(407));n=n()}else{if(n=e(),qt===null)throw Error(te(349));Ls&30||Vk(r,e,n)}o.memoizedState=n;var i={value:n,getSnapshot:e};return o.queue=i,rE(Yk.bind(null,r,i,t),[t]),r.flags|=2048,Wc(9,Wk.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=co(),e=qt.identifierPrefix;if(ut){var n=zo,r=Bo;n=(r&~(1<<32-Xr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Hc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=eV++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iV={readContext:Tr,useCallback:t$,useContext:Tr,useEffect:Aw,useImperativeHandle:e$,useInsertionEffect:Qk,useLayoutEffect:Zk,useMemo:n$,useReducer:Jg,useRef:qk,useState:function(){return Jg(Vc)},useDebugValue:Rw,useDeferredValue:function(t){var e=Mr();return r$(e,Nt.memoizedState,t)},useTransition:function(){var t=Jg(Vc)[0],e=Mr().memoizedState;return[t,e]},useMutableSource:Kk,useSyncExternalStore:Hk,useId:o$,unstable_isNewReconciler:!1},sV={readContext:Tr,useCallback:t$,useContext:Tr,useEffect:Aw,useImperativeHandle:e$,useInsertionEffect:Qk,useLayoutEffect:Zk,useMemo:n$,useReducer:em,useRef:qk,useState:function(){return em(Vc)},useDebugValue:Rw,useDeferredValue:function(t){var e=Mr();return Nt===null?e.memoizedState=t:r$(e,Nt.memoizedState,t)},useTransition:function(){var t=em(Vc)[0],e=Mr().memoizedState;return[t,e]},useMutableSource:Kk,useSyncExternalStore:Hk,useId:o$,unstable_isNewReconciler:!1};function Za(t,e){try{var n="",r=e;do n+=LK(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:o,digest:null}}function tm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function t0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var aV=typeof WeakMap=="function"?WeakMap:Map;function l$(t,e,n){n=Yo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ap||(ap=!0,d0=r),t0(t,e)},n}function c$(t,e,n){n=Yo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){t0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){t0(t,e),typeof r!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function oE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new aV;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=bV.bind(null,t,e,n),e.then(t,t))}function iE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sE(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yo(-1,1),e.tag=2,Ti(n,e,1))),n.lanes|=1),t)}var lV=ni.ReactCurrentOwner,Un=!1;function Sn(t,e,n,r){e.child=t===null?Uk(e,null,n,r):qa(e,t.child,n,r)}function aE(t,e,n,r,o){n=n.render;var i=e.ref;return Ba(e,o),r=Tw(t,e,n,r,i,o),n=Mw(),t!==null&&!Un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,ei(t,e,o)):(ut&&n&&vw(e),e.flags|=1,Sn(t,e,r,o),e.child)}function lE(t,e,n,r,o){if(t===null){var i=n.type;return typeof i=="function"&&!Uw(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,u$(t,e,i,r,o)):(t=hh(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&o)){var s=i.memoizedProps;if(n=n.compare,n=n!==null?n:Nc,n(s,r)&&t.ref===e.ref)return ei(t,e,o)}return e.flags|=1,t=Ri(i,r),t.ref=e.ref,t.return=e,e.child=t}function u$(t,e,n,r,o){if(t!==null){var i=t.memoizedProps;if(Nc(i,r)&&t.ref===e.ref)if(Un=!1,e.pendingProps=r=i,(t.lanes&o)!==0)t.flags&131072&&(Un=!0);else return e.lanes=t.lanes,ei(t,e,o)}return n0(t,e,n,r,o)}function d$(t,e,n){var r=e.pendingProps,o=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt(Ca,er),er|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,tt(Ca,er),er|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,tt(Ca,er),er|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,tt(Ca,er),er|=r;return Sn(t,e,o,n),e.child}function h$(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function n0(t,e,n,r,o){var i=Vn(n)?As:vn.current;return i=Xa(e,i),Ba(e,o),n=Tw(t,e,n,r,i,o),r=Mw(),t!==null&&!Un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,ei(t,e,o)):(ut&&r&&vw(e),e.flags|=1,Sn(t,e,n,o),e.child)}function cE(t,e,n,r,o){if(Vn(n)){var i=!0;Qh(e)}else i=!1;if(Ba(e,o),e.stateNode===null)ch(t,e),Bk(e,n,r),e0(e,n,r,o),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=Tr(c):(c=Vn(n)?As:vn.current,c=Xa(e,c));var d=n.getDerivedStateFromProps,u=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";u||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&eE(e,s,r,c),fi=!1;var h=e.memoizedState;s.state=h,np(e,r,s,o),l=e.memoizedState,a!==r||h!==l||Hn.current||fi?(typeof d=="function"&&(Jy(e,n,d,r),l=e.memoizedState),(a=fi||JS(e,n,a,r,h,l,c))?(u||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,jk(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:zr(e.type,a),s.props=c,u=e.pendingProps,h=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=Tr(l):(l=Vn(n)?As:vn.current,l=Xa(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==u||h!==l)&&eE(e,s,r,l),fi=!1,h=e.memoizedState,s.state=h,np(e,r,s,o);var g=e.memoizedState;a!==u||h!==g||Hn.current||fi?(typeof p=="function"&&(Jy(e,n,p,r),g=e.memoizedState),(c=fi||JS(e,n,c,r,h,g,l)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,g,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,g,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),s.props=r,s.state=g,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return r0(t,e,n,r,i,o)}function r0(t,e,n,r,o,i){h$(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return o&&XS(e,n,!1),ei(t,e,i);r=e.stateNode,lV.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=qa(e,t.child,null,i),e.child=qa(e,null,a,i)):Sn(t,e,a,i),e.memoizedState=r.state,o&&XS(e,n,!0),e.child}function p$(t){var e=t.stateNode;e.pendingContext?YS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&YS(t,e.context,!1),Iw(t,e.containerInfo)}function uE(t,e,n,r,o){return Ga(),xw(o),e.flags|=256,Sn(t,e,n,r),e.child}var o0={dehydrated:null,treeContext:null,retryLane:0};function i0(t){return{baseLanes:t,cachePool:null,transitions:null}}function f$(t,e,n){var r=e.pendingProps,o=ft.current,i=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(o&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),tt(ft,o&1),t===null)return Qy(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,i?(r=e.mode,i=e.child,s={mode:"hidden",children:s},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=of(s,r,0,null),t=Is(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=i0(n),e.memoizedState=o0,t):Lw(e,s));if(o=t.memoizedState,o!==null&&(a=o.dehydrated,a!==null))return cV(t,e,s,r,a,o,n);if(i){i=r.fallback,s=e.mode,o=t.child,a=o.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ri(o,l),r.subtreeFlags=o.subtreeFlags&14680064),a!==null?i=Ri(a,i):(i=Is(i,s,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,s=t.child.memoizedState,s=s===null?i0(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=t.childLanes&~n,e.memoizedState=o0,r}return i=t.child,t=i.sibling,r=Ri(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Lw(t,e){return e=of({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function vd(t,e,n,r){return r!==null&&xw(r),qa(e,t.child,null,n),t=Lw(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function cV(t,e,n,r,o,i,s){if(n)return e.flags&256?(e.flags&=-257,r=tm(Error(te(422))),vd(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,o=e.mode,r=of({mode:"visible",children:r.children},o,0,null),i=Is(i,o,s,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&qa(e,t.child,null,s),e.child.memoizedState=i0(s),e.memoizedState=o0,i);if(!(e.mode&1))return vd(t,e,s,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(te(419)),r=tm(i,r,void 0),vd(t,e,s,r)}if(a=(s&t.childLanes)!==0,Un||a){if(r=qt,r!==null){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|s)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,Jo(t,o),Gr(r,t,o,-1))}return zw(),r=tm(Error(te(421))),vd(t,e,s,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=SV.bind(null,t),o._reactRetry=e,null):(t=i.treeContext,rr=$i(o.nextSibling),ir=e,ut=!0,Wr=null,t!==null&&(Pr[_r++]=Bo,Pr[_r++]=zo,Pr[_r++]=Rs,Bo=t.id,zo=t.overflow,Rs=e),e=Lw(e,r.children),e.flags|=4096,e)}function dE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Zy(t.return,e,n)}function nm(t,e,n,r,o){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function g$(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(Sn(t,e,r.children,n),r=ft.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&dE(t,n,e);else if(t.tag===19)dE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(tt(ft,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&rp(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),nm(e,!1,o,n,i);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&rp(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}nm(e,!0,n,null,i);break;case"together":nm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ch(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ei(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ds|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(te(153));if(e.child!==null){for(t=e.child,n=Ri(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ri(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function uV(t,e,n){switch(e.tag){case 3:p$(e),Ga();break;case 5:Fk(e);break;case 1:Vn(e.type)&&Qh(e);break;case 4:Iw(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;tt(ep,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(tt(ft,ft.current&1),e.flags|=128,null):n&e.child.childLanes?f$(t,e,n):(tt(ft,ft.current&1),t=ei(t,e,n),t!==null?t.sibling:null);tt(ft,ft.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return g$(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),tt(ft,ft.current),r)break;return null;case 22:case 23:return e.lanes=0,d$(t,e,n)}return ei(t,e,n)}var m$,s0,y$,v$;m$=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};s0=function(){};y$=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,bs(wo.current);var i=null;switch(n){case"input":o=ky(t,o),r=ky(t,r),i=[];break;case"select":o=yt({},o,{value:void 0}),r=yt({},r,{value:void 0}),i=[];break;case"textarea":o=My(t,o),r=My(t,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Gh)}Ry(n,r);var s;n=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var a=o[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Mc.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Mc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&rt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};v$=function(t,e,n,r){n!==r&&(e.flags|=4)};function zl(t,e){if(!ut)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function pn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function dV(t,e,n){var r=e.pendingProps;switch(ww(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pn(e),null;case 1:return Vn(e.type)&&qh(),pn(e),null;case 3:return r=e.stateNode,Qa(),at(Hn),at(vn),kw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(md(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Wr!==null&&(f0(Wr),Wr=null))),s0(t,e),pn(e),null;case 5:Cw(e);var o=bs(Kc.current);if(n=e.type,t!==null&&e.stateNode!=null)y$(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(te(166));return pn(e),null}if(t=bs(wo.current),md(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[go]=e,r[Uc]=i,t=(e.mode&1)!==0,n){case"dialog":rt("cancel",r),rt("close",r);break;case"iframe":case"object":case"embed":rt("load",r);break;case"video":case"audio":for(o=0;o<tc.length;o++)rt(tc[o],r);break;case"source":rt("error",r);break;case"img":case"image":case"link":rt("error",r),rt("load",r);break;case"details":rt("toggle",r);break;case"input":xS(r,i),rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},rt("invalid",r);break;case"textarea":SS(r,i),rt("invalid",r)}Ry(n,i),o=null;for(var s in i)if(i.hasOwnProperty(s)){var a=i[s];s==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&gd(r.textContent,a,t),o=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&gd(r.textContent,a,t),o=["children",""+a]):Mc.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&rt("scroll",r)}switch(n){case"input":ad(r),bS(r,i,!0);break;case"textarea":ad(r),ES(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Gh)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=VC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[go]=e,t[Uc]=r,m$(t,e,!1,!1),e.stateNode=t;e:{switch(s=Ly(n,r),n){case"dialog":rt("cancel",t),rt("close",t),o=r;break;case"iframe":case"object":case"embed":rt("load",t),o=r;break;case"video":case"audio":for(o=0;o<tc.length;o++)rt(tc[o],t);o=r;break;case"source":rt("error",t),o=r;break;case"img":case"image":case"link":rt("error",t),rt("load",t),o=r;break;case"details":rt("toggle",t),o=r;break;case"input":xS(t,r),o=ky(t,r),rt("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=yt({},r,{value:void 0}),rt("invalid",t);break;case"textarea":SS(t,r),o=My(t,r),rt("invalid",t);break;default:o=r}Ry(n,o),a=o;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?XC(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&WC(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ac(t,l):typeof l=="number"&&Ac(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Mc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&rt("scroll",t):l!=null&&ow(t,i,l,s))}switch(n){case"input":ad(t),bS(t,r,!1);break;case"textarea":ad(t),ES(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Oi(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Da(t,!!r.multiple,i,!1):r.defaultValue!=null&&Da(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Gh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return pn(e),null;case 6:if(t&&e.stateNode!=null)v$(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(te(166));if(n=bs(Kc.current),bs(wo.current),md(e)){if(r=e.stateNode,n=e.memoizedProps,r[go]=e,(i=r.nodeValue!==n)&&(t=ir,t!==null))switch(t.tag){case 3:gd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&gd(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[go]=e,e.stateNode=r}return pn(e),null;case 13:if(at(ft),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ut&&rr!==null&&e.mode&1&&!(e.flags&128))Dk(),Ga(),e.flags|=98560,i=!1;else if(i=md(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(te(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(te(317));i[go]=e}else Ga(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;pn(e),i=!1}else Wr!==null&&(f0(Wr),Wr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ft.current&1?zt===0&&(zt=3):zw())),e.updateQueue!==null&&(e.flags|=4),pn(e),null);case 4:return Qa(),s0(t,e),t===null&&Bc(e.stateNode.containerInfo),pn(e),null;case 10:return Ew(e.type._context),pn(e),null;case 17:return Vn(e.type)&&qh(),pn(e),null;case 19:if(at(ft),i=e.memoizedState,i===null)return pn(e),null;if(r=(e.flags&128)!==0,s=i.rendering,s===null)if(r)zl(i,!1);else{if(zt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=rp(t),s!==null){for(e.flags|=128,zl(i,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,t=s.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return tt(ft,ft.current&1|2),e.child}t=t.sibling}i.tail!==null&&It()>Ja&&(e.flags|=128,r=!0,zl(i,!1),e.lanes=4194304)}else{if(!r)if(t=rp(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),zl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!ut)return pn(e),null}else 2*It()-i.renderingStartTime>Ja&&n!==1073741824&&(e.flags|=128,r=!0,zl(i,!1),e.lanes=4194304);i.isBackwards?(s.sibling=e.child,e.child=s):(n=i.last,n!==null?n.sibling=s:e.child=s,i.last=s)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=It(),e.sibling=null,n=ft.current,tt(ft,r?n&1|2:n&1),e):(pn(e),null);case 22:case 23:return Bw(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?er&1073741824&&(pn(e),e.subtreeFlags&6&&(e.flags|=8192)):pn(e),null;case 24:return null;case 25:return null}throw Error(te(156,e.tag))}function hV(t,e){switch(ww(e),e.tag){case 1:return Vn(e.type)&&qh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Qa(),at(Hn),at(vn),kw(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Cw(e),null;case 13:if(at(ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(te(340));Ga()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return at(ft),null;case 4:return Qa(),null;case 10:return Ew(e.type._context),null;case 22:case 23:return Bw(),null;case 24:return null;default:return null}}var wd=!1,mn=!1,pV=typeof WeakSet=="function"?WeakSet:Set,pe=null;function Ia(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){bt(t,e,r)}else n.current=null}function a0(t,e,n){try{n()}catch(r){bt(t,e,r)}}var hE=!1;function fV(t,e){if(Hy=Wh,t=Sk(),yw(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,d=0,u=t,h=null;t:for(;;){for(var p;u!==n||o!==0&&u.nodeType!==3||(a=s+o),u!==i||r!==0&&u.nodeType!==3||(l=s+r),u.nodeType===3&&(s+=u.nodeValue.length),(p=u.firstChild)!==null;)h=u,u=p;for(;;){if(u===t)break t;if(h===n&&++c===o&&(a=s),h===i&&++d===r&&(l=s),(p=u.nextSibling)!==null)break;u=h,h=u.parentNode}u=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Vy={focusedElem:t,selectionRange:n},Wh=!1,pe=e;pe!==null;)if(e=pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pe=t;else for(;pe!==null;){e=pe;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,v=g.memoizedState,x=e.stateNode,b=x.getSnapshotBeforeUpdate(e.elementType===e.type?m:zr(e.type,m),v);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(P){bt(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,pe=t;break}pe=e.return}return g=hE,hE=!1,g}function pc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var i=o.destroy;o.destroy=void 0,i!==void 0&&a0(e,n,i)}o=o.next}while(o!==r)}}function nf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function l0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function w$(t){var e=t.alternate;e!==null&&(t.alternate=null,w$(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[go],delete e[Uc],delete e[Xy],delete e[qH],delete e[QH])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function x$(t){return t.tag===5||t.tag===3||t.tag===4}function pE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||x$(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function c0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Gh));else if(r!==4&&(t=t.child,t!==null))for(c0(t,e,n),t=t.sibling;t!==null;)c0(t,e,n),t=t.sibling}function u0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(u0(t,e,n),t=t.sibling;t!==null;)u0(t,e,n),t=t.sibling}var nn=null,Fr=!1;function di(t,e,n){for(n=n.child;n!==null;)b$(t,e,n),n=n.sibling}function b$(t,e,n){if(vo&&typeof vo.onCommitFiberUnmount=="function")try{vo.onCommitFiberUnmount(Xp,n)}catch{}switch(n.tag){case 5:mn||Ia(n,e);case 6:var r=nn,o=Fr;nn=null,di(t,e,n),nn=r,Fr=o,nn!==null&&(Fr?(t=nn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):nn.removeChild(n.stateNode));break;case 18:nn!==null&&(Fr?(t=nn,n=n.stateNode,t.nodeType===8?Gg(t.parentNode,n):t.nodeType===1&&Gg(t,n),Oc(t)):Gg(nn,n.stateNode));break;case 4:r=nn,o=Fr,nn=n.stateNode.containerInfo,Fr=!0,di(t,e,n),nn=r,Fr=o;break;case 0:case 11:case 14:case 15:if(!mn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&a0(n,e,s),o=o.next}while(o!==r)}di(t,e,n);break;case 1:if(!mn&&(Ia(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){bt(n,e,a)}di(t,e,n);break;case 21:di(t,e,n);break;case 22:n.mode&1?(mn=(r=mn)||n.memoizedState!==null,di(t,e,n),mn=r):di(t,e,n);break;default:di(t,e,n)}}function fE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new pV),e.forEach(function(r){var o=EV.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Br(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:nn=a.stateNode,Fr=!1;break e;case 3:nn=a.stateNode.containerInfo,Fr=!0;break e;case 4:nn=a.stateNode.containerInfo,Fr=!0;break e}a=a.return}if(nn===null)throw Error(te(160));b$(i,s,o),nn=null,Fr=!1;var l=o.alternate;l!==null&&(l.return=null),o.return=null}catch(c){bt(o,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)S$(e,t),e=e.sibling}function S$(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Br(e,t),ao(t),r&4){try{pc(3,t,t.return),nf(3,t)}catch(m){bt(t,t.return,m)}try{pc(5,t,t.return)}catch(m){bt(t,t.return,m)}}break;case 1:Br(e,t),ao(t),r&512&&n!==null&&Ia(n,n.return);break;case 5:if(Br(e,t),ao(t),r&512&&n!==null&&Ia(n,n.return),t.flags&32){var o=t.stateNode;try{Ac(o,"")}catch(m){bt(t,t.return,m)}}if(r&4&&(o=t.stateNode,o!=null)){var i=t.memoizedProps,s=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&KC(o,i),Ly(a,s);var c=Ly(a,i);for(s=0;s<l.length;s+=2){var d=l[s],u=l[s+1];d==="style"?XC(o,u):d==="dangerouslySetInnerHTML"?WC(o,u):d==="children"?Ac(o,u):ow(o,d,u,c)}switch(a){case"input":$y(o,i);break;case"textarea":HC(o,i);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Da(o,!!i.multiple,p,!1):h!==!!i.multiple&&(i.defaultValue!=null?Da(o,!!i.multiple,i.defaultValue,!0):Da(o,!!i.multiple,i.multiple?[]:"",!1))}o[Uc]=i}catch(m){bt(t,t.return,m)}}break;case 6:if(Br(e,t),ao(t),r&4){if(t.stateNode===null)throw Error(te(162));o=t.stateNode,i=t.memoizedProps;try{o.nodeValue=i}catch(m){bt(t,t.return,m)}}break;case 3:if(Br(e,t),ao(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Oc(e.containerInfo)}catch(m){bt(t,t.return,m)}break;case 4:Br(e,t),ao(t);break;case 13:Br(e,t),ao(t),o=t.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(jw=It())),r&4&&fE(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(mn=(c=mn)||d,Br(e,t),mn=c):Br(e,t),ao(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(pe=t,d=t.child;d!==null;){for(u=pe=d;pe!==null;){switch(h=pe,p=h.child,h.tag){case 0:case 11:case 14:case 15:pc(4,h,h.return);break;case 1:Ia(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){bt(r,n,m)}}break;case 5:Ia(h,h.return);break;case 22:if(h.memoizedState!==null){mE(u);continue}}p!==null?(p.return=h,pe=p):mE(u)}d=d.sibling}e:for(d=null,u=t;;){if(u.tag===5){if(d===null){d=u;try{o=u.stateNode,c?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=u.stateNode,l=u.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=YC("display",s))}catch(m){bt(t,t.return,m)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(m){bt(t,t.return,m)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Br(e,t),ao(t),r&4&&fE(t);break;case 21:break;default:Br(e,t),ao(t)}}function ao(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(x$(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Ac(o,""),r.flags&=-33);var i=pE(t);u0(t,i,o);break;case 3:case 4:var s=r.stateNode.containerInfo,a=pE(t);c0(t,a,s);break;default:throw Error(te(161))}}catch(l){bt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gV(t,e,n){pe=t,E$(t)}function E$(t,e,n){for(var r=(t.mode&1)!==0;pe!==null;){var o=pe,i=o.child;if(o.tag===22&&r){var s=o.memoizedState!==null||wd;if(!s){var a=o.alternate,l=a!==null&&a.memoizedState!==null||mn;a=wd;var c=mn;if(wd=s,(mn=l)&&!c)for(pe=o;pe!==null;)s=pe,l=s.child,s.tag===22&&s.memoizedState!==null?yE(o):l!==null?(l.return=s,pe=l):yE(o);for(;i!==null;)pe=i,E$(i),i=i.sibling;pe=o,wd=a,mn=c}gE(t)}else o.subtreeFlags&8772&&i!==null?(i.return=o,pe=i):gE(t)}}function gE(t){for(;pe!==null;){var e=pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:mn||nf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!mn)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:zr(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ZS(e,i,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ZS(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&Oc(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}mn||e.flags&512&&l0(e)}catch(h){bt(e,e.return,h)}}if(e===t){pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,pe=n;break}pe=e.return}}function mE(t){for(;pe!==null;){var e=pe;if(e===t){pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pe=n;break}pe=e.return}}function yE(t){for(;pe!==null;){var e=pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{nf(4,e)}catch(l){bt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(l){bt(e,o,l)}}var i=e.return;try{l0(e)}catch(l){bt(e,i,l)}break;case 5:var s=e.return;try{l0(e)}catch(l){bt(e,s,l)}}}catch(l){bt(e,e.return,l)}if(e===t){pe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,pe=a;break}pe=e.return}}var mV=Math.ceil,sp=ni.ReactCurrentDispatcher,Dw=ni.ReactCurrentOwner,kr=ni.ReactCurrentBatchConfig,Ke=0,qt=null,Rt=null,an=0,er=0,Ca=qi(0),zt=0,Yc=null,Ds=0,rf=0,Ow=0,fc=null,Bn=null,jw=0,Ja=1/0,Lo=null,ap=!1,d0=null,Mi=null,xd=!1,Si=null,lp=0,gc=0,h0=null,uh=-1,dh=0;function In(){return Ke&6?It():uh!==-1?uh:uh=It()}function Ai(t){return t.mode&1?Ke&2&&an!==0?an&-an:JH.transition!==null?(dh===0&&(dh=sk()),dh):(t=Xe,t!==0||(t=window.event,t=t===void 0?16:pk(t.type)),t):1}function Gr(t,e,n,r){if(50<gc)throw gc=0,h0=null,Error(te(185));xu(t,n,r),(!(Ke&2)||t!==qt)&&(t===qt&&(!(Ke&2)&&(rf|=n),zt===4&&yi(t,an)),Wn(t,r),n===1&&Ke===0&&!(e.mode&1)&&(Ja=It()+500,Jp&&Qi()))}function Wn(t,e){var n=t.callbackNode;JK(t,e);var r=Vh(t,t===qt?an:0);if(r===0)n!==null&&IS(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&IS(n),e===1)t.tag===0?ZH(vE.bind(null,t)):Ak(vE.bind(null,t)),XH(function(){!(Ke&6)&&Qi()}),n=null;else{switch(ak(r)){case 1:n=cw;break;case 4:n=ok;break;case 16:n=Hh;break;case 536870912:n=ik;break;default:n=Hh}n=M$(n,P$.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function P$(t,e){if(uh=-1,dh=0,Ke&6)throw Error(te(327));var n=t.callbackNode;if(za()&&t.callbackNode!==n)return null;var r=Vh(t,t===qt?an:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=cp(t,r);else{e=r;var o=Ke;Ke|=2;var i=I$();(qt!==t||an!==e)&&(Lo=null,Ja=It()+500,_s(t,e));do try{wV();break}catch(a){_$(t,a)}while(1);Sw(),sp.current=i,Ke=o,Rt!==null?e=0:(qt=null,an=0,e=zt)}if(e!==0){if(e===2&&(o=By(t),o!==0&&(r=o,e=p0(t,o))),e===1)throw n=Yc,_s(t,0),yi(t,r),Wn(t,It()),n;if(e===6)yi(t,r);else{if(o=t.current.alternate,!(r&30)&&!yV(o)&&(e=cp(t,r),e===2&&(i=By(t),i!==0&&(r=i,e=p0(t,i))),e===1))throw n=Yc,_s(t,0),yi(t,r),Wn(t,It()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(te(345));case 2:ds(t,Bn,Lo);break;case 3:if(yi(t,r),(r&130023424)===r&&(e=jw+500-It(),10<e)){if(Vh(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){In(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Yy(ds.bind(null,t,Bn,Lo),e);break}ds(t,Bn,Lo);break;case 4:if(yi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var s=31-Xr(r);i=1<<s,s=e[s],s>o&&(o=s),r&=~i}if(r=o,r=It()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*mV(r/1960))-r,10<r){t.timeoutHandle=Yy(ds.bind(null,t,Bn,Lo),r);break}ds(t,Bn,Lo);break;case 5:ds(t,Bn,Lo);break;default:throw Error(te(329))}}}return Wn(t,It()),t.callbackNode===n?P$.bind(null,t):null}function p0(t,e){var n=fc;return t.current.memoizedState.isDehydrated&&(_s(t,e).flags|=256),t=cp(t,e),t!==2&&(e=Bn,Bn=n,e!==null&&f0(e)),t}function f0(t){Bn===null?Bn=t:Bn.push.apply(Bn,t)}function yV(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!Zr(i(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function yi(t,e){for(e&=~Ow,e&=~rf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Xr(e),r=1<<n;t[n]=-1,e&=~r}}function vE(t){if(Ke&6)throw Error(te(327));za();var e=Vh(t,0);if(!(e&1))return Wn(t,It()),null;var n=cp(t,e);if(t.tag!==0&&n===2){var r=By(t);r!==0&&(e=r,n=p0(t,r))}if(n===1)throw n=Yc,_s(t,0),yi(t,e),Wn(t,It()),n;if(n===6)throw Error(te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ds(t,Bn,Lo),Wn(t,It()),null}function Nw(t,e){var n=Ke;Ke|=1;try{return t(e)}finally{Ke=n,Ke===0&&(Ja=It()+500,Jp&&Qi())}}function Os(t){Si!==null&&Si.tag===0&&!(Ke&6)&&za();var e=Ke;Ke|=1;var n=kr.transition,r=Xe;try{if(kr.transition=null,Xe=1,t)return t()}finally{Xe=r,kr.transition=n,Ke=e,!(Ke&6)&&Qi()}}function Bw(){er=Ca.current,at(Ca)}function _s(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,YH(n)),Rt!==null)for(n=Rt.return;n!==null;){var r=n;switch(ww(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qh();break;case 3:Qa(),at(Hn),at(vn),kw();break;case 5:Cw(r);break;case 4:Qa();break;case 13:at(ft);break;case 19:at(ft);break;case 10:Ew(r.type._context);break;case 22:case 23:Bw()}n=n.return}if(qt=t,Rt=t=Ri(t.current,null),an=er=e,zt=0,Yc=null,Ow=rf=Ds=0,Bn=fc=null,xs!==null){for(e=0;e<xs.length;e++)if(n=xs[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var s=i.next;i.next=o,r.next=s}n.pending=r}xs=null}return t}function _$(t,e){do{var n=Rt;try{if(Sw(),ah.current=ip,op){for(var r=mt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}op=!1}if(Ls=0,Yt=Nt=mt=null,hc=!1,Hc=0,Dw.current=null,n===null||n.return===null){zt=1,Yc=e,Rt=null;break}e:{var i=t,s=n.return,a=n,l=e;if(e=an,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,u=d.tag;if(!(d.mode&1)&&(u===0||u===11||u===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=iE(s);if(p!==null){p.flags&=-257,sE(p,s,a,i,e),p.mode&1&&oE(i,c,e),e=p,l=c;var g=e.updateQueue;if(g===null){var m=new Set;m.add(l),e.updateQueue=m}else g.add(l);break e}else{if(!(e&1)){oE(i,c,e),zw();break e}l=Error(te(426))}}else if(ut&&a.mode&1){var v=iE(s);if(v!==null){!(v.flags&65536)&&(v.flags|=256),sE(v,s,a,i,e),xw(Za(l,a));break e}}i=l=Za(l,a),zt!==4&&(zt=2),fc===null?fc=[i]:fc.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=l$(i,l,e);QS(i,x);break e;case 1:a=l;var b=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Mi===null||!Mi.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=c$(i,a,e);QS(i,P);break e}}i=i.return}while(i!==null)}k$(n)}catch(C){e=C,Rt===n&&n!==null&&(Rt=n=n.return);continue}break}while(1)}function I$(){var t=sp.current;return sp.current=ip,t===null?ip:t}function zw(){(zt===0||zt===3||zt===2)&&(zt=4),qt===null||!(Ds&268435455)&&!(rf&268435455)||yi(qt,an)}function cp(t,e){var n=Ke;Ke|=2;var r=I$();(qt!==t||an!==e)&&(Lo=null,_s(t,e));do try{vV();break}catch(o){_$(t,o)}while(1);if(Sw(),Ke=n,sp.current=r,Rt!==null)throw Error(te(261));return qt=null,an=0,zt}function vV(){for(;Rt!==null;)C$(Rt)}function wV(){for(;Rt!==null&&!HK();)C$(Rt)}function C$(t){var e=T$(t.alternate,t,er);t.memoizedProps=t.pendingProps,e===null?k$(t):Rt=e,Dw.current=null}function k$(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=hV(n,e),n!==null){n.flags&=32767,Rt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{zt=6,Rt=null;return}}else if(n=dV(n,e,er),n!==null){Rt=n;return}if(e=e.sibling,e!==null){Rt=e;return}Rt=e=t}while(e!==null);zt===0&&(zt=5)}function ds(t,e,n){var r=Xe,o=kr.transition;try{kr.transition=null,Xe=1,xV(t,e,n,r)}finally{kr.transition=o,Xe=r}return null}function xV(t,e,n,r){do za();while(Si!==null);if(Ke&6)throw Error(te(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(te(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(eH(t,i),t===qt&&(Rt=qt=null,an=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||xd||(xd=!0,M$(Hh,function(){return za(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=kr.transition,kr.transition=null;var s=Xe;Xe=1;var a=Ke;Ke|=4,Dw.current=null,fV(t,n),S$(n,t),zH(Vy),Wh=!!Hy,Vy=Hy=null,t.current=n,gV(n),VK(),Ke=a,Xe=s,kr.transition=i}else t.current=n;if(xd&&(xd=!1,Si=t,lp=o),i=t.pendingLanes,i===0&&(Mi=null),XK(n.stateNode),Wn(t,It()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(ap)throw ap=!1,t=d0,d0=null,t;return lp&1&&t.tag!==0&&za(),i=t.pendingLanes,i&1?t===h0?gc++:(gc=0,h0=t):gc=0,Qi(),null}function za(){if(Si!==null){var t=ak(lp),e=kr.transition,n=Xe;try{if(kr.transition=null,Xe=16>t?16:t,Si===null)var r=!1;else{if(t=Si,Si=null,lp=0,Ke&6)throw Error(te(331));var o=Ke;for(Ke|=4,pe=t.current;pe!==null;){var i=pe,s=i.child;if(pe.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(pe=c;pe!==null;){var d=pe;switch(d.tag){case 0:case 11:case 15:pc(8,d,i)}var u=d.child;if(u!==null)u.return=d,pe=u;else for(;pe!==null;){d=pe;var h=d.sibling,p=d.return;if(w$(d),d===c){pe=null;break}if(h!==null){h.return=p,pe=h;break}pe=p}}}var g=i.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}pe=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,pe=s;else e:for(;pe!==null;){if(i=pe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:pc(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,pe=x;break e}pe=i.return}}var b=t.current;for(pe=b;pe!==null;){s=pe;var E=s.child;if(s.subtreeFlags&2064&&E!==null)E.return=s,pe=E;else e:for(s=b;pe!==null;){if(a=pe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:nf(9,a)}}catch(C){bt(a,a.return,C)}if(a===s){pe=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,pe=P;break e}pe=a.return}}if(Ke=o,Qi(),vo&&typeof vo.onPostCommitFiberRoot=="function")try{vo.onPostCommitFiberRoot(Xp,t)}catch{}r=!0}return r}finally{Xe=n,kr.transition=e}}return!1}function wE(t,e,n){e=Za(n,e),e=l$(t,e,1),t=Ti(t,e,1),e=In(),t!==null&&(xu(t,1,e),Wn(t,e))}function bt(t,e,n){if(t.tag===3)wE(t,t,n);else for(;e!==null;){if(e.tag===3){wE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Mi===null||!Mi.has(r))){t=Za(n,t),t=c$(e,t,1),e=Ti(e,t,1),t=In(),e!==null&&(xu(e,1,t),Wn(e,t));break}}e=e.return}}function bV(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=In(),t.pingedLanes|=t.suspendedLanes&n,qt===t&&(an&n)===n&&(zt===4||zt===3&&(an&130023424)===an&&500>It()-jw?_s(t,0):Ow|=n),Wn(t,e)}function $$(t,e){e===0&&(t.mode&1?(e=ud,ud<<=1,!(ud&130023424)&&(ud=4194304)):e=1);var n=In();t=Jo(t,e),t!==null&&(xu(t,e,n),Wn(t,n))}function SV(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),$$(t,n)}function EV(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(e),$$(t,n)}var T$;T$=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Hn.current)Un=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Un=!1,uV(t,e,n);Un=!!(t.flags&131072)}else Un=!1,ut&&e.flags&1048576&&Rk(e,Jh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ch(t,e),t=e.pendingProps;var o=Xa(e,vn.current);Ba(e,n),o=Tw(null,e,r,t,o,n);var i=Mw();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Vn(r)?(i=!0,Qh(e)):i=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,_w(e),o.updater=ef,e.stateNode=o,o._reactInternals=e,e0(e,r,t,n),e=r0(null,e,r,!0,i,n)):(e.tag=0,ut&&i&&vw(e),Sn(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ch(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=_V(r),t=zr(r,t),o){case 0:e=n0(null,e,r,t,n);break e;case 1:e=cE(null,e,r,t,n);break e;case 11:e=aE(null,e,r,t,n);break e;case 14:e=lE(null,e,r,zr(r.type,t),n);break e}throw Error(te(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zr(r,o),n0(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zr(r,o),cE(t,e,r,o,n);case 3:e:{if(p$(e),t===null)throw Error(te(387));r=e.pendingProps,i=e.memoizedState,o=i.element,jk(t,e),np(e,r,null,n);var s=e.memoizedState;if(r=s.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){o=Za(Error(te(423)),e),e=uE(t,e,r,n,o);break e}else if(r!==o){o=Za(Error(te(424)),e),e=uE(t,e,r,n,o);break e}else for(rr=$i(e.stateNode.containerInfo.firstChild),ir=e,ut=!0,Wr=null,n=Uk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ga(),r===o){e=ei(t,e,n);break e}Sn(t,e,r,n)}e=e.child}return e;case 5:return Fk(e),t===null&&Qy(e),r=e.type,o=e.pendingProps,i=t!==null?t.memoizedProps:null,s=o.children,Wy(r,o)?s=null:i!==null&&Wy(r,i)&&(e.flags|=32),h$(t,e),Sn(t,e,s,n),e.child;case 6:return t===null&&Qy(e),null;case 13:return f$(t,e,n);case 4:return Iw(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=qa(e,null,r,n):Sn(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zr(r,o),aE(t,e,r,o,n);case 7:return Sn(t,e,e.pendingProps,n),e.child;case 8:return Sn(t,e,e.pendingProps.children,n),e.child;case 12:return Sn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,i=e.memoizedProps,s=o.value,tt(ep,r._currentValue),r._currentValue=s,i!==null)if(Zr(i.value,s)){if(i.children===o.children&&!Hn.current){e=ei(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){s=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Yo(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Zy(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)s=i.type===e.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(te(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Zy(s,n,e),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===e){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Sn(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,Ba(e,n),o=Tr(o),r=r(o),e.flags|=1,Sn(t,e,r,n),e.child;case 14:return r=e.type,o=zr(r,e.pendingProps),o=zr(r.type,o),lE(t,e,r,o,n);case 15:return u$(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zr(r,o),ch(t,e),e.tag=1,Vn(r)?(t=!0,Qh(e)):t=!1,Ba(e,n),Bk(e,r,o),e0(e,r,o,n),r0(null,e,r,!0,t,n);case 19:return g$(t,e,n);case 22:return d$(t,e,n)}throw Error(te(156,e.tag))};function M$(t,e){return rk(t,e)}function PV(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(t,e,n,r){return new PV(t,e,n,r)}function Uw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function _V(t){if(typeof t=="function")return Uw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===sw)return 11;if(t===aw)return 14}return 2}function Ri(t,e){var n=t.alternate;return n===null?(n=Ir(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function hh(t,e,n,r,o,i){var s=2;if(r=t,typeof t=="function")Uw(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case ya:return Is(n.children,o,i,e);case iw:s=8,o|=8;break;case Py:return t=Ir(12,n,e,o|2),t.elementType=Py,t.lanes=i,t;case _y:return t=Ir(13,n,e,o),t.elementType=_y,t.lanes=i,t;case Iy:return t=Ir(19,n,e,o),t.elementType=Iy,t.lanes=i,t;case zC:return of(n,o,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case NC:s=10;break e;case BC:s=9;break e;case sw:s=11;break e;case aw:s=14;break e;case pi:s=16,r=null;break e}throw Error(te(130,t==null?t:typeof t,""))}return e=Ir(s,n,e,o),e.elementType=t,e.type=r,e.lanes=i,e}function Is(t,e,n,r){return t=Ir(7,t,r,e),t.lanes=n,t}function of(t,e,n,r){return t=Ir(22,t,r,e),t.elementType=zC,t.lanes=n,t.stateNode={isHidden:!1},t}function rm(t,e,n){return t=Ir(6,t,null,e),t.lanes=n,t}function om(t,e,n){return e=Ir(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function IV(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ng(0),this.expirationTimes=Ng(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ng(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Fw(t,e,n,r,o,i,s,a,l){return t=new IV(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ir(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_w(i),t}function CV(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ma,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function A$(t){if(!t)return ji;t=t._reactInternals;e:{if(Ks(t)!==t||t.tag!==1)throw Error(te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(te(171))}if(t.tag===1){var n=t.type;if(Vn(n))return Mk(t,n,e)}return e}function R$(t,e,n,r,o,i,s,a,l){return t=Fw(n,r,!0,t,o,i,s,a,l),t.context=A$(null),n=t.current,r=In(),o=Ai(n),i=Yo(r,o),i.callback=e??null,Ti(n,i,o),t.current.lanes=o,xu(t,o,r),Wn(t,r),t}function sf(t,e,n,r){var o=e.current,i=In(),s=Ai(o);return n=A$(n),e.context===null?e.context=n:e.pendingContext=n,e=Yo(i,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ti(o,e,s),t!==null&&(Gr(t,o,s,i),sh(t,o,s)),s}function up(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Kw(t,e){xE(t,e),(t=t.alternate)&&xE(t,e)}function kV(){return null}var L$=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hw(t){this._internalRoot=t}af.prototype.render=Hw.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(te(409));sf(t,e,null,null)};af.prototype.unmount=Hw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Os(function(){sf(null,t,null,null)}),e[Zo]=null}};function af(t){this._internalRoot=t}af.prototype.unstable_scheduleHydration=function(t){if(t){var e=uk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<mi.length&&e!==0&&e<mi[n].priority;n++);mi.splice(n,0,t),n===0&&hk(t)}};function Vw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function lf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function bE(){}function $V(t,e,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var c=up(s);i.call(c)}}var s=R$(e,r,t,0,null,!1,!1,"",bE);return t._reactRootContainer=s,t[Zo]=s.current,Bc(t.nodeType===8?t.parentNode:t),Os(),s}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var a=r;r=function(){var c=up(l);a.call(c)}}var l=Fw(t,0,!1,null,null,!1,!1,"",bE);return t._reactRootContainer=l,t[Zo]=l.current,Bc(t.nodeType===8?t.parentNode:t),Os(function(){sf(e,l,n,r)}),l}function cf(t,e,n,r,o){var i=n._reactRootContainer;if(i){var s=i;if(typeof o=="function"){var a=o;o=function(){var l=up(s);a.call(l)}}sf(e,s,t,o)}else s=$V(n,e,t,o,r);return up(s)}lk=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ec(e.pendingLanes);n!==0&&(uw(e,n|1),Wn(e,It()),!(Ke&6)&&(Ja=It()+500,Qi()))}break;case 13:Os(function(){var r=Jo(t,1);if(r!==null){var o=In();Gr(r,t,1,o)}}),Kw(t,1)}};dw=function(t){if(t.tag===13){var e=Jo(t,134217728);if(e!==null){var n=In();Gr(e,t,134217728,n)}Kw(t,134217728)}};ck=function(t){if(t.tag===13){var e=Ai(t),n=Jo(t,e);if(n!==null){var r=In();Gr(n,t,e,r)}Kw(t,e)}};uk=function(){return Xe};dk=function(t,e){var n=Xe;try{return Xe=t,e()}finally{Xe=n}};Oy=function(t,e,n){switch(e){case"input":if($y(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=Zp(r);if(!o)throw Error(te(90));FC(r),$y(r,o)}}}break;case"textarea":HC(t,n);break;case"select":e=n.value,e!=null&&Da(t,!!n.multiple,e,!1)}};QC=Nw;ZC=Os;var TV={usingClientEntryPoint:!1,Events:[Su,ba,Zp,GC,qC,Nw]},Ul={findFiberByHostInstance:ws,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},MV={bundleType:Ul.bundleType,version:Ul.version,rendererPackageName:Ul.rendererPackageName,rendererConfig:Ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ni.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=tk(t),t===null?null:t.stateNode},findFiberByHostInstance:Ul.findFiberByHostInstance||kV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bd.isDisabled&&bd.supportsFiber)try{Xp=bd.inject(MV),vo=bd}catch{}}cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TV;cr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vw(e))throw Error(te(200));return CV(t,e,null,n)};cr.createRoot=function(t,e){if(!Vw(t))throw Error(te(299));var n=!1,r="",o=L$;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=Fw(t,1,!1,null,null,n,!1,r,o),t[Zo]=e.current,Bc(t.nodeType===8?t.parentNode:t),new Hw(e)};cr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(te(188)):(t=Object.keys(t).join(","),Error(te(268,t)));return t=tk(e),t=t===null?null:t.stateNode,t};cr.flushSync=function(t){return Os(t)};cr.hydrate=function(t,e,n){if(!lf(e))throw Error(te(200));return cf(null,t,e,!0,n)};cr.hydrateRoot=function(t,e,n){if(!Vw(t))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",s=L$;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=R$(e,null,t,1,n??null,o,!1,i,s),t[Zo]=e.current,Bc(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new af(e)};cr.render=function(t,e,n){if(!lf(e))throw Error(te(200));return cf(null,t,e,!1,n)};cr.unmountComponentAtNode=function(t){if(!lf(t))throw Error(te(40));return t._reactRootContainer?(Os(function(){cf(null,null,t,!1,function(){t._reactRootContainer=null,t[Zo]=null})}),!0):!1};cr.unstable_batchedUpdates=Nw;cr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!lf(n))throw Error(te(200));if(t==null||t._reactInternals===void 0)throw Error(te(38));return cf(t,e,n,!1,r)};cr.version="18.2.0-next-9e3b772b8-20220608";function D$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(D$)}catch(t){console.error(t)}}D$(),RC.exports=cr;var fl=RC.exports;const AV=tl(fl),js=w.forwardRef((t,e)=>{const{children:n,...r}=t,o=w.Children.toArray(n),i=o.find(LV);if(i){const s=i.props.children,a=o.map(l=>l===i?w.Children.count(s)>1?w.Children.only(null):w.isValidElement(s)?s.props.children:null:l);return w.createElement(g0,oe({},r,{ref:e}),w.isValidElement(s)?w.cloneElement(s,void 0,a):null)}return w.createElement(g0,oe({},r,{ref:e}),n)});js.displayName="Slot";const g0=w.forwardRef((t,e)=>{const{children:n,...r}=t;return w.isValidElement(n)?w.cloneElement(n,{...DV(r,n.props),ref:Yp(e,n.ref)}):w.Children.count(n)>1?w.Children.only(null):null});g0.displayName="SlotClone";const RV=({children:t})=>w.createElement(w.Fragment,null,t);function LV(t){return w.isValidElement(t)&&t.type===RV}function DV(t,e){const n={...e};for(const r in e){const o=t[r],i=e[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...a)=>{i(...a),o(...a)}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...t,...n}}const OV=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],He=OV.reduce((t,e)=>{const n=w.forwardRef((r,o)=>{const{asChild:i,...s}=r,a=i?js:e;return w.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),w.createElement(a,oe({},s,{ref:o}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Ww(t,e){t&&fl.flushSync(()=>t.dispatchEvent(e))}function jV(t,e=globalThis==null?void 0:globalThis.document){const n=ln(t);w.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[n,e])}const m0="dismissableLayer.update",NV="dismissableLayer.pointerDownOutside",BV="dismissableLayer.focusOutside";let SE;const O$=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),uf=w.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:a,onDismiss:l,...c}=t,d=w.useContext(O$),[u,h]=w.useState(null),p=(n=u==null?void 0:u.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,g]=w.useState({}),m=qe(e,A=>h(A)),v=Array.from(d.layers),[x]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),b=v.indexOf(x),E=u?v.indexOf(u):-1,P=d.layersWithOutsidePointerEventsDisabled.size>0,C=E>=b,k=UV(A=>{const D=A.target,j=[...d.branches].some(Y=>Y.contains(D));!C||j||(i==null||i(A),a==null||a(A),A.defaultPrevented||l==null||l())},p),$=FV(A=>{const D=A.target;[...d.branches].some(Y=>Y.contains(D))||(s==null||s(A),a==null||a(A),A.defaultPrevented||l==null||l())},p);return jV(A=>{E===d.layers.size-1&&(o==null||o(A),!A.defaultPrevented&&l&&(A.preventDefault(),l()))},p),w.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(SE=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),EE(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=SE)}},[u,p,r,d]),w.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),EE())},[u,d]),w.useEffect(()=>{const A=()=>g({});return document.addEventListener(m0,A),()=>document.removeEventListener(m0,A)},[]),w.createElement(He.div,oe({},c,{ref:m,style:{pointerEvents:P?C?"auto":"none":void 0,...t.style},onFocusCapture:fe(t.onFocusCapture,$.onFocusCapture),onBlurCapture:fe(t.onBlurCapture,$.onBlurCapture),onPointerDownCapture:fe(t.onPointerDownCapture,k.onPointerDownCapture)}))}),zV=w.forwardRef((t,e)=>{const n=w.useContext(O$),r=w.useRef(null),o=qe(e,r);return w.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),w.createElement(He.div,oe({},t,{ref:o}))});function UV(t,e=globalThis==null?void 0:globalThis.document){const n=ln(t),r=w.useRef(!1),o=w.useRef(()=>{});return w.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let d=function(){j$(NV,n,c,{discrete:!0})};var l=d;const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=d,e.addEventListener("click",o.current,{once:!0})):d()}r.current=!1},s=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(s),e.removeEventListener("pointerdown",i),e.removeEventListener("click",o.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function FV(t,e=globalThis==null?void 0:globalThis.document){const n=ln(t),r=w.useRef(!1);return w.useEffect(()=>{const o=i=>{i.target&&!r.current&&j$(BV,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function EE(){const t=new CustomEvent(m0);document.dispatchEvent(t)}function j$(t,e,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&o.addEventListener(t,e,{once:!0}),r?Ww(o,i):o.dispatchEvent(i)}const KV=uf,HV=zV,im="focusScope.autoFocusOnMount",sm="focusScope.autoFocusOnUnmount",PE={bubbles:!1,cancelable:!0},Yw=w.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...s}=t,[a,l]=w.useState(null),c=ln(o),d=ln(i),u=w.useRef(null),h=qe(e,m=>l(m)),p=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(r){let x=function(E){if(p.paused||!a)return;const P=E.target;a.contains(P)?u.current=P:hs(u.current,{select:!0})},b=function(E){p.paused||!a||a.contains(E.relatedTarget)||hs(u.current,{select:!0})};var m=x,v=b;return document.addEventListener("focusin",x),document.addEventListener("focusout",b),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",b)}}},[r,a,p.paused]),w.useEffect(()=>{if(a){IE.add(p);const m=document.activeElement;if(!a.contains(m)){const x=new CustomEvent(im,PE);a.addEventListener(im,c),a.dispatchEvent(x),x.defaultPrevented||(VV(qV(N$(a)),{select:!0}),document.activeElement===m&&hs(a))}return()=>{a.removeEventListener(im,c),setTimeout(()=>{const x=new CustomEvent(sm,PE);a.addEventListener(sm,d),a.dispatchEvent(x),x.defaultPrevented||hs(m??document.body,{select:!0}),a.removeEventListener(sm,d),IE.remove(p)},0)}}},[a,c,d,p]);const g=w.useCallback(m=>{if(!n&&!r||p.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,x=document.activeElement;if(v&&x){const b=m.currentTarget,[E,P]=WV(b);E&&P?!m.shiftKey&&x===P?(m.preventDefault(),n&&hs(E,{select:!0})):m.shiftKey&&x===E&&(m.preventDefault(),n&&hs(P,{select:!0})):x===b&&m.preventDefault()}},[n,r,p.paused]);return w.createElement(He.div,oe({tabIndex:-1},s,{ref:h,onKeyDown:g}))});function VV(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(hs(r,{select:e}),document.activeElement!==n)return}function WV(t){const e=N$(t),n=_E(e,t),r=_E(e.reverse(),t);return[n,r]}function N$(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function _E(t,e){for(const n of t)if(!YV(n,{upTo:e}))return n}function YV(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function XV(t){return t instanceof HTMLInputElement&&"select"in t}function hs(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&XV(t)&&e&&t.select()}}const IE=GV();function GV(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=CE(t,e),t.unshift(e)},remove(e){var n;t=CE(t,e),(n=t[0])===null||n===void 0||n.resume()}}}function CE(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function qV(t){return t.filter(e=>e.tagName!=="A")}const df=w.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...o}=t;return r?AV.createPortal(w.createElement(He.div,oe({},o,{ref:e})),r):null});function QV(t,e){return w.useReducer((n,r)=>{const o=e[n][r];return o??n},t)}const no=t=>{const{present:e,children:n}=t,r=ZV(e),o=typeof n=="function"?n({present:r.isPresent}):w.Children.only(n),i=qe(r.ref,o.ref);return typeof n=="function"||r.isPresent?w.cloneElement(o,{ref:i}):null};no.displayName="Presence";function ZV(t){const[e,n]=w.useState(),r=w.useRef({}),o=w.useRef(t),i=w.useRef("none"),s=t?"mounted":"unmounted",[a,l]=QV(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const c=Sd(r.current);i.current=a==="mounted"?c:"none"},[a]),nr(()=>{const c=r.current,d=o.current;if(d!==t){const h=i.current,p=Sd(c);t?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(d&&h!==p?"ANIMATION_OUT":"UNMOUNT"),o.current=t}},[t,l]),nr(()=>{if(e){const c=u=>{const p=Sd(r.current).includes(u.animationName);u.target===e&&p&&fl.flushSync(()=>l("ANIMATION_END"))},d=u=>{u.target===e&&(i.current=Sd(r.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",c),e.addEventListener("animationend",c),()=>{e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",c),e.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:w.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function Sd(t){return(t==null?void 0:t.animationName)||"none"}let am=0;function Xw(){w.useEffect(()=>{var t,e;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:kE()),document.body.insertAdjacentElement("beforeend",(e=n[1])!==null&&e!==void 0?e:kE()),am++,()=>{am===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),am--}},[])}function kE(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}var mo=function(){return mo=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mo.apply(this,arguments)};function B$(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function JV(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,i;r<o;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var ph="right-scroll-bar-position",fh="width-before-scroll-bar",eW="with-scroll-bars-hidden",tW="--removed-body-scroll-bar-size";function nW(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function rW(t,e){var n=w.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var o=n.value;o!==r&&(n.value=r,n.callback(r,o))}}}})[0];return n.callback=e,n.facade}function oW(t,e){return rW(e||null,function(n){return t.forEach(function(r){return nW(r,n)})})}function iW(t){return t}function sW(t,e){e===void 0&&(e=iW);var n=[],r=!1,o={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var s=e(i,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(i){for(r=!0;n.length;){var s=n;n=[],s.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(i),s=n}var l=function(){var d=s;s=[],d.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(d){s.push(d),c()},filter:function(d){return s=s.filter(d),n}}}};return o}function aW(t){t===void 0&&(t={});var e=sW(null);return e.options=mo({async:!0,ssr:!1},t),e}var z$=function(t){var e=t.sideCar,n=B$(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return w.createElement(r,mo({},n))};z$.isSideCarExport=!0;function lW(t,e){return t.useMedium(e),z$}var U$=aW(),lm=function(){},hf=w.forwardRef(function(t,e){var n=w.useRef(null),r=w.useState({onScrollCapture:lm,onWheelCapture:lm,onTouchMoveCapture:lm}),o=r[0],i=r[1],s=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,d=t.enabled,u=t.shards,h=t.sideCar,p=t.noIsolation,g=t.inert,m=t.allowPinchZoom,v=t.as,x=v===void 0?"div":v,b=B$(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),E=h,P=oW([n,e]),C=mo(mo({},b),o);return w.createElement(w.Fragment,null,d&&w.createElement(E,{sideCar:U$,removeScrollBar:c,shards:u,noIsolation:p,inert:g,setCallbacks:i,allowPinchZoom:!!m,lockRef:n}),s?w.cloneElement(w.Children.only(a),mo(mo({},C),{ref:P})):w.createElement(x,mo({},C,{className:l,ref:P}),a))});hf.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};hf.classNames={fullWidth:fh,zeroRight:ph};var $E,cW=function(){if($E)return $E;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function uW(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=cW();return e&&t.setAttribute("nonce",e),t}function dW(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function hW(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var pW=function(){var t=0,e=null;return{add:function(n){t==0&&(e=uW())&&(dW(e,n),hW(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},fW=function(){var t=pW();return function(e,n){w.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},F$=function(){var t=fW(),e=function(n){var r=n.styles,o=n.dynamic;return t(r,o),null};return e},gW={left:0,top:0,right:0,gap:0},cm=function(t){return parseInt(t||"",10)||0},mW=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],o=e[t==="padding"?"paddingRight":"marginRight"];return[cm(n),cm(r),cm(o)]},yW=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return gW;var e=mW(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},vW=F$(),wW=function(t,e,n,r){var o=t.left,i=t.top,s=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(eW,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ph,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(fh,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(ph," .").concat(ph,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(fh," .").concat(fh,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body {
    `).concat(tW,": ").concat(a,`px;
  }
`)},xW=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,o=r===void 0?"margin":r,i=w.useMemo(function(){return yW(o)},[o]);return w.createElement(vW,{styles:wW(i,!e,o,n?"":"!important")})},y0=!1;if(typeof window<"u")try{var Ed=Object.defineProperty({},"passive",{get:function(){return y0=!0,!0}});window.addEventListener("test",Ed,Ed),window.removeEventListener("test",Ed,Ed)}catch{y0=!1}var aa=y0?{passive:!1}:!1,bW=function(t){return t.tagName==="TEXTAREA"},K$=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!bW(t)&&n[e]==="visible")},SW=function(t){return K$(t,"overflowY")},EW=function(t){return K$(t,"overflowX")},TE=function(t,e){var n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=H$(t,n);if(r){var o=V$(t,n),i=o[1],s=o[2];if(i>s)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},PW=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},_W=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},H$=function(t,e){return t==="v"?SW(e):EW(e)},V$=function(t,e){return t==="v"?PW(e):_W(e)},IW=function(t,e){return t==="h"&&e==="rtl"?-1:1},CW=function(t,e,n,r,o){var i=IW(t,window.getComputedStyle(e).direction),s=i*r,a=n.target,l=e.contains(a),c=!1,d=s>0,u=0,h=0;do{var p=V$(t,a),g=p[0],m=p[1],v=p[2],x=m-v-i*g;(g||x)&&H$(t,a)&&(u+=x,h+=g),a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(d&&(o&&u===0||!o&&s>u)||!d&&(o&&h===0||!o&&-s>h))&&(c=!0),c},Pd=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},ME=function(t){return[t.deltaX,t.deltaY]},AE=function(t){return t&&"current"in t?t.current:t},kW=function(t,e){return t[0]===e[0]&&t[1]===e[1]},$W=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},TW=0,la=[];function MW(t){var e=w.useRef([]),n=w.useRef([0,0]),r=w.useRef(),o=w.useState(TW++)[0],i=w.useState(function(){return F$()})[0],s=w.useRef(t);w.useEffect(function(){s.current=t},[t]),w.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(o));var m=JV([t.lockRef.current],(t.shards||[]).map(AE),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(o))})}}},[t.inert,t.lockRef.current,t.shards]);var a=w.useCallback(function(m,v){if("touches"in m&&m.touches.length===2)return!s.current.allowPinchZoom;var x=Pd(m),b=n.current,E="deltaX"in m?m.deltaX:b[0]-x[0],P="deltaY"in m?m.deltaY:b[1]-x[1],C,k=m.target,$=Math.abs(E)>Math.abs(P)?"h":"v";if("touches"in m&&$==="h"&&k.type==="range")return!1;var A=TE($,k);if(!A)return!0;if(A?C=$:(C=$==="v"?"h":"v",A=TE($,k)),!A)return!1;if(!r.current&&"changedTouches"in m&&(E||P)&&(r.current=C),!C)return!0;var D=r.current||C;return CW(D,v,m,D==="h"?E:P,!0)},[]),l=w.useCallback(function(m){var v=m;if(!(!la.length||la[la.length-1]!==i)){var x="deltaY"in v?ME(v):Pd(v),b=e.current.filter(function(C){return C.name===v.type&&C.target===v.target&&kW(C.delta,x)})[0];if(b&&b.should){v.cancelable&&v.preventDefault();return}if(!b){var E=(s.current.shards||[]).map(AE).filter(Boolean).filter(function(C){return C.contains(v.target)}),P=E.length>0?a(v,E[0]):!s.current.noIsolation;P&&v.cancelable&&v.preventDefault()}}},[]),c=w.useCallback(function(m,v,x,b){var E={name:m,delta:v,target:x,should:b};e.current.push(E),setTimeout(function(){e.current=e.current.filter(function(P){return P!==E})},1)},[]),d=w.useCallback(function(m){n.current=Pd(m),r.current=void 0},[]),u=w.useCallback(function(m){c(m.type,ME(m),m.target,a(m,t.lockRef.current))},[]),h=w.useCallback(function(m){c(m.type,Pd(m),m.target,a(m,t.lockRef.current))},[]);w.useEffect(function(){return la.push(i),t.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:h}),document.addEventListener("wheel",l,aa),document.addEventListener("touchmove",l,aa),document.addEventListener("touchstart",d,aa),function(){la=la.filter(function(m){return m!==i}),document.removeEventListener("wheel",l,aa),document.removeEventListener("touchmove",l,aa),document.removeEventListener("touchstart",d,aa)}},[]);var p=t.removeScrollBar,g=t.inert;return w.createElement(w.Fragment,null,g?w.createElement(i,{styles:$W(o)}):null,p?w.createElement(xW,{gapMode:"margin"}):null)}const AW=lW(U$,MW);var W$=w.forwardRef(function(t,e){return w.createElement(hf,mo({},t,{ref:e,sideCar:AW}))});W$.classNames=hf.classNames;const Gw=W$;var RW=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},ca=new WeakMap,_d=new WeakMap,Id={},um=0,Y$=function(t){return t&&(t.host||Y$(t.parentNode))},LW=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=Y$(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},DW=function(t,e,n,r){var o=LW(e,Array.isArray(t)?t:[t]);Id[n]||(Id[n]=new WeakMap);var i=Id[n],s=[],a=new Set,l=new Set(o),c=function(u){!u||a.has(u)||(a.add(u),c(u.parentNode))};o.forEach(c);var d=function(u){!u||l.has(u)||Array.prototype.forEach.call(u.children,function(h){if(a.has(h))d(h);else{var p=h.getAttribute(r),g=p!==null&&p!=="false",m=(ca.get(h)||0)+1,v=(i.get(h)||0)+1;ca.set(h,m),i.set(h,v),s.push(h),m===1&&g&&_d.set(h,!0),v===1&&h.setAttribute(n,"true"),g||h.setAttribute(r,"true")}})};return d(e),a.clear(),um++,function(){s.forEach(function(u){var h=ca.get(u)-1,p=i.get(u)-1;ca.set(u,h),i.set(u,p),h||(_d.has(u)||u.removeAttribute(r),_d.delete(u)),p||u.removeAttribute(n)}),um--,um||(ca=new WeakMap,ca=new WeakMap,_d=new WeakMap,Id={})}},qw=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),o=e||RW(t);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),DW(r,o,n,"aria-hidden")):function(){return null}};const X$="Dialog",[G$,ete]=to(X$),[OW,ri]=G$(X$),jW=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:o,onOpenChange:i,modal:s=!0}=t,a=w.useRef(null),l=w.useRef(null),[c=!1,d]=Xi({prop:r,defaultProp:o,onChange:i});return w.createElement(OW,{scope:e,triggerRef:a,contentRef:l,contentId:Wo(),titleId:Wo(),descriptionId:Wo(),open:c,onOpenChange:d,onOpenToggle:w.useCallback(()=>d(u=>!u),[d]),modal:s},n)},q$="DialogPortal",[NW,Q$]=G$(q$,{forceMount:void 0}),BW=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:o}=t,i=ri(q$,e);return w.createElement(NW,{scope:e,forceMount:n},w.Children.map(r,s=>w.createElement(no,{present:n||i.open},w.createElement(df,{asChild:!0,container:o},s))))},v0="DialogOverlay",zW=w.forwardRef((t,e)=>{const n=Q$(v0,t.__scopeDialog),{forceMount:r=n.forceMount,...o}=t,i=ri(v0,t.__scopeDialog);return i.modal?w.createElement(no,{present:r||i.open},w.createElement(UW,oe({},o,{ref:e}))):null}),UW=w.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=ri(v0,n);return w.createElement(Gw,{as:js,allowPinchZoom:!0,shards:[o.contentRef]},w.createElement(He.div,oe({"data-state":J$(o.open)},r,{ref:e,style:{pointerEvents:"auto",...r.style}})))}),Xc="DialogContent",FW=w.forwardRef((t,e)=>{const n=Q$(Xc,t.__scopeDialog),{forceMount:r=n.forceMount,...o}=t,i=ri(Xc,t.__scopeDialog);return w.createElement(no,{present:r||i.open},i.modal?w.createElement(KW,oe({},o,{ref:e})):w.createElement(HW,oe({},o,{ref:e})))}),KW=w.forwardRef((t,e)=>{const n=ri(Xc,t.__scopeDialog),r=w.useRef(null),o=qe(e,n.contentRef,r);return w.useEffect(()=>{const i=r.current;if(i)return qw(i)},[]),w.createElement(Z$,oe({},t,{ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:fe(t.onCloseAutoFocus,i=>{var s;i.preventDefault(),(s=n.triggerRef.current)===null||s===void 0||s.focus()}),onPointerDownOutside:fe(t.onPointerDownOutside,i=>{const s=i.detail.originalEvent,a=s.button===0&&s.ctrlKey===!0;(s.button===2||a)&&i.preventDefault()}),onFocusOutside:fe(t.onFocusOutside,i=>i.preventDefault())}))}),HW=w.forwardRef((t,e)=>{const n=ri(Xc,t.__scopeDialog),r=w.useRef(!1);return w.createElement(Z$,oe({},t,{ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i;if((i=t.onCloseAutoFocus)===null||i===void 0||i.call(t,o),!o.defaultPrevented){var s;r.current||(s=n.triggerRef.current)===null||s===void 0||s.focus(),o.preventDefault()}r.current=!1},onInteractOutside:o=>{var i,s;(i=t.onInteractOutside)===null||i===void 0||i.call(t,o),o.defaultPrevented||(r.current=!0);const a=o.target;((s=n.triggerRef.current)===null||s===void 0?void 0:s.contains(a))&&o.preventDefault()}}))}),Z$=w.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:i,...s}=t,a=ri(Xc,n),l=w.useRef(null),c=qe(e,l);return Xw(),w.createElement(w.Fragment,null,w.createElement(Yw,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:i},w.createElement(uf,oe({role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":J$(a.open)},s,{ref:c,onDismiss:()=>a.onOpenChange(!1)}))),!1)}),VW="DialogTitle",WW=w.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=ri(VW,n);return w.createElement(He.h2,oe({id:o.titleId},r,{ref:e}))}),YW="DialogClose",XW=w.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,o=ri(YW,n);return w.createElement(He.button,oe({type:"button"},r,{ref:e,onClick:fe(t.onClick,()=>o.onOpenChange(!1))}))});function J$(t){return t?"open":"closed"}const GW=jW,qW=BW,QW=zW,ZW=FW,eT=w.createContext(null);function JW({assetUrls:t,children:e}){return f.jsx(eT.Provider,{value:t,children:e})}function Qw(){const t=w.useContext(eT);if(!t)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return t}const w0={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","style-panel.title":"Styles","style-panel.align":"Align","style-panel.position":"Position","style-panel.arrowheads":"Arrowheads","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again"},Zw=[{locale:"ar",label:"عربي"},{locale:"ca",label:"Català"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Español"},{locale:"fa",label:"فارسی"},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Français"},{locale:"gl",label:"Galego"},{locale:"he",label:"עברית"},{locale:"it",label:"Italiano"},{locale:"ja",label:"日本語"},{locale:"ko-kr",label:"한국어"},{locale:"ku",label:"کوردی"},{locale:"hi-in",label:"हिन्दी"},{locale:"hu",label:"Magyar"},{locale:"my",label:"မြန်မာစာ"},{locale:"ne",label:"नेपाली"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Português - Brasil"},{locale:"pt-pt",label:"Português - Europeu"},{locale:"ro",label:"Română"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:"తెలుగు"},{locale:"th",label:"ภาษาไทย"},{locale:"tr",label:"Türkçe"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Tiếng Việt"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:"繁體中文 (台灣)"}],ua={locale:"en",label:"English",messages:w0};async function eY(t,e){if(!(await fetch(e.translations.en)).ok)return console.warn("No main translations found."),ua;if(t==="en")return ua;const r=Zw.find(a=>a.locale===t);if(!r)return console.warn(`No translation found for locale ${t}`),ua;const i=await(await fetch(e.translations[r.locale])).json();if(!i)return console.warn(`No messages found for locale ${t}`),ua;const s=[];for(const a in ua)i[a]||s.push(a);return s.length>0,{locale:t,label:r.label,messages:{...ua.messages,...i}}}async function tY(t,e){return await eY(t,e)}const tT=w.createContext({}),nY=()=>w.useContext(tT),rY=Me(function({overrides:e,children:n}){const o=Z().userSettings.locale,i=Qw(),[s,a]=w.useState(()=>e&&e.en?{locale:"en",label:"English",messages:{...w0,...e.en}}:{locale:"en",label:"English",messages:w0});return w.useEffect(()=>{let l=!1;async function c(){const d=await tY(o,i);d&&!l&&(e&&e[o]?a({...d,messages:{...d.messages,...e[o]}}):a(d))}return c(),()=>{l=!0}},[i,o,e]),f.jsx(tT.Provider,{value:s,children:n})});function Be(){const t=nY();return w.useCallback(function(n){return t.messages[n]??n},[t])}function oY(t){return f.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",...t,children:f.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[f.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),f.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:f.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const Yn=w.memo(function({small:e,invertIcon:n,icon:r,color:o,className:i,...s}){const l=Qw().icons[r],c=w.useRef(null);return w.useLayoutEffect(()=>{c!=null&&c.current&&(c.current.style.webkitMask=`url(${l}) center 100% / 100% no-repeat`)},[c,l]),f.jsx("div",{...s,ref:c,className:Se("tlui-icon",{"tlui-icon__small":e},i),style:{color:o,mask:`url(${l}) center 100% / 100% no-repeat`,transform:n?"scale(-1, 1)":void 0}})}),nT=typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,rT=nT?"⌘":"Ctrl",oT=nT?"⌥":"Alt";function iY(t){return t.split(",")[0].split("").map(e=>{const n=e.replace(/\$/g,rT).replace(/\?/g,oT).replace(/!/g,"⇧");return n[0].toUpperCase()+n.slice(1)})}function xo(t){return"— "+t.split(",")[0].split("").map(e=>{const n=e.replace(/\$/g,rT).replace(/\?/g,oT).replace(/!/g,"⇧");return n[0].toUpperCase()+n.slice(1)}).join(" ")}function pf({children:t}){return f.jsx("kbd",{className:"tlui-kbd",children:iY(t).map((e,n)=>f.jsx("span",{children:e},n))})}const me=w.forwardRef(function({label:e,icon:n,invertIcon:r,iconLeft:o,smallIcon:i,kbd:s,isChecked:a=!1,type:l="normal",children:c,spinner:d,...u},h){const p=Be(),g=e?p(e):"";return f.jsxs("button",{ref:h,draggable:!1,type:"button",...u,title:u.title??g,className:Se("tlui-button",`tlui-button__${l}`,u.className),children:[o&&f.jsx(Yn,{icon:o,className:"tlui-icon-left",small:!0}),c,e&&f.jsxs("span",{draggable:!1,children:[g,a&&f.jsx(Yn,{icon:"check"})]}),s&&f.jsx(pf,{children:s}),n&&!d&&f.jsx(Yn,{icon:n,small:!!e||i,invertIcon:r}),d&&f.jsx(oY,{})]})});function ff({className:t,children:e}){return f.jsx("div",{className:Se("tlui-dialog__header",t),children:e})}function gf({className:t,children:e}){return f.jsx(WW,{dir:"ltr",className:Se("tlui-dialog__header__title",t),children:e})}function mf(){return f.jsx("div",{className:"tlui-dialog__header__close",children:f.jsx(XW,{"data-wd":"dialog.close",dir:"ltr",asChild:!0,children:f.jsx(me,{"aria-label":"Close",onTouchEnd:t=>t.target.click(),children:f.jsx(Yn,{small:!0,icon:"cross-2"})})})})}function Gc({className:t,children:e,style:n}){return f.jsx("div",{className:Se("tlui-dialog__body",t),style:n,children:e})}function Jw({className:t,children:e}){return f.jsx("div",{className:Se("tlui-dialog__footer",t),children:e})}function yf(t){const e=t+"CollectionProvider",[n,r]=to(e),[o,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),s=p=>{const{scope:g,children:m}=p,v=xe.useRef(null),x=xe.useRef(new Map).current;return xe.createElement(o,{scope:g,itemMap:x,collectionRef:v},m)},a=t+"CollectionSlot",l=xe.forwardRef((p,g)=>{const{scope:m,children:v}=p,x=i(a,m),b=qe(g,x.collectionRef);return xe.createElement(js,{ref:b},v)}),c=t+"CollectionItemSlot",d="data-radix-collection-item",u=xe.forwardRef((p,g)=>{const{scope:m,children:v,...x}=p,b=xe.useRef(null),E=qe(g,b),P=i(c,m);return xe.useEffect(()=>(P.itemMap.set(b,{ref:b,...x}),()=>void P.itemMap.delete(b))),xe.createElement(js,{[d]:"",ref:E},v)});function h(p){const g=i(t+"CollectionConsumer",p);return xe.useCallback(()=>{const v=g.collectionRef.current;if(!v)return[];const x=Array.from(v.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((P,C)=>x.indexOf(P.ref.current)-x.indexOf(C.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:s,Slot:l,ItemSlot:u},h,r]}const sY=w.createContext(void 0);function ex(t){const e=w.useContext(sY);return t||e||"ltr"}function Hs(t){return t.split("-")[0]}function Pu(t){return t.split("-")[1]}function gl(t){return["top","bottom"].includes(Hs(t))?"x":"y"}function tx(t){return t==="y"?"height":"width"}function RE(t,e,n){let{reference:r,floating:o}=t;const i=r.x+r.width/2-o.width/2,s=r.y+r.height/2-o.height/2,a=gl(e),l=tx(a),c=r[l]/2-o[l]/2,d=a==="x";let u;switch(Hs(e)){case"top":u={x:i,y:r.y-o.height};break;case"bottom":u={x:i,y:r.y+r.height};break;case"right":u={x:r.x+r.width,y:s};break;case"left":u={x:r.x-o.width,y:s};break;default:u={x:r.x,y:r.y}}switch(Pu(e)){case"start":u[a]-=c*(n&&d?-1:1);break;case"end":u[a]+=c*(n&&d?-1:1)}return u}const aY=async(t,e,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:s}=n,a=await(s.isRTL==null?void 0:s.isRTL(e));let l=await s.getElementRects({reference:t,floating:e,strategy:o}),{x:c,y:d}=RE(l,r,a),u=r,h={},p=0;for(let g=0;g<i.length;g++){const{name:m,fn:v}=i[g],{x,y:b,data:E,reset:P}=await v({x:c,y:d,initialPlacement:r,placement:u,strategy:o,middlewareData:h,rects:l,platform:s,elements:{reference:t,floating:e}});c=x??c,d=b??d,h={...h,[m]:{...h[m],...E}},P&&p<=50&&(p++,typeof P=="object"&&(P.placement&&(u=P.placement),P.rects&&(l=P.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:o}):P.rects),{x:c,y:d}=RE(l,u,a)),g=-1)}return{x:c,y:d,placement:u,strategy:o,middlewareData:h}};function iT(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function dp(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function qc(t,e){var n;e===void 0&&(e={});const{x:r,y:o,platform:i,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:p=0}=e,g=iT(p),m=a[h?u==="floating"?"reference":"floating":u],v=dp(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(m)))==null||n?m:m.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),x=dp(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:u==="floating"?{...s.floating,x:r,y:o}:s.reference,offsetParent:await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),strategy:l}):s[u]);return{top:v.top-x.top+g.top,bottom:x.bottom-v.bottom+g.bottom,left:v.left-x.left+g.left,right:x.right-v.right+g.right}}const lY=Math.min,ps=Math.max;function x0(t,e,n){return ps(t,lY(e,n))}const LE=t=>({name:"arrow",options:t,async fn(e){const{element:n,padding:r=0}=t??{},{x:o,y:i,placement:s,rects:a,platform:l}=e;if(n==null)return{};const c=iT(r),d={x:o,y:i},u=gl(s),h=Pu(s),p=tx(u),g=await l.getDimensions(n),m=u==="y"?"top":"left",v=u==="y"?"bottom":"right",x=a.reference[p]+a.reference[u]-d[u]-a.floating[p],b=d[u]-a.reference[u],E=await(l.getOffsetParent==null?void 0:l.getOffsetParent(n));let P=E?u==="y"?E.clientHeight||0:E.clientWidth||0:0;P===0&&(P=a.floating[p]);const C=x/2-b/2,k=c[m],$=P-g[p]-c[v],A=P/2-g[p]/2+C,D=x0(k,A,$),j=(h==="start"?c[m]:c[v])>0&&A!==D&&a.reference[p]<=a.floating[p];return{[u]:d[u]-(j?A<k?k-A:$-A:0),data:{[u]:D,centerOffset:A-D}}}}),cY={left:"right",right:"left",bottom:"top",top:"bottom"};function hp(t){return t.replace(/left|right|bottom|top/g,e=>cY[e])}function uY(t,e,n){n===void 0&&(n=!1);const r=Pu(t),o=gl(t),i=tx(o);let s=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(s=hp(s)),{main:s,cross:hp(s)}}const dY={start:"end",end:"start"};function DE(t){return t.replace(/start|end/g,e=>dY[e])}const sT=["top","right","bottom","left"];sT.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]);const aT=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n;const{placement:r,middlewareData:o,rects:i,initialPlacement:s,platform:a,elements:l}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:u,fallbackStrategy:h="bestFit",flipAlignment:p=!0,...g}=t,m=Hs(r),v=u||(m===s||!p?[hp(s)]:function(A){const D=hp(A);return[DE(A),D,DE(D)]}(s)),x=[s,...v],b=await qc(e,g),E=[];let P=((n=o.flip)==null?void 0:n.overflows)||[];if(c&&E.push(b[m]),d){const{main:A,cross:D}=uY(r,i,await(a.isRTL==null?void 0:a.isRTL(l.floating)));E.push(b[A],b[D])}if(P=[...P,{placement:r,overflows:E}],!E.every(A=>A<=0)){var C,k;const A=((C=(k=o.flip)==null?void 0:k.index)!=null?C:0)+1,D=x[A];if(D)return{data:{index:A,overflows:P},reset:{placement:D}};let j="bottom";switch(h){case"bestFit":{var $;const Y=($=P.map(V=>[V,V.overflows.filter(q=>q>0).reduce((q,F)=>q+F,0)]).sort((V,q)=>V[1]-q[1])[0])==null?void 0:$[0].placement;Y&&(j=Y);break}case"initialPlacement":j=s}if(r!==j)return{reset:{placement:j}}}return{}}}};function OE(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function jE(t){return sT.some(e=>t[e]>=0)}const lT=function(t){let{strategy:e="referenceHidden",...n}=t===void 0?{}:t;return{name:"hide",async fn(r){const{rects:o}=r;switch(e){case"referenceHidden":{const i=OE(await qc(r,{...n,elementContext:"reference"}),o.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:jE(i)}}}case"escaped":{const i=OE(await qc(r,{...n,altBoundary:!0}),o.floating);return{data:{escapedOffsets:i,escaped:jE(i)}}}default:return{}}}}},cT=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:n,y:r}=e,o=await async function(i,s){const{placement:a,platform:l,elements:c}=i,d=await(l.isRTL==null?void 0:l.isRTL(c.floating)),u=Hs(a),h=Pu(a),p=gl(a)==="x",g=["left","top"].includes(u)?-1:1,m=d&&p?-1:1,v=typeof s=="function"?s(i):s;let{mainAxis:x,crossAxis:b,alignmentAxis:E}=typeof v=="number"?{mainAxis:v,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...v};return h&&typeof E=="number"&&(b=h==="end"?-1*E:E),p?{x:b*m,y:x*g}:{x:x*g,y:b*m}}(e,t);return{x:n+o.x,y:r+o.y,data:o}}}};function uT(t){return t==="x"?"y":"x"}const dT=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:o}=e,{mainAxis:i=!0,crossAxis:s=!1,limiter:a={fn:v=>{let{x,y:b}=v;return{x,y:b}}},...l}=t,c={x:n,y:r},d=await qc(e,l),u=gl(Hs(o)),h=uT(u);let p=c[u],g=c[h];if(i){const v=u==="y"?"bottom":"right";p=x0(p+d[u==="y"?"top":"left"],p,p-d[v])}if(s){const v=h==="y"?"bottom":"right";g=x0(g+d[h==="y"?"top":"left"],g,g-d[v])}const m=a.fn({...e,[u]:p,[h]:g});return{...m,data:{x:m.x-n,y:m.y-r}}}}},hT=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:o,rects:i,middlewareData:s}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=t,d={x:n,y:r},u=gl(o),h=uT(u);let p=d[u],g=d[h];const m=typeof a=="function"?a({...i,placement:o}):a,v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const C=u==="y"?"height":"width",k=i.reference[u]-i.floating[C]+v.mainAxis,$=i.reference[u]+i.reference[C]-v.mainAxis;p<k?p=k:p>$&&(p=$)}if(c){var x,b,E,P;const C=u==="y"?"width":"height",k=["top","left"].includes(Hs(o)),$=i.reference[h]-i.floating[C]+(k&&(x=(b=s.offset)==null?void 0:b[h])!=null?x:0)+(k?0:v.crossAxis),A=i.reference[h]+i.reference[C]+(k?0:(E=(P=s.offset)==null?void 0:P[h])!=null?E:0)-(k?v.crossAxis:0);g<$?g=$:g>A&&(g=A)}return{[u]:p,[h]:g}}}},pT=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:r,platform:o,elements:i}=e,{apply:s,...a}=t,l=await qc(e,a),c=Hs(n),d=Pu(n);let u,h;c==="top"||c==="bottom"?(u=c,h=d===(await(o.isRTL==null?void 0:o.isRTL(i.floating))?"start":"end")?"left":"right"):(h=c,u=d==="end"?"top":"bottom");const p=ps(l.left,0),g=ps(l.right,0),m=ps(l.top,0),v=ps(l.bottom,0),x={availableHeight:r.floating.height-(["left","right"].includes(n)?2*(m!==0||v!==0?m+v:ps(l.top,l.bottom)):l[u]),availableWidth:r.floating.width-(["top","bottom"].includes(n)?2*(p!==0||g!==0?p+g:ps(l.left,l.right)):l[h])},b=await o.getDimensions(i.floating);s==null||s({...e,...x});const E=await o.getDimensions(i.floating);return b.width!==E.width||b.height!==E.height?{reset:{rects:!0}}:{}}}};function fT(t){return t&&t.document&&t.location&&t.alert&&t.setInterval}function oi(t){if(t==null)return window;if(!fT(t)){const e=t.ownerDocument;return e&&e.defaultView||window}return t}function _u(t){return oi(t).getComputedStyle(t)}function Xo(t){return fT(t)?"":t?(t.nodeName||"").toLowerCase():""}function gT(){const t=navigator.userAgentData;return t!=null&&t.brands?t.brands.map(e=>e.brand+"/"+e.version).join(" "):navigator.userAgent}function bo(t){return t instanceof oi(t).HTMLElement}function Ni(t){return t instanceof oi(t).Element}function nx(t){return typeof ShadowRoot>"u"?!1:t instanceof oi(t).ShadowRoot||t instanceof ShadowRoot}function vf(t){const{overflow:e,overflowX:n,overflowY:r}=_u(t);return/auto|scroll|overlay|hidden/.test(e+r+n)}function hY(t){return["table","td","th"].includes(Xo(t))}function NE(t){const e=/firefox/i.test(gT()),n=_u(t);return n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].includes(n.willChange)||e&&n.willChange==="filter"||e&&!!n.filter&&n.filter!=="none"}function mT(){return!/^((?!chrome|android).)*safari/i.test(gT())}const BE=Math.min,mc=Math.max,pp=Math.round;function Go(t,e,n){var r,o,i,s;e===void 0&&(e=!1),n===void 0&&(n=!1);const a=t.getBoundingClientRect();let l=1,c=1;e&&bo(t)&&(l=t.offsetWidth>0&&pp(a.width)/t.offsetWidth||1,c=t.offsetHeight>0&&pp(a.height)/t.offsetHeight||1);const d=Ni(t)?oi(t):window,u=!mT()&&n,h=(a.left+(u&&(r=(o=d.visualViewport)==null?void 0:o.offsetLeft)!=null?r:0))/l,p=(a.top+(u&&(i=(s=d.visualViewport)==null?void 0:s.offsetTop)!=null?i:0))/c,g=a.width/l,m=a.height/c;return{width:g,height:m,top:p,right:h+g,bottom:p+m,left:h,x:h,y:p}}function Li(t){return(e=t,(e instanceof oi(e).Node?t.ownerDocument:t.document)||window.document).documentElement;var e}function wf(t){return Ni(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function yT(t){return Go(Li(t)).left+wf(t).scrollLeft}function pY(t,e,n){const r=bo(e),o=Li(e),i=Go(t,r&&function(l){const c=Go(l);return pp(c.width)!==l.offsetWidth||pp(c.height)!==l.offsetHeight}(e),n==="fixed");let s={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(r||!r&&n!=="fixed")if((Xo(e)!=="body"||vf(o))&&(s=wf(e)),bo(e)){const l=Go(e,!0);a.x=l.x+e.clientLeft,a.y=l.y+e.clientTop}else o&&(a.x=yT(o));return{x:i.left+s.scrollLeft-a.x,y:i.top+s.scrollTop-a.y,width:i.width,height:i.height}}function vT(t){return Xo(t)==="html"?t:t.assignedSlot||t.parentNode||(nx(t)?t.host:null)||Li(t)}function zE(t){return bo(t)&&getComputedStyle(t).position!=="fixed"?t.offsetParent:null}function b0(t){const e=oi(t);let n=zE(t);for(;n&&hY(n)&&getComputedStyle(n).position==="static";)n=zE(n);return n&&(Xo(n)==="html"||Xo(n)==="body"&&getComputedStyle(n).position==="static"&&!NE(n))?e:n||function(r){let o=vT(r);for(nx(o)&&(o=o.host);bo(o)&&!["html","body"].includes(Xo(o));){if(NE(o))return o;o=o.parentNode}return null}(t)||e}function UE(t){if(bo(t))return{width:t.offsetWidth,height:t.offsetHeight};const e=Go(t);return{width:e.width,height:e.height}}function wT(t){const e=vT(t);return["html","body","#document"].includes(Xo(e))?t.ownerDocument.body:bo(e)&&vf(e)?e:wT(e)}function fp(t,e){var n;e===void 0&&(e=[]);const r=wT(t),o=r===((n=t.ownerDocument)==null?void 0:n.body),i=oi(r),s=o?[i].concat(i.visualViewport||[],vf(r)?r:[]):r,a=e.concat(s);return o?a:a.concat(fp(s))}function FE(t,e,n){return e==="viewport"?dp(function(r,o){const i=oi(r),s=Li(r),a=i.visualViewport;let l=s.clientWidth,c=s.clientHeight,d=0,u=0;if(a){l=a.width,c=a.height;const h=mT();(h||!h&&o==="fixed")&&(d=a.offsetLeft,u=a.offsetTop)}return{width:l,height:c,x:d,y:u}}(t,n)):Ni(e)?function(r,o){const i=Go(r,!1,o==="fixed"),s=i.top+r.clientTop,a=i.left+r.clientLeft;return{top:s,left:a,x:a,y:s,right:a+r.clientWidth,bottom:s+r.clientHeight,width:r.clientWidth,height:r.clientHeight}}(e,n):dp(function(r){var o;const i=Li(r),s=wf(r),a=(o=r.ownerDocument)==null?void 0:o.body,l=mc(i.scrollWidth,i.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),c=mc(i.scrollHeight,i.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0);let d=-s.scrollLeft+yT(r);const u=-s.scrollTop;return _u(a||i).direction==="rtl"&&(d+=mc(i.clientWidth,a?a.clientWidth:0)-l),{width:l,height:c,x:d,y:u}}(Li(t)))}function fY(t){const e=fp(t),n=["absolute","fixed"].includes(_u(t).position)&&bo(t)?b0(t):t;return Ni(n)?e.filter(r=>Ni(r)&&function(o,i){const s=i.getRootNode==null?void 0:i.getRootNode();if(o.contains(i))return!0;if(s&&nx(s)){let a=i;do{if(a&&o===a)return!0;a=a.parentNode||a.host}while(a)}return!1}(r,n)&&Xo(r)!=="body"):[]}const gY={getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:r,strategy:o}=t;const i=[...n==="clippingAncestors"?fY(e):[].concat(n),r],s=i[0],a=i.reduce((l,c)=>{const d=FE(e,c,o);return l.top=mc(d.top,l.top),l.right=BE(d.right,l.right),l.bottom=BE(d.bottom,l.bottom),l.left=mc(d.left,l.left),l},FE(e,s,o));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:n,strategy:r}=t;const o=bo(n),i=Li(n);if(n===i)return e;let s={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if((o||!o&&r!=="fixed")&&((Xo(n)!=="body"||vf(i))&&(s=wf(n)),bo(n))){const l=Go(n,!0);a.x=l.x+n.clientLeft,a.y=l.y+n.clientTop}return{...e,x:e.x-s.scrollLeft+a.x,y:e.y-s.scrollTop+a.y}},isElement:Ni,getDimensions:UE,getOffsetParent:b0,getDocumentElement:Li,getElementRects:t=>{let{reference:e,floating:n,strategy:r}=t;return{reference:pY(e,b0(n),r),floating:{...UE(n),x:0,y:0}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>_u(t).direction==="rtl"};function xT(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:s=!0,animationFrame:a=!1}=r,l=o&&!a,c=i&&!a,d=l||c?[...Ni(t)?fp(t):[],...fp(e)]:[];d.forEach(g=>{l&&g.addEventListener("scroll",n,{passive:!0}),c&&g.addEventListener("resize",n)});let u,h=null;if(s){let g=!0;h=new ResizeObserver(()=>{g||n(),g=!1}),Ni(t)&&!a&&h.observe(t),h.observe(e)}let p=a?Go(t):null;return a&&function g(){const m=Go(t);!p||m.x===p.x&&m.y===p.y&&m.width===p.width&&m.height===p.height||n(),p=m,u=requestAnimationFrame(g)}(),n(),()=>{var g;d.forEach(m=>{l&&m.removeEventListener("scroll",n),c&&m.removeEventListener("resize",n)}),(g=h)==null||g.disconnect(),h=null,a&&cancelAnimationFrame(u)}}const mY=(t,e,n)=>aY(t,e,{platform:gY,...n});var S0=typeof document<"u"?w.useLayoutEffect:w.useEffect;function E0(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,o;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(!E0(t[r],e[r]))return!1;return!0}if(o=Object.keys(t),n=o.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,o[r]))return!1;for(r=n;r--!==0;){const i=o[r];if(!(i==="_owner"&&t.$$typeof)&&!E0(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function yY(t){const e=w.useRef(t);return S0(()=>{e.current=t}),e}function bT(t){let{middleware:e,placement:n="bottom",strategy:r="absolute",whileElementsMounted:o}=t===void 0?{}:t;const i=w.useRef(null),s=w.useRef(null),a=yY(o),l=w.useRef(null),[c,d]=w.useState({x:null,y:null,strategy:r,placement:n,middlewareData:{}}),[u,h]=w.useState(e);E0(u==null?void 0:u.map(E=>{let{options:P}=E;return P}),e==null?void 0:e.map(E=>{let{options:P}=E;return P}))||h(e);const p=w.useCallback(()=>{!i.current||!s.current||mY(i.current,s.current,{middleware:u,placement:n,strategy:r}).then(E=>{g.current&&fl.flushSync(()=>{d(E)})})},[u,n,r]);S0(()=>{g.current&&p()},[p]);const g=w.useRef(!1);S0(()=>(g.current=!0,()=>{g.current=!1}),[]);const m=w.useCallback(()=>{if(typeof l.current=="function"&&(l.current(),l.current=null),i.current&&s.current)if(a.current){const E=a.current(i.current,s.current,p);l.current=E}else p()},[p,a]),v=w.useCallback(E=>{i.current=E,m()},[m]),x=w.useCallback(E=>{s.current=E,m()},[m]),b=w.useMemo(()=>({reference:i,floating:s}),[]);return w.useMemo(()=>({...c,update:p,refs:b,reference:v,floating:x}),[c,p,b,v,x])}const ST=t=>{const{element:e,padding:n}=t;function r(o){return Object.prototype.hasOwnProperty.call(o,"current")}return{name:"arrow",options:t,fn(o){return r(e)?e.current!=null?LE({element:e.current,padding:n}).fn(o):{}:e?LE({element:e,padding:n}).fn(o):{}}}};function rx(t){const[e,n]=w.useState(void 0);return nr(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const i=o[0];let s,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,a=c.blockSize}else s=t.offsetWidth,a=t.offsetHeight;n({width:s,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}const ET="Popper",[ox,PT]=to(ET),[vY,_T]=ox(ET),wY=t=>{const{__scopePopper:e,children:n}=t,[r,o]=w.useState(null);return w.createElement(vY,{scope:e,anchor:r,onAnchorChange:o},n)},xY="PopperAnchor",bY=w.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...o}=t,i=_T(xY,n),s=w.useRef(null),a=qe(e,s);return w.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:w.createElement(He.div,oe({},o,{ref:a}))}),gp="PopperContent",[SY,tte]=ox(gp),[EY,PY]=ox(gp,{hasParent:!1,positionUpdateFns:new Set}),_Y=w.forwardRef((t,e)=>{var n,r,o,i,s,a,l,c;const{__scopePopper:d,side:u="bottom",sideOffset:h=0,align:p="center",alignOffset:g=0,arrowPadding:m=0,collisionBoundary:v=[],collisionPadding:x=0,sticky:b="partial",hideWhenDetached:E=!1,avoidCollisions:P=!0,onPlaced:C,...k}=t,$=_T(gp,d),[A,D]=w.useState(null),j=qe(e,We=>D(We)),[Y,V]=w.useState(null),q=rx(Y),F=(n=q==null?void 0:q.width)!==null&&n!==void 0?n:0,X=(r=q==null?void 0:q.height)!==null&&r!==void 0?r:0,ne=u+(p!=="center"?"-"+p:""),ie=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},W=Array.isArray(v)?v:[v],H=W.length>0,G={padding:ie,boundary:W.filter(CY),altBoundary:H},{reference:Q,floating:le,strategy:De,x:Ie,y:we,placement:Ze,middlewareData:je,update:ze}=bT({strategy:"fixed",placement:ne,whileElementsMounted:xT,middleware:[kY(),cT({mainAxis:h+X,alignmentAxis:g}),P?dT({mainAxis:!0,crossAxis:!1,limiter:b==="partial"?hT():void 0,...G}):void 0,Y?ST({element:Y,padding:m}):void 0,P?aT({...G}):void 0,pT({...G,apply:({elements:We,availableWidth:dr,availableHeight:Dr})=>{We.floating.style.setProperty("--radix-popper-available-width",`${dr}px`),We.floating.style.setProperty("--radix-popper-available-height",`${Dr}px`)}}),$Y({arrowWidth:F,arrowHeight:X}),E?lT({strategy:"referenceHidden"}):void 0].filter(IY)});nr(()=>{Q($.anchor)},[Q,$.anchor]);const Re=Ie!==null&&we!==null,[Ft,Zt]=IT(Ze),vt=ln(C);nr(()=>{Re&&(vt==null||vt())},[Re,vt]);const kt=(o=je.arrow)===null||o===void 0?void 0:o.x,Lt=(i=je.arrow)===null||i===void 0?void 0:i.y,xn=((s=je.arrow)===null||s===void 0?void 0:s.centerOffset)!==0,[Dt,Kt]=w.useState();nr(()=>{A&&Kt(window.getComputedStyle(A).zIndex)},[A]);const{hasParent:Lr,positionUpdateFns:ht}=PY(gp,d),Pt=!Lr;w.useLayoutEffect(()=>{if(!Pt)return ht.add(ze),()=>{ht.delete(ze)}},[Pt,ht,ze]),nr(()=>{Pt&&Re&&Array.from(ht).reverse().forEach(We=>requestAnimationFrame(We))},[Pt,Re,ht]);const Ht={"data-side":Ft,"data-align":Zt,...k,ref:j,style:{...k.style,animation:Re?void 0:"none",opacity:(a=je.hide)!==null&&a!==void 0&&a.referenceHidden?0:void 0}};return w.createElement("div",{ref:le,"data-radix-popper-content-wrapper":"",style:{position:De,left:0,top:0,transform:Re?`translate3d(${Math.round(Ie)}px, ${Math.round(we)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:Dt,["--radix-popper-transform-origin"]:[(l=je.transformOrigin)===null||l===void 0?void 0:l.x,(c=je.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},w.createElement(SY,{scope:d,placedSide:Ft,onArrowChange:V,arrowX:kt,arrowY:Lt,shouldHideArrow:xn},Pt?w.createElement(EY,{scope:d,hasParent:!0,positionUpdateFns:ht},w.createElement(He.div,Ht)):w.createElement(He.div,Ht)))});function IY(t){return t!==void 0}function CY(t){return t!==null}const kY=()=>({name:"anchorCssProperties",fn(t){const{rects:e,elements:n}=t,{width:r,height:o}=e.reference;return n.floating.style.setProperty("--radix-popper-anchor-width",`${r}px`),n.floating.style.setProperty("--radix-popper-anchor-height",`${o}px`),{}}}),$Y=t=>({name:"transformOrigin",options:t,fn(e){var n,r,o,i,s;const{placement:a,rects:l,middlewareData:c}=e,u=((n=c.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,h=u?0:t.arrowWidth,p=u?0:t.arrowHeight,[g,m]=IT(a),v={start:"0%",center:"50%",end:"100%"}[m],x=((r=(o=c.arrow)===null||o===void 0?void 0:o.x)!==null&&r!==void 0?r:0)+h/2,b=((i=(s=c.arrow)===null||s===void 0?void 0:s.y)!==null&&i!==void 0?i:0)+p/2;let E="",P="";return g==="bottom"?(E=u?v:`${x}px`,P=`${-p}px`):g==="top"?(E=u?v:`${x}px`,P=`${l.floating.height+p}px`):g==="right"?(E=`${-p}px`,P=u?v:`${b}px`):g==="left"&&(E=`${l.floating.width+p}px`,P=u?v:`${b}px`),{data:{x:E,y:P}}}});function IT(t){const[e,n="center"]=t.split("-");return[e,n]}const CT=wY,TY=bY,MY=_Y,dm="rovingFocusGroup.onEntryFocus",AY={bubbles:!1,cancelable:!0},ix="RovingFocusGroup",[P0,kT,RY]=yf(ix),[LY,$T]=to(ix,[RY]),[DY,OY]=LY(ix),jY=w.forwardRef((t,e)=>w.createElement(P0.Provider,{scope:t.__scopeRovingFocusGroup},w.createElement(P0.Slot,{scope:t.__scopeRovingFocusGroup},w.createElement(NY,oe({},t,{ref:e}))))),NY=w.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:o=!1,dir:i,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,...d}=t,u=w.useRef(null),h=qe(e,u),p=ex(i),[g=null,m]=Xi({prop:s,defaultProp:a,onChange:l}),[v,x]=w.useState(!1),b=ln(c),E=kT(n),P=w.useRef(!1),[C,k]=w.useState(0);return w.useEffect(()=>{const $=u.current;if($)return $.addEventListener(dm,b),()=>$.removeEventListener(dm,b)},[b]),w.createElement(DY,{scope:n,orientation:r,dir:p,loop:o,currentTabStopId:g,onItemFocus:w.useCallback($=>m($),[m]),onItemShiftTab:w.useCallback(()=>x(!0),[]),onFocusableItemAdd:w.useCallback(()=>k($=>$+1),[]),onFocusableItemRemove:w.useCallback(()=>k($=>$-1),[])},w.createElement(He.div,oe({tabIndex:v||C===0?-1:0,"data-orientation":r},d,{ref:h,style:{outline:"none",...t.style},onMouseDown:fe(t.onMouseDown,()=>{P.current=!0}),onFocus:fe(t.onFocus,$=>{const A=!P.current;if($.target===$.currentTarget&&A&&!v){const D=new CustomEvent(dm,AY);if($.currentTarget.dispatchEvent(D),!D.defaultPrevented){const j=E().filter(X=>X.focusable),Y=j.find(X=>X.active),V=j.find(X=>X.id===g),F=[Y,V,...j].filter(Boolean).map(X=>X.ref.current);TT(F)}}P.current=!1}),onBlur:fe(t.onBlur,()=>x(!1))})))}),BY="RovingFocusGroupItem",zY=w.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:o=!1,tabStopId:i,...s}=t,a=Wo(),l=i||a,c=OY(BY,n),d=c.currentTabStopId===l,u=kT(n),{onFocusableItemAdd:h,onFocusableItemRemove:p}=c;return w.useEffect(()=>{if(r)return h(),()=>p()},[r,h,p]),w.createElement(P0.ItemSlot,{scope:n,id:l,focusable:r,active:o},w.createElement(He.span,oe({tabIndex:d?0:-1,"data-orientation":c.orientation},s,{ref:e,onMouseDown:fe(t.onMouseDown,g=>{r?c.onItemFocus(l):g.preventDefault()}),onFocus:fe(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:fe(t.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){c.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const m=KY(g,c.orientation,c.dir);if(m!==void 0){g.preventDefault();let x=u().filter(b=>b.focusable).map(b=>b.ref.current);if(m==="last")x.reverse();else if(m==="prev"||m==="next"){m==="prev"&&x.reverse();const b=x.indexOf(g.currentTarget);x=c.loop?HY(x,b+1):x.slice(b+1)}setTimeout(()=>TT(x))}})})))}),UY={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function FY(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function KY(t,e,n){const r=FY(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return UY[r]}function TT(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function HY(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const VY=jY,WY=zY,_0=["Enter"," "],YY=["ArrowDown","PageUp","Home"],MT=["ArrowUp","PageDown","End"],XY=[...YY,...MT],GY={ltr:[..._0,"ArrowRight"],rtl:[..._0,"ArrowLeft"]},qY={ltr:["ArrowLeft"],rtl:["ArrowRight"]},xf="Menu",[Qc,QY,ZY]=yf(xf),[Vs,bf]=to(xf,[ZY,PT,$T]),Sf=PT(),AT=$T(),[RT,Zi]=Vs(xf),[JY,Iu]=Vs(xf),eX=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:o,onOpenChange:i,modal:s=!0}=t,a=Sf(e),[l,c]=w.useState(null),d=w.useRef(!1),u=ln(i),h=ex(o);return w.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),w.createElement(CT,a,w.createElement(RT,{scope:e,open:n,onOpenChange:u,content:l,onContentChange:c},w.createElement(JY,{scope:e,onClose:w.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:d,dir:h,modal:s},r)))},LT=w.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,o=Sf(n);return w.createElement(TY,oe({},o,r,{ref:e}))}),DT="MenuPortal",[tX,OT]=Vs(DT,{forceMount:void 0}),nX=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:o}=t,i=Zi(DT,e);return w.createElement(tX,{scope:e,forceMount:n},w.createElement(no,{present:n||i.open},w.createElement(df,{asChild:!0,container:o},r)))},qr="MenuContent",[rX,sx]=Vs(qr),oX=w.forwardRef((t,e)=>{const n=OT(qr,t.__scopeMenu),{forceMount:r=n.forceMount,...o}=t,i=Zi(qr,t.__scopeMenu),s=Iu(qr,t.__scopeMenu);return w.createElement(Qc.Provider,{scope:t.__scopeMenu},w.createElement(no,{present:r||i.open},w.createElement(Qc.Slot,{scope:t.__scopeMenu},s.modal?w.createElement(iX,oe({},o,{ref:e})):w.createElement(sX,oe({},o,{ref:e})))))}),iX=w.forwardRef((t,e)=>{const n=Zi(qr,t.__scopeMenu),r=w.useRef(null),o=qe(e,r);return w.useEffect(()=>{const i=r.current;if(i)return qw(i)},[]),w.createElement(ax,oe({},t,{ref:o,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:fe(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)}))}),sX=w.forwardRef((t,e)=>{const n=Zi(qr,t.__scopeMenu);return w.createElement(ax,oe({},t,{ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)}))}),ax=w.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:h,onDismiss:p,disableOutsideScroll:g,...m}=t,v=Zi(qr,n),x=Iu(qr,n),b=Sf(n),E=AT(n),P=QY(n),[C,k]=w.useState(null),$=w.useRef(null),A=qe(e,$,v.onContentChange),D=w.useRef(0),j=w.useRef(""),Y=w.useRef(0),V=w.useRef(null),q=w.useRef("right"),F=w.useRef(0),X=g?Gw:w.Fragment,ne=g?{as:js,allowPinchZoom:!0}:void 0,ie=H=>{var G,Q;const le=j.current+H,De=P().filter(Re=>!Re.disabled),Ie=document.activeElement,we=(G=De.find(Re=>Re.ref.current===Ie))===null||G===void 0?void 0:G.textValue,Ze=De.map(Re=>Re.textValue),je=xX(Ze,le,we),ze=(Q=De.find(Re=>Re.textValue===je))===null||Q===void 0?void 0:Q.ref.current;(function Re(Ft){j.current=Ft,window.clearTimeout(D.current),Ft!==""&&(D.current=window.setTimeout(()=>Re(""),1e3))})(le),ze&&setTimeout(()=>ze.focus())};w.useEffect(()=>()=>window.clearTimeout(D.current),[]),Xw();const W=w.useCallback(H=>{var G,Q;return q.current===((G=V.current)===null||G===void 0?void 0:G.side)&&SX(H,(Q=V.current)===null||Q===void 0?void 0:Q.area)},[]);return w.createElement(rX,{scope:n,searchRef:j,onItemEnter:w.useCallback(H=>{W(H)&&H.preventDefault()},[W]),onItemLeave:w.useCallback(H=>{var G;W(H)||((G=$.current)===null||G===void 0||G.focus(),k(null))},[W]),onTriggerLeave:w.useCallback(H=>{W(H)&&H.preventDefault()},[W]),pointerGraceTimerRef:Y,onPointerGraceIntentChange:w.useCallback(H=>{V.current=H},[])},w.createElement(X,ne,w.createElement(Yw,{asChild:!0,trapped:o,onMountAutoFocus:fe(i,H=>{var G;H.preventDefault(),(G=$.current)===null||G===void 0||G.focus()}),onUnmountAutoFocus:s},w.createElement(uf,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:h,onDismiss:p},w.createElement(VY,oe({asChild:!0},E,{dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:k,onEntryFocus:fe(l,H=>{x.isUsingKeyboardRef.current||H.preventDefault()})}),w.createElement(MY,oe({role:"menu","aria-orientation":"vertical","data-state":FT(v.open),"data-radix-menu-content":"",dir:x.dir},b,m,{ref:A,style:{outline:"none",...m.style},onKeyDown:fe(m.onKeyDown,H=>{const Q=H.target.closest("[data-radix-menu-content]")===H.currentTarget,le=H.ctrlKey||H.altKey||H.metaKey,De=H.key.length===1;Q&&(H.key==="Tab"&&H.preventDefault(),!le&&De&&ie(H.key));const Ie=$.current;if(H.target!==Ie||!XY.includes(H.key))return;H.preventDefault();const Ze=P().filter(je=>!je.disabled).map(je=>je.ref.current);MT.includes(H.key)&&Ze.reverse(),vX(Ze)}),onBlur:fe(t.onBlur,H=>{H.currentTarget.contains(H.target)||(window.clearTimeout(D.current),j.current="")}),onPointerMove:fe(t.onPointerMove,Zc(H=>{const G=H.target,Q=F.current!==H.clientX;if(H.currentTarget.contains(G)&&Q){const le=H.clientX>F.current?"right":"left";q.current=le,F.current=H.clientX}}))})))))))}),aX=w.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return w.createElement(He.div,oe({role:"group"},r,{ref:e}))}),I0="MenuItem",KE="menu.itemSelect",jT=w.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...o}=t,i=w.useRef(null),s=Iu(I0,t.__scopeMenu),a=sx(I0,t.__scopeMenu),l=qe(e,i),c=w.useRef(!1),d=()=>{const u=i.current;if(!n&&u){const h=new CustomEvent(KE,{bubbles:!0,cancelable:!0});u.addEventListener(KE,p=>r==null?void 0:r(p),{once:!0}),Ww(u,h),h.defaultPrevented?c.current=!1:s.onClose()}};return w.createElement(NT,oe({},o,{ref:l,disabled:n,onClick:fe(t.onClick,d),onPointerDown:u=>{var h;(h=t.onPointerDown)===null||h===void 0||h.call(t,u),c.current=!0},onPointerUp:fe(t.onPointerUp,u=>{var h;c.current||(h=u.currentTarget)===null||h===void 0||h.click()}),onKeyDown:fe(t.onKeyDown,u=>{const h=a.searchRef.current!=="";n||h&&u.key===" "||_0.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})}))}),NT=w.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:o,...i}=t,s=sx(I0,n),a=AT(n),l=w.useRef(null),c=qe(e,l),[d,u]=w.useState(!1),[h,p]=w.useState("");return w.useEffect(()=>{const g=l.current;if(g){var m;p(((m=g.textContent)!==null&&m!==void 0?m:"").trim())}},[i.children]),w.createElement(Qc.ItemSlot,{scope:n,disabled:r,textValue:o??h},w.createElement(WY,oe({asChild:!0},a,{focusable:!r}),w.createElement(He.div,oe({role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0},i,{ref:c,onPointerMove:fe(t.onPointerMove,Zc(g=>{r?s.onItemLeave(g):(s.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus())})),onPointerLeave:fe(t.onPointerLeave,Zc(g=>s.onItemLeave(g))),onFocus:fe(t.onFocus,()=>u(!0)),onBlur:fe(t.onBlur,()=>u(!1))}))))}),lX=w.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...o}=t;return w.createElement(uX,{scope:t.__scopeMenu,checked:n},w.createElement(jT,oe({role:"menuitemcheckbox","aria-checked":mp(n)?"mixed":n},o,{ref:e,"data-state":KT(n),onSelect:fe(o.onSelect,()=>r==null?void 0:r(mp(n)?!0:!n),{checkForDefaultPrevented:!1})})))}),cX="MenuRadioGroup";Vs(cX,{value:void 0,onValueChange:()=>{}});const BT="MenuItemIndicator",[uX,dX]=Vs(BT,{checked:!1}),hX=w.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...o}=t,i=dX(BT,n);return w.createElement(no,{present:r||mp(i.checked)||i.checked===!0},w.createElement(He.span,oe({},o,{ref:e,"data-state":KT(i.checked)})))}),zT="MenuSub",[pX,UT]=Vs(zT),fX=t=>{const{__scopeMenu:e,children:n,open:r=!1,onOpenChange:o}=t,i=Zi(zT,e),s=Sf(e),[a,l]=w.useState(null),[c,d]=w.useState(null),u=ln(o);return w.useEffect(()=>(i.open===!1&&u(!1),()=>u(!1)),[i.open,u]),w.createElement(CT,s,w.createElement(RT,{scope:e,open:r,onOpenChange:u,content:c,onContentChange:d},w.createElement(pX,{scope:e,contentId:Wo(),triggerId:Wo(),trigger:a,onTriggerChange:l},n)))},Cd="MenuSubTrigger",gX=w.forwardRef((t,e)=>{const n=Zi(Cd,t.__scopeMenu),r=Iu(Cd,t.__scopeMenu),o=UT(Cd,t.__scopeMenu),i=sx(Cd,t.__scopeMenu),s=w.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=i,c={__scopeMenu:t.__scopeMenu},d=w.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return w.useEffect(()=>d,[d]),w.useEffect(()=>{const u=a.current;return()=>{window.clearTimeout(u),l(null)}},[a,l]),w.createElement(LT,oe({asChild:!0},c),w.createElement(NT,oe({id:o.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":o.contentId,"data-state":FT(n.open)},t,{ref:Yp(e,o.onTriggerChange),onClick:u=>{var h;(h=t.onClick)===null||h===void 0||h.call(t,u),!(t.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:fe(t.onPointerMove,Zc(u=>{i.onItemEnter(u),!u.defaultPrevented&&!t.disabled&&!n.open&&!s.current&&(i.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:fe(t.onPointerLeave,Zc(u=>{var h;d();const p=(h=n.content)===null||h===void 0?void 0:h.getBoundingClientRect();if(p){var g;const m=(g=n.content)===null||g===void 0?void 0:g.dataset.side,v=m==="right",x=v?-5:5,b=p[v?"left":"right"],E=p[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:u.clientX+x,y:u.clientY},{x:b,y:p.top},{x:E,y:p.top},{x:E,y:p.bottom},{x:b,y:p.bottom}],side:m}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(u),u.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:fe(t.onKeyDown,u=>{const h=i.searchRef.current!=="";if(!(t.disabled||h&&u.key===" ")&&GY[r.dir].includes(u.key)){var p;n.onOpenChange(!0),(p=n.content)===null||p===void 0||p.focus(),u.preventDefault()}})})))}),mX="MenuSubContent",yX=w.forwardRef((t,e)=>{const n=OT(qr,t.__scopeMenu),{forceMount:r=n.forceMount,...o}=t,i=Zi(qr,t.__scopeMenu),s=Iu(qr,t.__scopeMenu),a=UT(mX,t.__scopeMenu),l=w.useRef(null),c=qe(e,l);return w.createElement(Qc.Provider,{scope:t.__scopeMenu},w.createElement(no,{present:r||i.open},w.createElement(Qc.Slot,{scope:t.__scopeMenu},w.createElement(ax,oe({id:a.contentId,"aria-labelledby":a.triggerId},o,{ref:c,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var u;s.isUsingKeyboardRef.current&&((u=l.current)===null||u===void 0||u.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:fe(t.onFocusOutside,d=>{d.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:fe(t.onEscapeKeyDown,d=>{s.onClose(),d.preventDefault()}),onKeyDown:fe(t.onKeyDown,d=>{const u=d.currentTarget.contains(d.target),h=qY[s.dir].includes(d.key);if(u&&h){var p;i.onOpenChange(!1),(p=a.trigger)===null||p===void 0||p.focus(),d.preventDefault()}})})))))});function FT(t){return t?"open":"closed"}function mp(t){return t==="indeterminate"}function KT(t){return mp(t)?"indeterminate":t?"checked":"unchecked"}function vX(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function wX(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function xX(t,e,n){const o=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let s=wX(t,Math.max(i,0));o.length===1&&(s=s.filter(c=>c!==n));const l=s.find(c=>c.toLowerCase().startsWith(o.toLowerCase()));return l!==n?l:void 0}function bX(t,e){const{x:n,y:r}=t;let o=!1;for(let i=0,s=e.length-1;i<e.length;s=i++){const a=e[i].x,l=e[i].y,c=e[s].x,d=e[s].y;l>r!=d>r&&n<(c-a)*(r-l)/(d-l)+a&&(o=!o)}return o}function SX(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return bX(n,e)}function Zc(t){return e=>e.pointerType==="mouse"?t(e):void 0}const HT=eX,VT=LT,WT=nX,YT=oX,XT=aX,GT=jT,qT=lX,EX=hX,QT=fX,ZT=gX,JT=yX,eM="DropdownMenu",[PX,nte]=to(eM,[bf]),ro=bf(),[_X,tM]=PX(eM),IX=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:o,defaultOpen:i,onOpenChange:s,modal:a=!0}=t,l=ro(e),c=w.useRef(null),[d=!1,u]=Xi({prop:o,defaultProp:i,onChange:s});return w.createElement(_X,{scope:e,triggerId:Wo(),triggerRef:c,contentId:Wo(),open:d,onOpenChange:u,onOpenToggle:w.useCallback(()=>u(h=>!h),[u]),modal:a},w.createElement(HT,oe({},l,{open:d,onOpenChange:u,dir:r,modal:a}),n))},CX="DropdownMenuTrigger",kX=w.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...o}=t,i=tM(CX,n),s=ro(n);return w.createElement(VT,oe({asChild:!0},s),w.createElement(He.button,oe({type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r},o,{ref:Yp(e,i.triggerRef),onPointerDown:fe(t.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:fe(t.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})))}),$X=t=>{const{__scopeDropdownMenu:e,...n}=t,r=ro(e);return w.createElement(WT,oe({},r,n))},TX="DropdownMenuContent",MX=w.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=tM(TX,n),i=ro(n),s=w.useRef(!1);return w.createElement(YT,oe({id:o.contentId,"aria-labelledby":o.triggerId},i,r,{ref:e,onCloseAutoFocus:fe(t.onCloseAutoFocus,a=>{var l;s.current||(l=o.triggerRef.current)===null||l===void 0||l.focus(),s.current=!1,a.preventDefault()}),onInteractOutside:fe(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;(!o.modal||d)&&(s.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),AX=w.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=ro(n);return w.createElement(XT,oe({},o,r,{ref:e}))}),RX=w.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=ro(n);return w.createElement(GT,oe({},o,r,{ref:e}))}),LX=w.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=ro(n);return w.createElement(qT,oe({},o,r,{ref:e}))}),DX=w.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=ro(n);return w.createElement(EX,oe({},o,r,{ref:e}))}),OX=t=>{const{__scopeDropdownMenu:e,children:n,open:r,onOpenChange:o,defaultOpen:i}=t,s=ro(e),[a=!1,l]=Xi({prop:r,defaultProp:i,onChange:o});return w.createElement(QT,oe({},s,{open:a,onOpenChange:l}),n)},jX=w.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=ro(n);return w.createElement(ZT,oe({},o,r,{ref:e}))}),NX=w.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,o=ro(n);return w.createElement(JT,oe({},o,r,{ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),nM=IX,Jc=kX,lx=$X,rM=MX,BX=AX,ha=RX,oM=LX,zX=DX,UX=OX,FX=jX,KX=NX,HX=()=>{},iM=w.createContext({});function VX({onEvent:t,children:e}){return f.jsx(iM.Provider,{value:t??HX,children:e})}function ml(){return w.useContext(iM)}function yl(t,e){const n=Z(),r=w.useRef(!1),o=ml(),i=w.useCallback(a=>{r.current=a,n.batch(()=>{a?(n.complete(),n.addOpenMenu(t)):(n.deleteOpenMenu(t),n.openMenus.forEach(l=>{l.startsWith(t)&&n.deleteOpenMenu(l)})),e==null||e(a)})},[n,t,e]);return w.useEffect(()=>(r.current&&(o("open-menu",{source:"unknown",id:t}),n.addOpenMenu(t)),()=>{r.current&&(n.deleteOpenMenu(t),n.openMenus.forEach(a=>{a.startsWith(t)&&(o("close-menu",{source:"unknown",id:t}),n.deleteOpenMenu(a))}),r.current=!1)}),[n,t,o]),[ge("is menu open",()=>n.openMenus.includes(t),[n,t]),i]}function Bi({id:t,children:e,modal:n=!1}){const[r,o]=yl(t);return f.jsx(nM,{open:r,dir:"ltr",modal:n,onOpenChange:o,children:e})}function Cu({children:t,"data-wd":e}){return f.jsx(Jc,{dir:"ltr","data-wd":e,asChild:!0,children:t})}function zi({side:t="bottom",align:e="start",sideOffset:n=8,alignOffset:r=8,children:o}){const i=Tn();return f.jsx(lx,{dir:"ltr",container:i,children:f.jsx(rM,{className:"tlui-menu",align:e,sideOffset:n,side:t,alignOffset:r,collisionPadding:4,children:o})})}function cx({id:t,children:e}){const[n,r]=yl(t);return f.jsx(UX,{open:n,onOpenChange:r,children:e})}function ux({label:t,"data-wd":e,"data-direction":n}){return f.jsx(FX,{dir:"ltr","data-direction":n,"data-wd":e,asChild:!0,children:f.jsx(me,{className:"tlui-menu__button tlui-menu__submenu__trigger",label:t,icon:"chevron-right"})})}function dx({alignOffset:t=0,sideOffset:e=5,children:n}){const r=Tn();return f.jsx(lx,{container:r,dir:"ltr",children:f.jsx(KX,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:t,sideOffset:e,collisionPadding:4,children:n})})}function Ui({children:t,size:e="medium"}){return f.jsx(BX,{dir:"ltr",className:"tlui-menu__group","data-size":e,children:t})}function gn({noClose:t,...e}){return f.jsx(ha,{dir:"ltr",asChild:!0,onClick:t||e.isChecked!==void 0?Ve:void 0,children:f.jsx(me,{className:"tlui-menu__button",...e})})}function WX({children:t,onSelect:e,...n}){return f.jsxs(oM,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:r=>{e==null||e(r),Ve(r)},...n,children:[f.jsx("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${n.checked?1:.5})`,opacity:n.checked?1:.5},children:f.jsx(Yn,{small:!0,icon:n.checked?"check":"checkbox-empty"})}),t]})}function YX({children:t,onSelect:e,...n}){return f.jsxs(oM,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:r=>{e==null||e(r),Ve(r)},...n,children:[f.jsx(zX,{dir:"ltr",className:"tlui-menu__checkbox-item__check",children:f.jsx(Yn,{icon:"check"})}),t]})}const sM=w.forwardRef((t,e)=>w.createElement(He.span,oe({},t,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}))),aM="ToastProvider",[hx,XX,GX]=yf("Toast"),[lM,rte]=to("Toast",[GX]),[qX,Ef]=lM(aM),cM=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:i=50,children:s}=t,[a,l]=w.useState(null),[c,d]=w.useState(0),u=w.useRef(!1),h=w.useRef(!1);return w.createElement(hx.Provider,{scope:e},w.createElement(qX,{scope:e,label:n,duration:r,swipeDirection:o,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:w.useCallback(()=>d(p=>p+1),[]),onToastRemove:w.useCallback(()=>d(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:u,isClosePausedRef:h},s))};cM.propTypes={label(t){if(t.label&&typeof t.label=="string"&&!t.label.trim()){const e=`Invalid prop \`label\` supplied to \`${aM}\`. Expected non-empty \`string\`.`;return new Error(e)}return null}};const QX="ToastViewport",ZX=["F8"],C0="toast.viewportPause",k0="toast.viewportResume",JX=w.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=ZX,label:o="Notifications ({hotkey})",...i}=t,s=Ef(QX,n),a=XX(n),l=w.useRef(null),c=w.useRef(null),d=w.useRef(null),u=w.useRef(null),h=qe(e,u,s.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=s.toastCount>0;w.useEffect(()=>{const v=x=>{var b;r.every(P=>x[P]||x.code===P)&&((b=u.current)===null||b===void 0||b.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[r]),w.useEffect(()=>{const v=l.current,x=u.current;if(g&&v&&x){const b=()=>{if(!s.isClosePausedRef.current){const k=new CustomEvent(C0);x.dispatchEvent(k),s.isClosePausedRef.current=!0}},E=()=>{if(s.isClosePausedRef.current){const k=new CustomEvent(k0);x.dispatchEvent(k),s.isClosePausedRef.current=!1}},P=k=>{!v.contains(k.relatedTarget)&&E()},C=()=>{v.contains(document.activeElement)||E()};return v.addEventListener("focusin",b),v.addEventListener("focusout",P),v.addEventListener("pointermove",b),v.addEventListener("pointerleave",C),window.addEventListener("blur",b),window.addEventListener("focus",E),()=>{v.removeEventListener("focusin",b),v.removeEventListener("focusout",P),v.removeEventListener("pointermove",b),v.removeEventListener("pointerleave",C),window.removeEventListener("blur",b),window.removeEventListener("focus",E)}}},[g,s.isClosePausedRef]);const m=w.useCallback(({tabbingDirection:v})=>{const b=a().map(E=>{const P=E.ref.current,C=[P,...gG(P)];return v==="forwards"?C:C.reverse()});return(v==="forwards"?b.reverse():b).flat()},[a]);return w.useEffect(()=>{const v=u.current;if(v){const x=b=>{const E=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!E){const A=document.activeElement,D=b.shiftKey;if(b.target===v&&D){var C;(C=c.current)===null||C===void 0||C.focus();return}const V=m({tabbingDirection:D?"backwards":"forwards"}),q=V.findIndex(F=>F===A);if(hm(V.slice(q+1)))b.preventDefault();else{var k,$;D?(k=c.current)===null||k===void 0||k.focus():($=d.current)===null||$===void 0||$.focus()}}};return v.addEventListener("keydown",x),()=>v.removeEventListener("keydown",x)}},[a,m]),w.createElement(HV,{ref:l,role:"region","aria-label":o.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:g?void 0:"none"}},g&&w.createElement(HE,{ref:c,onFocusFromOutsideViewport:()=>{const v=m({tabbingDirection:"forwards"});hm(v)}}),w.createElement(hx.Slot,{scope:n},w.createElement(He.ol,oe({tabIndex:-1},i,{ref:h}))),g&&w.createElement(HE,{ref:d,onFocusFromOutsideViewport:()=>{const v=m({tabbingDirection:"backwards"});hm(v)}}))}),eG="ToastFocusProxy",HE=w.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...o}=t,i=Ef(eG,n);return w.createElement(sM,oe({"aria-hidden":!0,tabIndex:0},o,{ref:e,style:{position:"fixed"},onFocus:s=>{var a;const l=s.relatedTarget;!((a=i.viewport)!==null&&a!==void 0&&a.contains(l))&&r()}}))}),Pf="Toast",tG="toast.swipeStart",nG="toast.swipeMove",rG="toast.swipeCancel",oG="toast.swipeEnd",iG=w.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:o,onOpenChange:i,...s}=t,[a=!0,l]=Xi({prop:r,defaultProp:o,onChange:i});return w.createElement(no,{present:n||a},w.createElement(uM,oe({open:a},s,{ref:e,onClose:()=>l(!1),onPause:ln(t.onPause),onResume:ln(t.onResume),onSwipeStart:fe(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:fe(t.onSwipeMove,c=>{const{x:d,y:u}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${u}px`)}),onSwipeCancel:fe(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:fe(t.onSwipeEnd,c=>{const{x:d,y:u}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${u}px`),l(!1)})})))}),[sG,aG]=lM(Pf,{onClose(){}}),uM=w.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:o,open:i,onClose:s,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:d,onSwipeMove:u,onSwipeCancel:h,onSwipeEnd:p,...g}=t,m=Ef(Pf,n),[v,x]=w.useState(null),b=qe(e,F=>x(F)),E=w.useRef(null),P=w.useRef(null),C=o||m.duration,k=w.useRef(0),$=w.useRef(C),A=w.useRef(0),{onToastAdd:D,onToastRemove:j}=m,Y=ln(()=>{var F;(v==null?void 0:v.contains(document.activeElement))&&((F=m.viewport)===null||F===void 0||F.focus()),s()}),V=w.useCallback(F=>{!F||F===1/0||(window.clearTimeout(A.current),k.current=new Date().getTime(),A.current=window.setTimeout(Y,F))},[Y]);w.useEffect(()=>{const F=m.viewport;if(F){const X=()=>{V($.current),c==null||c()},ne=()=>{const ie=new Date().getTime()-k.current;$.current=$.current-ie,window.clearTimeout(A.current),l==null||l()};return F.addEventListener(C0,ne),F.addEventListener(k0,X),()=>{F.removeEventListener(C0,ne),F.removeEventListener(k0,X)}}},[m.viewport,C,l,c,V]),w.useEffect(()=>{i&&!m.isClosePausedRef.current&&V(C)},[i,C,m.isClosePausedRef,V]),w.useEffect(()=>(D(),()=>j()),[D,j]);const q=w.useMemo(()=>v?fM(v):null,[v]);return m.viewport?w.createElement(w.Fragment,null,q&&w.createElement(lG,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0},q),w.createElement(sG,{scope:n,onClose:Y},fl.createPortal(w.createElement(hx.ItemSlot,{scope:n},w.createElement(KV,{asChild:!0,onEscapeKeyDown:fe(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||Y(),m.isFocusedToastEscapeKeyDownRef.current=!1})},w.createElement(He.li,oe({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":m.swipeDirection},g,{ref:b,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:fe(t.onKeyDown,F=>{F.key==="Escape"&&(a==null||a(F.nativeEvent),F.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,Y()))}),onPointerDown:fe(t.onPointerDown,F=>{F.button===0&&(E.current={x:F.clientX,y:F.clientY})}),onPointerMove:fe(t.onPointerMove,F=>{if(!E.current)return;const X=F.clientX-E.current.x,ne=F.clientY-E.current.y,ie=!!P.current,W=["left","right"].includes(m.swipeDirection),H=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,G=W?H(0,X):0,Q=W?0:H(0,ne),le=F.pointerType==="touch"?10:2,De={x:G,y:Q},Ie={originalEvent:F,delta:De};ie?(P.current=De,kd(nG,u,Ie,{discrete:!1})):VE(De,m.swipeDirection,le)?(P.current=De,kd(tG,d,Ie,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(X)>le||Math.abs(ne)>le)&&(E.current=null)}),onPointerUp:fe(t.onPointerUp,F=>{const X=P.current,ne=F.target;if(ne.hasPointerCapture(F.pointerId)&&ne.releasePointerCapture(F.pointerId),P.current=null,E.current=null,X){const ie=F.currentTarget,W={originalEvent:F,delta:X};VE(X,m.swipeDirection,m.swipeThreshold)?kd(oG,p,W,{discrete:!0}):kd(rG,h,W,{discrete:!0}),ie.addEventListener("click",H=>H.preventDefault(),{once:!0})}})})))),m.viewport))):null});uM.propTypes={type(t){if(t.type&&!["foreground","background"].includes(t.type)){const e=`Invalid prop \`type\` supplied to \`${Pf}\`. Expected \`foreground | background\`.`;return new Error(e)}return null}};const lG=t=>{const{__scopeToast:e,children:n,...r}=t,o=Ef(Pf,e),[i,s]=w.useState(!1),[a,l]=w.useState(!1);return pG(()=>s(!0)),w.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:w.createElement(df,{asChild:!0},w.createElement(sM,r,i&&w.createElement(w.Fragment,null,o.label," ",n)))},cG=w.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return w.createElement(He.div,oe({},r,{ref:e}))}),uG=w.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return w.createElement(He.div,oe({},r,{ref:e}))}),dG="ToastAction",dM=w.forwardRef((t,e)=>{const{altText:n,...r}=t;return n?w.createElement(pM,{altText:n,asChild:!0},w.createElement(hM,oe({},r,{ref:e}))):null});dM.propTypes={altText(t){return t.altText?null:new Error(`Missing prop \`altText\` expected on \`${dG}\``)}};const hG="ToastClose",hM=w.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,o=aG(hG,n);return w.createElement(pM,{asChild:!0},w.createElement(He.button,oe({type:"button"},r,{ref:e,onClick:fe(t.onClick,o.onClose)})))}),pM=w.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...o}=t;return w.createElement(He.div,oe({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0},o,{ref:e}))});function fM(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),fG(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!o)if(i){const s=r.dataset.radixToastAnnounceAlt;s&&e.push(s)}else e.push(...fM(r))}}),e}function kd(t,e,n,{discrete:r}){const o=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&o.addEventListener(t,e,{once:!0}),r?Ww(o,i):o.dispatchEvent(i)}const VE=(t,e,n=0)=>{const r=Math.abs(t.x),o=Math.abs(t.y),i=r>o;return e==="left"||e==="right"?i&&r>n:!i&&o>n};function pG(t=()=>{}){const e=ln(t);nr(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function fG(t){return t.nodeType===t.ELEMENT_NODE}function gG(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function hm(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}const mG=iG,yG=cG,vG=uG,wG=dM,WE=hM,xG=["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlighter","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","visible","warning-triangle","zoom-in","zoom-out"];let gM={...qv,icons:Object.fromEntries(xG.map(t=>[t,`/icons/icon/${t}.svg`])),translations:Object.fromEntries(Zw.map(t=>[t.locale,`/translations/${t.locale}.json`])),embedIcons:Object.fromEntries(Va.map(t=>[t.type,`/embed-icons/${t.type}.png`]))};function bG(t){gM=t}const px=w.forwardRef(function({className:e,label:n,icon:r,iconLeft:o,autoselect:i=!1,autofocus:s=!1,defaultValue:a,placeholder:l,onComplete:c,onValueChange:d,onCancel:u,shouldManuallyMaintainScrollPositionWhenFocused:h=!1,children:p,value:g},m){const v=w.useRef(null);w.useImperativeHandle(m,()=>v.current);const x=Be(),b=w.useRef(a??""),E=w.useRef(a??""),[P,C]=w.useState(!1),k=w.useCallback(j=>{C(!0);const Y=j.currentTarget;E.current=Y.value,requestAnimationFrame(()=>{i&&Y.select()})},[i]),$=w.useCallback(j=>{const Y=j.currentTarget.value;E.current=Y,d==null||d(Y)},[d]),A=w.useCallback(j=>{switch(j.key){case"Enter":{j.currentTarget.blur(),j.stopPropagation(),c==null||c(j.currentTarget.value);break}case"Escape":{j.currentTarget.value=b.current,j.currentTarget.blur(),j.stopPropagation(),u==null||u(j.currentTarget.value);break}}},[c,u]),D=w.useCallback(()=>C(!1),[]);return w.useEffect(()=>{const j=window.visualViewport;if(P&&h&&j){const Y=()=>{var V;(V=v.current)==null||V.scrollIntoView({block:"center"})};return j.addEventListener("resize",Y),j.addEventListener("scroll",Y),requestAnimationFrame(()=>{var V;(V=v.current)==null||V.scrollIntoView({block:"center"})}),()=>{j.removeEventListener("resize",Y),j.removeEventListener("scroll",Y)}}},[P,h]),f.jsxs("div",{draggable:!1,className:"tlui-input__wrapper",children:[p,n&&f.jsx("label",{children:x(n)}),o&&f.jsx(Yn,{icon:o,className:"tlui-icon-left",small:!0}),f.jsx("input",{ref:v,className:Se("tlui-input",e),type:"text",defaultValue:a,onKeyUp:A,onChange:$,onFocus:k,onBlur:D,autoFocus:s,placeholder:l,value:g}),r&&f.jsx(Yn,{icon:r,small:!!n})]})}),YE=new RegExp(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);function pm(t){return YE.test(t)?!0:YE.test("https://"+t)?"needs protocol":!1}const SG=Me(function({onClose:e}){const n=Z(),r=Be(),o=n.onlySelectedShape,[i,s]=w.useState(pm(o==null?void 0:o.props.url)),a=w.useRef(o==null?void 0:o.props.url),l=w.useRef(o==null?void 0:o.props.url),[c,d]=w.useState(i?i==="needs protocol"?"https://"+(o==null?void 0:o.props.url):o==null?void 0:o.props.url:"https://"),u=w.useCallback(v=>{const x=v.replace(/https?:\/\/(https?:\/\/)/,(E,P)=>P);d(x);const b=pm(x.trim());s(E=>E===b?E:b),b&&(l.current=x)},[]),h=w.useCallback(()=>{n.setProp("url","",!1),e()},[n,e]),p=w.useCallback(v=>{v=v.trim();const x=pm(v),b=n.selectedShapes[0];if(b){const E=b.props.url,P=x?x==="needs protocol"?"https://"+v:v:b.type==="bookmark"?a.current:"";E!==void 0&&E!==P&&n.setProp("url",P,!1)}e()},[n,e]),g=w.useCallback(()=>{e()},[e]);if(!o)return e(),null;const m=a.current&&!i;return f.jsxs(f.Fragment,{children:[f.jsxs(ff,{children:[f.jsx(gf,{children:r("edit-link-dialog.title")}),f.jsx(mf,{})]}),f.jsx(Gc,{children:f.jsxs("div",{className:"tlui-edit-link-dialog",children:[f.jsx(px,{className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:c,onValueChange:u,onComplete:p,onCancel:g}),f.jsx("div",{children:r(i?"edit-link-dialog.detail":"edit-link-dialog.invalid-url")})]})}),f.jsxs(Jw,{className:"tlui-dialog__footer__actions",children:[f.jsx(me,{onClick:g,onTouchEnd:g,children:r("edit-link-dialog.cancel")}),m?f.jsx(me,{type:"danger",onTouchEnd:h,onClick:h,children:r("edit-link-dialog.clear")}):f.jsx(me,{type:"primary",disabled:!i,onTouchEnd:()=>p(l.current),onClick:()=>p(l.current),children:r("edit-link-dialog.save")})]})]})}),mM=Me(function({onClose:e}){const n=Z(),r=Be(),o=Qw(),[i,s]=w.useState(null),[a,l]=w.useState(""),[c,d]=w.useState(null),[u,h]=w.useState(!1),p=w.useRef(-1);return f.jsxs(f.Fragment,{children:[f.jsxs(ff,{children:[f.jsx(gf,{children:i?`${r("embed-dialog.title")} — ${i.title}`:r("embed-dialog.title")}),f.jsx(mf,{})]}),i?f.jsxs(f.Fragment,{children:[f.jsxs(Gc,{className:"tlui-embed-dialog__enter",children:[f.jsx(px,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:g=>{l(g);const m=xi(g);d(m&&m.definition.type===i.type?m:null),h(!1),clearTimeout(p.current),p.current=setTimeout(()=>h(!m),320)}}),a===""?f.jsxs("div",{className:"tlui-embed-dialog__instruction",children:[f.jsx("span",{children:r("embed-dialog.instruction")})," ",i.instructionLink&&f.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:i.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",f.jsx(Yn,{icon:"external-link",small:!0})]})]}):f.jsx("div",{className:"tlui-embed-dialog__warning",children:u?r("embed-dialog.invalid-url"):" "})]}),f.jsxs(Jw,{className:"tlui-dialog__footer__actions",children:[f.jsx(me,{onClick:()=>{s(null),d(null),l("")},label:"embed-dialog.back"}),f.jsx("div",{className:"tlui-embed__spacer"}),f.jsx(me,{label:"embed-dialog.cancel",onClick:e}),f.jsx(me,{type:"primary",disabled:!c,label:"embed-dialog.create",onClick:()=>{c&&(s2(n,a,n.viewportPageCenter,{width:c.definition.width,height:c.definition.height,doesResize:c.definition.doesResize}),e())}})]})]}):f.jsxs(f.Fragment,{children:[f.jsx(Gc,{className:"tlui-embed-dialog__list",children:Va.map(g=>f.jsxs("button",{className:"tlui-embed-dialog__item",onClick:()=>s(g),children:[f.jsx("div",{className:"tlui-embed-dialog__item__image",children:f.jsx("div",{className:"tlui-embed-dialog__item__image__img",style:{backgroundImage:`url(${o.embedIcons[g.type]})`}})}),f.jsx("div",{className:"tlui-embed-dialog__item__title",children:g.title})]},g.type))}),f.jsx("div",{className:"tlui-dialog__scrim"})]})]})});var fx={exports:{}};fx.exports;(function(t){var e=function(){var n=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function s(l,c){if(!i[l]){i[l]={};for(var d=0;d<l.length;d++)i[l][l.charAt(d)]=d}return i[l][c]}var a={compressToBase64:function(l){if(l==null)return"";var c=a._compress(l,6,function(d){return r.charAt(d)});switch(c.length%4){default:case 0:return c;case 1:return c+"===";case 2:return c+"==";case 3:return c+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:a._decompress(l.length,32,function(c){return s(r,l.charAt(c))})},compressToUTF16:function(l){return l==null?"":a._compress(l,15,function(c){return n(c+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:a._decompress(l.length,16384,function(c){return l.charCodeAt(c)-32})},compressToUint8Array:function(l){for(var c=a.compress(l),d=new Uint8Array(c.length*2),u=0,h=c.length;u<h;u++){var p=c.charCodeAt(u);d[u*2]=p>>>8,d[u*2+1]=p%256}return d},decompressFromUint8Array:function(l){if(l==null)return a.decompress(l);for(var c=new Array(l.length/2),d=0,u=c.length;d<u;d++)c[d]=l[d*2]*256+l[d*2+1];var h=[];return c.forEach(function(p){h.push(n(p))}),a.decompress(h.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":a._compress(l,6,function(c){return o.charAt(c)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),a._decompress(l.length,32,function(c){return s(o,l.charAt(c))}))},compress:function(l){return a._compress(l,16,function(c){return n(c)})},_compress:function(l,c,d){if(l==null)return"";var u,h,p={},g={},m="",v="",x="",b=2,E=3,P=2,C=[],k=0,$=0,A;for(A=0;A<l.length;A+=1)if(m=l.charAt(A),Object.prototype.hasOwnProperty.call(p,m)||(p[m]=E++,g[m]=!0),v=x+m,Object.prototype.hasOwnProperty.call(p,v))x=v;else{if(Object.prototype.hasOwnProperty.call(g,x)){if(x.charCodeAt(0)<256){for(u=0;u<P;u++)k=k<<1,$==c-1?($=0,C.push(d(k)),k=0):$++;for(h=x.charCodeAt(0),u=0;u<8;u++)k=k<<1|h&1,$==c-1?($=0,C.push(d(k)),k=0):$++,h=h>>1}else{for(h=1,u=0;u<P;u++)k=k<<1|h,$==c-1?($=0,C.push(d(k)),k=0):$++,h=0;for(h=x.charCodeAt(0),u=0;u<16;u++)k=k<<1|h&1,$==c-1?($=0,C.push(d(k)),k=0):$++,h=h>>1}b--,b==0&&(b=Math.pow(2,P),P++),delete g[x]}else for(h=p[x],u=0;u<P;u++)k=k<<1|h&1,$==c-1?($=0,C.push(d(k)),k=0):$++,h=h>>1;b--,b==0&&(b=Math.pow(2,P),P++),p[v]=E++,x=String(m)}if(x!==""){if(Object.prototype.hasOwnProperty.call(g,x)){if(x.charCodeAt(0)<256){for(u=0;u<P;u++)k=k<<1,$==c-1?($=0,C.push(d(k)),k=0):$++;for(h=x.charCodeAt(0),u=0;u<8;u++)k=k<<1|h&1,$==c-1?($=0,C.push(d(k)),k=0):$++,h=h>>1}else{for(h=1,u=0;u<P;u++)k=k<<1|h,$==c-1?($=0,C.push(d(k)),k=0):$++,h=0;for(h=x.charCodeAt(0),u=0;u<16;u++)k=k<<1|h&1,$==c-1?($=0,C.push(d(k)),k=0):$++,h=h>>1}b--,b==0&&(b=Math.pow(2,P),P++),delete g[x]}else for(h=p[x],u=0;u<P;u++)k=k<<1|h&1,$==c-1?($=0,C.push(d(k)),k=0):$++,h=h>>1;b--,b==0&&(b=Math.pow(2,P),P++)}for(h=2,u=0;u<P;u++)k=k<<1|h&1,$==c-1?($=0,C.push(d(k)),k=0):$++,h=h>>1;for(;;)if(k=k<<1,$==c-1){C.push(d(k));break}else $++;return C.join("")},decompress:function(l){return l==null?"":l==""?null:a._decompress(l.length,32768,function(c){return l.charCodeAt(c)})},_decompress:function(l,c,d){var u=[],h=4,p=4,g=3,m="",v=[],x,b,E,P,C,k,$,A={val:d(0),position:c,index:1};for(x=0;x<3;x+=1)u[x]=x;for(E=0,C=Math.pow(2,2),k=1;k!=C;)P=A.val&A.position,A.position>>=1,A.position==0&&(A.position=c,A.val=d(A.index++)),E|=(P>0?1:0)*k,k<<=1;switch(E){case 0:for(E=0,C=Math.pow(2,8),k=1;k!=C;)P=A.val&A.position,A.position>>=1,A.position==0&&(A.position=c,A.val=d(A.index++)),E|=(P>0?1:0)*k,k<<=1;$=n(E);break;case 1:for(E=0,C=Math.pow(2,16),k=1;k!=C;)P=A.val&A.position,A.position>>=1,A.position==0&&(A.position=c,A.val=d(A.index++)),E|=(P>0?1:0)*k,k<<=1;$=n(E);break;case 2:return""}for(u[3]=$,b=$,v.push($);;){if(A.index>l)return"";for(E=0,C=Math.pow(2,g),k=1;k!=C;)P=A.val&A.position,A.position>>=1,A.position==0&&(A.position=c,A.val=d(A.index++)),E|=(P>0?1:0)*k,k<<=1;switch($=E){case 0:for(E=0,C=Math.pow(2,8),k=1;k!=C;)P=A.val&A.position,A.position>>=1,A.position==0&&(A.position=c,A.val=d(A.index++)),E|=(P>0?1:0)*k,k<<=1;u[p++]=n(E),$=p-1,h--;break;case 1:for(E=0,C=Math.pow(2,16),k=1;k!=C;)P=A.val&A.position,A.position>>=1,A.position==0&&(A.position=c,A.val=d(A.index++)),E|=(P>0?1:0)*k,k<<=1;u[p++]=n(E),$=p-1,h--;break;case 2:return v.join("")}if(h==0&&(h=Math.pow(2,g),g++),u[$])m=u[$];else if($===p)m=b+b.charAt(0);else return null;v.push(m),u[p++]=b+m.charAt(0),h--,b=m,h==0&&(h=Math.pow(2,g),g++)}}};return a}();t!=null?t.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(fx);var yM=fx.exports;async function EG(t,e,n){var x,b,E;const{elements:r,files:o}=e,i={shapes:[],rootShapeIds:[],assets:[],schema:t.store.schema.serialize()},s=new Map,a=new Map,{currentPageId:l}=t,c=new Map,d=[],u=new Set;r.forEach(P=>{if(c.set(P.id,t.createShapeId()),P.boundElements!==null)for(const C of P.boundElements)C.type==="text"&&u.add(C.id)});let h="a1";for(const P of r){if(u.has(P.id))continue;const C=c.get(P.id),k={id:C,typeName:"shape",parentId:l,index:h,x:P.x,y:P.y,rotation:0,isLocked:P.locked};switch(P.angle!==0&&a.set(C,P.angle),P.groupIds&&P.groupIds.length>0?s.has(P.groupIds[0])?(x=s.get(P.groupIds[0]))==null||x.push(C):s.set(P.groupIds[0],[C]):d.push(C),P.type){case"rectangle":case"ellipse":case"diamond":{let $="",A="middle";if(P.boundElements!==null){for(const j of P.boundElements)if(j.type==="text"){const Y=r.find(V=>V.id===j.id);Y&&($=Y.text,A=XE[Y.textAlign])}}const D=P.backgroundColor==="transparent"?P.strokeColor:P.backgroundColor;i.shapes.push({...k,type:"geo",props:{geo:P.type,opacity:da(P.opacity),url:P.link??"",w:P.width,h:P.height,size:$d[P.strokeWidth]??"draw",color:Fl[D]??"black",text:$,align:A,dash:Td(P),fill:TG(P)}});break}case"freedraw":{i.shapes.push({...k,type:"draw",props:{dash:Td(P),size:$d[P.strokeWidth],opacity:da(P.opacity),color:Fl[P.strokeColor]??"black",segments:[{type:"free",points:P.points.map(([$,A,D=.5])=>({x:$,y:A,z:D}))}]}});break}case"line":{const $=P.points[0],A=P.points[P.points.length-1],D=j2(P.points.length);i.shapes.push({...k,type:"line",props:{dash:Td(P),size:$d[P.strokeWidth],opacity:da(P.opacity),color:Fl[P.strokeColor]??"black",spline:P.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:D[0],x:$[0],y:$[1]},end:{id:"end",type:"vertex",index:D[D.length-1],x:A[0],y:A[1]},...Object.fromEntries(P.points.slice(1,-1).map(([j,Y],V)=>{const q=_t();return[q,{id:q,type:"vertex",index:D[V+1],x:j,y:Y}]}))}}});break}case"arrow":{let $="";if(P.boundElements!==null){for(const V of P.boundElements)if(V.type==="text"){const q=r.find(F=>F.id===V.id);q&&($=q.text)}}const A=P.points[0],D=P.points[P.points.length-1],j=c.get((b=P.startBinding)==null?void 0:b.elementId),Y=c.get((E=P.endBinding)==null?void 0:E.elementId);i.shapes.push({...k,type:"arrow",props:{text:$,bend:$G(P,A,D),dash:Td(P),opacity:da(P.opacity),size:$d[P.strokeWidth]??"m",color:Fl[P.strokeColor]??"black",start:j?{type:"binding",boundShapeId:j,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:A[0],y:A[1]},end:Y?{type:"binding",boundShapeId:Y,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:D[0],y:D[1]},arrowheadEnd:GE[P.endArrowhead]??"none",arrowheadStart:GE[P.startArrowhead]??"none"}});break}case"text":{const{size:$,scale:A}=_G(P.fontSize);i.shapes.push({...k,type:"text",props:{size:$,scale:A,font:IG[P.fontFamily]??"draw",opacity:da(P.opacity),color:Fl[P.strokeColor]??"black",text:P.text,align:XE[P.textAlign]}});break}case"image":{const $=o[P.fileId];if(!$)break;const A=pu.createId();i.assets.push({id:A,typeName:"asset",type:"image",props:{w:P.width,h:P.height,name:P.id??"Untitled",isAnimated:!1,mimeType:$.mimeType,src:$.dataURL}}),i.shapes.push({...k,type:"image",props:{opacity:da(P.opacity),w:P.width,h:P.height,assetId:A}})}}h=Oo(h)}const p=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0);t.mark("paste"),t.putContent(i,{point:p,select:!1,preserveIds:!0});for(const P of s.values())if(P.length>1){t.groupShapes(P);const C=t.getShapeById(P[0]);C!=null&&C.parentId&&vr(C.parentId)&&d.push(C.parentId)}for(const[P,C]of a)t.select(P),t.rotateShapesBy([P],C);const g=Ee(d.map(P=>t.getShapeById(P))),m=de.Common(g.map(P=>t.getPageBounds(P))),v=t.viewportPageBounds.center;t.updateShapes(g.map(P=>{const C={x:(P.x??0)-(m.x+m.w/2),y:(P.y??0)-(m.y+m.h/2)};return{id:P.id,type:P.type,x:v.x+C.x,y:v.y+C.y}})),t.setSelectedIds(d)}const da=t=>{const e=t/100;return e<.2?"0.1":e<.4?"0.25":e<.6?"0.5":e<.8?"0.75":"1"},$d={1:"s",2:"m",3:"l",4:"xl"},PG={16:"s",20:"m",28:"l",36:"xl"};function _G(t){const e=PG[t];return e?{size:e,scale:1}:t<16?{size:"s",scale:t/16}:t>36?{size:"xl",scale:t/36}:{size:"m",scale:1}}const IG={1:"draw",2:"sans",3:"mono"},Fl={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},CG={solid:"draw",dashed:"dashed",dotted:"dotted"},kG={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},XE={left:"start",center:"middle",right:"end"},GE={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function $G(t,e,n){let r=0;if(t.points.length>2){const o=new I(e[0],e[1]),i=new I(n[0],n[1]),s=new I(t.points[1][0],t.points[1][1]),a=I.Sub(i,o),l=I.Per(a),c=I.Med(i,o),d=I.Sub(c,l),u=I.Add(c,l),h=I.NearestPointOnLineSegment(d,u,s,!1);r=I.Dist(h,c),I.Clockwise(h,i,c)&&(r*=-1)}return r}const Td=t=>{let e=CG[t.strokeStyle]??"draw";return e==="draw"&&t.roughness===0&&(e="solid"),e},TG=t=>t.backgroundColor==="transparent"?"none":kG[t.fillStyle]??"solid";async function vM(t,e,n){const r=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter),i=(await Promise.all(e.map(async s=>await(await fetch(s)).blob()))).map(s=>new File([s],"tldrawFile",{type:s.type}));t.mark("paste"),await Fv(t,i,r,!1),e.forEach(s=>URL.revokeObjectURL(s))}const MG=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function AG(t){return t.replace(/\t/g,vs)}function RG(t){const e=t.split(`
`);for(;e[0].trim().length===0;)e.shift();let n=1/0;for(const r of e)if(r.trim().length>0){const o=r.length-r.trimStart().length;n=Math.min(n,o)}return e.map(r=>r.slice(n)).join(`
`)}function LG(t){return t.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}async function DG(t,e,n){const r=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter),o=t.getShapeUtilByDef(Vp).defaultProps(),i=LG(RG(AG(e)));let s,a,l,c="middle";const d=i.split(`
`).length>1,u=MG.test(i);d&&(c=d?u?"end":"start":"middle");const h=t.textMeasure.measureText({...Ct,text:i,fontFamily:Ko[o.font],fontSize:ys[o.size],width:"fit-content"}),p=Math.min(d?t.viewportPageBounds.width*.9:920,Math.max(200,t.viewportPageBounds.width*.9));if(h.w>p){const g=t.textMeasure.measureText({...Ct,text:i,fontFamily:Ko[o.font],fontSize:ys[o.size],width:p+"px"});s=g.w,a=g.h,l=!1,c=u?"end":"start"}else s=h.w,a=h.h,l=!0;r.y-a/2<t.viewportPageBounds.minY+40&&(r.y=t.viewportPageBounds.minY+40+a/2),t.mark("paste"),t.createShapes([{id:Ut(),type:"text",x:r.x-s/2,y:r.y-a/2,props:{text:i,align:c,autoSize:l,w:s}}])}async function OG(t,e,n){const r=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter);return t.mark("paste"),await y7(t,e,r)}function jG(t,e,n){const r=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0);t.mark("paste"),t.putContent(e,{point:r,select:!0})}async function $0(t,e,n){var i;const r=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter);try{if((i=(await fetch(e)).headers.get("content-type"))!=null&&i.match(/^image\//)){t.mark("paste"),vM(t,[e]);return}}catch(s){s.message!=="Failed to fetch"&&console.error(s)}t.mark("paste");const o=xi(e);return o?await s2(t,o.url,r,o.definition):await m7(t,e,r)}function NG(){const t=Z();return ge("app.isFocused",()=>t.isFocused,[t])}const BG=["input","select","textarea"];function gh(t){const{activeElement:e}=document;return t.isMenuOpen||e&&(e.getAttribute("contenteditable")||BG.indexOf(e.tagName.toLowerCase())>-1)}async function fm(t){return new Promise((e,n)=>{const r=new FileReader;r.addEventListener("loadend",()=>{const o=r.result;e(o)}),r.addEventListener("error",()=>{n(r.error)}),r.readAsText(t)})}function zG(t){const e=document.implementation.createHTMLDocument("");return e.documentElement.innerHTML=t.trim(),e.body.textContent||e.body.innerText||""}const UG=t=>t.types.find(e=>e.match(/^image\//)),gm=(t,e,n)=>{const r=w7(e);if(r)for(const o of r)$0(t,o,n);else v7(e)?$0(t,e,n):x7(e)?OG(t,e,n):DG(t,e,n)},FG=async(t,e,n)=>{if(t.editingId!==null)return;if(!e)throw Error("No clipboard data");const r=[];for(const o of Object.values(e.items))switch(o.kind){case"file":{r.push({type:"file",source:new Promise(i=>i(o.getAsFile()))});break}case"string":{o.type==="text/html"?r.push({type:"html",source:new Promise(i=>o.getAsString(i))}):o.type==="text/plain"?r.push({type:"text",source:new Promise(i=>o.getAsString(i))}):r.push({type:o.type,source:new Promise(i=>o.getAsString(i))});break}}xM(t,r,n)},wM=async(t,e,n)=>{const r=[];for(const o of e){if(UG(o))for(const i of o.types)i.match(/^image\//)&&r.push({type:"blob",source:o.getType(i)});o.types.includes("text/html")&&r.push({type:"html",source:new Promise(i=>o.getType("text/html").then(s=>fm(s).then(i)))}),o.types.includes("text/uri-list")&&r.push({type:"url",source:new Promise(i=>o.getType("text/uri-list").then(s=>fm(s).then(i)))}),o.types.includes("text/plain")&&r.push({type:"text",source:new Promise(i=>o.getType("text/plain").then(s=>fm(s).then(i)))})}return await xM(t,r,n)};async function xM(t,e,n){const r=e.filter(i=>(i.type==="file"||i.type==="blob")&&i.source!==null);if(r.length){const s=(await Promise.all(r.map(a=>a.source))).filter(Boolean).map(a=>URL.createObjectURL(a));return await vM(t,s,n)}const o=await Promise.all(e.filter(i=>i.type!=="file").map(i=>new Promise(s=>{const a=i;if(a.type==="file"){s({type:"error",data:null,reason:"unexpected file"});return}a.source.then(l=>{var d;const c=(d=l.match(/<tldraw[^>]*>(.*)<\/tldraw>/))==null?void 0:d[1];if(c)try{const u=yM.decompressFromBase64(c);if(u===null){s({type:"error",data:u,reason:"found tldraw data comment but could not parse base64"});return}else{const h=JSON.parse(u);if(h.type!=="application/tldraw"&&s({type:"error",data:h,reason:`found tldraw data comment but JSON was of a different type: ${h.type}`}),typeof h.data=="string"){s({type:"error",data:h,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}s({type:"tldraw",data:h.data});return}}catch{s({type:"error",data:c,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if(a.type==="html"){s({type:"text",data:l,subtype:"html"});return}if(a.type==="url"){s({type:"text",data:l,subtype:"url"});return}try{const u=JSON.parse(l);if(u.type==="excalidraw/clipboard"){s({type:"excalidraw",data:u});return}else{s({type:"text",data:l,subtype:"json"});return}}catch{s({type:"text",data:l,subtype:"text"});return}}s({type:"error",data:l,reason:"unhandled case"})})})));for(const i of o)if(i.type==="tldraw"){jG(t,i.data,n);return}for(const i of o)if(i.type==="excalidraw"){EG(t,i.data,n);return}for(const i of o)if(i.type==="text"&&i.subtype==="html"){const a=new DOMParser().parseFromString(i.data,"text/html").querySelector("body");if(a&&Array.from(a.children).filter(c=>c.nodeType===1).length===1&&a.firstElementChild&&a.firstElementChild.tagName==="A"&&a.firstElementChild.hasAttribute("href")&&a.firstElementChild.getAttribute("href")!==""){const c=a.firstElementChild.getAttribute("href");gm(t,c,n);return}if(!o.some(c=>c.type==="text"&&c.subtype!=="html")&&i.data.trim()){gm(t,zG(i.data),n);return}}for(const i of o)if(i.type==="text"&&i.subtype==="url"){$0(t,i.data,n);return}for(const i of o)if(i.type==="text"&&i.subtype==="text"&&i.data.trim()){gm(t,i.data,n);return}}const yp=t=>{var r;const e=t.getContent();if(!e){window.navigator.clipboard.writeText("");return}const n=yM.compressToBase64(JSON.stringify({type:"application/tldraw",kind:"content",data:e}));if(typeof(window==null?void 0:window.navigator)<"u"){const o=e.shapes.map(i=>Vp.is(i)||T2.is(i)||Mt.is(i)?i.props.text:jp.is(i)||Tc.is(i)?i.props.url:null).filter(r5);if((r=navigator.clipboard)!=null&&r.write){const i=new Blob([`<tldraw>${n}</tldraw>`],{type:"text/html"});let s=o.join(" ");s===""&&(s=" "),navigator.clipboard.write([new ClipboardItem({"text/html":i,"text/plain":new Blob([s],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${n}</tldraw>`)}};function gx(t){const e=Z(),n=ml(),r=w.useCallback(function(){e.selectedIds.length!==0&&(yp(e),n("copy",{source:t}))},[e,n,t]),o=w.useCallback(function(){e.selectedIds.length!==0&&(yp(e),e.deleteShapes(),n("cut",{source:t}))},[e,n,t]),i=w.useCallback(async function(a,l){e.editingId!==null||gh(e)||(Array.isArray(a)&&a[0]instanceof ClipboardItem?(wM(e,a,l),n("paste",{source:"menu"})):navigator.clipboard.read().then(c=>{i(c,e.inputs.currentPagePoint)}))},[e,n]);return{copy:r,cut:o,paste:i}}function KG(){const t=Z(),e=ml(),n=NG();w.useEffect(()=>{if(!n)return;const r=()=>{t.selectedIds.length===0||t.editingId!==null||gh(t)||(yp(t),e("copy",{source:"kbd"}))};function o(){t.selectedIds.length===0||t.editingId!==null||gh(t)||(yp(t),t.deleteShapes(),e("cut",{source:"kbd"}))}let i=!1;const s=l=>{l.button===1&&(i=!0,requestAnimationFrame(()=>{i=!1}))},a=l=>{if(i){l.stopPropagation();return}t.editingId!==null||gh(t)||(l.clipboardData&&!t.inputs.shiftKey?FG(t,l.clipboardData):navigator.clipboard.read().then(c=>{Array.isArray(c)&&c[0]instanceof ClipboardItem&&wM(t,c,t.inputs.currentPagePoint)}),e("paste",{source:"kbd"}))};return document.addEventListener("copy",r),document.addEventListener("cut",o),document.addEventListener("paste",a),document.addEventListener("pointerup",s),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",o),document.removeEventListener("paste",a),document.removeEventListener("pointerup",s)}},[t,e,n])}const bM=w.createContext({});function HG({children:t}){const[e,n]=w.useState([]),r=w.useCallback(s=>{const a=s.id??_t();return n(l=>[...l.filter(c=>c.id!==s.id),{...s,id:a}]),a},[]),o=w.useCallback(s=>(n(a=>a.filter(l=>l.id!==s)),s),[]),i=w.useCallback(()=>{n(()=>[])},[]);return f.jsx(bM.Provider,{value:{toasts:e,addToast:r,removeToast:o,clearToasts:i},children:t})}function _o(){const t=w.useContext(bM);if(!t)throw new Error("useToasts must be used within a ToastsProvider");return t}function VG(){const t=Z(),{addToast:e}=_o(),n=Be();return w.useCallback(function(o=t.selectedIds,i="svg"){if(o.length===0&&(o=[...t.shapeIds]),o.length!==0)switch(i){case"svg":{window.navigator.clipboard&&(window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":WG(t,o)})]):qE(async()=>SC(await mx(t,o))));break}case"jpeg":case"png":{const s=i==="jpeg"?"image/jpeg":"image/png",a=YG(t,o,i).then(l=>{if(l){if(window.navigator.clipboard)return l;throw new Error("Copy not supported")}else throw e({id:"copy-fail",icon:"warning-triangle",title:n("toast.error.copy-fail.title"),description:n("toast.error.copy-fail.desc")}),new Error("Copy not possible")});window.navigator.clipboard.write([new ClipboardItem({[s]:a})]).catch(l=>{l.toString().match(/^TypeError: DOMString not supported/)||console.error(l),a.then(c=>{window.navigator.clipboard.write([new ClipboardItem({[s]:c})])})});break}case"json":{const s=t.getContent(o);if(window.navigator.clipboard){const a=JSON.stringify(s);window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"})})]):qE(async()=>a)}break}default:throw new Error(`Copy type ${i} not supported.`)}},[t,e,n])}async function mx(t,e){const n=await t.getSvg(e,{scale:1,background:t.instanceState.exportBackground});if(!n)throw new Error("Could not construct SVG.");return n}async function WG(t,e){return new Blob([SC(await mx(t,e))],{type:"text/plain"})}async function YG(t,e,n){return await EC(await mx(t,e),{type:n,quality:1,scale:2})}async function qE(t){navigator.clipboard.writeText(await t())}const SM=w.createContext({});function XG({children:t}){const e=Z(),n=ml(),[r,o]=w.useState([]),i=w.useCallback(c=>{const d=c.id??_t();return o(u=>[...u.filter(h=>h.id!==c.id),{...c,id:d}]),n("open-menu",{source:"dialog",id:d}),e.addOpenMenu(d),d},[e,n]),s=w.useCallback((c,d)=>(o(u=>u.map(h=>h.id===c?{...h,...d}:h)),n("open-menu",{source:"dialog",id:c}),e.addOpenMenu(c),c),[e,n]),a=w.useCallback(c=>(o(d=>d.filter(u=>{var h;return u.id===c?((h=u.onClose)==null||h.call(u),!1):!0})),n("close-menu",{source:"dialog",id:c}),e.deleteOpenMenu(c),c),[e,n]),l=w.useCallback(()=>{o(c=>(c.forEach(d=>{var u;(u=d.onClose)==null||u.call(d),n("close-menu",{source:"dialog",id:d.id}),e.deleteOpenMenu(d.id)}),[]))},[e,n]);return f.jsx(SM.Provider,{value:{dialogs:r,addDialog:i,removeDialog:a,clearDialogs:l,updateDialog:s},children:t})}function Ws(){const t=w.useContext(SM);if(!t)throw new Error("useDialogs must be used within a DialogsProvider");return t}function GG(){const t=Z(),{addToast:e}=_o(),n=Be();return w.useCallback(async function(o=t.selectedIds,i="png"){if(o.length===0&&(o=[...t.shapeIds]),o.length===0)return;const s=await t.getSvg(o,{scale:1,background:t.instanceState.exportBackground});if(!s)throw new Error("Could not construct SVG.");let a="shapes";if(o.length===1){const l=t.getShapeById(o[0]);l.type==="frame"?a=l.props.name??"frame":a=l.id.replace(/:/,"_")}switch(i){case"svg":{const l=await PC(s);Tg(l,`${a||"shapes"}.svg`);return}case"webp":case"png":{const l=await EC(s,{type:i,quality:1,scale:2});if(!l){e({id:"export-fail",title:n("toast.error.export-fail.title"),description:n("toast.error.export-fail.desc")});return}const c=URL.createObjectURL(l);Tg(c,`${a||"shapes"}.${i}`),URL.revokeObjectURL(c);return}case"json":{const l=t.getContent(o),c=URL.createObjectURL(new Blob([JSON.stringify(l,null,4)],{type:"application/json"}));Tg(c,`${a||"shapes"}.json`),URL.revokeObjectURL(c);return}default:throw new Error(`Export type ${i} not supported.`)}},[t,e,n])}function EM(){const t=Z(),e=w.useRef();return w.useEffect(()=>{const n=window.document.createElement("input");n.type="file",n.accept=l7,n.multiple=!0,e.current=n;async function r(o){const i=o.target.files;!i||i.length===0||(await Fv(t,Array.from(i),t.viewportPageBounds.center,!1),n.value="")}return n.addEventListener("change",r),()=>{e.current=void 0,n.removeEventListener("change",r)}},[t]),w.useCallback(()=>{var n;(n=e.current)==null||n.click()},[e])}function qG(){const t=Z(),e=w.useRef(null),n=w.useRef(null);return w.useCallback(async function(){const o=document.createElement("div"),i=document.createElement("style"),s=(x,b)=>{x&&(x.innerHTML=""),b&&document.head.contains(b)&&document.head.removeChild(b),x&&document.body.contains(x)&&document.body.removeChild(x)};s(e.current,n.current),e.current=o,n.current=i;const a=`tl-print-surface-${_t()}`;o.className=a,i.innerHTML=`
			.${a} {
				display: none;
			}

			.${a} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.${a} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${a}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${a}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${a}__item__header {
					display: none;
				}

				.${a}__item__footer {
					display: none;
					text-align: right;
				}

				.${a}__item__footer__hide {
					display: none;
				}

				
			}

		`;const l=()=>{document.head.appendChild(i),document.body.appendChild(o)},c=()=>{t.once("change-history",()=>{s(o,i)})};window.addEventListener("beforeprint",l),window.addEventListener("afterprint",c);function d(x,b,E){try{o.innerHTML+=`<div class="${a}__item">
        <div class="${a}__item__header">
          ${x.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${a}__item__main">
          ${E.outerHTML}
        </div>
        <div class="${a}__item__footer ${a}__item__footer__${b?"":"hide"}">
          ${b??""}
        </div>
      </div>`}catch(P){console.error(P)}}function u(){t.isChromeForIos?(l(),window.print()):t.isSafari?(l(),document.execCommand("print",!1)):window.print()}const{pages:h,currentPageId:p,selectedIds:g}=t,v={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(t.selectedIds.length>0){const x=await t.getSvg(g,v);if(x){const b=h.find(E=>E.id===p);d(`tldraw — ${b==null?void 0:b.name}`,null,x),u()}}else{const x=t.currentPage,b=await t.getSvg(t.getSortedChildIds(x.id),v);b&&(d(`tldraw — ${x.name}`,null,b),u())}window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",c)},[t])}const PM=w.createContext({});function QG(t){return Object.fromEntries(t.map(e=>[e.id,e]))}function ZG({overrides:t,children:e}){const n=Z(),{addDialog:r,clearDialogs:o}=Ws(),{clearToasts:i}=_o(),s=EM(),a=qG(),{cut:l,copy:c}=gx("unknown"),d=VG(),u=GG(),h=ml(),p=w.useMemo(()=>{const g=QG([{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect(m){h("edit-link",{source:m}),n.mark("edit-link"),r({component:SG})}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect(m){h("insert-embed",{source:m}),r({component:mM})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect(m){h("insert-media",{source:m}),s()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect(m){h("undo",{source:m}),n.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect(m){h("redo",{source:m}),n.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect(m){h("export-as",{format:"svg",source:m}),u(n.selectedIds,"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect(m){h("export-as",{format:"png",source:m}),u(n.selectedIds,"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect(m){h("export-as",{format:"json",source:m}),u(n.selectedIds,"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect(m){h("copy-as",{format:"svg",source:m}),d(n.selectedIds,"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect(m){h("copy-as",{format:"png",source:m}),d(n.selectedIds,"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect(m){h("copy-as",{format:"json",source:m}),d(n.selectedIds,"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect(m){h("toggle-auto-size",{source:m}),n.mark(),n.updateShapes(n.selectedShapes.filter(v=>v&&v.type==="text"&&v.props.autoSize===!1).map(v=>({id:v.id,type:v.type,props:{...v.props,w:8,autoSize:!0}})))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(m){h("open-embed-link",{source:m});const v=n.selectedIds,x="No embed shapes selected";if(v.length!==1){console.error(x);return}const b=n.getShapeById(v[0]);if(!b||!Tc.is(b)){console.error(x);return}q9(b.props.url,"_blank")}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect(m){h("convert-to-bookmark",{source:m});const x=n.selectedIds.map(P=>n.getShapeById(P)),b=[],E=[];for(const P of x){if(!P||!Tc.is(P)||!P.props.url)continue;const C=new I(P.x,P.y);C.rot(-P.rotation),C.add(new I(P.props.w/2-jI/2,P.props.h/2-NI/2)),C.rot(P.rotation),b.push({id:n.createShapeId(),type:"bookmark",rotation:P.rotation,x:C.x,y:C.y,props:{url:P.props.url,opacity:"1"}}),E.push(P.id)}n.mark("convert shapes to bookmark"),n.deleteShapes(E),n.createShapes(b)}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect(m){h("convert-to-embed",{source:m});const v=n.selectedIds,x=Ee(v.map(P=>n.getShapeById(P))),b=[],E=[];for(const P of x){if(!jp.is(P))continue;const{url:C}=P.props,k=xi(P.props.url);if(!k||!k.definition)continue;const{width:$,height:A,doesResize:D}=k.definition,j=new I(P.x,P.y);j.rot(-P.rotation),j.add(new I(P.props.w/2-$/2,P.props.h/2-A/2)),j.rot(P.rotation),b.push({id:n.createShapeId(),type:"embed",x:j.x,y:j.y,rotation:P.rotation,props:{url:C,w:$,h:A,doesResize:D}}),E.push(P.id)}n.mark("convert shapes to embed"),n.deleteShapes(E),n.createShapes(b)}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect(m){if(n.currentToolId!=="select")return;h("duplicate-shapes",{source:m});const v=n.selectedIds,x=de.Common(Ee(v.map(E=>n.getPageBoundsById(E)))),b=n.canMoveCamera?{x:x.width+10,y:0}:{x:16/n.zoomLevel,y:16/n.zoomLevel};n.mark("duplicate shapes"),n.duplicateShapes(v,b)}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect(m){h("ungroup-shapes",{source:m}),n.mark("ungroup"),n.ungroupShapes(n.selectedIds)}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect(m){h("group-shapes",{source:m}),n.selectedShapes.length===1&&n.selectedShapes[0].type==="group"?(n.mark("ungroup"),n.ungroupShapes(n.selectedIds)):(n.mark("group"),n.groupShapes(n.selectedIds))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect(m){h("align-shapes",{operation:"left",source:m}),n.mark("align left"),n.alignShapes("left",n.selectedIds)}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect(m){h("align-shapes",{operation:"center-horizontal",source:m}),n.mark("align center horizontal"),n.alignShapes("center-horizontal",n.selectedIds)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect(m){h("align-shapes",{operation:"right",source:m}),n.mark("align right"),n.alignShapes("right",n.selectedIds)}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect(m){h("align-shapes",{operation:"center-vertical",source:m}),n.mark("align center vertical"),n.alignShapes("center-vertical",n.selectedIds)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect(m){h("align-shapes",{operation:"top",source:m}),n.mark("align top"),n.alignShapes("top",n.selectedIds)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect(m){h("align-shapes",{operation:"bottom",source:m}),n.mark("align bottom"),n.alignShapes("bottom",n.selectedIds)}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",readonlyOk:!1,onSelect(m){h("distribute-shapes",{operation:"horizontal",source:m}),n.mark("distribute horizontal"),n.distributeShapes("horizontal",n.selectedIds)}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",readonlyOk:!1,onSelect(m){h("distribute-shapes",{operation:"vertical",source:m}),n.mark("distribute vertical"),n.distributeShapes("vertical",n.selectedIds)}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect(m){h("stretch-shapes",{operation:"horizontal",source:m}),n.mark("stretch horizontal"),n.stretchShapes("horizontal",n.selectedIds)}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect(m){h("stretch-shapes",{operation:"vertical",source:m}),n.mark("stretch vertical"),n.stretchShapes("vertical",n.selectedIds)}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect(m){h("flip-shapes",{operation:"horizontal",source:m}),n.mark("flip horizontal"),n.flipShapes("horizontal",n.selectedIds)}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect(m){h("flip-shapes",{operation:"vertical",source:m}),n.mark("flip vertical"),n.flipShapes("vertical",n.selectedIds)}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect(m){h("pack-shapes",{source:m}),n.mark("pack"),n.packShapes(n.selectedIds)}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect(m){h("stack-shapes",{operation:"vertical",source:m}),n.mark("stack-vertical"),n.stackShapes("vertical",n.selectedIds)}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect(m){h("stack-shapes",{operation:"horizontal",source:m}),n.mark("stack-horizontal"),n.stackShapes("horizontal",n.selectedIds)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect(m){h("reorder-shapes",{operation:"toFront",source:m}),n.mark("bring to front"),n.bringToFront()}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect(m){h("reorder-shapes",{operation:"forward",source:m}),n.mark("bring forward"),n.bringForward()}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect(m){h("reorder-shapes",{operation:"backward",source:m}),n.mark("send backward"),n.sendBackward()}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect(m){h("reorder-shapes",{operation:"toBack",source:m}),n.mark("send to back"),n.sendToBack()}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect(m){h("cut",{source:m}),n.mark("cut"),l()}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(m){h("copy",{source:m}),c()}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect(){}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(m){h("select-all-shapes",{source:m}),n.currentToolId!=="select"&&(n.cancel(),n.setSelectedTool("select")),n.mark("select all kbd"),n.selectAll()}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(m){h("select-none-shapes",{source:m}),n.mark("select none"),n.selectNone()}},{id:"delete",label:"action.delete",kbd:"⌫",icon:"trash",readonlyOk:!1,onSelect(m){n.currentToolId==="select"&&(h("delete-shapes",{source:m}),n.mark("delete"),n.deleteShapes())}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect(m){if(n.selectedIds.length===0)return;h("rotate-cw",{source:m}),n.mark("rotate-cw");const v=n.selectionRotation%(Ye/2),x=nc(v,0)||nc(v,Ye/2);n.rotateShapesBy(n.selectedIds,Ye/2-(x?0:v))}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect(m){if(n.selectedIds.length===0)return;h("rotate-ccw",{source:m}),n.mark("rotate-ccw");const v=n.selectionRotation%(Ye/2),x=nc(v,0);n.rotateShapesBy(n.selectedIds,x?-(Ye/2):-v)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=",readonlyOk:!0,onSelect(m){h("zoom-in",{source:m}),n.zoomIn(n.viewportScreenCenter,{duration:No})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-",readonlyOk:!0,onSelect(m){h("zoom-out",{source:m}),n.zoomOut(n.viewportScreenCenter,{duration:No})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(m){h("reset-zoom",{source:m}),n.resetZoom(n.viewportScreenCenter,{duration:No})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(m){h("zoom-to-fit",{source:m}),n.zoomToFit({duration:No})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(m){h("zoom-to-selection",{source:m}),n.zoomToSelection({duration:No})}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect(m){h("toggle-snap-mode",{source:m}),n.setSnapMode(!n.isSnapMode)},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect(m){h("toggle-dark-mode",{source:m}),n.setDarkMode(!n.isDarkMode)},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect(m){h("toggle-transparent",{source:m}),n.updateInstanceState({exportBackground:!n.instanceState.exportBackground},!0)},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect(m){h("toggle-tool-lock",{source:m}),n.setToolLocked(!n.isToolLocked)},checkbox:!0},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(m){requestAnimationFrame(()=>{n.batch(()=>{h("toggle-focus-mode",{source:m}),o(),i(),n.setFocusMode(!n.isFocusMode)})})}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect(m){h("toggle-grid-mode",{source:m}),n.setGridMode(!n.isGridMode)},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect(m){h("toggle-debug-mode",{source:m}),n.updateInstanceState({isDebugMode:!n.instanceState.isDebugMode},!0)},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(m){h("print",{source:m}),a()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(m){h("exit-pen-mode",{source:m}),n.setPenMode(!1)}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(m){h("stop-following",{source:m}),n.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(m){h("zoom-to-content",{source:m}),n.zoomToContent()}}]);return t?t(n,g,void 0):g},[h,t,n,r,s,u,d,l,c,o,i,a]);return f.jsx(PM.Provider,{value:p,children:e})}function An(){const t=w.useContext(PM);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}function yx(t){return t.filter(e=>e!=null&&e!==!1)}function $e(t,...e){const n=yx(e);return n.length===0?null:{id:t,type:"group",checkbox:n.every(r=>r.type==="item"&&r.actionItem.checkbox),disabled:n.every(r=>r.disabled),readonlyOk:n.some(r=>r.readonlyOk),children:n}}function po(t,e,...n){const r=yx(n);return r.length===0?null:{id:t,type:"submenu",label:e,children:r,disabled:r.every(o=>o.disabled),readonlyOk:r.some(o=>o.readonlyOk)}}function vp(t,e={}){const{readonlyOk:n=!0,disabled:r=!1}=e;return{id:t,type:"custom",disabled:r,readonlyOk:n}}function K(t,e={}){if(!t)throw Error("No action item provided to menuItem");if(!t.label)throw Error("Trying to create menu item for action item that doesn't have a label");const{checked:n=!1,disabled:r=!1}=e;return{id:t.id,type:"item",actionItem:t,disabled:r,checked:n,readonlyOk:t.readonlyOk}}function _M(t){const{selectedIds:e}=t;return e.map(r=>t.getShapeById(r)).filter(r=>!(!r||Mt.is(r)&&r.props.start.type==="binding"||Mt.is(r)&&r.props.end.type==="binding"))}const IM=()=>{const t=Z();return ge("threeStackableItems",()=>_M(t).length>2,[t])},vx=()=>{const t=Z();return ge("allowGroup",()=>_M(t).length>1,[t])},wx=()=>{const t=Z();return ge("allowUngroup",()=>t.selectedIds.some(e=>{var n;return((n=t.getShapeById(e))==null?void 0:n.type)==="group"}),[])},CM=typeof window<"u"&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read,JG=[0,380,420,460,580,640,840,1023],kM=xe.createContext(0);function eq({children:t}){const e=Z(),n=ge("breakpoint",()=>{const{width:r}=e.viewportScreenBounds,o=JG;for(let i=0;i<o.length-1;i++)if(r>o[i]&&r<=o[i+1])return i;return o.length},[e]);return f.jsx(kM.Provider,{value:n,children:t})}function Rr(){let t=w.useContext(kM);const e=new URL(window.location.href).searchParams.get("layout");return e==="desktop"?t=7:e==="mobile"&&(t=1),t}function xx(){const t=Z();return ge("hasLinkShapeSelected",()=>{const{selectedShapes:e}=t;return e.length===1&&"url"in e[0].props&&e[0].type!=="embed"},[t])}const $M=xe.createContext({}),tq=Me(function({overrides:e,children:n}){const r=Z(),o=An(),i=r.selectedIds.length,s=i>0,a=i>1,l=i>2,c=IM(),d=vx(),u=wx(),h=xx(),p=Rr(),g=r.zoomLevel===1,m=w.useMemo(()=>{const v=[K(o["align-left"],{disabled:!a}),K(o["align-center-horizontal"],{disabled:!a}),K(o["align-right"],{disabled:!a}),K(o["stretch-horizontal"],{disabled:!a}),K(o["align-top"],{disabled:!a}),K(o["align-center-vertical"],{disabled:!a}),K(o["align-bottom"],{disabled:!a}),K(o["stretch-vertical"],{disabled:!a}),K(o["distribute-horizontal"],{disabled:!l}),K(o["distribute-vertical"],{disabled:!l}),K(o["stack-horizontal"],{disabled:!c}),K(o["stack-vertical"],{disabled:!c}),K(o["send-to-back"],{disabled:!s}),K(o["send-backward"],{disabled:!s}),K(o["bring-forward"],{disabled:!s}),K(o["bring-to-front"],{disabled:!s}),p<5?K(o["zoom-to-100"],{disabled:!!g}):K(o["rotate-ccw"],{disabled:!s}),K(o["rotate-cw"],{disabled:!s}),K(o["edit-link"],{disabled:!h}),d?K(o.group,{disabled:!a}):u?K(o.ungroup):K(o.group,{disabled:!a})];return e?e(r,v,{actions:o,oneSelected:s,twoSelected:a,threeSelected:l}):v},[r,g,d,e,o,s,a,l,c,u,h,p]);return f.jsx($M.Provider,{value:m,children:n})});function nq(){const t=xe.useContext($M);if(!t)throw new Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return t}function rq(){const t=Z();return ge("onlyFlippableShape",()=>{const{selectedShapes:e}=t;return e.length===1&&e.every(n=>n.type==="group"||D9(n))},[t])}function TM(){const t=Z();return ge("showAutoSizeToggle",()=>{const{selectedShapes:e}=t;return e.length===1&&e[0].type==="text"&&e[0].props.autoSize===!1},[t])}const MM=xe.createContext({}),oq=Me(function({overrides:e,children:n}){var C;const r=Z(),o=An(),i=TM(),s=rq(),a=r.selectedIds.length,l=a>0,c=ge("oneEmbedSelected",()=>r.selectedIds.length!==1?!1:r.selectedIds.some(k=>{const $=r.getShapeById(k);return $&&Tc.is($)&&$.props.url}),[]),d=ge("oneEmbeddableBookmarkSelected",()=>r.selectedIds.length!==1?!1:r.selectedIds.some(k=>{const $=r.getShapeById(k);return $&&jp.is($)&&xi($.props.url)}),[]),u=a>1,h=a>2,p=IM(),g=ge("atLeastOneShapeOnPage",()=>r.shapeIds.size>0,[]),m=ge("isTransparentBg",()=>r.instanceState.exportBackground,[]),v=vx(),x=wx(),b=!!((C=window.navigator.clipboard)!=null&&C.write),E=xx(),P=w.useMemo(()=>{let k=yx([$e("selection",c&&K(o["open-embed-link"]),c&&K(o["convert-to-bookmark"]),d&&K(o["convert-to-embed"]),i&&K(o["toggle-auto-size"]),E&&K(o["edit-link"]),l&&K(o.duplicate),v&&K(o.group),x&&K(o.ungroup)),$e("modify",(u||s)&&po("arrange","context-menu.arrange",u&&$e("align",K(o["align-left"]),K(o["align-center-horizontal"]),K(o["align-right"]),K(o["align-top"]),K(o["align-center-vertical"]),K(o["align-bottom"])),h&&$e("distribute",K(o["distribute-horizontal"]),K(o["distribute-vertical"])),u&&$e("stretch",K(o["stretch-horizontal"]),K(o["stretch-vertical"])),s&&$e("flip",K(o["flip-horizontal"]),K(o["flip-vertical"])),u&&$e("order",K(o.pack,{disabled:!u}),p&&K(o["stack-vertical"]),p&&K(o["stack-horizontal"]))),l&&po("reorder","context-menu.reorder",$e("reorder",K(o["bring-to-front"]),K(o["bring-forward"]),K(o["send-backward"]),K(o["send-to-back"]))),l&&vp("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),$e("clipboard-group",l&&K(o.cut),l&&K(o.copy),CM&&vp("MENU_PASTE",{readonlyOk:!1})),g&&$e("conversions",po("copy-as","context-menu.copy-as",$e("copy-as-group",K(o["copy-as-svg"]),b&&K(o["copy-as-png"]),K(o["copy-as-json"])),$e("export-bg",K(o["toggle-transparent"],{checked:!m}))),po("export-as","context-menu.export-as",$e("export-as-group",K(o["export-as-svg"]),K(o["export-as-png"]),K(o["export-as-json"])),$e("export-bg,",K(o["toggle-transparent"],{checked:!m})))),g&&$e("set-selection-group",K(o["select-all"]),l&&K(o["select-none"])),l&&$e("delete-group",K(o.delete))]);return e&&(k=e(r,k,{actions:o,oneSelected:l,twoSelected:u,threeSelected:h,showAutoSizeToggle:i,showUngroup:x,onlyFlippableShapeSelected:s})),k},[r,e,o,l,u,h,i,s,g,p,v,x,b,E,c,d,m]);return f.jsx(MM.Provider,{value:P,children:n})});function AM(){const t=xe.useContext(MM);if(!t)throw new Error("useContextMenuSchema must be used inside of a ContextMenuSchemaProvider.");return t}const RM=w.createContext({});function iq({overrides:t,children:e}){const n=Z(),r=ml(),{addDialog:o}=Ws(),i=EM(),s=w.useMemo(()=>{const a=sq([{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(l){n.setSelectedTool("select"),r("select-tool",{source:l,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(l){n.setSelectedTool("hand"),r("select-tool",{source:l,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect(l){n.setSelectedTool("eraser"),r("select-tool",{source:l,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect(l){n.setSelectedTool("draw"),r("select-tool",{source:l,id:"draw"})}},...[...q_].map(l=>({id:l,label:`tool.${l}`,readonlyOk:!1,meta:{geo:l},kbd:l==="rectangle"?"r":l==="ellipse"?"o":void 0,icon:"geo-"+l,onSelect(c){n.batch(()=>{n.updateInstanceState({propsForNextShape:{...n.instanceState.propsForNextShape,geo:l}},!0),n.setSelectedTool("geo"),r("select-tool",{source:c,id:`geo-${l}`})})}})),{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect(l){n.setSelectedTool("arrow"),r("select-tool",{source:l,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect(l){n.setSelectedTool("line"),r("select-tool",{source:l,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect(l){n.setSelectedTool("frame"),r("select-tool",{source:l,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect(l){n.setSelectedTool("text"),r("select-tool",{source:l,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect(l){i(),r("select-tool",{source:l,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect(l){n.setSelectedTool("note"),r("select-tool",{source:l,id:"note"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect(l){o({component:mM}),r("select-tool",{source:l,id:"embed"})}}]);return t?t(n,a,{insertMedia:i}):a},[n,r,t,i,o]);return f.jsx(RM.Provider,{value:s,children:e})}function sq(t){return Object.fromEntries(t.map(e=>[e.id,e]))}function LM(){const t=w.useContext(RM);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}const DM=xe.createContext({}),aq=Me(function({overrides:e,children:n}){const r=Z(),o=LM(),i=An(),s=w.useMemo(()=>{const a=Ee([$e("shortcuts-dialog.tools",K(i["toggle-tool-lock"]),K(o.select),K(o.draw),K(o.eraser),K(o.hand),K(o.rectangle),K(o.ellipse),K(o.arrow),K(o.line),K(o.text),K(o.frame),K(o.note)),$e("shortcuts-dialog.file",K(i["insert-media"]),K(i.print)),$e("shortcuts-dialog.preferences",K(i["toggle-dark-mode"]),K(i["toggle-focus-mode"]),K(i["toggle-grid"])),$e("shortcuts-dialog.edit",K(i.undo),K(i.redo),K(i.cut),K(i.copy),K(i.paste),K(i["select-all"]),K(i.delete),K(i.duplicate),K(i["export-as-svg"]),K(i["export-as-png"])),$e("shortcuts-dialog.view",K(i["zoom-in"]),K(i["zoom-out"]),K(i["zoom-to-100"]),K(i["zoom-to-fit"]),K(i["zoom-to-selection"])),$e("shortcuts-dialog.transform",K(i["bring-to-front"]),K(i["bring-forward"]),K(i["send-backward"]),K(i["send-to-back"]),K(i.group),K(i.ungroup),K(i["flip-horizontal"]),K(i["flip-vertical"]),K(i["align-top"]),K(i["align-center-vertical"]),K(i["align-bottom"]),K(i["align-left"]),K(i["align-center-horizontal"]),K(i["align-right"]))]);return e?e(r,a,{tools:o,actions:i}):a},[r,e,i,o]);return f.jsx(DM.Provider,{value:s,children:n})});function lq(){const t=xe.useContext(DM);if(!t)throw new Error("Shortcuts must be used inside of a ShortcutsProvider.");return t}function ii(){const t=Z();return ge("isReadOnlyMode",()=>t.isReadOnly,[t])}const cq=()=>{const t=Be(),e=ii(),n=lq();function r(o){if(e&&!o.readonlyOk)return null;switch(o.type){case"group":return f.jsxs("div",{className:"tlui-shortcuts-dialog__group",children:[f.jsx("h2",{className:"tlui-shortcuts-dialog__group__title",children:t(o.id)}),f.jsx("div",{className:"tlui-shortcuts-dialog__group__content",children:o.children.filter(i=>i.type==="item"&&i.actionItem.kbd).map(r)})]},o.id);case"item":{const{id:i,label:s,shortcutsLabel:a,kbd:l}=o.actionItem;return f.jsxs("div",{className:"tlui-shortcuts-dialog__key-pair",children:[f.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:t(a??s)}),f.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:f.jsx(pf,{children:l})})]},i)}}}return f.jsxs(f.Fragment,{children:[f.jsxs(ff,{className:"tlui-shortcuts-dialog__header",children:[f.jsx(gf,{children:t("shortcuts-dialog.title")}),f.jsx(mf,{})]}),f.jsx(Gc,{className:"tlui-shortcuts-dialog__body",children:n.map(r)}),f.jsx("div",{className:"tlui-dialog__scrim"})]})};function OM(){const t=Z();return{languages:Zw,currentLanguage:t.user.locale}}const jM=xe.createContext({}),uq=Me(function({overrides:e,children:n}){const r=Z(),o=An(),i=r.selectedIds.length,s=i>0,a=i>1,l=i>2,{languages:c,currentLanguage:d}=OM(),{addDialog:u}=Ws(),h=w.useMemo(()=>{const p=Ee([$e("top",vp("LANGUAGE_MENU",{readonlyOk:!0}),K({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect(){u({component:cq})}}))]);return e?e(r,p,{actions:o,currentLanguage:d,languages:c,oneSelected:s,twoSelected:a,threeSelected:l}):p},[r,e,c,o,s,a,l,d,u]);return f.jsx(jM.Provider,{value:h,children:n})});function dq(){const t=xe.useContext(jM);if(!t)throw new Error("useHelpMenuSchema must be used inside of a helpMenuSchemaProvider.");return t}function NM(){const t=Z();return ge("useCanRedo",()=>t.canRedo,[t])}function BM(){const t=Z();return ge("useCanUndo",()=>t.canUndo,[t])}const zM=xe.createContext({});function hq({overrides:t,children:e}){var V;const n=Z(),r=An(),i=Rr()<5,s=ge("isDarkMode",()=>n.userDocumentSettings.isDarkMode,[n]),a=ge("isGridMode",()=>n.userDocumentSettings.isGridMode,[n]),l=ge("isSnapMode",()=>n.userDocumentSettings.isSnapMode,[n]),c=ge("isToolLock",()=>n.instanceState.isToolLocked,[n]),d=ge("isFocusMode",()=>n.instanceState.isFocusMode,[n]),u=ge("isDebugMode",()=>n.instanceState.isDebugMode,[n]),h=ge("exportBackground",()=>n.instanceState.exportBackground,[n]),p=ge("emptyPage",()=>n.shapeIds.size===0,[n]),g=ge("selectedCount",()=>n.selectedIds.length,[n]),m=g===0,v=g>0,x=g>1,b=g>2,E=!!((V=window.navigator.clipboard)!=null&&V.write),P=xx(),C=TM(),k=vx(),$=wx(),A=BM(),D=NM(),j=ge("isZoomedTo100",()=>n.zoomLevel===1,[n]),Y=w.useMemo(()=>{const q=Ee([$e("menu",po("file","menu.file",$e("print",K(r.print,{disabled:p}))),po("edit","menu.edit",$e("undo-actions",K(r.undo,{disabled:!A}),K(r.redo,{disabled:!D})),$e("clipboard-actions",K(r.cut,{disabled:m}),K(r.copy,{disabled:m}),{id:"MENU_PASTE",type:"custom",disabled:!CM,readonlyOk:!1}),$e("conversions",po("copy-as","menu.copy-as",$e("copy-as-group",K(r["copy-as-svg"],{disabled:p}),K(r["copy-as-png"],{disabled:p||!E}),K(r["copy-as-json"],{disabled:p})),$e("export-bg",K(r["toggle-transparent"],{checked:!h}))),po("export-as","menu.export-as",$e("export-as-group",K(r["export-as-svg"],{disabled:p}),K(r["export-as-png"],{disabled:p}),K(r["export-as-json"],{disabled:p})),$e("export-bg",K(r["toggle-transparent"],{checked:!h})))),$e("set-selection-group",K(r["select-all"],{disabled:p}),K(r["select-none"],{disabled:!v})),$e("selection",C&&K(r["toggle-auto-size"]),P&&K(r["edit-link"]),K(r.duplicate,{disabled:!v}),k&&K(r.group),$&&K(r.ungroup)),$e("delete-group",K(r.delete,{disabled:!v}))),po("view","menu.view",$e("view-actions",K(r["zoom-in"]),K(r["zoom-out"]),K(r["zoom-to-100"],{disabled:j}),K(r["zoom-to-fit"],{disabled:p}),K(r["zoom-to-selection"],{disabled:p||!v})))),$e("extras",K(r["insert-embed"]),K(r["insert-media"])),$e("preferences",po("preferences","menu.preferences",$e("preferences-actions",K(r["toggle-snap-mode"],{checked:l}),K(r["toggle-tool-lock"],{checked:c}),K(r["toggle-grid"],{checked:a}),K(r["toggle-dark-mode"],{checked:s}),K(r["toggle-focus-mode"],{checked:d}),K(r["toggle-debug-mode"],{checked:u}))),i&&vp("LANGUAGE_MENU",{readonlyOk:!0}))]);return t?t(n,q,{actions:r,noneSelected:m,oneSelected:v,twoSelected:x,threeSelected:b}):q},[n,t,r,v,x,b,p,i,k,$,P,E,C,m,A,D,s,a,l,c,d,h,u,j]);return f.jsx(zM.Provider,{value:Y,children:e})}function pq(){const t=xe.useContext(zM);if(!t)throw new Error("useMenuSchema must be used inside of a MenuSchemaProvider.");return t}function Ge(t){return{id:t.id,type:"item",readonlyOk:t.readonlyOk,toolItem:t}}const UM=xe.createContext([]);function fq({overrides:t,children:e}){const n=Z(),r=LM(),o=xe.useMemo(()=>{const i=[Ge(r.select),Ge(r.hand),Ge(r.draw),Ge(r.eraser),Ge(r.arrow),Ge(r.text),Ge(r.note),Ge(r.asset),Ge(r.rectangle),Ge(r.ellipse),Ge(r.diamond),Ge(r.triangle),Ge(r.trapezoid),Ge(r.rhombus),Ge(r.pentagon),Ge(r.hexagon),Ge(r.octagon),Ge(r.star),Ge(r.oval),Ge(r["x-box"]),Ge(r["arrow-right"]),Ge(r["arrow-left"]),Ge(r["arrow-up"]),Ge(r["arrow-down"]),Ge(r.line),Ge(r.frame),Ge(r.embed)];return t?t(n,i,{tools:r}):i},[n,t,r]);return f.jsx(UM.Provider,{value:o,children:e})}function gq(){const t=xe.useContext(UM);if(!t)throw new Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return t}function mq(){const{addToast:t,removeToast:e,clearToasts:n}=_o(),{addDialog:r,clearDialogs:o,removeDialog:i,updateDialog:s}=Ws(),l=Rr()<5,c=Be();return w.useMemo(()=>({addToast:t,removeToast:e,clearToasts:n,addDialog:r,clearDialogs:o,removeDialog:i,updateDialog:s,msg:c,isMobile:l}),[r,t,o,n,c,i,e,s,l])}function yq(t,e){const n={};for(const r of t)if(r.translations)for(const[o,i]of O_(r.translations)){let s=n[o];s||(s=n[o]={}),Object.assign(s,i)}return{actionsMenu:(r,o,i)=>{for(const s of t)s.actionsMenu&&(o=s.actionsMenu(r,o,{...e,...i}));return o},actions:(r,o)=>{for(const i of t)i.actions&&(o=i.actions(r,o,e));return o},contextMenu:(r,o,i)=>{for(const s of t)s.contextMenu&&(o=s.contextMenu(r,o,{...e,...i}));return o},helpMenu:(r,o,i)=>{for(const s of t)s.helpMenu&&(o=s.helpMenu(r,o,{...e,...i}));return o},menu:(r,o,i)=>{for(const s of t)s.menu&&(o=s.menu(r,o,{...e,...i}));return o},toolbar:(r,o,i)=>{for(const s of t)s.toolbar&&(o=s.toolbar(r,o,{...e,...i}));return o},keyboardShortcutsMenu:(r,o,i)=>{for(const s of t)s.keyboardShortcutsMenu&&(o=s.keyboardShortcutsMenu(r,o,{...e,...i}));return o},tools:(r,o,i)=>{for(const s of t)s.tools&&(o=s.tools(r,o,{...e,...i}));return o},translations:n}}function FM(t){return w.useMemo(()=>t,t)}function vq(t){const e=FM(t==null?[]:Array.isArray(t)?t:[t]);return w.useMemo(()=>{const n={};for(const r of e)if(r.translations)for(const[o,i]of O_(r.translations)){let s=n[o];s||(s=n[o]={}),Object.assign(s,i)}return n},[e])}function wq(t){const e=mq(),n=FM(t==null?[]:Array.isArray(t)?t:[t]);return w.useMemo(()=>yq(n,e),[n,e])}function xq({overrides:t,assetUrls:e,onUiEvent:n,children:r}){return f.jsx(JW,{assetUrls:e??gM,children:f.jsx(rY,{overrides:vq(t),children:f.jsx(VX,{onEvent:n,children:f.jsx(HG,{children:f.jsx(XG,{children:f.jsx(eq,{children:f.jsx(bq,{overrides:t,children:r})})})})})})})}function bq({overrides:t,children:e}){const n=wq(t);return f.jsx(ZG,{overrides:n.actions,children:f.jsx(iq,{overrides:n.tools,children:f.jsx(fq,{overrides:n.toolbar,children:f.jsx(tq,{overrides:n.actionsMenu,children:f.jsx(aq,{overrides:n.keyboardShortcutsMenu,children:f.jsx(oq,{overrides:n.contextMenu,children:f.jsx(uq,{overrides:n.helpMenu,children:f.jsx(hq,{overrides:n.menu,children:e})})})})})})})})}function Sq(){const t=Z(),n=An()["back-to-content"],[r,o]=w.useState(!1);return w.useEffect(()=>{let i=!1;const s=setInterval(()=>{const{renderingShapes:a}=t,c=a.filter(d=>d.isInViewport).length===0&&t.shapesArray.length>0;i!==c&&(o(c),i=c)},1e3);return()=>{clearInterval(s)}},[t]),r?f.jsx(me,{iconLeft:n.icon,label:n.label,onClick:()=>{n.onSelect("helper-buttons"),o(!1)}}):null}let QE=0;function Eq(t,e){const n=Array(e),r=Math.floor(Math.sqrt(e));for(let o=0;o<e;o++)QE++,n[o]={id:t.createShapeId("box"+QE),type:"geo",x:o%r*132,y:Math.floor(o/r)*132};t.batch(()=>{t.createShapes(n).setSelectedIds(n.map(o=>o.id))})}const Pq=w.memo(function({renderDebugMenuItems:e}){const n=Be();return f.jsxs("div",{className:"tlui-debug-panel",children:[f.jsx(_q,{}),f.jsx(Iq,{}),f.jsxs(Bi,{id:"debug",children:[f.jsx(Cu,{children:f.jsx(me,{icon:"dots-horizontal",title:n("debug-panel.more")})}),f.jsx(zi,{side:"top",align:"end",alignOffset:0,children:f.jsx(Cq,{renderDebugMenuItems:e})})]})]})}),_q=Me(function(){const e=Z();return f.jsx("div",{className:"tlui-debug-panel__current-state",children:e.root.path.value})}),Iq=function(){const e=Z(),n=ge("rendering shapes count",()=>e.renderingShapes.length,[e]);return f.jsxs("div",{children:[n," Shapes"]})};function Cq({renderDebugMenuItems:t}){const e=Z(),{addToast:n}=_o(),{addDialog:r}=Ws(),[o,i]=w.useState(!1);return f.jsxs(f.Fragment,{children:[f.jsxs(Ui,{children:[f.jsx(gn,{onClick:()=>{n({id:_t(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!"})},children:f.jsx("span",{children:"Show toast"})}),f.jsx(gn,{onClick:()=>{r({component:({onClose:s})=>f.jsx(kq,{displayDontShowAgain:!0,onCancel:()=>{s()},onContinue:()=>{s()}}),onClose:()=>{}})},children:f.jsx("span",{children:"Show dialog"})}),f.jsx(gn,{onClick:()=>Eq(e,100),children:f.jsx("span",{children:"Create 100 shapes"})}),f.jsx(gn,{onClick:()=>{function s({children:u}){let h=0;if(!u.length)return 0;for(const p of[...u])h++,h+=s(p);return h}const{selectedShapes:a}=e,l=a.length===0?e.renderingShapes:a,c=l.map(u=>document.getElementById(u.id).parentElement);let d=c.length;for(const u of c)d+=s(u);window.alert(`Shapes ${l.length}, DOM nodes:${d}`)},children:f.jsx("span",{children:"Count shapes and nodes"})}),(()=>{if(o)throw Error("oh no!")})(),f.jsx(gn,{onClick:()=>{i(!0)},children:f.jsx("span",{children:"Throw error"})}),f.jsx(gn,{onClick:()=>{GI()},children:f.jsx("span",{children:"Hard reset"})})]}),f.jsxs(Ui,{children:[f.jsx(gn,{onClick:()=>{Gt.peopleMenu.set(!Gt.peopleMenu.value),window.location.reload()},children:f.jsx("span",{children:"Toggle people menu"})}),f.jsx(gn,{onClick:()=>{e.setReadOnly(!e.isReadOnly)},children:f.jsx("span",{children:"Toggle read-only"})})]}),t==null?void 0:t()]})}function kq({title:t="title",body:e="hello hello hello",cancel:n="Cancel",confirm:r="Continue",displayDontShowAgain:o=!1,onCancel:i,onContinue:s}){const[a,l]=w.useState(!1);return f.jsxs(f.Fragment,{children:[f.jsxs(ff,{children:[f.jsx(gf,{children:t}),f.jsx(mf,{})]}),f.jsx(Gc,{style:{maxWidth:350},children:e}),f.jsxs(Jw,{className:"tlui-dialog__footer__actions",children:[o&&f.jsx(me,{onClick:()=>l(!a),iconLeft:a?"checkbox-checked":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),f.jsx(me,{onClick:i,children:n}),f.jsx(me,{type:"primary",onClick:async()=>s(),children:r})]})]})}const $q=({id:t,component:e,onClose:n})=>{const{removeDialog:r}=Ws(),o=Tn(),i=w.useCallback(s=>{if(!s){if(n)try{n()}catch(a){console.warn(a)}r(t)}},[t,n,r]);return f.jsx(GW,{onOpenChange:i,defaultOpen:!0,children:f.jsx(qW,{container:o,children:f.jsx(QW,{dir:"ltr",className:"tlui-dialog__overlay",children:f.jsx(ZW,{dir:"ltr",className:"tlui-dialog__content",children:f.jsx(e,{onClose:()=>i(!1)})})})})})};function Tq(){const{dialogs:t}=Ws();return f.jsx(f.Fragment,{children:t.map(e=>f.jsx($q,{...e},e.id))})}const Mq=xe.memo(Tq);function KM(){const t=Z(),{languages:e,currentLanguage:n}=OM(),r=w.useCallback(o=>{t.updateUser({locale:o})},[t]);return f.jsxs(cx,{id:"help menu language",children:[f.jsx(ux,{label:"menu.language","data-direction":"left"}),f.jsx(dx,{sideOffset:-4,children:f.jsx(Ui,{children:e.map(({locale:o,label:i})=>f.jsx(YX,{title:o,checked:o===n,onSelect:()=>r(o),children:f.jsx("span",{children:i})},o))})})]})}const Aq=w.memo(function(){const e=Tn(),n=Be(),[r,o]=yl("help menu");return f.jsx("div",{className:"tlui-help-menu",children:f.jsxs(nM,{dir:"ltr",open:r,onOpenChange:o,modal:!1,children:[f.jsx(Jc,{className:"tlui-button tlui-help-menu__button",dir:"ltr",title:n("help-menu.title"),children:f.jsx(Yn,{icon:"question-mark"})}),f.jsx(lx,{container:e,dir:"ltr",children:f.jsx(rM,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:f.jsx(Rq,{})})})]})})});function Rq(){const t=dq(),e=ii();function n(r){if(e&&!r.readonlyOk)return null;switch(r.type){case"custom":{if(r.id==="LANGUAGE_MENU")return f.jsx(KM,{},"item");break}case"group":return f.jsx(Ui,{size:"small",children:r.children.map(n)},r.id);case"submenu":return f.jsxs(cx,{id:`help menu ${r.id}`,children:[f.jsx(ux,{label:r.label}),f.jsx(dx,{children:r.children.map(n)})]},r.id);case"item":{const{id:o,kbd:i,label:s,onSelect:a,icon:l}=r.actionItem;return f.jsx(gn,{kbd:i,label:s,onClick:()=>a("help-menu"),iconLeft:l},o)}}}return f.jsx(f.Fragment,{children:t.map(n)})}const HM="Popper",[bx,VM]=to(HM),[Lq,WM]=bx(HM),Dq=t=>{const{__scopePopper:e,children:n}=t,[r,o]=w.useState(null);return w.createElement(Lq,{scope:e,anchor:r,onAnchorChange:o},n)},Oq="PopperAnchor",jq=w.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...o}=t,i=WM(Oq,n),s=w.useRef(null),a=qe(e,s);return w.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:w.createElement(He.div,oe({},o,{ref:a}))}),wp="PopperContent",[Nq,ote]=bx(wp),[Bq,zq]=bx(wp,{hasParent:!1,positionUpdateFns:new Set}),Uq=w.forwardRef((t,e)=>{var n,r,o,i,s,a,l,c;const{__scopePopper:d,side:u="bottom",sideOffset:h=0,align:p="center",alignOffset:g=0,arrowPadding:m=0,collisionBoundary:v=[],collisionPadding:x=0,sticky:b="partial",hideWhenDetached:E=!1,avoidCollisions:P=!0,onPlaced:C,...k}=t,$=WM(wp,d),[A,D]=w.useState(null),j=qe(e,We=>D(We)),[Y,V]=w.useState(null),q=rx(Y),F=(n=q==null?void 0:q.width)!==null&&n!==void 0?n:0,X=(r=q==null?void 0:q.height)!==null&&r!==void 0?r:0,ne=u+(p!=="center"?"-"+p:""),ie=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},W=Array.isArray(v)?v:[v],H=W.length>0,G={padding:ie,boundary:W.filter(Kq),altBoundary:H},{reference:Q,floating:le,strategy:De,x:Ie,y:we,placement:Ze,middlewareData:je,update:ze}=bT({strategy:"fixed",placement:ne,whileElementsMounted:xT,middleware:[cT({mainAxis:h+X,alignmentAxis:g}),P?dT({mainAxis:!0,crossAxis:!1,limiter:b==="partial"?hT():void 0,...G}):void 0,P?aT({...G}):void 0,pT({...G,apply:({elements:We,rects:dr,availableWidth:Dr,availableHeight:Rn})=>{const{width:Ji,height:M}=dr.reference,_=We.floating.style;_.setProperty("--radix-popper-available-width",`${Dr}px`),_.setProperty("--radix-popper-available-height",`${Rn}px`),_.setProperty("--radix-popper-anchor-width",`${Ji}px`),_.setProperty("--radix-popper-anchor-height",`${M}px`)}}),Y?ST({element:Y,padding:m}):void 0,Hq({arrowWidth:F,arrowHeight:X}),E?lT({strategy:"referenceHidden"}):void 0].filter(Fq)});nr(()=>{Q($.anchor)},[Q,$.anchor]);const Re=Ie!==null&&we!==null,[Ft,Zt]=YM(Ze),vt=ln(C);nr(()=>{Re&&(vt==null||vt())},[Re,vt]);const kt=(o=je.arrow)===null||o===void 0?void 0:o.x,Lt=(i=je.arrow)===null||i===void 0?void 0:i.y,xn=((s=je.arrow)===null||s===void 0?void 0:s.centerOffset)!==0,[Dt,Kt]=w.useState();nr(()=>{A&&Kt(window.getComputedStyle(A).zIndex)},[A]);const{hasParent:Lr,positionUpdateFns:ht}=zq(wp,d),Pt=!Lr;w.useLayoutEffect(()=>{if(!Pt)return ht.add(ze),()=>{ht.delete(ze)}},[Pt,ht,ze]),nr(()=>{Pt&&Re&&Array.from(ht).reverse().forEach(We=>requestAnimationFrame(We))},[Pt,Re,ht]);const Ht={"data-side":Ft,"data-align":Zt,...k,ref:j,style:{...k.style,animation:Re?void 0:"none",opacity:(a=je.hide)!==null&&a!==void 0&&a.referenceHidden?0:void 0}};return w.createElement("div",{ref:le,"data-radix-popper-content-wrapper":"",style:{position:De,left:0,top:0,transform:Re?`translate3d(${Math.round(Ie)}px, ${Math.round(we)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:Dt,["--radix-popper-transform-origin"]:[(l=je.transformOrigin)===null||l===void 0?void 0:l.x,(c=je.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},w.createElement(Nq,{scope:d,placedSide:Ft,onArrowChange:V,arrowX:kt,arrowY:Lt,shouldHideArrow:xn},Pt?w.createElement(Bq,{scope:d,hasParent:!0,positionUpdateFns:ht},w.createElement(He.div,Ht)):w.createElement(He.div,Ht)))});function Fq(t){return t!==void 0}function Kq(t){return t!==null}const Hq=t=>({name:"transformOrigin",options:t,fn(e){var n,r,o,i,s;const{placement:a,rects:l,middlewareData:c}=e,u=((n=c.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,h=u?0:t.arrowWidth,p=u?0:t.arrowHeight,[g,m]=YM(a),v={start:"0%",center:"50%",end:"100%"}[m],x=((r=(o=c.arrow)===null||o===void 0?void 0:o.x)!==null&&r!==void 0?r:0)+h/2,b=((i=(s=c.arrow)===null||s===void 0?void 0:s.y)!==null&&i!==void 0?i:0)+p/2;let E="",P="";return g==="bottom"?(E=u?v:`${x}px`,P=`${-p}px`):g==="top"?(E=u?v:`${x}px`,P=`${l.floating.height+p}px`):g==="right"?(E=`${-p}px`,P=u?v:`${b}px`):g==="left"&&(E=`${l.floating.width+p}px`,P=u?v:`${b}px`),{data:{x:E,y:P}}}});function YM(t){const[e,n="center"]=t.split("-");return[e,n]}const Vq=Dq,Wq=jq,Yq=Uq,XM="Popover",[GM,ite]=to(XM,[VM]),Sx=VM(),[Xq,vl]=GM(XM),Gq=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:o,onOpenChange:i,modal:s=!1}=t,a=Sx(e),l=w.useRef(null),[c,d]=w.useState(!1),[u=!1,h]=Xi({prop:r,defaultProp:o,onChange:i});return w.createElement(Vq,a,w.createElement(Xq,{scope:e,contentId:Wo(),triggerRef:l,open:u,onOpenChange:h,onOpenToggle:w.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:c,onCustomAnchorAdd:w.useCallback(()=>d(!0),[]),onCustomAnchorRemove:w.useCallback(()=>d(!1),[]),modal:s},n))},qq="PopoverTrigger",Qq=w.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,o=vl(qq,n),i=Sx(n),s=qe(e,o.triggerRef),a=w.createElement(He.button,oe({type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":ZM(o.open)},r,{ref:s,onClick:fe(t.onClick,o.onOpenToggle)}));return o.hasCustomAnchor?a:w.createElement(Wq,oe({asChild:!0},i),a)}),qM="PopoverPortal",[Zq,Jq]=GM(qM,{forceMount:void 0}),eQ=t=>{const{__scopePopover:e,forceMount:n,children:r,container:o}=t,i=vl(qM,e);return w.createElement(Zq,{scope:e,forceMount:n},w.createElement(no,{present:n||i.open},w.createElement(df,{asChild:!0,container:o},r)))},eu="PopoverContent",tQ=w.forwardRef((t,e)=>{const n=Jq(eu,t.__scopePopover),{forceMount:r=n.forceMount,...o}=t,i=vl(eu,t.__scopePopover);return w.createElement(no,{present:r||i.open},i.modal?w.createElement(nQ,oe({},o,{ref:e})):w.createElement(rQ,oe({},o,{ref:e})))}),nQ=w.forwardRef((t,e)=>{const n=vl(eu,t.__scopePopover),r=w.useRef(null),o=qe(e,r),i=w.useRef(!1);return w.useEffect(()=>{const s=r.current;if(s)return qw(s)},[]),w.createElement(Gw,{as:js,allowPinchZoom:!0},w.createElement(QM,oe({},t,{ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:fe(t.onCloseAutoFocus,s=>{var a;s.preventDefault(),i.current||(a=n.triggerRef.current)===null||a===void 0||a.focus()}),onPointerDownOutside:fe(t.onPointerDownOutside,s=>{const a=s.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:fe(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})))}),rQ=w.forwardRef((t,e)=>{const n=vl(eu,t.__scopePopover),r=w.useRef(!1),o=w.useRef(!1);return w.createElement(QM,oe({},t,{ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var s;if((s=t.onCloseAutoFocus)===null||s===void 0||s.call(t,i),!i.defaultPrevented){var a;r.current||(a=n.triggerRef.current)===null||a===void 0||a.focus(),i.preventDefault()}r.current=!1,o.current=!1},onInteractOutside:i=>{var s,a;(s=t.onInteractOutside)===null||s===void 0||s.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const l=i.target;((a=n.triggerRef.current)===null||a===void 0?void 0:a.contains(l))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&o.current&&i.preventDefault()}}))}),QM=w.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:d,...u}=t,h=vl(eu,n),p=Sx(n);return Xw(),w.createElement(Yw,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:i},w.createElement(uf,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:d,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1)},w.createElement(Yq,oe({"data-state":ZM(h.open),role:"dialog",id:h.contentId},p,u,{ref:e,style:{...u.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function ZM(t){return t?"open":"closed"}const oQ=Gq,iQ=Qq,JM=eQ,e3=tQ,Ex=({id:t,children:e,onOpenChange:n})=>{const[r,o]=yl(t,n);return f.jsx(oQ,{onOpenChange:o,open:r,children:f.jsx("div",{className:"tlui-popover",children:e})})},Px=({children:t,disabled:e,"data-wd":n})=>f.jsx(iQ,{"data-wd":n,disabled:e,asChild:!0,dir:"ltr",children:t}),t3=({side:t,children:e,align:n="center",sideOffset:r=8,alignOffset:o=0})=>{const i=Tn();return f.jsx(JM,{dir:"ltr",container:i,children:f.jsx(e3,{className:"tlui-popover__content",side:t,sideOffset:r,align:n,alignOffset:o,dir:"ltr",children:e})})},n3=w.memo(function(){const e=Be(),n=Tn(),r=nq(),o=ii();function i(s){if(o&&!s.readonlyOk)return null;switch(s.type){case"item":{const{id:a,icon:l,label:c,kbd:d,onSelect:u}=s.actionItem;return f.jsx(me,{className:"tlui-button-grid__button","data-wd":`menu-item.${s.id}`,icon:l,title:c?d?`${e(c)} ${xo(d)}`:`${e(c)}`:d?`${xo(d)}`:"",onClick:()=>u("actions-menu"),disabled:s.disabled},a)}}}return f.jsxs(Ex,{id:"actions menu",children:[f.jsx(Px,{children:f.jsx(me,{className:"tlui-menu__trigger","data-wd":"main.action-menu",icon:"dots-vertical",title:e("actions-menu.title"),smallIcon:!0})}),f.jsx(JM,{dir:"ltr",container:n,children:f.jsx(e3,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:f.jsx("div",{className:"tlui-actions-menu tlui-button-grid__four",children:r.map(i)})})})]})}),r3=Me(function(){const e=Z(),n=An(),r=Be(),o=n.duplicate,i=e.selectedIds.length<=0;return f.jsx(me,{icon:o.icon,onClick:()=>o.onSelect("quick-actions"),disabled:i,title:`${r(o.label)} ${xo(o.kbd)}`,smallIcon:!0})}),sQ=w.memo(function(){const e=Be();return f.jsxs(Bi,{id:"main menu",children:[f.jsx(Cu,{children:f.jsx(me,{className:"tlui-menu__trigger","data-wd":"main.menu",title:e("menu.title"),icon:"menu"})}),f.jsx(zi,{alignOffset:0,sideOffset:6,children:f.jsx(aQ,{})})]})});function aQ(){const t=Z(),e=Be(),n=pq(),r=Rr(),o=ii(),{paste:i}=gx("menu");function s(a,l,c,d){switch(l.type){case"custom":return o&&!l.readonlyOk?null:l.id==="LANGUAGE_MENU"?f.jsx(KM,{},"item"):l.id==="MENU_PASTE"?f.jsx(gn,{"data-wd":`menu-item.${l.id}`,kbd:"$v",label:"action.paste",disabled:l.disabled,onMouseDown:()=>{var u;a.isSafari&&((u=navigator.clipboard)!=null&&u.read)&&navigator.clipboard.read().then(h=>{i(h)})},onClick:()=>{var u;a.isSafari||(u=navigator.clipboard)!=null&&u.read&&navigator.clipboard.read().then(h=>{i(h)})},onPointerUp:Ve},l.id):null;case"group":return o&&!l.readonlyOk?null:f.jsx(Ui,{size:d<=1?"medium":r<3||(c==null?void 0:c.type)==="submenu"&&d>2?"tiny":"medium",children:l.children.map(u=>s(a,u,l,d+1))},l.id);case"submenu":return o&&!l.readonlyOk?null:f.jsxs(cx,{id:`main menu ${c?c.id+" ":""}${l.id}`,children:[f.jsx(ux,{label:l.label,"data-wd":`menu-item.${l.id}`}),f.jsx(dx,{sideOffset:-4,alignOffset:-1,children:l.children.map(u=>s(a,u,l,d+1))})]},l.id);case"item":{if(o&&!l.readonlyOk)return null;const{id:u,checkbox:h,menuLabel:p,label:g,onSelect:m,kbd:v}=l.actionItem,x=p??g,b=x?e(x):void 0;return h?f.jsxs(WX,{onSelect:()=>m("menu"),title:b||"",checked:l.checked,disabled:l.disabled,children:[b&&f.jsx("span",{children:b}),v&&f.jsx(pf,{children:v})]},u):f.jsx(gn,{"data-wd":`menu-item.${l.id}`,kbd:v,label:x,onClick:()=>m("menu"),disabled:l.disabled},u)}}}return f.jsx(f.Fragment,{children:n.map(a=>s(t,a,null,0))})}const lQ=function({name:e,id:n,isCurrentPage:r}){const o=Z(),i=w.useRef(null),s=w.useCallback(l=>{o.renamePage(n,l||"New Page",!0)},[o,n]),a=w.useCallback(l=>{o.mark("rename page"),o.renamePage(n,l||"New Page",!1)},[o,n]);return f.jsx(px,{className:"tlui-page-menu__item__input",ref:l=>i.current=l,defaultValue:e,onValueChange:s,onComplete:a,onCancel:a,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:r,autoselect:!0})},T0=(t,e,n,r)=>{let o;const i=t.pages,s=n>r?i[r-1]:i[r],a=n>r?i[r]:i[r+1];s&&!a?o=Oo(s.index):!s&&a?o=MF(i[0].index):o=oc(s.index,a.index),o!==i[n].index&&(t.mark("moving page"),t.updatePage({id:e,index:o}))},ZE=Me(function({index:e,listSize:n,item:r,onRename:o}){const i=Z(),s=Be(),a=i.pages,l=w.useCallback(()=>{i.mark("creating page");const h=it.createId();i.duplicatePage(r.id,h)},[i,r]),c=w.useCallback(()=>{T0(i,r.id,e,e-1)},[i,r,e]),d=w.useCallback(()=>{T0(i,r.id,e,e+1)},[i,r,e]),u=w.useCallback(()=>{i.mark("deleting page"),i.deletePage(r.id)},[i,r]);return f.jsxs(Bi,{id:"page item submenu",children:[f.jsx(Cu,{children:f.jsx(me,{title:s("page-menu.submenu.title"),icon:"dots-vertical"})}),f.jsxs(zi,{alignOffset:0,children:[f.jsxs(Ui,{children:[o&&f.jsx(ha,{dir:"ltr",onSelect:o,asChild:!0,children:f.jsx(me,{className:"tlui-menu__button",label:"page-menu.submenu.rename"})}),f.jsx(ha,{dir:"ltr",onSelect:l,disabled:a.length>=Mh,asChild:!0,children:f.jsx(me,{className:"tlui-menu__button",label:"page-menu.submenu.duplicate-page"})}),e>0&&f.jsx(ha,{dir:"ltr",onSelect:c,asChild:!0,children:f.jsx(me,{className:"tlui-menu__button",label:"page-menu.submenu.move-up"})}),e<n-1&&f.jsx(ha,{dir:"ltr",onSelect:d,asChild:!0,children:f.jsx(me,{className:"tlui-menu__button",label:"page-menu.submenu.move-down"})})]}),n>1&&f.jsx(Ui,{children:f.jsx(ha,{dir:"ltr",onSelect:u,asChild:!0,children:f.jsx(me,{className:"tlui-menu__button",label:"page-menu.submenu.delete"})})})]})]})}),cQ=function(){const e=Z(),n=Be(),r=Rr(),o=r<5?36:40,i=w.useRef(null),s=ge("pages",()=>e.pages,[e]),a=ge("currentPage",()=>e.currentPage,[e]),l=ge("isReadonlyMode",()=>e.isReadOnly,[e]),c=ge("maxPageCountReached",()=>e.pages.length>=Mh,[e]),d=ge("isCoarsePointer",()=>e.isCoarsePointer,[e]),[u,h]=w.useState(!1),p=w.useCallback(()=>{l||h(D=>!D)},[l]),[g,m]=w.useState(!1),v=w.useCallback(D=>{m(D),h(!1)},[]),x=w.useRef({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[b,E]=w.useState(Object.fromEntries(s.map((D,j)=>[D.id,{y:j*o,offsetY:0,isSelected:!1}])));w.useLayoutEffect(()=>{E(Object.fromEntries(s.map((D,j)=>[D.id,{y:j*o,offsetY:0,isSelected:!1}])))},[o,s]),w.useEffect(()=>{g&&requestAnimationFrame(()=>{const D=document.querySelector(`[data-wd="page-menu-item-${a.id}"]`);if(D){const j=i.current;if(!j)return;const Y=D.offsetTop,V=j.scrollTop;Y<V&&j.scrollTo({top:Y});const q=Y+o,F=j.scrollTop+j.offsetHeight;q>F&&j.scrollTo({top:q-j.offsetHeight})}})},[o,a,g]);const P=w.useCallback(D=>{const{clientY:j,currentTarget:Y}=D,{dataset:{id:V,index:q}}=Y;if(!V||!q)return;const F=x.current;D.currentTarget.setPointerCapture(D.pointerId),F.status="pointing",F.pointing={id:V,index:+q};const ne=b[V].y;F.startY=j,F.startIndex=Math.max(0,Math.min(Math.round(ne/o),s.length-1))},[o,s.length,b]),C=w.useCallback(D=>{const j=x.current;if(j.status==="pointing"){const{clientY:Y}=D,V=Y-j.startY;Math.abs(V)>5&&(j.status="dragging")}if(j.status==="dragging"){const{clientY:Y}=D,V=Y-j.startY,q=b[j.pointing.id],{startIndex:F,pointing:X}=j,ne=q.y+V,ie=Math.max(0,Math.min(Math.round(ne/o),s.length-1)),W={...b};if(W[X.id]={y:q.y,offsetY:V,isSelected:!0},ie!==j.dragIndex){j.dragIndex=ie;for(let H=0;H<s.length;H++){const G=s[H];if(G.id===j.pointing.id)continue;let{y:Q}=W[G.id];ie===F?Q=H*o:ie<F?ie<=H&&H<F?Q=(H+1)*o:Q=H*o:ie>F&&(ie>=H&&H>F?Q=(H-1)*o:Q=H*o),Q!==W[G.id].y&&(W[G.id]={y:Q,offsetY:0,isSelected:!0})}}E(W)}},[o,s,b]),k=w.useCallback(D=>{const j=x.current;if(j.status==="dragging"){const{id:Y,index:V}=j.pointing;T0(e,Y,V,j.dragIndex)}D.currentTarget.releasePointerCapture(D.pointerId),j.status="idle"},[e]),$=w.useCallback(D=>{const j=x.current;D.key==="Escape"&&(j.status==="dragging"&&E(Object.fromEntries(s.map((Y,V)=>[Y.id,{y:V*o,offsetY:0,isSelected:!1}]))),j.status="idle")},[o,s]),A=w.useCallback(()=>{if(l)return;e.mark("creating page");const D=it.createId();e.createPage(n("page-menu.new-page-initial-name"),D),h(!0)},[e,n,l]);return f.jsxs(Ex,{id:"page menu",onOpenChange:v,open:g,children:[f.jsx(Px,{children:f.jsx(me,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-wd":"main.page-menu",icon:"chevron-down",title:a.name,children:f.jsx("div",{className:"tlui-page-menu__name",children:a.name})})}),f.jsx(t3,{side:"bottom",align:"start",sideOffset:6,children:f.jsxs("div",{className:"tlui-page-menu__wrapper",children:[f.jsxs("div",{className:"tlui-page-menu__header",children:[f.jsx("div",{className:"tlui-page-menu__header__title",children:n("page-menu.title")}),!l&&f.jsxs(f.Fragment,{children:[f.jsx(me,{"data-wd":"page-menu.edit",title:n(u?"page-menu.edit-done":"page-menu.edit-start"),icon:u?"check":"edit",onClick:p}),f.jsx(me,{"data-wd":"page-menu.create",icon:"plus",title:n(c?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:c,onClick:A})]})]}),f.jsx("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:o*s.length+4},ref:i,children:s.map((D,j)=>{const Y=b[D.id]??{position:j*40,offsetY:0};return u?f.jsxs("div",{"data-wd":`page-menu-item-${D.id}`,className:"tlui-page_menu__item__sortable",style:{zIndex:D.id===a.id?888:j,transform:`translate(0px, ${Y.y+Y.offsetY}px)`},children:[f.jsx(me,{tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:P,onPointerUp:k,onPointerMove:C,onKeyDown:$,"data-id":D.id,"data-index":j}),r<5&&d?f.jsx(me,{className:"tlui-page-menu__item__button",onClick:()=>{const V=window.prompt("Rename page",D.name);V&&V!==D.name&&e.renamePage(D.id,V)},onDoubleClick:p,isChecked:D.id===a.id,children:f.jsx("span",{children:D.name})}):f.jsx("div",{id:`page-menu-item-${D.id}`,"data-wd":`page-menu-item-${D.id}`,className:"tlui-page_menu__item__sortable__title",style:{height:o},children:f.jsx(lQ,{id:D.id,name:D.name,isCurrentPage:D.id===a.id})}),!l&&f.jsx("div",{className:"tlui-page_menu__item__submenu","data-isediting":u,children:f.jsx(ZE,{index:j,item:D,listSize:s.length})})]},D.id+"_editing"):f.jsxs("div",{"data-wd":`page-menu-item-${D.id}`,className:"tlui-page-menu__item",children:[f.jsxs(me,{className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:()=>e.setCurrentPageId(D.id),onDoubleClick:p,isChecked:D.id===a.id,title:n("page-menu.go-to-page"),children:[f.jsx("div",{className:"tlui-page-menu__item__button__check",children:D.id===a.id&&f.jsx(Yn,{icon:"check"})}),f.jsx("span",{children:D.name})]}),!l&&f.jsx("div",{className:"tlui-page_menu__item__submenu",children:f.jsx(ZE,{index:j,item:D,listSize:s.length,onRename:()=>{if(e.isIos){const V=window.prompt("Rename page",D.name);V&&V!==D.name&&e.renamePage(D.id,V)}else h(!0),e.setCurrentPageId(D.id)}})})]},D.id)})})]})})]})},o3=w.memo(function(){const e=Be(),n=NM(),o=An().redo;return f.jsx(me,{"data-wd":"main.redo",icon:o.icon,title:`${e(o.label)} ${xo(o.kbd)}`,disabled:!n,onClick:()=>o.onSelect("quick-actions"),smallIcon:!0})}),i3=Me(function(){const e=Z(),n=An(),r=Be(),o=n.delete;if(ii())return null;const s=e.selectedIds.length<=0;return f.jsx(me,{icon:o.icon,onClick:()=>o.onSelect("quick-actions"),disabled:s,title:`${r(o.label)} ${xo(o.kbd)}`,smallIcon:!0})}),s3=w.memo(function(){const e=Be(),n=BM(),o=An().undo;return f.jsx(me,{"data-wd":"main.undo",icon:o.icon,title:`${e(o.label)} ${xo(o.kbd)}`,disabled:!n,onClick:()=>o.onSelect("quick-actions"),smallIcon:!0})}),uQ=Me(function(){const e=Z(),n=Rr(),o=!ii()&&!e.isInAny("hand","zoom","eraser");return f.jsx("div",{className:"tlui-menu-zone",children:f.jsxs("div",{className:"tlui-menu-zone__controls",children:[f.jsx(sQ,{}),f.jsx("div",{className:"tlui-menu-zone__divider"}),f.jsx(cQ,{}),n>=5&&o&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"tlui-menu-zone__divider"}),f.jsx(s3,{}),f.jsx(o3,{}),f.jsx(i3,{}),f.jsx(r3,{}),f.jsx(n3,{})]})]})})});function dQ(t,e){const[n,r]=xe.useState(e);xe.useLayoutEffect(()=>{const i=localStorage.getItem(t);if(i)try{r(JSON.parse(i))}catch{console.error(`Could not restore value ${t} from local storage.`)}},[t]);const o=xe.useCallback(i=>{r(s=>{const a=typeof i=="function"?i(s):i;return localStorage.setItem(t,JSON.stringify(a)),a})},[t]);return[n,o]}class yc{constructor(e,n){y(this,"colors",{shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"});y(this,"id",_t());y(this,"cvs",null);y(this,"pageBounds",[]);y(this,"collaborators",[]);y(this,"canvasScreenBounds",new de);y(this,"canvasPageBounds",new de);y(this,"contentPageBounds",new de);y(this,"contentScreenBounds",new de);y(this,"originPagePoint",new I);y(this,"originPageCenter",new I);y(this,"isInViewport",!1);y(this,"debug",!1);y(this,"updateContentScreenBounds",()=>{const{contentScreenBounds:e,contentPageBounds:n,canvasScreenBounds:r}=this;let{x:o,y:i,w:s,h:a}=e;if(n.w>n.h){const l=r.w/(n.w/n.h);l>r.h?(o=(r.w-r.w*(r.h/l))/2,i=0,s=r.w*(r.h/l),a=r.h):(o=0,i=(r.h-l)/2,s=r.w,a=l)}else if(n.w<n.h){const l=r.h/(n.h/n.w);o=(r.w-l)/2,i=0,s=l,a=r.h}else o=r.h/2,i=0,s=r.h,a=r.h;e.set(o,i,s,a)});y(this,"updateCanvasPageBounds",()=>{const{canvasPageBounds:e,canvasScreenBounds:n,contentPageBounds:r,contentScreenBounds:o}=this;e.set(0,0,r.width/(o.width/n.width),r.height/(o.height/n.height)),e.center=r.center});y(this,"getScreenPoint",(e,n)=>{const{canvasScreenBounds:r}=this,o=(e-r.minX)*this.dpr,i=(n-r.minY)*this.dpr;return{x:o,y:i}});y(this,"getPagePoint",(e,n)=>{const{contentPageBounds:r,contentScreenBounds:o,canvasPageBounds:i}=this,{x:s,y:a}=this.getScreenPoint(e,n);return{x:i.minX+s*r.width/o.width,y:i.minY+a*r.height/o.height,z:1}});y(this,"minimapScreenPointToPagePoint",(e,n,r=!1,o=!1)=>{const{app:i}=this,{viewportPageBounds:s}=i;let{x:a,y:l}=this.getPagePoint(e,n);if(o){const c=this.app.allShapesCommonBounds,d=s,u=((c==null?void 0:c.minX)??0)-d.width/2,h=((c==null?void 0:c.maxX)??0)+d.width/2,p=((c==null?void 0:c.minY)??0)-d.height/2,g=((c==null?void 0:c.maxY)??0)+d.height/2,m=Math.max(0,u+d.width-a),v=Math.max(0,-(h-d.width-a)),x=Math.max(0,p+d.height-l),b=Math.max(0,-(g-d.height-l)),E=Math.max(0,m-v),P=Math.max(0,v-m),C=Math.max(0,x-b),k=Math.max(0,b-x);E&&E>P?a+=E/2:P&&(a-=P/2),C&&C>k?l+=C/2:k&&(l-=k/2),a=Vr(a,u,h),l=Vr(l,p,g)}if(r){const{originPagePoint:c}=this,d=Math.abs(a-c.x),u=Math.abs(l-c.y);d>u?l=c.y:a=c.x}return{x:a,y:l}});y(this,"render",()=>{const{cvs:e,pageBounds:n}=this;this.updateCanvasPageBounds();const{app:r,canvasScreenBounds:o,canvasPageBounds:i,contentPageBounds:s,contentScreenBounds:a}=this,{width:l,height:c}=o,{viewportPageBounds:d,selectedIds:u}=r;if(!e||!n)return;const h=e.getContext("2d");if(!h)throw new Error("Minimap (shapes): Could not get context");h.resetTransform(),h.globalAlpha=1,h.clearRect(0,0,l,c);const p=a.width/s.width,g=a.height/s.height;h.translate((l-a.width)/2,(c-a.height)/2),h.scale(p,g),h.translate(-s.minX,-s.minY);const m=8/p,v=8/p,x=1/p,b=1/p,E=m/4,P=v/4,C=new Path2D,k=new Path2D,{shapeFill:$,selectFill:A,viewportFill:D}=this.colors;let j;for(let X=0,ne=n.length;X<ne;X++)j=n[X],yc.roundedRect(u.includes(j.id)?k:C,j.minX,j.minY,j.width,j.height,Vr(m,x,j.width/E),Vr(v,b,j.height/P));if(h.fillStyle=$,h.fill(C),h.fillStyle=A,h.fill(k),this.debug){const X=de.Common(n),{minX:ne,minY:ie,width:W,height:H}=X;h.strokeStyle="green",h.lineWidth=2/p,h.strokeRect(ne+1/p,ie+1/g,W-2/p,H-2/g)}{const{brush:X}=r;if(X){const{x:ne,y:ie,w:W,h:H}=X;h.beginPath(),yc.sharpRect(h,ne,ie,W,H),h.closePath(),h.fillStyle=D,h.fill()}}{const{minX:X,minY:ne,width:ie,height:W}=d;h.beginPath();const H=12/p,G=12/p;yc.roundedRect(h,X,ne,ie,W,Math.min(ie/4,H),Math.min(W/4,G)),h.closePath(),h.fillStyle=D,h.fill(),this.debug&&(h.strokeStyle="orange",h.strokeRect(X+1/p,ne+1/g,ie-2/p,W-2/g))}const Y=2.5/p,V=2.5/g,{currentPageId:q}=r;let F;for(let X=0;X<this.collaborators.length;X++){F=this.collaborators[X];const ne=F.lastUsedInstanceId?r.store.get(F.lastUsedInstanceId):null;(ne==null?void 0:ne.currentPageId)===q&&(h.beginPath(),h.ellipse(Vr(F.cursor.x,i.minX+Y,i.maxX-Y),Vr(F.cursor.y,i.minY+V,i.maxY-V),5/p,5/g,0,0,dt),h.fillStyle=F.color,h.fill())}if(this.debug){h.lineWidth=2/p;{const{minX:X,minY:ne,width:ie,height:W}=s;h.strokeStyle="red",h.strokeRect(X+1/p,ne+1/g,ie-2/p,W-2/g)}{const{minX:X,minY:ne,width:ie,height:W}=i;h.strokeStyle="blue",h.strokeRect(X+1/p,ne+1/g,ie-2/p,W-2/g)}}});this.app=e,this.dpr=n}setDpr(e){this.dpr=+e.toFixed(2)}static roundedRect(e,n,r,o,i,s,a){if(s<1&&a<1){e.rect(n,r,o,i);return}e.moveTo(n+s,r),e.lineTo(n+o-s,r),e.quadraticCurveTo(n+o,r,n+o,r+a),e.lineTo(n+o,r+i-a),e.quadraticCurveTo(n+o,r+i,n+o-s,r+i),e.lineTo(n+s,r+i),e.quadraticCurveTo(n,r+i,n,r+i-a),e.lineTo(n,r+a),e.quadraticCurveTo(n,r,n+s,r)}static sharpRect(e,n,r,o,i,s,a){e.rect(n,r,o,i)}}const hQ=1e4,pQ=()=>{const t=Z(),e=zI("time",Date.now());return w.useEffect(()=>{const n=setInterval(()=>e.set(Date.now()),5e3);return()=>clearInterval(n)},[e]),w.useMemo(()=>t.store.query.records("user_presence",()=>({lastActivityTimestamp:{gt:e.value-hQ},userId:{neq:t.userId}})),[t,e])},fQ=Me(function({shapeFill:e,selectFill:n,viewportFill:r}){const o=Z(),i=w.useRef(null),s=Tn(),a=w.useRef(!1),l=w.useMemo(()=>new yc(o,o.devicePixelRatio),[o]),c=o.userDocumentSettings.isDarkMode;w.useEffect(()=>{const v=requestAnimationFrame(()=>{const x=getComputedStyle(s);l.colors={shapeFill:x.getPropertyValue(e).trim(),selectFill:x.getPropertyValue(n).trim(),viewportFill:x.getPropertyValue(r).trim()},l.render()});return()=>{cancelAnimationFrame(v)}},[s,n,e,r,l,c]);const d=w.useCallback(v=>{if(!o.shapeIds.size)return;const{x,y:b}=l.minimapScreenPointToPagePoint(v.clientX,v.clientY,!1,!1),E=l.minimapScreenPointToPagePoint(v.clientX,v.clientY,!1,!0);l.originPagePoint.setTo(E),l.originPageCenter.setTo(o.viewportPageBounds.center),o.centerOnPoint(x,b,{duration:No})},[o,l]),u=w.useCallback(v=>{if(v.currentTarget.setPointerCapture(v.pointerId),!o.shapeIds.size)return;a.current=!0,l.isInViewport=!1;const{x,y:b}=l.minimapScreenPointToPagePoint(v.clientX,v.clientY,!1,!1),E=l.minimapScreenPointToPagePoint(v.clientX,v.clientY,!1,!0),P=o.viewportPageBounds;l.originPagePoint.setTo(E),l.originPageCenter.setTo(P.center),l.isInViewport=P.containsPoint(E),l.isInViewport||o.centerOnPoint(x,b,{duration:No})},[o,l]),h=w.useCallback(v=>{if(a.current){const{x:P,y:C}=l.minimapScreenPointToPagePoint(v.clientX,v.clientY,v.shiftKey,!0);if(l.isInViewport){const k=I.Sub({x:P,y:C},l.originPagePoint),$=I.Add(l.originPageCenter,k);o.centerOnPoint($.x,$.y);return}o.centerOnPoint(P,C)}const x=l.getPagePoint(v.clientX,v.clientY),b=o.pageToScreen(x.x,x.y),E={type:"pointer",target:"canvas",name:"pointer_move",...gQ(v),point:b,isPen:o.isPenMode};o.dispatch(E)},[o,l]),p=w.useCallback(v=>{a.current=!1},[]),g=w.useCallback(v=>{const x=y2(v);o.dispatch({type:"wheel",name:"wheel",delta:x,shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey})},[o]);Ps("update dpr",()=>{const{devicePixelRatio:v}=o;l.setDpr(v);const x=i.current,b=x.getBoundingClientRect(),E=b.width*v,P=b.height*v;x.width=E,x.height=P,l.canvasScreenBounds.set(b.x,b.y,E,P),l.cvs=i.current},[o,l]);const m=pQ();return Ps("minimap render when pagebounds or collaborators changes",()=>{const{devicePixelRatio:v,viewportPageBounds:x,allShapesCommonBounds:b}=o;l.contentPageBounds=b?de.Expand(b,x):x,l.updateContentScreenBounds();const E=[];o.shapeIds.forEach(P=>{let C=o.getPageBoundsById(P);const k=o.getPageMaskById(P);if(k){const $=dy(k,C.corners);if(!$)return;C=de.FromPoints($)}C&&(C.id=P,E.push(C))}),l.pageBounds=E,l.collaborators=m.value,l.render()},[o,l]),f.jsx("div",{className:"tlui-minimap",children:f.jsx("canvas",{ref:i,className:"tlui-minimap__canvas",onDoubleClick:d,onPointerMove:h,onPointerDown:u,onPointerUp:p,onWheel:g})})});function gQ(t){return t.isKilled=!0,{point:{x:t.clientX,y:t.clientY,z:t.pressure},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:t.pointerId,button:t.button,isPen:t.pointerType==="pen"}}const mm=Me(function(){const e=Z(),n=Be(),r=Rr(),o=e.zoomLevel,i=e.shapeIds.size>0,s=e.selectedIds.length>0,a=e.zoomLevel===1,l=w.useCallback(()=>{e.resetZoom(e.viewportScreenCenter,{duration:No})},[e]);return f.jsxs(Bi,{id:"zoom",children:[f.jsx(Cu,{children:f.jsx(me,{title:`${n("navigation-zone.zoom")}`,"data-wd":"minimap.zoom-menu",className:r<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:l,icon:r<4?"zoom-in":void 0,children:r<4?null:f.jsxs("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(o*100),"%"]})})}),f.jsx(zi,{side:"top",align:"start",alignOffset:0,children:f.jsxs(Ui,{children:[f.jsx(Kl,{action:"zoom-in","data-wd":"minimap.zoom-menu.zoom-in",noClose:!0}),f.jsx(Kl,{action:"zoom-out","data-wd":"minimap.zoom-menu.zoom-out",noClose:!0}),f.jsx(Kl,{action:"zoom-to-100","data-wd":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:a}),f.jsx(Kl,{action:"zoom-to-fit",disabled:!i,"data-wd":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),f.jsx(Kl,{action:"zoom-to-selection",disabled:!s,"data-wd":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})});function Kl(t){const{action:e,disabled:n=!1,noClose:r=!1}=t,o=An();return f.jsx(gn,{label:o[e].label,kbd:o[e].kbd,"data-wd":t["data-wd"],onClick:()=>o[e].onSelect("zoom-menu"),noClose:r,disabled:n})}const mQ=w.memo(function(){const e=An(),n=Be(),r=Rr(),[o,i]=dQ("minimap",!0),s=w.useCallback(()=>{i(a=>!a)},[i]);return r<4?null:f.jsxs("div",{className:"tlui-navigation-zone",children:[f.jsx("div",{className:"tlui-navigation-zone__controls",children:r<6?f.jsx(mm,{}):o?f.jsxs(f.Fragment,{children:[f.jsx(mm,{}),f.jsx(me,{title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle","data-wd":"minimap.toggle",onClick:s,icon:o?"chevrons-ne":"chevrons-sw"})]}):f.jsxs(f.Fragment,{children:[f.jsx(me,{icon:"minus","data-wd":"minimap.zoom-out",title:`${n(e["zoom-out"].label)} ${xo(e["zoom-out"].kbd)}`,onClick:()=>e["zoom-out"].onSelect("navigation-zone")}),f.jsx(mm,{}),f.jsx(me,{icon:"plus","data-wd":"minimap.zoom-in",title:`${n(e["zoom-in"].label)} ${xo(e["zoom-in"].kbd)}`,onClick:()=>e["zoom-in"].onSelect("navigation-zone")}),f.jsx(me,{title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:s,icon:o?"chevrons-ne":"chevrons-sw"})]})}),r>=6&&!o&&f.jsx(fQ,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})}),yQ=Me(function(){const n=Z().isPenMode,r=An();if(!n)return null;const o=r["exit-pen-mode"];return f.jsx(me,{label:o.label,iconLeft:o.icon,onClick:()=>o.onSelect("helper-buttons")})}),vQ=Me(function(){const e=Z(),n=An();if(!e.instanceState.followingUserId)return null;const r=n["stop-following"];return f.jsx(me,{label:r.label,iconLeft:r.icon,onClick:()=>r.onSelect("people-menu")})});function wQ(t){const{items:e,title:n,styleType:r,value:o=null,onValueChange:i,columns:s=Vr(e.length,2,4)}=t,a=Z(),l=Be(),c=w.useRef(!1),{handleButtonClick:d,handleButtonPointerDown:u,handleButtonPointerEnter:h,handleButtonPointerUp:p}=w.useMemo(()=>{const g=()=>{c.current=!1,window.removeEventListener("pointerup",g)};return{handleButtonClick:E=>{const{id:P}=E.currentTarget.dataset;o!==P&&(a.mark("point picker item"),i(e.find(C=>C.id===P),!1))},handleButtonPointerDown:E=>{const{id:P}=E.currentTarget.dataset;a.mark("point picker item"),i(e.find(C=>C.id===P),!0),c.current=!0,window.addEventListener("pointerup",g)},handleButtonPointerEnter:E=>{if(!c.current)return;const{id:P}=E.currentTarget.dataset;i(e.find(C=>C.id===P),!0)},handleButtonPointerUp:E=>{const{id:P}=E.currentTarget.dataset;i(e.find(C=>C.id===P),!1)}}},[a,o,i,e]);return f.jsx("div",{className:Se("tlui-button-grid",{"tlui-button-grid__two":s===2,"tlui-button-grid__three":s===3,"tlui-button-grid__four":s===4}),children:e.map(g=>f.jsx(me,{"data-id":g.id,"data-wd":`${t["data-wd"]}.${g.id}`,"aria-label":g.id,"data-state":o===g.id?"hinted":void 0,title:n+" — "+l(`${r}-style.${g.id}`),className:Se("tlui-button-grid__button"),style:g.type==="color"?{color:`var(--palette-${g.id})`}:void 0,onPointerEnter:h,onPointerDown:u,onPointerUp:p,onClick:d,icon:g.icon},g.id))})}const ka=w.memo(wQ);function xQ(t,[e,n]){return Math.min(n,Math.max(e,t))}function bQ(t){const e=w.useRef({value:t,previous:t});return w.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}const a3=["PageUp","PageDown"],l3=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],c3={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ku="Slider",[M0,SQ,EQ]=yf(ku),[u3,ste]=to(ku,[EQ]),[PQ,_f]=u3(ku),_Q=w.forwardRef((t,e)=>{const{name:n,min:r=0,max:o=100,step:i=1,orientation:s="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:d,onValueChange:u=()=>{},onValueCommit:h=()=>{},inverted:p=!1,...g}=t,[m,v]=w.useState(null),x=qe(e,F=>v(F)),b=w.useRef(new Set),E=w.useRef(0),P=s==="horizontal",C=m?!!m.closest("form"):!0,k=P?IQ:CQ,[$=[],A]=Xi({prop:d,defaultProp:c,onChange:F=>{var X;(X=[...b.current][E.current])===null||X===void 0||X.focus(),u(F)}}),D=w.useRef($);function j(F){const X=OQ($,F);q(F,X)}function Y(F){q(F,E.current)}function V(){const F=D.current[E.current];$[E.current]!==F&&h($)}function q(F,X,{commit:ne}={commit:!1}){const ie=zQ(i),W=UQ(Math.round((F-r)/i)*i+r,ie),H=xQ(W,[r,o]);A((G=[])=>{const Q=LQ(G,H,X);if(BQ(Q,l*i)){E.current=Q.indexOf(H);const le=String(Q)!==String(G);return le&&ne&&h(Q),le?Q:G}else return G})}return w.createElement(PQ,{scope:t.__scopeSlider,disabled:a,min:r,max:o,valueIndexToChangeRef:E,thumbs:b.current,values:$,orientation:s},w.createElement(M0.Provider,{scope:t.__scopeSlider},w.createElement(M0.Slot,{scope:t.__scopeSlider},w.createElement(k,oe({"aria-disabled":a,"data-disabled":a?"":void 0},g,{ref:x,onPointerDown:fe(g.onPointerDown,()=>{a||(D.current=$)}),min:r,max:o,inverted:p,onSlideStart:a?void 0:j,onSlideMove:a?void 0:Y,onSlideEnd:a?void 0:V,onHomeKeyDown:()=>!a&&q(r,0,{commit:!0}),onEndKeyDown:()=>!a&&q(o,$.length-1,{commit:!0}),onStepKeyDown:({event:F,direction:X})=>{if(!a){const W=a3.includes(F.key)||F.shiftKey&&l3.includes(F.key)?10:1,H=E.current,G=$[H],Q=i*W*X;q(G+Q,H,{commit:!0})}}})))),C&&$.map((F,X)=>w.createElement(RQ,{key:X,name:n?n+($.length>1?"[]":""):void 0,value:F})))}),[d3,h3]=u3(ku,{startEdge:"left",endEdge:"right",size:"width",direction:1}),IQ=w.forwardRef((t,e)=>{const{min:n,max:r,dir:o,inverted:i,onSlideStart:s,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...d}=t,[u,h]=w.useState(null),p=qe(e,E=>h(E)),g=w.useRef(),m=ex(o),v=m==="ltr",x=v&&!i||!v&&i;function b(E){const P=g.current||u.getBoundingClientRect(),C=[0,P.width],$=_x(C,x?[n,r]:[r,n]);return g.current=P,$(E-P.left)}return w.createElement(d3,{scope:t.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width"},w.createElement(p3,oe({dir:m,"data-orientation":"horizontal"},d,{ref:p,style:{...d.style,["--radix-slider-thumb-transform"]:"translateX(-50%)"},onSlideStart:E=>{const P=b(E.clientX);s==null||s(P)},onSlideMove:E=>{const P=b(E.clientX);a==null||a(P)},onSlideEnd:()=>{g.current=void 0,l==null||l()},onStepKeyDown:E=>{const C=c3[x?"from-left":"from-right"].includes(E.key);c==null||c({event:E,direction:C?-1:1})}})))}),CQ=w.forwardRef((t,e)=>{const{min:n,max:r,inverted:o,onSlideStart:i,onSlideMove:s,onSlideEnd:a,onStepKeyDown:l,...c}=t,d=w.useRef(null),u=qe(e,d),h=w.useRef(),p=!o;function g(m){const v=h.current||d.current.getBoundingClientRect(),x=[0,v.height],E=_x(x,p?[r,n]:[n,r]);return h.current=v,E(m-v.top)}return w.createElement(d3,{scope:t.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1},w.createElement(p3,oe({"data-orientation":"vertical"},c,{ref:u,style:{...c.style,["--radix-slider-thumb-transform"]:"translateY(50%)"},onSlideStart:m=>{const v=g(m.clientY);i==null||i(v)},onSlideMove:m=>{const v=g(m.clientY);s==null||s(v)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:m=>{const x=c3[p?"from-bottom":"from-top"].includes(m.key);l==null||l({event:m,direction:x?-1:1})}})))}),p3=w.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:o,onSlideEnd:i,onHomeKeyDown:s,onEndKeyDown:a,onStepKeyDown:l,...c}=t,d=_f(ku,n);return w.createElement(He.span,oe({},c,{ref:e,onKeyDown:fe(t.onKeyDown,u=>{u.key==="Home"?(s(u),u.preventDefault()):u.key==="End"?(a(u),u.preventDefault()):a3.concat(l3).includes(u.key)&&(l(u),u.preventDefault())}),onPointerDown:fe(t.onPointerDown,u=>{const h=u.target;h.setPointerCapture(u.pointerId),u.preventDefault(),d.thumbs.has(h)?h.focus():r(u)}),onPointerMove:fe(t.onPointerMove,u=>{u.target.hasPointerCapture(u.pointerId)&&o(u)}),onPointerUp:fe(t.onPointerUp,u=>{const h=u.target;h.hasPointerCapture(u.pointerId)&&(h.releasePointerCapture(u.pointerId),i(u))})}))}),kQ="SliderTrack",$Q=w.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,o=_f(kQ,n);return w.createElement(He.span,oe({"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation},r,{ref:e}))}),JE="SliderRange",TQ=w.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,o=_f(JE,n),i=h3(JE,n),s=w.useRef(null),a=qe(e,s),l=o.values.length,c=o.values.map(h=>f3(h,o.min,o.max)),d=l>1?Math.min(...c):0,u=100-Math.max(...c);return w.createElement(He.span,oe({"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0},r,{ref:a,style:{...t.style,[i.startEdge]:d+"%",[i.endEdge]:u+"%"}}))}),eP="SliderThumb",MQ=w.forwardRef((t,e)=>{const n=SQ(t.__scopeSlider),[r,o]=w.useState(null),i=qe(e,a=>o(a)),s=w.useMemo(()=>r?n().findIndex(a=>a.ref.current===r):-1,[n,r]);return w.createElement(AQ,oe({},t,{ref:i,index:s}))}),AQ=w.forwardRef((t,e)=>{const{__scopeSlider:n,index:r,...o}=t,i=_f(eP,n),s=h3(eP,n),[a,l]=w.useState(null),c=qe(e,v=>l(v)),d=rx(a),u=i.values[r],h=u===void 0?0:f3(u,i.min,i.max),p=DQ(r,i.values.length),g=d==null?void 0:d[s.size],m=g?jQ(g,h,s.direction):0;return w.useEffect(()=>{if(a)return i.thumbs.add(a),()=>{i.thumbs.delete(a)}},[a,i.thumbs]),w.createElement("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[s.startEdge]:`calc(${h}% + ${m}px)`}},w.createElement(M0.ItemSlot,{scope:t.__scopeSlider},w.createElement(He.span,oe({role:"slider","aria-label":t["aria-label"]||p,"aria-valuemin":i.min,"aria-valuenow":u,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0},o,{ref:c,style:u===void 0?{display:"none"}:t.style,onFocus:fe(t.onFocus,()=>{i.valueIndexToChangeRef.current=r})}))))}),RQ=t=>{const{value:e,...n}=t,r=w.useRef(null),o=bQ(e);return w.useEffect(()=>{const i=r.current,s=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(s,"value").set;if(o!==e&&l){const c=new Event("input",{bubbles:!0});l.call(i,e),i.dispatchEvent(c)}},[o,e]),w.createElement("input",oe({style:{display:"none"}},n,{ref:r,defaultValue:e}))};function LQ(t=[],e,n){const r=[...t];return r[n]=e,r.sort((o,i)=>o-i)}function f3(t,e,n){return 100/(n-e)*(t-e)}function DQ(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function OQ(t,e){if(t.length===1)return 0;const n=t.map(o=>Math.abs(o-e)),r=Math.min(...n);return n.indexOf(r)}function jQ(t,e,n){const r=t/2,i=_x([0,50],[0,r]);return(r-i(e)*n)*n}function NQ(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function BQ(t,e){if(e>0){const n=NQ(t);return Math.min(...n)>=e}return!0}function _x(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function zQ(t){return(String(t).split(".")[1]||"").length}function UQ(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}const FQ=_Q,KQ=$Q,HQ=TQ,VQ=MQ;function WQ(t){const{title:e,steps:n,value:r,label:o,onValueChange:i}=t,s=Z(),a=Be(),l=w.useCallback(u=>{i(u[0],!0)},[i]),c=w.useCallback(()=>{s.mark("click slider")},[s]),d=w.useCallback(()=>{r&&i(r,!1)},[r,i]);return f.jsx("div",{className:"tlui-slider__container",children:f.jsxs(FQ,{"data-wd":t["data-wd"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:n,step:1,value:r?[r]:void 0,onPointerDown:c,onValueChange:l,onPointerUp:d,title:e+" — "+a(o),children:[f.jsx(KQ,{className:"tlui-slider__track",dir:"ltr",children:r!==null&&f.jsx(HQ,{className:"tlui-slider__range",dir:"ltr"})}),r!==null&&f.jsx(VQ,{className:"tlui-slider__thumb",dir:"ltr"})]})})}const YQ=w.memo(function({"data-wd":e,label:n,labelA:r,labelB:o,itemsA:i,itemsB:s,styleTypeA:a,styleTypeB:l,valueA:c,valueB:d,onValueChange:u}){const h=Be(),p=w.useMemo(()=>{var x;return((x=i.find(b=>b.id===c))==null?void 0:x.icon)??"mixed"},[i,c]),g=w.useMemo(()=>{var x;return((x=s.find(b=>b.id===d))==null?void 0:x.icon)??"mixed"},[s,d]);if(c===void 0&&d===void 0)return null;const m=`${e}.start`,v=`${e}.end`;return f.jsxs("div",{className:"tlui-style-panel__double-select-picker",children:[f.jsx("div",{title:h(n),className:"tlui-style-panel__double-select-picker-label",children:h(n)}),f.jsxs(Bi,{id:`style panel ${a}`,children:[f.jsx(Jc,{asChild:!0,children:f.jsx(me,{"data-wd":m,title:h(r)+" — "+h(c===null?"style-panel.mixed":`${a}-style.${c}`),icon:p,invertIcon:!0,smallIcon:!0})}),f.jsx(zi,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:f.jsx("div",{className:Se("tlui-button-grid",{"tlui-button-grid__two":i.length<4,"tlui-button-grid__four":i.length>=4}),children:i.map(x=>f.jsx(gn,{className:"tlui-button-grid__button",title:h(r)+" — "+h(`${a}-style.${x.id}`),"data-wd":`${m}.${x.id}`,icon:x.icon,onClick:()=>u(x,!1),invertIcon:!0},x.id))})})]}),f.jsxs(Bi,{id:`style panel ${l}`,children:[f.jsx(Jc,{asChild:!0,children:f.jsx(me,{"data-wd":v,title:h(o)+" — "+h(d===null?"style-panel.mixed":`${l}-style.${d}`),icon:g,smallIcon:!0})}),f.jsx(zi,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:f.jsx("div",{className:Se("tlui-button-grid",{"tlui-button-grid__two":i.length<4,"tlui-button-grid__four":i.length>=4}),children:s.map(x=>f.jsx(gn,{className:"tlui-button-grid__button",title:h(o)+" — "+h(`${l}-style.${x.id}`),"data-wd":`${v}.${x.id}`,icon:x.icon,onClick:()=>u(x,!1)},x.id))})})]})]})}),g3=w.memo(function({id:e,items:n,styleType:r,label:o,value:i,onValueChange:s,"data-wd":a}){const l=Be(),c=w.useMemo(()=>{var d;return(d=n.find(u=>u.id===i))==null?void 0:d.icon},[n,i]);return f.jsxs(Bi,{id:`style panel ${e}`,children:[f.jsx(Jc,{asChild:!0,children:f.jsx(me,{"data-wd":a,title:l(i===null?"style-panel.mixed":`${r}-style.${i}`),label:o,icon:c??"mixed"})}),f.jsx(zi,{side:"left",align:"center",alignOffset:0,children:f.jsx("div",{className:Se("tlui-button-grid",{"tlui-button-grid__two":n.length<4,"tlui-button-grid__four":n.length>=4}),children:n.map(d=>f.jsx(gn,{className:"tlui-button-grid__button","data-wd":`${a}.${d.id}`,title:l(`${r}-style.${d.id}`),icon:d.icon,onClick:()=>s(d,!1)},d.id))})})]})}),m3=function({isMobile:e}){const n=Z(),r=ge("props",()=>n.props,[n]),o=w.useCallback(()=>{e||(n.isChangingStyle=!1)},[n,e]);if(!r)return null;const{geo:i,arrowheadEnd:s,arrowheadStart:a,spline:l,font:c}=r,d=i===void 0,u=s===void 0&&a===void 0,h=l===void 0,p=c===void 0;return f.jsxs("div",{className:"tlui-style-panel","data-ismobile":e,onPointerLeave:o,children:[f.jsx(XQ,{props:r}),!p&&f.jsx(GQ,{props:r}),!(d&&u&&h)&&f.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[f.jsx(qQ,{props:r}),f.jsx(ZQ,{props:r}),f.jsx(QQ,{props:r})]})]})},{styles:Nn}=Pe;function $u(){const t=Z();return xe.useCallback((e,n)=>{t.batch(()=>{t.setProp(e.type,e.id,!1,n),t.isChangingStyle=!0})},[t])}function XQ({props:t}){const e=Z(),n=Be(),r=$u(),o=xe.useCallback((h,p)=>{const g=Nn.opacity[h];e.setProp(g.type,g.id,p),e.isChangingStyle=!0},[e]),{color:i,fill:s,dash:a,size:l,opacity:c}=t;if(i===void 0&&s===void 0&&a===void 0&&l===void 0&&c===void 0)return null;const d=s||a||l,u=Nn.opacity.findIndex(h=>h.id===c);return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[i===void 0?null:f.jsx(ka,{title:n("style-panel.color"),styleType:"color","data-wd":"style.color",items:Nn.color,value:i,onValueChange:r}),c===void 0?null:f.jsx(WQ,{"data-wd":"style.opacity",value:u>=0?u:Nn.opacity.length-1,label:c?`opacity-style.${c}`:"style-panel.mixed",onValueChange:o,steps:Nn.opacity.length-1,title:n("style-panel.opacity")})]}),d&&f.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[s===void 0?null:f.jsx(ka,{title:n("style-panel.fill"),styleType:"fill","data-wd":"style.fill",items:Nn.fill,value:s,onValueChange:r}),a===void 0?null:f.jsx(ka,{title:n("style-panel.dash"),styleType:"dash","data-wd":"style.dash",items:Nn.dash,value:a,onValueChange:r}),l===void 0?null:f.jsx(ka,{title:n("style-panel.size"),styleType:"size","data-wd":"style.size",items:Nn.size,value:l,onValueChange:r})]})]})}function GQ({props:t}){const e=Be(),n=$u(),{font:r,align:o}=t;return r===void 0&&o===void 0?null:f.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[r===void 0?null:f.jsx(ka,{title:e("style-panel.font"),styleType:"font","data-wd":"font",items:Nn.font,value:r,onValueChange:n}),o===void 0?null:f.jsxs("div",{className:"tlui-style-panel__row",children:[f.jsx(ka,{title:e("style-panel.align"),styleType:"align","data-wd":"align",items:Nn.align,value:o,onValueChange:n}),f.jsx(me,{title:e("style-panel.position"),"data-wd":"position",icon:"align-center-center",disabled:!0})]})]})}function qQ({props:t}){const e=$u(),{geo:n}=t;return n===void 0?null:f.jsx(g3,{id:"geo",label:"style-panel.geo",styleType:"geo","data-wd":"style-panel.geo",items:Nn.geo,value:n,onValueChange:e})}function QQ({props:t}){const e=$u(),{spline:n}=t;return n===void 0?null:f.jsx(g3,{id:"spline",label:"style-panel.spline",styleType:"spline","data-wd":"style.spline",items:Nn.spline,value:n,onValueChange:e})}function ZQ({props:t}){const e=$u(),{arrowheadEnd:n,arrowheadStart:r}=t;return n===void 0&&r===void 0?null:f.jsx(YQ,{label:"style-panel.arrowheads",styleTypeA:"arrowheadStart","data-wd":"style.arrowheads",itemsA:Nn.arrowheadStart,valueA:r,styleTypeB:"arrowheadEnd",itemsB:Nn.arrowheadEnd,valueB:n,onValueChange:e,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"})}function JQ({toast:t}){const{removeToast:e}=_o(),n=Be(),r=i=>{i||e(t.id)},o=t.actions&&t.actions.length>0;return f.jsxs(mG,{onOpenChange:r,className:"tlui-toast__container",duration:t.keepOpen?1/0:5e3,children:[t.icon&&f.jsx("div",{className:"tlui-toast__icon",children:f.jsx(Yn,{icon:t.icon})}),f.jsxs("div",{className:"tlui-toast__main",children:[f.jsxs("div",{className:"tlui-toast__content",children:[f.jsx(yG,{className:"tlui-toast__title",children:t.title}),f.jsx(vG,{className:"tlui-toast__description",children:t.description})]}),t.actions&&f.jsxs("div",{className:"tlui-toast__actions",children:[t.actions.map((i,s)=>f.jsx(wG,{altText:i.label,asChild:!0,onClick:i.onClick,children:f.jsx(me,{className:i.type==="warn"?"tlui-button__warning":"tlui-button__primary",children:i.label})},s)),o&&f.jsx(WE,{asChild:!0,children:f.jsx(me,{className:"tlui-toast__close",style:{marginLeft:"auto"},children:t.closeLabel??n("toast.close")})})]})]}),!o&&f.jsx(WE,{asChild:!0,children:f.jsx(me,{className:"tlui-toast__close",children:t.closeLabel??n("toast.close")})})]})}function eZ(){const{toasts:t}=_o();return f.jsx(f.Fragment,{children:t.map(e=>f.jsx(JQ,{toast:e},e.id))})}const tZ=w.memo(eZ);function nZ(){const{toasts:t}=_o(),[e,n]=w.useState(!1);return w.useEffect(()=>{let r=!1;return t.length?n(!0):setTimeout(()=>{r||n(!1)},1e3),()=>{r=!0}},[t.length,n]),e?f.jsx(JX,{className:"tlui-toast__viewport"}):null}function rZ(){const t=Z(),e=Be(),n=ge("current color",()=>{const{props:i}=t;return i?i.color?t.getCssColor(i.color):null:"var(--color-muted-1)"},[t]),r=ge("isHandOrEraserToolActive",()=>t.isInAny("hand","zoom","eraser"),[t]),o=w.useCallback(i=>{i||(t.isChangingStyle=!1)},[t]);return f.jsxs(Ex,{id:"style menu",onOpenChange:o,children:[f.jsx(Px,{disabled:r,children:f.jsx(me,{className:"tlui-toolbar__tools__button tlui-toolbar__styles__button tlui-popover__trigger","data-wd":"mobile.styles",style:{color:n??"var(--color-text)"},title:e("style-panel.title"),children:f.jsx(Yn,{icon:n?"blob":"mixed"})})}),f.jsx(t3,{side:"top",align:"end",children:f.jsx(m3,{isMobile:!0})})]})}const oZ=function({activeToolId:e}){const n=Z(),r=Rr(),o=Be(),i=ge("is tool locked",()=>n.instanceState.isToolLocked,[n]);return e==="select"||e==="hand"||e==="draw"||e==="eraser"||e==="text"||e==="zoom"?null:f.jsx(me,{title:o("action.toggle-tool-lock"),className:Se("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":r<5}),icon:i?"lock":"unlock",onClick:()=>n.updateInstanceState({isToolLocked:!i}),smallIcon:!0})},iZ=function(){const e=Z(),n=Be(),r=Rr(),o=xe.useRef(void 0),i=ii(),s=gq(),a=ge("current tool id",()=>e.currentToolId,[e]),l=a==="hand",c=ge("geo",()=>e.props?e.props.geo:void 0,[e]),d=!i,u=!(i||l),h=x=>x.label?`${n(x.label)} ${x.kbd?xo(x.kbd):""}`:"",p=s.find(x=>Hl(x.toolItem,a,c)),{itemsInPanel:g,itemsInDropdown:m,dropdownFirstItem:v}=xe.useMemo(()=>{const x=[],b=[];let E;const P=Math.min(8,5+r);for(let C=4;C<s.length;C++){const k=s[C];C<P?x.push(k):(k===p&&(E=k),b.push(k))}return E||(o.current||(o.current=b[0]),E=o.current,b.includes(E)||(E=b[0])),o.current=E,b.length<=2&&(x.push(...b),b.length=0),{itemsInPanel:x,itemsInDropdown:b,dropdownFirstItem:E}},[s,p,r]);return f.jsx("div",{className:"tlui-toolbar",children:f.jsxs("div",{className:"tlui-toolbar__inner",children:[f.jsxs("div",{className:"tlui-toolbar__left",children:[!i&&f.jsxs("div",{className:Se("tlui-toolbar__extras",{"tlui-toolbar__extras__hidden":!u}),children:[r<5&&f.jsxs("div",{className:"tlui-toolbar__extras__controls",children:[f.jsx(s3,{}),f.jsx(o3,{}),f.jsx(i3,{}),f.jsx(r3,{}),f.jsx(n3,{})]}),f.jsx(oZ,{activeToolId:a})]}),f.jsxs("div",{className:Se("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<5}),children:[s.slice(0,2).map(({toolItem:x})=>f.jsx(Md,{item:x,title:h(x),isSelected:Hl(x,a,c)},x.id)),d&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"tlui-toolbar__divider"}),s.slice(2,4).map(({toolItem:x})=>f.jsx(Md,{item:x,title:h(x),isSelected:Hl(x,a,c)},x.id)),f.jsx("div",{className:"tlui-toolbar__divider"}),g.map(({toolItem:x})=>f.jsx(Md,{item:x,title:h(x),isSelected:Hl(x,a,c)},x.id)),m.length?f.jsxs(f.Fragment,{children:[f.jsx(Md,{item:v.toolItem,title:h(v.toolItem),isSelected:Hl(v.toolItem,a,c)},v.toolItem.id),f.jsxs(Bi,{id:"toolbar overflow",modal:!1,children:[f.jsx(Cu,{children:f.jsx(me,{className:"tlui-toolbar__tools__button tlui-toolbar__overflow",icon:"chevron-up","data-wd":"tools.more",title:n("tool-panel.more")})}),f.jsx(zi,{side:"top",align:"center",children:f.jsx(sZ,{toolbarItems:m})})]})]}):null]})]})]}),r<5&&!i&&f.jsx("div",{className:"tlui-toolbar__tools",children:f.jsx(rZ,{})})]})})},sZ=Me(function({toolbarItems:e}){const n=Be();return f.jsx("div",{className:"tlui-button-grid__four tlui-button-grid__reverse",children:e.map(({toolItem:{id:r,meta:o,kbd:i,label:s,onSelect:a,icon:l}})=>f.jsx(gn,{className:"tlui-button-grid__button","data-wd":`tools.${r}`,"data-tool":r,"data-geo":(o==null?void 0:o.geo)??"","aria-label":s,onClick:()=>a("toolbar"),title:s?`${n(s)} ${i?xo(i):""}`:"",icon:l},r))})});function Md({item:t,title:e,isSelected:n}){var r;return f.jsx(me,{className:"tlui-toolbar__tools__button","data-wd":`tools.${t.id}`,"data-tool":t.id,"data-geo":((r=t.meta)==null?void 0:r.geo)??"","aria-label":t.label,title:e,icon:t.icon,"data-state":n?"selected":void 0,onClick:()=>t.onSelect("toolbar"),onTouchStart:o=>{Ve(o),t.onSelect("toolbar")}})}const Hl=(t,e,n)=>{var r,o;return(r=t.meta)!=null&&r.geo?e==="geo"&&n===((o=t.meta)==null?void 0:o.geo):e===t.id};function aZ(){const t=Z(),{addToast:e}=_o();w.useEffect(()=>{function n({name:r,count:o}){e({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${r} (${o}). Please delete some shapes or move to a different page to continue.`})}return t.addListener("max-shapes",n),()=>{t.removeListener("max-shapes",n)}},[t,e])}const y3=xe.memo(function({shareZone:e,renderDebugMenuItems:n,children:r,hideUi:o,...i}){return f.jsx(xq,{...i,children:f.jsx(lZ,{hideUi:o,shareZone:e,renderDebugMenuItems:n,children:r})})}),lZ=xe.memo(function({children:e,hideUi:n,...r}){return f.jsxs(f.Fragment,{children:[e,n?null:f.jsx(cZ,{...r})]})}),cZ=xe.memo(function({shareZone:e,renderDebugMenuItems:n}){const r=Z(),o=Be(),i=Rr(),s=ge("isReadOnlyMode",()=>r.isReadOnly,[]),a=ge("isFocusMode",()=>r.instanceState.isFocusMode,[]),l=ge("isDebugMode",()=>r.instanceState.isDebugMode,[]);KG(),aZ();const{"toggle-focus-mode":c}=An();return f.jsx(cM,{children:f.jsxs("main",{"data-tldraw-area":"active-drawing",className:Se("tlui-layout",{"tlui-layout__mobile":i<5}),children:[a?f.jsx("div",{className:"tlui-layout__top",children:f.jsx(me,{className:"tlui-focus-button",title:`${o("focus-mode.toggle-focus-mode")}`,icon:"dot",onClick:()=>c.onSelect("menu")})}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"tlui-layout__top",children:[f.jsxs("div",{className:"tlui-layout__top__left",children:[f.jsx(uQ,{}),f.jsxs("div",{className:"tlui-helper-buttons",children:[f.jsx(yQ,{}),f.jsx(Sq,{}),f.jsx(vQ,{})]})]}),f.jsxs("div",{className:"tlui-layout__top__right",children:[e&&f.jsx("div",{className:"tlui-share-zone",draggable:!1,children:e}),i>=5&&!s&&f.jsx("div",{className:"tlui-style-panel__wrapper",children:f.jsx(m3,{})})]})]}),f.jsxs("div",{className:"tlui-layout__bottom",children:[f.jsxs("div",{className:"tlui-layout__bottom__main",children:[f.jsx(mQ,{}),f.jsx(iZ,{}),i>=4&&f.jsx(Aq,{})]}),l&&f.jsx(Pq,{renderDebugMenuItems:n??null})]})]}),f.jsx(tZ,{}),f.jsx(Mq,{}),f.jsx(nZ,{})]})})}),v3="ContextMenu",[uZ,ate]=to(v3,[bf]),Io=bf(),[dZ,w3]=uZ(v3),hZ=t=>{const{__scopeContextMenu:e,children:n,onOpenChange:r,dir:o,modal:i=!0}=t,[s,a]=w.useState(!1),l=Io(e),c=ln(r),d=w.useCallback(u=>{a(u),c(u)},[c]);return w.createElement(dZ,{scope:e,open:s,onOpenChange:d,modal:i},w.createElement(HT,oe({},l,{dir:o,open:s,onOpenChange:d,modal:i}),n))},pZ="ContextMenuTrigger",fZ=w.forwardRef((t,e)=>{const{__scopeContextMenu:n,disabled:r=!1,...o}=t,i=w3(pZ,n),s=Io(n),a=w.useRef({x:0,y:0}),l=w.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...a.current})}),c=w.useRef(0),d=w.useCallback(()=>window.clearTimeout(c.current),[]),u=h=>{a.current={x:h.clientX,y:h.clientY},i.onOpenChange(!0)};return w.useEffect(()=>d,[d]),w.useEffect(()=>void(r&&d()),[r,d]),w.createElement(w.Fragment,null,w.createElement(VT,oe({},s,{virtualRef:l})),w.createElement(He.span,oe({"data-state":i.open?"open":"closed","data-disabled":r?"":void 0},o,{ref:e,style:{WebkitTouchCallout:"none",...t.style},onContextMenu:r?t.onContextMenu:fe(t.onContextMenu,h=>{d(),u(h),h.preventDefault()}),onPointerDown:r?t.onPointerDown:fe(t.onPointerDown,Ad(h=>{d(),c.current=window.setTimeout(()=>u(h),700)})),onPointerMove:r?t.onPointerMove:fe(t.onPointerMove,Ad(d)),onPointerCancel:r?t.onPointerCancel:fe(t.onPointerCancel,Ad(d)),onPointerUp:r?t.onPointerUp:fe(t.onPointerUp,Ad(d))})))}),gZ=t=>{const{__scopeContextMenu:e,...n}=t,r=Io(e);return w.createElement(WT,oe({},r,n))},mZ="ContextMenuContent",yZ=w.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,o=w3(mZ,n),i=Io(n),s=w.useRef(!1);return w.createElement(YT,oe({},i,r,{ref:e,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:a=>{var l;(l=t.onCloseAutoFocus)===null||l===void 0||l.call(t,a),!a.defaultPrevented&&s.current&&a.preventDefault(),s.current=!1},onInteractOutside:a=>{var l;(l=t.onInteractOutside)===null||l===void 0||l.call(t,a),!a.defaultPrevented&&!o.modal&&(s.current=!0)},style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),vZ=w.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,o=Io(n);return w.createElement(XT,oe({},o,r,{ref:e}))}),wZ=w.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,o=Io(n);return w.createElement(GT,oe({},o,r,{ref:e}))}),xZ=w.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,o=Io(n);return w.createElement(qT,oe({},o,r,{ref:e}))}),bZ=t=>{const{__scopeContextMenu:e,children:n,onOpenChange:r,open:o,defaultOpen:i}=t,s=Io(e),[a,l]=Xi({prop:o,defaultProp:i,onChange:r});return w.createElement(QT,oe({},s,{open:a,onOpenChange:l}),n)},SZ=w.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,o=Io(n);return w.createElement(ZT,oe({},o,r,{ref:e}))}),EZ=w.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,o=Io(n);return w.createElement(JT,oe({},o,r,{ref:e,style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});function Ad(t){return e=>e.pointerType!=="mouse"?t(e):void 0}const PZ=hZ,_Z=fZ,A0=gZ,IZ=yZ,R0=vZ,xp=wZ,CZ=xZ,x3=bZ,b3=SZ,S3=EZ,kZ=Me(function(){const e=Z(),n=Tn(),r=e.pages,o=e.currentPageId,i=Be(),{addToast:s}=_o();return f.jsxs(x3,{children:[f.jsx(b3,{dir:"ltr",asChild:!0,children:f.jsx(me,{className:"tlui-menu__button",label:"context-menu.move-to-page","data-wd":"menu-item.move-to-page",icon:"chevron-right"})}),f.jsx(A0,{container:n,dir:"ltr",children:f.jsxs(S3,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[f.jsx(R0,{dir:"ltr",className:"tlui-menu__group","data-wd":"menu-item.pages",children:r.map(a=>f.jsx(xp,{disabled:o===a.id,onSelect:()=>{e.mark("move_shapes_to_page"),e.moveShapesToPage(e.selectedIds,a.id);const l=e.getPageById(a.id);l&&s({title:"Changed Page",description:`Moved to ${l.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{e.mark("change-page"),e.setCurrentPageId(o)}}]})},asChild:!0,children:f.jsx(me,{title:a.name,className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:f.jsx("span",{children:a.name})})},a.id))},"pages"),f.jsx(R0,{dir:"ltr",className:"tlui-menu__group","data-wd":"menu-item.new-page",children:f.jsx(xp,{onSelect:()=>{e.mark("move_shapes_to_page");const a=it.createId(),l=e.selectedIds,c=e.currentPageId;e.batch(()=>{e.createPage("Page 1",a),e.setCurrentPageId(c),e.moveShapesToPage(l,a)})},asChild:!0,children:f.jsx(me,{title:i("context.pages.new-page"),className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:i("context.pages.new-page")})},"new-page")},"new-page")]})})]})}),E3=function({children:e}){const n=Z(),r=AM(),[o,i]=yl("context menu"),s=ii(),a=r.length===0||s&&r.every(d=>!d.readonlyOk),c=!ge("isSelectToolActive",()=>n.currentToolId==="select",[n])||a;return f.jsxs(PZ,{dir:"ltr",onOpenChange:i,children:[f.jsx(_Z,{onContextMenu:c?Ve:void 0,dir:"ltr",disabled:c,children:e}),f.jsx($Z,{})]})};function $Z(){const t=Z(),e=Be(),n=AM(),[r,o]=yl("context menu sub"),i=ii(),{paste:s}=gx("context-menu"),a=Rr(),l=Tn(),[c,d]=w.useState(!1);function u(h,p,g,m){if(i&&!p.readonlyOk)return null;switch(p.type){case"custom":{switch(p.id){case"MENU_PASTE":return f.jsx(xp,{children:f.jsx(me,{className:"tlui-menu__button","data-wd":`menu-item.${p.id}`,kbd:"$v",label:"action.paste",disabled:p.disabled,onClick:()=>{(!h.isSafari||h.isSafari&&h.isIos)&&navigator.clipboard.read().then(v=>{s(v,h.inputs.currentPagePoint)})},onMouseDown:()=>{h.isSafari&&!h.isIos&&navigator.clipboard.read().then(v=>{s(v,h.inputs.currentPagePoint)})}})},p.id);case"MOVE_TO_PAGE_MENU":return f.jsx(kZ,{},p.id)}break}case"group":return f.jsx(R0,{dir:"ltr",className:Se("tlui-menu__group",{"tlui-menu__group__small":(g==null?void 0:g.type)==="submenu"}),"data-wd":`menu-item.${p.id}`,children:p.children.map(v=>u(h,v,p,m+1))},p.id);case"submenu":return f.jsxs(x3,{onOpenChange:o,children:[f.jsx(b3,{dir:"ltr",disabled:p.disabled,asChild:!0,children:f.jsx(me,{className:"tlui-menu__button",label:p.label,"data-wd":`menu-item.${p.id}`,icon:"chevron-right"})}),f.jsx(A0,{container:l,dir:"ltr",children:f.jsx(S3,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:p.children.map(v=>u(h,v,p,m+1))})})]},p.id);case"item":{if(i&&!p.readonlyOk)return null;const{id:v,checkbox:x,contextMenuLabel:b,label:E,onSelect:P,kbd:C,icon:k}=p.actionItem,$=b??E,A=$?e($):void 0;return x?f.jsxs(CZ,{className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",dir:"ltr",disabled:p.disabled,onSelect:D=>{P("context-menu"),Ve(D)},title:A||void 0,checked:p.checked,children:[f.jsx("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${p.checked?1:.5})`,opacity:p.checked?1:.5},children:f.jsx(Yn,{small:!0,icon:p.checked?"check":"checkbox-empty"})}),A&&f.jsx("span",{children:A}),C&&f.jsx(pf,{children:C})]},v):f.jsx(xp,{dir:"ltr",asChild:!0,children:f.jsx(me,{className:"tlui-menu__button","data-wd":`menu-item.${v}`,kbd:C,label:$,disabled:p.disabled,iconLeft:a<3&&m>2?k:void 0,onClick:()=>{c?d(!1):P("context-menu")}})},v)}}}return f.jsx(A0,{dir:"ltr",container:l,children:f.jsx(IZ,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:Ve,children:n.map(h=>u(t,h,null,0))})})}Me(function(){const e=Z(),n=w.useRef(null),r=e.camera,o=e.shapesArray;if(n.current){const i=n.current,s=i.getContext("2d");s.resetTransform(),s.clearRect(0,0,i.width,i.height);const a=new Path2D;s.translate(r.x,r.y);for(const l of o){const c=e.getPageBounds(l);a.rect(c.minX,c.minY,c.width,c.height)}s.fillStyle="#cccccc",s.fill(a);for(const l of o)s.save(),e.getPageCorners(l).forEach(d=>TZ(s,d.x,d.y,"red")),s.restore()}return f.jsx("canvas",{ref:n,width:e.viewportScreenBounds.width,height:e.viewportScreenBounds.height,style:{width:"100%",height:"100%"}})});function TZ(t,e,n,r="#000"){t.save(),t.beginPath(),t.ellipse(e,n,4,4,0,0,Math.PI*2),t.fillStyle=r,t.fill(),t.restore()}var ym=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function vm(t,e,n,r){t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on".concat(e),function(){n(window.event)})}function P3(t,e){for(var n=e.slice(0,e.length-1),r=0;r<n.length;r++)n[r]=t[n[r].toLowerCase()];return n}function _3(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");for(var e=t.split(","),n=e.lastIndexOf("");n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}function MZ(t,e){for(var n=t.length>=e.length?t:e,r=t.length>=e.length?e:t,o=!0,i=0;i<n.length;i++)r.indexOf(n[i])===-1&&(o=!1);return o}var tu={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":ym?173:189,"=":ym?61:187,";":ym?59:186,"'":222,"[":219,"]":221,"\\":220},So={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},L0={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},rn={16:!1,18:!1,17:!1,91:!1},At={};for(var Rd=1;Rd<20;Rd++)tu["f".concat(Rd)]=111+Rd;var st=[],tP=!1,I3="all",C3=[],If=function(e){return tu[e.toLowerCase()]||So[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)},AZ=function(e){return Object.keys(tu).find(function(n){return tu[n]===e})},RZ=function(e){return Object.keys(So).find(function(n){return So[n]===e})};function k3(t){I3=t||"all"}function nu(){return I3||"all"}function LZ(){return st.slice(0)}function DZ(){return st.map(function(t){return AZ(t)||RZ(t)||String.fromCharCode(t)})}function OZ(t){var e=t.target||t.srcElement,n=e.tagName,r=!0;return(e.isContentEditable||(n==="INPUT"||n==="TEXTAREA"||n==="SELECT")&&!e.readOnly)&&(r=!1),r}function jZ(t){return typeof t=="string"&&(t=If(t)),st.indexOf(t)!==-1}function NZ(t,e){var n,r;t||(t=nu());for(var o in At)if(Object.prototype.hasOwnProperty.call(At,o))for(n=At[o],r=0;r<n.length;)n[r].scope===t?n.splice(r,1):r++;nu()===t&&k3(e||"all")}function BZ(t){var e=t.keyCode||t.which||t.charCode,n=st.indexOf(e);if(n>=0&&st.splice(n,1),t.key&&t.key.toLowerCase()==="meta"&&st.splice(0,st.length),(e===93||e===224)&&(e=91),e in rn){rn[e]=!1;for(var r in So)So[r]===e&&(Ei[r]=!1)}}function zZ(t){if(typeof t>"u")Object.keys(At).forEach(function(s){return delete At[s]});else if(Array.isArray(t))t.forEach(function(s){s.key&&wm(s)});else if(typeof t=="object")t.key&&wm(t);else if(typeof t=="string"){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=n[0],i=n[1];typeof o=="function"&&(i=o,o=""),wm({key:t,scope:o,method:i,splitKey:"+"})}}var wm=function(e){var n=e.key,r=e.scope,o=e.method,i=e.splitKey,s=i===void 0?"+":i,a=_3(n);a.forEach(function(l){var c=l.split(s),d=c.length,u=c[d-1],h=u==="*"?"*":If(u);if(At[h]){r||(r=nu());var p=d>1?P3(So,c):[];At[h]=At[h].filter(function(g){var m=o?g.method===o:!0;return!(m&&g.scope===r&&MZ(g.mods,p))})}})};function nP(t,e,n,r){if(e.element===r){var o;if(e.scope===n||e.scope==="all"){o=e.mods.length>0;for(var i in rn)Object.prototype.hasOwnProperty.call(rn,i)&&(!rn[i]&&e.mods.indexOf(+i)>-1||rn[i]&&e.mods.indexOf(+i)===-1)&&(o=!1);(e.mods.length===0&&!rn[16]&&!rn[18]&&!rn[17]&&!rn[91]||o||e.shortcut==="*")&&e.method(t,e)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}}function rP(t,e){var n=At["*"],r=t.keyCode||t.which||t.charCode;if(Ei.filter.call(this,t)){if((r===93||r===224)&&(r=91),st.indexOf(r)===-1&&r!==229&&st.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(g){var m=L0[g];t[g]&&st.indexOf(m)===-1?st.push(m):!t[g]&&st.indexOf(m)>-1?st.splice(st.indexOf(m),1):g==="metaKey"&&t[g]&&st.length===3&&(t.ctrlKey||t.shiftKey||t.altKey||(st=st.slice(st.indexOf(m))))}),r in rn){rn[r]=!0;for(var o in So)So[o]===r&&(Ei[o]=!0);if(!n)return}for(var i in rn)Object.prototype.hasOwnProperty.call(rn,i)&&(rn[i]=t[L0[i]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(st.indexOf(17)===-1&&st.push(17),st.indexOf(18)===-1&&st.push(18),rn[17]=!0,rn[18]=!0);var s=nu();if(n)for(var a=0;a<n.length;a++)n[a].scope===s&&(t.type==="keydown"&&n[a].keydown||t.type==="keyup"&&n[a].keyup)&&nP(t,n[a],s,e);if(r in At){for(var l=0;l<At[r].length;l++)if((t.type==="keydown"&&At[r][l].keydown||t.type==="keyup"&&At[r][l].keyup)&&At[r][l].key){for(var c=At[r][l],d=c.splitKey,u=c.key.split(d),h=[],p=0;p<u.length;p++)h.push(If(u[p]));h.sort().join("")===st.sort().join("")&&nP(t,c,s,e)}}}}function UZ(t){return C3.indexOf(t)>-1}function Ei(t,e,n){st=[];var r=_3(t),o=[],i="all",s=document,a=0,l=!1,c=!0,d="+",u=!1;for(n===void 0&&typeof e=="function"&&(n=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(i=e.scope),e.element&&(s=e.element),e.keyup&&(l=e.keyup),e.keydown!==void 0&&(c=e.keydown),e.capture!==void 0&&(u=e.capture),typeof e.splitKey=="string"&&(d=e.splitKey)),typeof e=="string"&&(i=e);a<r.length;a++)t=r[a].split(d),o=[],t.length>1&&(o=P3(So,t)),t=t[t.length-1],t=t==="*"?"*":If(t),t in At||(At[t]=[]),At[t].push({keyup:l,keydown:c,scope:i,mods:o,shortcut:r[a],method:n,key:r[a],splitKey:d,element:s});typeof s<"u"&&!UZ(s)&&window&&(C3.push(s),vm(s,"keydown",function(h){rP(h,s)},u),tP||(tP=!0,vm(window,"focus",function(){st=[]},u)),vm(s,"keyup",function(h){rP(h,s),BZ(h)},u))}function FZ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(At).forEach(function(n){var r=At[n].filter(function(o){return o.scope===e&&o.shortcut===t});r.forEach(function(o){o&&o.method&&o.method()})})}var xm={getPressedKeyString:DZ,setScope:k3,getScope:nu,deleteScope:NZ,getPressedKeyCodes:LZ,isPressed:jZ,filter:OZ,trigger:FZ,unbind:zZ,keyMap:tu,modifier:So,modifierMap:L0};for(var bm in xm)Object.prototype.hasOwnProperty.call(xm,bm)&&(Ei[bm]=xm[bm]);if(typeof window<"u"){var KZ=window.hotkeys;Ei.noConflict=function(t){return t&&window.hotkeys===Ei&&(window.hotkeys=KZ),Ei},window.hotkeys=Ei}function Ar(t){const{children:e,persistenceKey:n=TC,instanceId:r=zh,...o}=t,i=kC(),s=t.userId??i.id,a=AC({instanceId:r,userId:s,universalPersistenceKey:n,config:t.config});return f.jsx(Qv,{...o,instanceId:r,userId:s,store:a,children:f.jsxs(y3,{...o,children:[f.jsx(E3,{children:f.jsx(Hp,{})}),e]})})}var $3,oP=fl;$3=oP.createRoot,oP.hydrateRoot;/**
 * @remix-run/router v1.5.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ue(){return Ue=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ue.apply(this,arguments)}var Tt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Tt||(Tt={}));const iP="popstate";function HZ(t){t===void 0&&(t={});function e(r,o){let{pathname:i,search:s,hash:a}=r.location;return ru("",{pathname:i,search:s,hash:a},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:Ns(o)}return WZ(e,n,null,t)}function Le(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function el(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function VZ(){return Math.random().toString(36).substr(2,8)}function sP(t,e){return{usr:t.state,key:t.key,idx:e}}function ru(t,e,n,r){return n===void 0&&(n=null),Ue({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?si(e):e,{state:n,key:e&&e.key||r||VZ()})}function Ns(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function si(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function WZ(t,e,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,s=o.history,a=Tt.Pop,l=null,c=d();c==null&&(c=0,s.replaceState(Ue({},s.state,{idx:c}),""));function d(){return(s.state||{idx:null}).idx}function u(){a=Tt.Pop;let v=d(),x=v==null?null:v-c;c=v,l&&l({action:a,location:m.location,delta:x})}function h(v,x){a=Tt.Push;let b=ru(m.location,v,x);n&&n(b,v),c=d()+1;let E=sP(b,c),P=m.createHref(b);try{s.pushState(E,"",P)}catch{o.location.assign(P)}i&&l&&l({action:a,location:m.location,delta:1})}function p(v,x){a=Tt.Replace;let b=ru(m.location,v,x);n&&n(b,v),c=d();let E=sP(b,c),P=m.createHref(b);s.replaceState(E,"",P),i&&l&&l({action:a,location:m.location,delta:0})}function g(v){let x=o.location.origin!=="null"?o.location.origin:o.location.href,b=typeof v=="string"?v:Ns(v);return Le(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let m={get action(){return a},get location(){return t(o,s)},listen(v){if(l)throw new Error("A history only accepts one active listener");return o.addEventListener(iP,u),l=v,()=>{o.removeEventListener(iP,u),l=null}},createHref(v){return e(o,v)},createURL:g,encodeLocation(v){let x=g(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:p,go(v){return s.go(v)}};return m}var jt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(jt||(jt={}));const YZ=new Set(["lazy","caseSensitive","path","id","index","children"]);function XZ(t){return t.index===!0}function T3(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((o,i)=>{let s=[...n,i],a=typeof o.id=="string"?o.id:s.join("-");if(Le(o.index!==!0||!o.children,"Cannot specify children on an index route"),Le(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),XZ(o)){let l=Ue({},o,{hasErrorBoundary:e(o),id:a});return r[a]=l,l}else{let l=Ue({},o,{id:a,hasErrorBoundary:e(o),children:void 0});return r[a]=l,o.children&&(l.children=T3(o.children,e,s,r)),l}})}function $a(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?si(e):e,o=Cf(r.pathname||"/",n);if(o==null)return null;let i=M3(t);GZ(i);let s=null;for(let a=0;s==null&&a<i.length;++a)s=oJ(i[a],aJ(o));return s}function M3(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(i,s,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};l.relativePath.startsWith("/")&&(Le(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Cs([r,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(Le(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),M3(i.children,e,d,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:nJ(c,i.index),routesMeta:d})};return t.forEach((i,s)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))o(i,s);else for(let l of A3(i.path))o(i,s,l)}),e}function A3(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let s=A3(r.join("/")),a=[];return a.push(...s.map(l=>l===""?i:[i,l].join("/"))),o&&a.push(...s),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function GZ(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:rJ(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const qZ=/^:\w+$/,QZ=3,ZZ=2,JZ=1,eJ=10,tJ=-2,aP=t=>t==="*";function nJ(t,e){let n=t.split("/"),r=n.length;return n.some(aP)&&(r+=tJ),e&&(r+=ZZ),n.filter(o=>!aP(o)).reduce((o,i)=>o+(qZ.test(i)?QZ:i===""?JZ:eJ),r)}function rJ(t,e){return t.length===e.length&&t.slice(0,-1).every((r,o)=>r===e[o])?t[t.length-1]-e[e.length-1]:0}function oJ(t,e){let{routesMeta:n}=t,r={},o="/",i=[];for(let s=0;s<n.length;++s){let a=n[s],l=s===n.length-1,c=o==="/"?e:e.slice(o.length)||"/",d=iJ({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},c);if(!d)return null;Object.assign(r,d.params);let u=a.route;i.push({params:r,pathname:Cs([o,d.pathname]),pathnameBase:hJ(Cs([o,d.pathnameBase])),route:u}),d.pathnameBase!=="/"&&(o=Cs([o,d.pathnameBase]))}return i}function iJ(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=sJ(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let i=o[0],s=i.replace(/(.)\/+$/,"$1"),a=o.slice(1);return{params:r.reduce((c,d,u)=>{if(d==="*"){let h=a[u]||"";s=i.slice(0,i.length-h.length).replace(/(.)\/+$/,"$1")}return c[d]=lJ(a[u]||"",d),c},{}),pathname:i,pathnameBase:s,pattern:t}}function sJ(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),el(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(s,a)=>(r.push(a),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function aJ(t){try{return decodeURI(t)}catch(e){return el(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function lJ(t,e){try{return decodeURIComponent(t)}catch(n){return el(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Cf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function cJ(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:o=""}=typeof t=="string"?si(t):t;return{pathname:n?n.startsWith("/")?n:uJ(n,e):e,search:pJ(r),hash:fJ(o)}}function uJ(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function Sm(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function R3(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function dJ(t,e,n,r){r===void 0&&(r=!1);let o;typeof t=="string"?o=si(t):(o=Ue({},t),Le(!o.pathname||!o.pathname.includes("?"),Sm("?","pathname","search",o)),Le(!o.pathname||!o.pathname.includes("#"),Sm("#","pathname","hash",o)),Le(!o.search||!o.search.includes("#"),Sm("#","search","hash",o)));let i=t===""||o.pathname==="",s=i?"/":o.pathname,a;if(r||s==null)a=n;else{let u=e.length-1;if(s.startsWith("..")){let h=s.split("/");for(;h[0]==="..";)h.shift(),u-=1;o.pathname=h.join("/")}a=u>=0?e[u]:"/"}let l=cJ(o,a),c=s&&s!=="/"&&s.endsWith("/"),d=(i||s===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||d)&&(l.pathname+="/"),l}const Cs=t=>t.join("/").replace(/\/\/+/g,"/"),hJ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),pJ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,fJ=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Ix{constructor(e,n,r,o){o===void 0&&(o=!1),this.status=e,this.statusText=n||"",this.internal=o,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function L3(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const D3=["post","put","patch","delete"],gJ=new Set(D3),mJ=["get",...D3],yJ=new Set(mJ),vJ=new Set([301,302,303,307,308]),wJ=new Set([307,308]),Em={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},xJ={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},lP={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},O3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,j3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bJ=!j3,SJ=t=>!!t.hasErrorBoundary;function EJ(t){Le(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let e=t.detectErrorBoundary||SJ,n={},r=T3(t.routes,e,void 0,n),o,i=Ue({v7_normalizeFormMethod:!1},t.future),s=null,a=new Set,l=null,c=null,d=null,u=t.hydrationData!=null,h=$a(r,t.history.location,t.basename),p=null;if(h==null){let S=uo(404,{pathname:t.history.location.pathname}),{matches:T,route:R}=gP(r);h=T,p={[R.id]:S}}let g=!h.some(S=>S.route.lazy)&&(!h.some(S=>S.route.loader)||t.hydrationData!=null),m,v={historyAction:t.history.action,location:t.history.location,matches:h,initialized:g,navigation:Em,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||p,fetchers:new Map,blockers:new Map},x=Tt.Pop,b=!1,E,P=!1,C=!1,k=[],$=[],A=new Map,D=0,j=-1,Y=new Map,V=new Set,q=new Map,F=new Map,X=new Map,ne=!1;function ie(){return s=t.history.listen(S=>{let{action:T,location:R,delta:N}=S;if(ne){ne=!1;return}el(X.size===0||N!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let z=dr({currentLocation:v.location,nextLocation:R,historyAction:T});if(z&&N!=null){ne=!0,t.history.go(N*-1),We(z,{state:"blocked",location:R,proceed(){We(z,{state:"proceeding",proceed:void 0,reset:void 0,location:R}),t.history.go(N)},reset(){Ht(z),G({blockers:new Map(m.state.blockers)})}});return}return Ie(T,R)}),v.initialized||Ie(Tt.Pop,v.location),m}function W(){s&&s(),a.clear(),E&&E.abort(),v.fetchers.forEach((S,T)=>xn(T)),v.blockers.forEach((S,T)=>Ht(T))}function H(S){return a.add(S),()=>a.delete(S)}function G(S){v=Ue({},v,S),a.forEach(T=>T(v))}function Q(S,T){var R,N;let z=v.actionData!=null&&v.navigation.formMethod!=null&&Do(v.navigation.formMethod)&&v.navigation.state==="loading"&&((R=S.state)==null?void 0:R._isRedirect)!==!0,re;T.actionData?Object.keys(T.actionData).length>0?re=T.actionData:re=null:z?re=v.actionData:re=null;let ae=T.loaderData?fP(v.loaderData,T.loaderData,T.matches||[],T.errors):v.loaderData;for(let[se]of X)Ht(se);let ce=b===!0||v.navigation.formMethod!=null&&Do(v.navigation.formMethod)&&((N=S.state)==null?void 0:N._isRedirect)!==!0;o&&(r=o,o=void 0),G(Ue({},T,{actionData:re,loaderData:ae,historyAction:x,location:S,initialized:!0,navigation:Em,revalidation:"idle",restoreScrollPosition:M(S,T.matches||v.matches),preventScrollReset:ce,blockers:new Map(v.blockers)})),P||x===Tt.Pop||(x===Tt.Push?t.history.push(S,S.state):x===Tt.Replace&&t.history.replace(S,S.state)),x=Tt.Pop,b=!1,P=!1,C=!1,k=[],$=[]}async function le(S,T){if(typeof S=="number"){t.history.go(S);return}let{path:R,submission:N,error:z}=cP(S,i,T),re=v.location,ae=ru(v.location,R,T&&T.state);ae=Ue({},ae,t.history.encodeLocation(ae));let ce=T&&T.replace!=null?T.replace:void 0,se=Tt.Push;ce===!0?se=Tt.Replace:ce===!1||N!=null&&Do(N.formMethod)&&N.formAction===v.location.pathname+v.location.search&&(se=Tt.Replace);let ve=T&&"preventScrollReset"in T?T.preventScrollReset===!0:void 0,ke=dr({currentLocation:re,nextLocation:ae,historyAction:se});if(ke){We(ke,{state:"blocked",location:ae,proceed(){We(ke,{state:"proceeding",proceed:void 0,reset:void 0,location:ae}),le(S,T)},reset(){Ht(ke),G({blockers:new Map(v.blockers)})}});return}return await Ie(se,ae,{submission:N,pendingError:z,preventScrollReset:ve,replace:T&&T.replace})}function De(){if(kt(),G({revalidation:"loading"}),v.navigation.state!=="submitting"){if(v.navigation.state==="idle"){Ie(v.historyAction,v.location,{startUninterruptedRevalidation:!0});return}Ie(x||v.historyAction,v.navigation.location,{overrideNavigation:v.navigation})}}async function Ie(S,T,R){E&&E.abort(),E=null,x=S,P=(R&&R.startUninterruptedRevalidation)===!0,Ji(v.location,v.matches),b=(R&&R.preventScrollReset)===!0;let N=o||r,z=R&&R.overrideNavigation,re=$a(N,T,t.basename);if(!re){let $t=uo(404,{pathname:T.pathname}),{matches:Ot,route:bn}=gP(N);Dr(),Q(T,{matches:Ot,loaderData:{},errors:{[bn.id]:$t}});return}if(kJ(v.location,T)&&!(R&&R.submission&&Do(R.submission.formMethod))){Q(T,{matches:re});return}E=new AbortController;let ae=Wl(t.history,T,E.signal,R&&R.submission),ce,se;if(R&&R.pendingError)se={[Ta(re).route.id]:R.pendingError};else if(R&&R.submission&&Do(R.submission.formMethod)){let $t=await we(ae,T,R.submission,re,{replace:R.replace});if($t.shortCircuited)return;ce=$t.pendingActionData,se=$t.pendingActionError,z=Ue({state:"loading",location:T},R.submission),ae=new Request(ae.url,{signal:ae.signal})}let{shortCircuited:ve,loaderData:ke,errors:Ln}=await Ze(ae,T,re,z,R&&R.submission,R&&R.fetcherSubmission,R&&R.replace,ce,se);ve||(E=null,Q(T,Ue({matches:re},ce?{actionData:ce}:{},{loaderData:ke,errors:Ln})))}async function we(S,T,R,N,z){kt();let re=Ue({state:"submitting",location:T},R);G({navigation:re});let ae,ce=D0(N,T);if(!ce.route.action&&!ce.route.lazy)ae={type:jt.error,error:uo(405,{method:S.method,pathname:T.pathname,routeId:ce.route.id})};else if(ae=await Vl("action",S,ce,N,n,e,m.basename),S.signal.aborted)return{shortCircuited:!0};if(Ua(ae)){let se;return z&&z.replace!=null?se=z.replace:se=ae.location===v.location.pathname+v.location.search,await Zt(v,ae,{submission:R,replace:se}),{shortCircuited:!0}}if(vc(ae)){let se=Ta(N,ce.route.id);return(z&&z.replace)!==!0&&(x=Tt.Push),{pendingActionData:{},pendingActionError:{[se.route.id]:ae.error}}}if(Ss(ae))throw uo(400,{type:"defer-action"});return{pendingActionData:{[ce.route.id]:ae.data}}}async function Ze(S,T,R,N,z,re,ae,ce,se){let ve=N;ve||(ve=Ue({state:"loading",location:T,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},z));let ke=z||re?z||re:ve.formMethod&&ve.formAction&&ve.formData&&ve.formEncType?{formMethod:ve.formMethod,formAction:ve.formAction,formData:ve.formData,formEncType:ve.formEncType}:void 0,Ln=o||r,[$t,Ot]=uP(t.history,v,R,ke,T,C,k,$,q,Ln,t.basename,ce,se);if(Dr(Vt=>!(R&&R.some(Qn=>Qn.route.id===Vt))||$t&&$t.some(Qn=>Qn.route.id===Vt)),$t.length===0&&Ot.length===0)return Q(T,Ue({matches:R,loaderData:{},errors:se||null},ce?{actionData:ce}:{})),{shortCircuited:!0};if(!P){Ot.forEach(Qn=>{let $o=v.fetchers.get(Qn.key),ts={state:"loading",data:$o&&$o.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};v.fetchers.set(Qn.key,ts)});let Vt=ce||v.actionData;G(Ue({navigation:ve},Vt?Object.keys(Vt).length===0?{actionData:null}:{actionData:Vt}:{},Ot.length>0?{fetchers:new Map(v.fetchers)}:{}))}j=++D,Ot.forEach(Vt=>A.set(Vt.key,E));let{results:bn,loaderResults:Or,fetcherResults:es}=await vt(v.matches,R,$t,Ot,S);if(S.signal.aborted)return{shortCircuited:!0};Ot.forEach(Vt=>A.delete(Vt.key));let Co=mP(bn);if(Co)return await Zt(v,Co,{replace:ae}),{shortCircuited:!0};let{loaderData:oo,errors:ko}=pP(v,R,$t,Or,se,Ot,es,F);F.forEach((Vt,Qn)=>{Vt.subscribe($o=>{($o||Vt.done)&&F.delete(Qn)})}),Lr();let wl=ht(j);return Ue({loaderData:oo,errors:ko},wl||Ot.length>0?{fetchers:new Map(v.fetchers)}:{})}function je(S){return v.fetchers.get(S)||xJ}function ze(S,T,R,N){if(bJ)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");A.has(S)&&Dt(S);let re=$a(o||r,R,t.basename);if(!re){Lt(S,T,uo(404,{pathname:R}));return}let{path:ae,submission:ce}=cP(R,i,N,!0),se=D0(re,ae);if(b=(N&&N.preventScrollReset)===!0,ce&&Do(ce.formMethod)){Re(S,T,ae,se,re,ce);return}q.set(S,{routeId:T,path:ae}),Ft(S,T,ae,se,re,ce)}async function Re(S,T,R,N,z,re){if(kt(),q.delete(S),!N.route.action&&!N.route.lazy){let Jt=uo(405,{method:re.formMethod,pathname:R,routeId:T});Lt(S,T,Jt);return}let ae=v.fetchers.get(S),ce=Ue({state:"submitting"},re,{data:ae&&ae.data," _hasFetcherDoneAnything ":!0});v.fetchers.set(S,ce),G({fetchers:new Map(v.fetchers)});let se=new AbortController,ve=Wl(t.history,R,se.signal,re);A.set(S,se);let ke=await Vl("action",ve,N,z,n,e,m.basename);if(ve.signal.aborted){A.get(S)===se&&A.delete(S);return}if(Ua(ke)){A.delete(S),V.add(S);let Jt=Ue({state:"loading"},re,{data:void 0," _hasFetcherDoneAnything ":!0});return v.fetchers.set(S,Jt),G({fetchers:new Map(v.fetchers)}),Zt(v,ke,{submission:re,isFetchActionRedirect:!0})}if(vc(ke)){Lt(S,T,ke.error);return}if(Ss(ke))throw uo(400,{type:"defer-action"});let Ln=v.navigation.location||v.location,$t=Wl(t.history,Ln,se.signal),Ot=o||r,bn=v.navigation.state!=="idle"?$a(Ot,v.navigation.location,t.basename):v.matches;Le(bn,"Didn't find any matches after fetcher action");let Or=++D;Y.set(S,Or);let es=Ue({state:"loading",data:ke.data},re,{" _hasFetcherDoneAnything ":!0});v.fetchers.set(S,es);let[Co,oo]=uP(t.history,v,bn,re,Ln,C,k,$,q,Ot,t.basename,{[N.route.id]:ke.data},void 0);oo.filter(Jt=>Jt.key!==S).forEach(Jt=>{let bl=Jt.key,Mu=v.fetchers.get(bl),Tf={state:"loading",data:Mu&&Mu.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};v.fetchers.set(bl,Tf),A.set(bl,se)}),G({fetchers:new Map(v.fetchers)});let{results:ko,loaderResults:wl,fetcherResults:Vt}=await vt(v.matches,bn,Co,oo,$t);if(se.signal.aborted)return;Y.delete(S),A.delete(S),oo.forEach(Jt=>A.delete(Jt.key));let Qn=mP(ko);if(Qn)return Zt(v,Qn);let{loaderData:$o,errors:ts}=pP(v,v.matches,Co,wl,void 0,oo,Vt,F),Tu={state:"idle",data:ke.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};v.fetchers.set(S,Tu);let xl=ht(Or);v.navigation.state==="loading"&&Or>j?(Le(x,"Expected pending action"),E&&E.abort(),Q(v.navigation.location,{matches:bn,loaderData:$o,errors:ts,fetchers:new Map(v.fetchers)})):(G(Ue({errors:ts,loaderData:fP(v.loaderData,$o,bn,ts)},xl?{fetchers:new Map(v.fetchers)}:{})),C=!1)}async function Ft(S,T,R,N,z,re){let ae=v.fetchers.get(S),ce=Ue({state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},re,{data:ae&&ae.data," _hasFetcherDoneAnything ":!0});v.fetchers.set(S,ce),G({fetchers:new Map(v.fetchers)});let se=new AbortController,ve=Wl(t.history,R,se.signal);A.set(S,se);let ke=await Vl("loader",ve,N,z,n,e,m.basename);if(Ss(ke)&&(ke=await U3(ke,ve.signal,!0)||ke),A.get(S)===se&&A.delete(S),ve.signal.aborted)return;if(Ua(ke)){await Zt(v,ke);return}if(vc(ke)){let $t=Ta(v.matches,T);v.fetchers.delete(S),G({fetchers:new Map(v.fetchers),errors:{[$t.route.id]:ke.error}});return}Le(!Ss(ke),"Unhandled fetcher deferred data");let Ln={state:"idle",data:ke.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};v.fetchers.set(S,Ln),G({fetchers:new Map(v.fetchers)})}async function Zt(S,T,R){var N;let{submission:z,replace:re,isFetchActionRedirect:ae}=R===void 0?{}:R;T.revalidate&&(C=!0);let ce=ru(S.location,T.location,Ue({_isRedirect:!0},ae?{_isFetchActionRedirect:!0}:{}));if(Le(ce,"Expected a location on the redirect navigation"),O3.test(T.location)&&j3&&typeof((N=window)==null?void 0:N.location)<"u"){let Ot=t.history.createURL(T.location),bn=Cf(Ot.pathname,t.basename||"/")==null;if(window.location.origin!==Ot.origin||bn){re?window.location.replace(T.location):window.location.assign(T.location);return}}E=null;let se=re===!0?Tt.Replace:Tt.Push,{formMethod:ve,formAction:ke,formEncType:Ln,formData:$t}=S.navigation;!z&&ve&&ke&&$t&&Ln&&(z={formMethod:ve,formAction:ke,formEncType:Ln,formData:$t}),wJ.has(T.status)&&z&&Do(z.formMethod)?await Ie(se,ce,{submission:Ue({},z,{formAction:T.location}),preventScrollReset:b}):ae?await Ie(se,ce,{overrideNavigation:{state:"loading",location:ce,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},fetcherSubmission:z,preventScrollReset:b}):await Ie(se,ce,{overrideNavigation:{state:"loading",location:ce,formMethod:z?z.formMethod:void 0,formAction:z?z.formAction:void 0,formEncType:z?z.formEncType:void 0,formData:z?z.formData:void 0},preventScrollReset:b})}async function vt(S,T,R,N,z){let re=await Promise.all([...R.map(se=>Vl("loader",z,se,T,n,e,m.basename)),...N.map(se=>se.matches&&se.match?Vl("loader",Wl(t.history,se.path,z.signal),se.match,se.matches,n,e,m.basename):{type:jt.error,error:uo(404,{pathname:se.path})})]),ae=re.slice(0,R.length),ce=re.slice(R.length);return await Promise.all([yP(S,R,ae,z.signal,!1,v.loaderData),yP(S,N.map(se=>se.match),ce,z.signal,!0)]),{results:re,loaderResults:ae,fetcherResults:ce}}function kt(){C=!0,k.push(...Dr()),q.forEach((S,T)=>{A.has(T)&&($.push(T),Dt(T))})}function Lt(S,T,R){let N=Ta(v.matches,T);xn(S),G({errors:{[N.route.id]:R},fetchers:new Map(v.fetchers)})}function xn(S){A.has(S)&&Dt(S),q.delete(S),Y.delete(S),V.delete(S),v.fetchers.delete(S)}function Dt(S){let T=A.get(S);Le(T,"Expected fetch controller: "+S),T.abort(),A.delete(S)}function Kt(S){for(let T of S){let N={state:"idle",data:je(T).data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};v.fetchers.set(T,N)}}function Lr(){let S=[];for(let T of V){let R=v.fetchers.get(T);Le(R,"Expected fetcher: "+T),R.state==="loading"&&(V.delete(T),S.push(T))}Kt(S)}function ht(S){let T=[];for(let[R,N]of Y)if(N<S){let z=v.fetchers.get(R);Le(z,"Expected fetcher: "+R),z.state==="loading"&&(Dt(R),Y.delete(R),T.push(R))}return Kt(T),T.length>0}function Pt(S,T){let R=v.blockers.get(S)||lP;return X.get(S)!==T&&X.set(S,T),R}function Ht(S){v.blockers.delete(S),X.delete(S)}function We(S,T){let R=v.blockers.get(S)||lP;Le(R.state==="unblocked"&&T.state==="blocked"||R.state==="blocked"&&T.state==="blocked"||R.state==="blocked"&&T.state==="proceeding"||R.state==="blocked"&&T.state==="unblocked"||R.state==="proceeding"&&T.state==="unblocked","Invalid blocker state transition: "+R.state+" -> "+T.state),v.blockers.set(S,T),G({blockers:new Map(v.blockers)})}function dr(S){let{currentLocation:T,nextLocation:R,historyAction:N}=S;if(X.size===0)return;X.size>1&&el(!1,"A router only supports one blocker at a time");let z=Array.from(X.entries()),[re,ae]=z[z.length-1],ce=v.blockers.get(re);if(!(ce&&ce.state==="proceeding")&&ae({currentLocation:T,nextLocation:R,historyAction:N}))return re}function Dr(S){let T=[];return F.forEach((R,N)=>{(!S||S(N))&&(R.cancel(),T.push(N),F.delete(N))}),T}function Rn(S,T,R){if(l=S,d=T,c=R||(N=>N.key),!u&&v.navigation===Em){u=!0;let N=M(v.location,v.matches);N!=null&&G({restoreScrollPosition:N})}return()=>{l=null,d=null,c=null}}function Ji(S,T){if(l&&c&&d){let R=T.map(z=>vP(z,v.loaderData)),N=c(S,R)||S.key;l[N]=d()}}function M(S,T){if(l&&c&&d){let R=T.map(re=>vP(re,v.loaderData)),N=c(S,R)||S.key,z=l[N];if(typeof z=="number")return z}return null}function _(S){o=S}return m={get basename(){return t.basename},get state(){return v},get routes(){return r},initialize:ie,subscribe:H,enableScrollRestoration:Rn,navigate:le,fetch:ze,revalidate:De,createHref:S=>t.history.createHref(S),encodeLocation:S=>t.history.encodeLocation(S),getFetcher:je,deleteFetcher:xn,dispose:W,getBlocker:Pt,deleteBlocker:Ht,_internalFetchControllers:A,_internalActiveDeferreds:F,_internalSetRoutes:_},m}function PJ(t){return t!=null&&"formData"in t}function cP(t,e,n,r){r===void 0&&(r=!1);let o=typeof t=="string"?t:Ns(t);if(!n||!PJ(n))return{path:o};if(n.formMethod&&!MJ(n.formMethod))return{path:o,error:uo(405,{method:n.formMethod})};let i;if(n.formData){let l=n.formMethod||"get";if(i={formMethod:e.v7_normalizeFormMethod?l.toUpperCase():l.toLowerCase(),formAction:z3(o),formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:n.formData},Do(i.formMethod))return{path:o,submission:i}}let s=si(o),a=B3(n.formData);return r&&s.search&&F3(s.search)&&a.append("index",""),s.search="?"+a,{path:Ns(s),submission:i}}function _J(t,e){let n=t;if(e){let r=t.findIndex(o=>o.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function uP(t,e,n,r,o,i,s,a,l,c,d,u,h){let p=h?Object.values(h)[0]:u?Object.values(u)[0]:void 0,g=t.createURL(e.location),m=t.createURL(o),v=i||g.toString()===m.toString()||g.search!==m.search,x=h?Object.keys(h)[0]:void 0,E=_J(n,x).filter((C,k)=>{if(C.route.lazy)return!0;if(C.route.loader==null)return!1;if(IJ(e.loaderData,e.matches[k],C)||s.some(D=>D===C.route.id))return!0;let $=e.matches[k],A=C;return dP(C,Ue({currentUrl:g,currentParams:$.params,nextUrl:m,nextParams:A.params},r,{actionResult:p,defaultShouldRevalidate:v||N3($,A)}))}),P=[];return l.forEach((C,k)=>{if(!n.some(j=>j.route.id===C.routeId))return;let $=$a(c,C.path,d);if(!$){P.push(Ue({key:k},C,{matches:null,match:null}));return}let A=D0($,C.path);if(a.includes(k)){P.push(Ue({key:k,matches:$,match:A},C));return}dP(A,Ue({currentUrl:g,currentParams:e.matches[e.matches.length-1].params,nextUrl:m,nextParams:n[n.length-1].params},r,{actionResult:p,defaultShouldRevalidate:v}))&&P.push(Ue({key:k,matches:$,match:A},C))}),[E,P]}function IJ(t,e,n){let r=!e||n.route.id!==e.route.id,o=t[n.route.id]===void 0;return r||o}function N3(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function dP(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function hP(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let o=n[t.id];Le(o,"No route found in manifest");let i={};for(let s in r){let l=o[s]!==void 0&&s!=="hasErrorBoundary";el(!l,'Route "'+o.id+'" has a static property "'+s+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+s+'" will be ignored.')),!l&&!YZ.has(s)&&(i[s]=r[s])}Object.assign(o,i),Object.assign(o,{hasErrorBoundary:e(Ue({},o)),lazy:void 0})}async function Vl(t,e,n,r,o,i,s,a,l,c){s===void 0&&(s="/"),a===void 0&&(a=!1),l===void 0&&(l=!1);let d,u,h,p=v=>{let x,b=new Promise((E,P)=>x=P);return h=()=>x(),e.signal.addEventListener("abort",h),Promise.race([v({request:e,params:n.params,context:c}),b])};try{let v=n.route[t];if(n.route.lazy)if(v)u=(await Promise.all([p(v),hP(n.route,i,o)]))[0];else if(await hP(n.route,i,o),v=n.route[t],v)u=await p(v);else{if(t==="action")throw uo(405,{method:e.method,pathname:new URL(e.url).pathname,routeId:n.route.id});return{type:jt.data,data:void 0}}else Le(v,"Could not find the "+t+' to run on the "'+n.route.id+'" route'),u=await p(v);Le(u!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(v){d=jt.error,u=v}finally{h&&e.signal.removeEventListener("abort",h)}if(TJ(u)){let v=u.status;if(vJ.has(v)){let E=u.headers.get("Location");if(Le(E,"Redirects returned/thrown from loaders/actions must have a Location header"),O3.test(E)){if(!a){let P=new URL(e.url),C=E.startsWith("//")?new URL(P.protocol+E):new URL(E),k=Cf(C.pathname,s)!=null;C.origin===P.origin&&k&&(E=C.pathname+C.search+C.hash)}}else{let P=r.slice(0,r.indexOf(n)+1),C=R3(P).map($=>$.pathnameBase),k=dJ(E,C,new URL(e.url).pathname);if(Le(Ns(k),"Unable to resolve redirect location: "+E),s){let $=k.pathname;k.pathname=$==="/"?s:Cs([s,$])}E=Ns(k)}if(a)throw u.headers.set("Location",E),u;return{type:jt.redirect,status:v,location:E,revalidate:u.headers.get("X-Remix-Revalidate")!==null}}if(l)throw{type:d||jt.data,response:u};let x,b=u.headers.get("Content-Type");return b&&/\bapplication\/json\b/.test(b)?x=await u.json():x=await u.text(),d===jt.error?{type:d,error:new Ix(v,u.statusText,x),headers:u.headers}:{type:jt.data,data:x,statusCode:u.status,headers:u.headers}}if(d===jt.error)return{type:d,error:u};if($J(u)){var g,m;return{type:jt.deferred,deferredData:u,statusCode:(g=u.init)==null?void 0:g.status,headers:((m=u.init)==null?void 0:m.headers)&&new Headers(u.init.headers)}}return{type:jt.data,data:u}}function Wl(t,e,n,r){let o=t.createURL(z3(e)).toString(),i={signal:n};if(r&&Do(r.formMethod)){let{formMethod:s,formEncType:a,formData:l}=r;i.method=s.toUpperCase(),i.body=a==="application/x-www-form-urlencoded"?B3(l):l}return new Request(o,i)}function B3(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,r instanceof File?r.name:r);return e}function CJ(t,e,n,r,o){let i={},s=null,a,l=!1,c={};return n.forEach((d,u)=>{let h=e[u].route.id;if(Le(!Ua(d),"Cannot handle redirect results in processLoaderData"),vc(d)){let p=Ta(t,h),g=d.error;r&&(g=Object.values(r)[0],r=void 0),s=s||{},s[p.route.id]==null&&(s[p.route.id]=g),i[h]=void 0,l||(l=!0,a=L3(d.error)?d.error.status:500),d.headers&&(c[h]=d.headers)}else Ss(d)?(o.set(h,d.deferredData),i[h]=d.deferredData.data):i[h]=d.data,d.statusCode!=null&&d.statusCode!==200&&!l&&(a=d.statusCode),d.headers&&(c[h]=d.headers)}),r&&(s=r,i[Object.keys(r)[0]]=void 0),{loaderData:i,errors:s,statusCode:a||200,loaderHeaders:c}}function pP(t,e,n,r,o,i,s,a){let{loaderData:l,errors:c}=CJ(e,n,r,o,a);for(let d=0;d<i.length;d++){let{key:u,match:h}=i[d];Le(s!==void 0&&s[d]!==void 0,"Did not find corresponding fetcher result");let p=s[d];if(vc(p)){let g=Ta(t.matches,h==null?void 0:h.route.id);c&&c[g.route.id]||(c=Ue({},c,{[g.route.id]:p.error})),t.fetchers.delete(u)}else if(Ua(p))Le(!1,"Unhandled fetcher revalidation redirect");else if(Ss(p))Le(!1,"Unhandled fetcher deferred data");else{let g={state:"idle",data:p.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};t.fetchers.set(u,g)}}return{loaderData:l,errors:c}}function fP(t,e,n,r){let o=Ue({},e);for(let i of n){let s=i.route.id;if(e.hasOwnProperty(s)?e[s]!==void 0&&(o[s]=e[s]):t[s]!==void 0&&i.route.loader&&(o[s]=t[s]),r&&r.hasOwnProperty(s))break}return o}function Ta(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function gP(t){let e=t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function uo(t,e){let{pathname:n,routeId:r,method:o,type:i}=e===void 0?{}:e,s="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(s="Bad Request",o&&n&&r?a="You made a "+o+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"&&(a="defer() is not supported in actions")):t===403?(s="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):t===404?(s="Not Found",a='No route matches URL "'+n+'"'):t===405&&(s="Method Not Allowed",o&&n&&r?a="You made a "+o.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":o&&(a='Invalid request method "'+o.toUpperCase()+'"')),new Ix(t||500,s,new Error(a),!0)}function mP(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Ua(n))return n}}function z3(t){let e=typeof t=="string"?si(t):t;return Ns(Ue({},e,{hash:""}))}function kJ(t,e){return t.pathname===e.pathname&&t.search===e.search&&t.hash!==e.hash}function Ss(t){return t.type===jt.deferred}function vc(t){return t.type===jt.error}function Ua(t){return(t&&t.type)===jt.redirect}function $J(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function TJ(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function MJ(t){return yJ.has(t.toLowerCase())}function Do(t){return gJ.has(t.toLowerCase())}async function yP(t,e,n,r,o,i){for(let s=0;s<n.length;s++){let a=n[s],l=e[s];if(!l)continue;let c=t.find(u=>u.route.id===l.route.id),d=c!=null&&!N3(c,l)&&(i&&i[l.route.id])!==void 0;Ss(a)&&(o||d)&&await U3(a,r,o).then(u=>{u&&(n[s]=u||n[s])})}}async function U3(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:jt.data,data:t.deferredData.unwrappedData}}catch(o){return{type:jt.error,error:o}}return{type:jt.data,data:t.deferredData.data}}}function F3(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function vP(t,e){let{route:n,pathname:r,params:o}=t;return{id:n.id,pathname:r,params:o,data:e[n.id],handle:n.handle}}function D0(t,e){let n=typeof e=="string"?si(e).search:e.search;if(t[t.length-1].route.index&&F3(n||""))return t[t.length-1];let r=R3(t);return r[r.length-1]}/**
 * React Router v6.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function AJ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}const RJ=typeof Object.is=="function"?Object.is:AJ,{useState:LJ,useEffect:DJ,useLayoutEffect:OJ,useDebugValue:jJ}=mh;function NJ(t,e,n){const r=e(),[{inst:o},i]=LJ({inst:{value:r,getSnapshot:e}});return OJ(()=>{o.value=r,o.getSnapshot=e,Pm(o)&&i({inst:o})},[t,r,e]),DJ(()=>(Pm(o)&&i({inst:o}),t(()=>{Pm(o)&&i({inst:o})})),[t]),jJ(r),r}function Pm(t){const e=t.getSnapshot,n=t.value;try{const r=e();return!RJ(n,r)}catch{return!0}}function BJ(t,e,n){return e()}const zJ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",UJ=!zJ,FJ=UJ?BJ:NJ,KJ="useSyncExternalStore"in mh?(t=>t.useSyncExternalStore)(mh):FJ,Cx=w.createContext(null),kx=w.createContext(null),K3=w.createContext(null),kf=w.createContext(null),$f=w.createContext({outlet:null,matches:[]}),H3=w.createContext(null);function O0(){return O0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},O0.apply(this,arguments)}function $x(){return w.useContext(kf)!=null}function HJ(){return $x()||Le(!1),w.useContext(kf).location}function VJ(t,e){$x()||Le(!1);let{navigator:n}=w.useContext(K3),r=w.useContext(kx),{matches:o}=w.useContext($f),i=o[o.length-1],s=i?i.params:{};i&&i.pathname;let a=i?i.pathnameBase:"/";i&&i.route;let l=HJ(),c;if(e){var d;let m=typeof e=="string"?si(e):e;a==="/"||(d=m.pathname)!=null&&d.startsWith(a)||Le(!1),c=m}else c=l;let u=c.pathname||"/",h=a==="/"?u:u.slice(a.length)||"/",p=$a(t,{pathname:h}),g=GJ(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},s,m.params),pathname:Cs([a,n.encodeLocation?n.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?a:Cs([a,n.encodeLocation?n.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),o,r||void 0);return e&&g?w.createElement(kf.Provider,{value:{location:O0({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Tt.Pop}},g):g}function WJ(){let t=JJ(),e=L3(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),n?w.createElement("pre",{style:o},n):null,i)}class YJ extends w.Component{constructor(e){super(e),this.state={location:e.location,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location?{error:e.error,location:e.location}:{error:e.error||n.error,location:n.location}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?w.createElement($f.Provider,{value:this.props.routeContext},w.createElement(H3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function XJ(t){let{routeContext:e,match:n,children:r}=t,o=w.useContext(Cx);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement($f.Provider,{value:e},r)}function GJ(t,e,n){if(e===void 0&&(e=[]),t==null)if(n!=null&&n.errors)t=n.matches;else return null;let r=t,o=n==null?void 0:n.errors;if(o!=null){let i=r.findIndex(s=>s.route.id&&(o==null?void 0:o[s.route.id]));i>=0||Le(!1),r=r.slice(0,Math.min(r.length,i+1))}return r.reduceRight((i,s,a)=>{let l=s.route.id?o==null?void 0:o[s.route.id]:null,c=null;n&&(s.route.ErrorBoundary?c=w.createElement(s.route.ErrorBoundary,null):s.route.errorElement?c=s.route.errorElement:c=w.createElement(WJ,null));let d=e.concat(r.slice(0,a+1)),u=()=>{let h=i;return l?h=c:s.route.Component?h=w.createElement(s.route.Component,null):s.route.element&&(h=s.route.element),w.createElement(XJ,{match:s,routeContext:{outlet:i,matches:d},children:h})};return n&&(s.route.ErrorBoundary||s.route.errorElement||a===0)?w.createElement(YJ,{location:n.location,component:c,error:l,children:u(),routeContext:{outlet:null,matches:d}}):u()},null)}var wP;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator"})(wP||(wP={}));var bp;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator"})(bp||(bp={}));function qJ(t){let e=w.useContext(kx);return e||Le(!1),e}function QJ(t){let e=w.useContext($f);return e||Le(!1),e}function ZJ(t){let e=QJ(),n=e.matches[e.matches.length-1];return n.route.id||Le(!1),n.route.id}function JJ(){var t;let e=w.useContext(H3),n=qJ(bp.UseRouteError),r=ZJ(bp.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function eee(t){let{fallbackElement:e,router:n}=t,r=w.useCallback(()=>n.state,[n]),o=KJ(n.subscribe,r,r),i=w.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:l=>n.navigate(l),push:(l,c,d)=>n.navigate(l,{state:c,preventScrollReset:d==null?void 0:d.preventScrollReset}),replace:(l,c,d)=>n.navigate(l,{replace:!0,state:c,preventScrollReset:d==null?void 0:d.preventScrollReset})}),[n]),s=n.basename||"/",a=w.useMemo(()=>({router:n,navigator:i,static:!1,basename:s}),[n,i,s]);return w.createElement(w.Fragment,null,w.createElement(Cx.Provider,{value:a},w.createElement(kx.Provider,{value:o},w.createElement(nee,{basename:n.basename,location:n.state.location,navigationType:n.state.historyAction,navigator:i},n.state.initialized?w.createElement(ree,null):e))),null)}function tee(t){Le(!1)}function nee(t){let{basename:e="/",children:n=null,location:r,navigationType:o=Tt.Pop,navigator:i,static:s=!1}=t;$x()&&Le(!1);let a=e.replace(/^\/*/,"/"),l=w.useMemo(()=>({basename:a,navigator:i,static:s}),[a,i,s]);typeof r=="string"&&(r=si(r));let{pathname:c="/",search:d="",hash:u="",state:h=null,key:p="default"}=r,g=w.useMemo(()=>{let m=Cf(c,a);return m==null?null:{location:{pathname:m,search:d,hash:u,state:h,key:p},navigationType:o}},[a,c,d,u,h,p,o]);return g==null?null:w.createElement(K3.Provider,{value:l},w.createElement(kf.Provider,{children:n,value:g}))}function ree(t){let{children:e,location:n}=t,r=w.useContext(Cx),o=r&&!e?r.router.routes:j0(e);return VJ(o,n)}var xP;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(xP||(xP={}));new Promise(()=>{});function j0(t,e){e===void 0&&(e=[]);let n=[];return w.Children.forEach(t,(r,o)=>{if(!w.isValidElement(r))return;let i=[...e,o];if(r.type===w.Fragment){n.push.apply(n,j0(r.props.children,i));return}r.type!==tee&&Le(!1),!r.props.index||!r.props.children||Le(!1);let s={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(s.children=j0(r.props.children,i)),n.push(s)}),n}function oee(t){return!!t.ErrorBoundary||!!t.errorElement}/**
 * React Router DOM v6.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function N0(){return N0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},N0.apply(this,arguments)}function iee(t,e){return EJ({basename:e==null?void 0:e.basename,future:e==null?void 0:e.future,history:HZ({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||see(),routes:t,detectErrorBoundary:oee}).initialize()}function see(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=N0({},e,{errors:aee(e.errors)})),e}function aee(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,o]of e)if(o&&o.__type==="RouteErrorResponse")n[r]=new Ix(o.status,o.statusText,o.data,o.internal===!0);else if(o&&o.__type==="Error"){let i=new Error(o.message);i.stack="",n[r]=i}else n[r]=o;return n}var bP;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmitImpl="useSubmitImpl",t.UseFetcher="useFetcher"})(bP||(bP={}));var SP;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(SP||(SP={}));function lee(){return f.jsx("div",{className:"tldraw__editor",children:f.jsx(Ar,{autoFocus:!0})})}const cee={Brush:({brush:t})=>f.jsx("rect",{className:"tl-brush",stroke:"red",fill:"none",width:Math.max(1,t.w),height:Math.max(1,t.h),transform:`translate(${t.x},${t.y})`}),Scribble:({scribble:t,opacity:e,color:n})=>f.jsx("polyline",{points:t.points.map(r=>`${r.x},${r.y}`).join(" "),stroke:n??"black",opacity:e??"1",fill:"none"}),SnapLine:null};function uee(){return f.jsx("div",{className:"tldraw__editor",children:f.jsx(Ar,{persistenceKey:"custom-components-example",components:cee})})}function dee(){const t=w.useRef(-1);return f.jsx("div",{className:"tldraw__editor",children:f.jsx(Ar,{persistenceKey:"user-presence-example",onMount:e=>{const n=$s.createCustomId("user-1"),r=$s.create({id:n,name:"User 1"}),o=$h.create({...e.userPresence,id:$h.createCustomId("user-1"),cursor:{x:0,y:0},userId:n}),i=Fo.create({...e.instanceState,id:Fo.createCustomId("user-1"),userId:n}),s=Ha.create({...e.pageState,id:Ha.createCustomId("user-1"),instanceId:Fo.createCustomId("instance-1")});e.store.put([r,i,o,s]),t.current&&clearTimeout(t.current),e.store.put([{...o,cursor:{x:0,y:0},lastActivityTimestamp:Date.now()}]),t.current=setInterval(()=>{e.store.put([{...o,cursor:{x:0,y:0},lastActivityTimestamp:Date.now()}])},1e3)}})})}function hee(){const[t,e]=w.useState([]),n=w.useCallback((r,o)=>{e(i=>[`${r} ${JSON.stringify(o)}`,...i])},[]);return f.jsxs("div",{style:{display:"flex"},children:[f.jsx("div",{style:{width:"60vw",height:"100vh"},children:f.jsx(Ar,{autoFocus:!0,onUiEvent:n})}),f.jsx("div",{children:f.jsx("div",{style:{width:"40vw",height:"100vh",padding:8,background:"#eee",border:"none",fontFamily:"monospace",fontSize:12,borderLeft:"solid 2px #333",display:"flex",flexDirection:"column-reverse",overflow:"auto"},children:t.map((r,o)=>f.jsx("div",{children:r},o))})})]})}function pee(){const[t,e]=w.useState(),n=w.useCallback(i=>{e(i)},[]),[r,o]=w.useState([]);return w.useEffect(()=>{if(!t)return;function i(a){o(l=>[a,...l])}const s=a=>{if(a.source==="user"){for(const l of Object.values(a.changes.added))l.typeName==="shape"&&i(`created shape (${l.type})`);for(const[l,c]of Object.values(a.changes.updated))l.typeName==="instance"&&c.typeName==="instance"&&l.currentPageId!==c.currentPageId&&i(`changed page (${l.currentPageId}, ${c.currentPageId})`);for(const l of Object.values(a.changes.removed))l.typeName==="shape"&&i(`deleted shape (${l.type})`)}};return t.on("change",s),()=>{t.off("change",s)}},[t]),f.jsxs("div",{style:{display:"flex"},children:[f.jsx("div",{style:{width:"60vw",height:"100vh"},children:f.jsx(Ar,{autoFocus:!0,onMount:n})}),f.jsx("div",{children:f.jsx("div",{style:{width:"40vw",height:"100vh",padding:8,background:"#eee",border:"none",fontFamily:"monospace",fontSize:12,borderLeft:"solid 2px #333",display:"flex",flexDirection:"column-reverse",overflow:"auto"},children:r.map((i,s)=>f.jsx("div",{children:i},s))})})]})}function fee(){const t=e=>{const n=e.createShapeId("hello");e.focus(),e.createShapes([{id:n,type:"geo",x:128+Math.random()*500,y:128+Math.random()*500,props:{geo:"rectangle",w:100,h:100,dash:"draw",color:"blue",size:"m"}}]);const r=e.getShapeById(n);e.updateShapes([{id:n,type:"geo",props:{h:r.props.h*3,text:"hello world!"}}]),e.select(n),e.rotateShapesBy([n],Math.PI/8),e.selectNone(),e.zoomToFit()};return f.jsx("div",{className:"tldraw__editor",children:f.jsx(Ar,{persistenceKey:"api-example",onMount:t,autoFocus:!1,children:f.jsx(gee,{})})})}const gee=()=>{const t=Z();return w.useEffect(()=>{let e=0;const n=setInterval(()=>{const r=[...t.selectedIds];t.selectAll(),t.setProp("color",e%2?"blue":"light-blue"),t.setSelectedIds(r),e++},1e3);return()=>{clearInterval(n)}},[t]),null},mee=qn({type:"card",getShapeUtil:()=>V3});class V3 extends Yi{constructor(){super(...arguments);y(this,"isAspectRatioLocked",n=>!1);y(this,"canResize",n=>!0);y(this,"canBind",n=>!0)}defaultProps(){return{opacity:"1",w:300,h:300}}render(n){const r=this.bounds(n);return f.jsxs(Ts,{id:n.id,style:{border:"1px solid black",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"all"},children:[r.w.toFixed(),"x",r.h.toFixed()]})}indicator(n){return f.jsx("rect",{width:n.props.w,height:n.props.h})}}y(V3,"type","card");class B0 extends ic{constructor(){super(...arguments);y(this,"shapeType","card")}}y(B0,"id","card"),y(B0,"initial","idle");const yee=new _i({tools:[B0],shapes:[mee],allowUnknownShapes:!0});function vee(){return f.jsx("div",{className:"tldraw__editor",children:f.jsx(Ar,{persistenceKey:"custom-config",config:yee,autoFocus:!0,overrides:{tools(t,e){return e.card={id:"card",icon:"color",label:"Card",kbd:"c",readonlyOk:!1,onSelect:()=>{t.setSelectedTool("card")}},e},toolbar(t,e,{tools:n}){return e.splice(4,0,Ge(n.card)),e},keyboardShortcutsMenu(t,e,{tools:n}){return e.find(o=>o.id==="shortcuts-dialog.tools").children.push(K(n.card)),e}}})})}function wee(){return f.jsx("div",{className:"tldraw__editor",children:f.jsxs(Qv,{autoFocus:!0,children:[f.jsx(Hp,{}),f.jsx(xee,{})]})})}const xee=Me(()=>{const t=Z();return w.useEffect(()=>{const e=n=>{switch(n.key){case"Delete":case"Backspace":t.deleteShapes()}};return window.addEventListener("keyup",e),()=>{window.removeEventListener("keyup",e)}}),f.jsx("div",{className:"custom-layout",children:f.jsxs("div",{className:"custom-toolbar",children:[f.jsx("button",{className:"custom-button","data-isactive":t.currentToolId==="select",onClick:()=>t.setSelectedTool("select"),children:"Select"}),f.jsx("button",{className:"custom-button","data-isactive":t.currentToolId==="draw",onClick:()=>t.setSelectedTool("draw"),children:"Pencil"}),f.jsx("button",{className:"custom-button","data-isactive":t.currentToolId==="eraser",onClick:()=>t.setSelectedTool("eraser"),children:"Eraser"})]})})}),EP=Fo.createCustomId("example");function bee(){const t=kC(),e=AC({instanceId:EP,userId:t.id,universalPersistenceKey:"exploded-example"});return f.jsx("div",{className:"tldraw__editor",children:f.jsx(Qv,{instanceId:EP,userId:t.id,store:e,autoFocus:!0,children:f.jsx(y3,{children:f.jsx(E3,{children:f.jsx(Hp,{})})})})})}function See(){return f.jsx("div",{style:{width:"120vw",height:"150vh",display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:"url(https://source.unsplash.com/random/2000x2000)"},children:f.jsx("div",{style:{width:"60vw",height:"80vh"},children:f.jsx(Ar,{persistenceKey:"scroll-example",autoFocus:!0})})})}function Eee(){return f.jsxs("div",{style:{width:"120vw",height:"150vh",display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:"url(https://source.unsplash.com/random/2000x2000)"},children:[f.jsx("div",{style:{width:"60vw",height:"80vh"},children:f.jsx(Ar,{persistenceKey:"steve",autoFocus:!0})}),f.jsx("textarea",{defaultValue:"type in me",style:{margin:10}}),f.jsx("div",{style:{width:"60vw",height:"80vh"},children:f.jsx(Ar,{persistenceKey:"david",autoFocus:!1})})]})}function Pee(){return f.jsx("div",{className:"tldraw__editor",children:f.jsx(Ar,{persistenceKey:"error-boundary-example",components:{ErrorFallback:null,ShapeErrorFallback:({error:t})=>f.jsxs("div",{children:["Shape error! ",String(t)]})},config:Iee,onMount:t=>{t.createShapes([{type:"error",id:Ut(),x:0,y:0,props:{message:"Something has gone wrong"}}])}})})}const _ee=qn({type:"error",getShapeUtil:()=>{var t;return t=class extends Yi{defaultProps(){return{message:"Error!",w:100,h:100}}render(n){throw new Error(n.props.message)}indicator(){throw new Error("Error shape indicator!")}},y(t,"type","error"),t}}),Iee=new _i({shapes:[_ee],allowUnknownShapes:!0});function Cee(){return f.jsx("div",{className:"tldraw__editor",children:f.jsx(Ar,{persistenceKey:"hide-ui-example",autoFocus:!0,hideUi:!0})})}const W3=rR();O9(W3);bG(W3);const kee=[{path:"/",element:f.jsx(lee,{})},{path:"/scroll",element:f.jsx(See,{})},{path:"/multiple",element:f.jsx(Eee,{})},{path:"/api",element:f.jsx(fee,{})},{path:"/custom",element:f.jsx(vee,{})},{path:"/custom-ui",element:f.jsx(wee,{})},{path:"/exploded",element:f.jsx(bee,{})},{path:"/hide-ui",element:f.jsx(Cee,{})},{path:"/error-boundary",element:f.jsx(Pee,{})},{path:"/custom-components",element:f.jsx(uee,{})},{path:"/ui-events",element:f.jsx(hee,{})},{path:"/store-events",element:f.jsx(pee,{})},{path:"/user-presence",element:f.jsx(dee,{})}],$ee=iee(kee),Tee=document.getElementById("root"),Mee=$3(Tee);Mee.render(f.jsx(w.StrictMode,{children:f.jsx(Hv,{fallback:t=>f.jsx(Vv,{error:t}),onError:t=>console.error(t),children:f.jsx(eee,{router:$ee})})}));
